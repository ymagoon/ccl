 ;;Solution_Test/script/PathNet -- BB Transfusion/BBTLocationType/BBT_GET_LOCATION_INFO.INC Turn on black mode

/*******************************************************************************************
 * NAME:  bbt_get_location_info.inc
 *
 * PURPOSE:  To retrieve the location name and address for a specific adress_location_cd
 *
 * USE:
 *       1.  In calling program 
 *              %i cclsource:bbt_get_location_info.inc
 *       2.  To retrieve info:
 *                      sub_get_location_name           ;holds the location name
 *                      sub_get_location_address1       ;holds the street_addr data
 *                      sub_get_location_address2       ;holds the street_addr2 data
 *                      sub_get_location_address3       ;holds the street_addr3 data
 *                      sub_get_location_address4       ;holds the street_addr4 data
 *                      sub_get_location_citystatezip   ;holds the concat(city,state,zip) data
 *                      sub_get_location_country        ;holds the county data
 *
 * NOTE:  May need to change the length of the sub_get_location_name.  May override the report title.
 * MODIFICATIONS:  12/16/98 Creation. SN4200
 *******************************************************************************************/
/*******************************************************************************************
 *  Variables to hold the information to be used in the calling program.                   *
 *******************************************************************************************/           
    set sub_get_location_name = FILLSTRING(25, " ")
    set sub_get_location_address1 = FILLSTRING(100, " ")
    set sub_get_location_address2 = FILLSTRING(100, " ")
    set sub_get_location_address3 = FILLSTRING(100, " ")
    set sub_get_location_address4 = FILLSTRING(100, " ")
    set sub_get_location_citystatezip = FILLSTRING(100, " ")
    set sub_get_location_country = FILLSTRING(100, " ")

;Test if there's an address code passed in.
IF (request->address_location_cd != 0) 
 set addr_type_cd = 0.0
 set code_cnt = 1
 set stat = uar_get_meaning_by_codeset(212, "BUSINESS", code_cnt, addr_type_cd)
 IF (addr_type_cd = 0.0)
        set sub_get_location_name = "<<INFORMATION NOT FOUND>>"
 ELSE

    SELECT INTO "nl:"
        a.street_addr,
        a.street_addr2,
        a.street_addr3,
        a.street_addr4,
        a.city,
        a.state,
        a.zipcode,
        a.country,
        l.location_cd

    FROM
        address a

    WHERE
        a.active_ind = 1 and
        a.address_type_cd = addr_type_cd and
        a.parent_entity_name = "LOCATION" and
        a.parent_entity_id = request->address_location_cd 

    DETAIL
        sub_get_location_name = uar_get_code_display(request->address_location_cd)
        sub_get_location_address1 = a.street_addr
        sub_get_location_address2 = a.street_addr2
        sub_get_location_address3 = a.street_addr3
        sub_get_location_address4 = a.street_addr4
        sub_get_location_citystatezip = concat(trim(a.city), ", ", trim(a.state), "  ", trim(a.zipcode))
        sub_get_location_country = a.country

    WITH    NOCOUNTER
    IF (curqual = 0)
        set sub_get_location_name = "<<INFORMATION NOT FOUND>>"
    ENDIF
  ENDIF

ELSE
        set sub_get_location_name = "<<INFORMATION NOT FOUND>>"
ENDIF



;Generated by GNU enscript 1.6.4.
