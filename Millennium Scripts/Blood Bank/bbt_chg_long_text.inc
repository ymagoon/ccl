 ;;Solution_Test/script/PathNet -- BB Transfusion/Bbt_Longtext_Inc/BBT_CHG_LONG_TEXT.INC Turn on black mode

/*
 * bbt_chg_long_text.inc:  change/update long_text row
 *
 * USE:
 *  1.  Include bbt_chg_long_text.inc in calling program (NOTE:  the 'END' for the subroutine is to be coded in the 
 *      calling program to allow for additional functionality for the subroutine by the calling program):
 *          %i cclsource:bbt_chg_long_text.inc
 *          END         ; end subroutine CHG_LONG_TEXT
 *  2.  Call CHG_LONG_TEXT as follows: */
 ;          call CHG_LONG_TEXT 
 ;              (
 ;               /* long_text_id       */ <long_text_id>,       
 ;               /* long_text_updt_cnt */ <long_text_updt_cnt>,
 ;               /* long_text          */ <long_text>,                  ; blank OK if update_text_id = 0
 ;               /* active_ind         */ 1 or 0, 
 ;               /* active_status_cd   *  reqdata->active_status_cd or reqdata->inactive_status_cd,
 ;               /* update_text_ind    */ 1 or 0,                       ; 1=update text, 0 = do NOT update text 
 ;              )
/*  3.  Evaluate curqual to determine success/failure of add
 */

subroutine CHG_LONG_TEXT
    (
     sub_long_text_id,
     sub_long_text_updt_cnt,
     sub_long_text,
     sub_active_ind,
     sub_active_status_cd,
     sub_update_text_ind
    )


    if (sub_update_text_ind = 1)
        /* Update long_text in long_text row */
        update into long_text lt
            set lt.long_text                = sub_long_text,
                lt.updt_cnt                 = lt.updt_cnt + 1,
                lt.updt_dt_tm               = cnvtdatetime(curdate, curtime3),
                lt.updt_id                  = reqinfo->updt_id,
                lt.updt_task                = reqinfo->updt_task,
                lt.updt_applctx             = reqinfo->updt_applctx,
                lt.active_ind               = sub_active_ind,
                lt.active_status_cd         = sub_active_status_cd,
                lt.active_status_dt_tm      = cnvtdatetime(curdate, curtime3),
                lt.active_status_prsnl_id   = reqinfo->updt_id
        
        where   lt.long_text_id             = sub_long_text_id
                  and lt.updt_cnt           = sub_long_text_updt_cnt

        with    nocounter

    else          
        /* do NOT update text in long_text row */
        update into long_text lt
            set lt.updt_cnt                 = lt.updt_cnt + 1,
                lt.updt_dt_tm               = cnvtdatetime(curdate, curtime3),
                lt.updt_id                  = reqinfo->updt_id,
                lt.updt_task                = reqinfo->updt_task,
                lt.updt_applctx             = reqinfo->updt_applctx,
                lt.active_ind               = sub_active_ind,
                lt.active_status_cd         = sub_active_status_cd,
                lt.active_status_dt_tm      = cnvtdatetime(curdate, curtime3),
                lt.active_status_prsnl_id   = reqinfo->updt_id
        
        where   lt.long_text_id             = sub_long_text_id
                  and lt.updt_cnt           = sub_long_text_updt_cnt

        with    nocounter
    endif

;Generated by GNU enscript 1.6.4.
