 ;;Solution_Test/script/PathNet -- BB Transfusion/Producttool/BBT_CHK_STORAGE_TEMP.PRG Turn on black mode

/*~BB~************************************************************************
  *                                                                      *
  *  Copyright Notice:  (c) 1983 Laboratory Information Systems &        *
  *                              Technology, Inc.                        *
  *       Revision      (c) 1984-1997 Cerner Corporation                 *
  *                                                                      *
  *  Cerner (R) Proprietary Rights Notice:  All rights reserved.         *
  *  This material contains the valuable properties and trade secrets of *
  *  Cerner Corporation of Kansas City, Missouri, United States of       *
  *  America (Cerner), embodying substantial creative efforts and        *
  *  confidential information, ideas and expressions, no part of which   *
  *  may be reproduced or transmitted in any form or by any means, or    *
  *  retained in any storage or retrieval system without the express     *
  *  written permission of Cerner.                                       *
  *                                                                      *
  *  Cerner is a registered mark of Cerner Corporation.                  *
  *                                                                      *
  ~BE~***********************************************************************/
/*****************************************************************************

        Source file name:       bbt_chk_storage_temp.prg
        Object name:            bbt_chk_storage_temp
        Request #:              <None>

        Product:                PathNet
        Product Team:           Blood Bank Transfusion
        HNA Version:            500
        CCL Version:            4.0

        Program purpose:        Validate  bbt_cnvt_storage_temp.prg

        Tables read:            product_category, product_index

        Tables updated:         <None>

        Executing from:         ccl

        Special Notes:          

******************************************************************************/
;~DB~************************************************************************
;    *                      GENERATED MODIFICATION CONTROL LOG              *
;    ************************************************************************
;    *                                                                      *
;    *Mod Date     Engineer             Comment                             *
;    *--- -------- -------------------- ----------------------------------- *
;    *000 06/02/98 Victoria Savariyar   Initial Release                     *
;    *                                                                      *
;~DE~************************************************************************
;
;~END~ ******************  END OF ALL MODCONTROL BLOCKS  ********************
 
drop program bbt_chk_storage_temp:dba go
create program bbt_chk_storage_temp:dba

record pc_rec
(
 1 pc[*]
   2 product_cat_cd     = f8
   2 product_class_cd   = f8
   2 storage_temp_cd    = f8
)

set request->setup_proc[1]->success_ind = 0
set request->setup_proc[1]->error_msg = ""
set stat = alterlist(pc_rec->pc,10)
set pc_cnt = 0

 select into "nl:"
       pc.product_category
  from product_category pc
  where pc.storage_temp_cd > 0
  detail
       pc_cnt = pc_cnt + 1
       if (mod(pc_cnt,10) = 1 and pc_cnt != 1)
           stat = alterlist(pc_rec->pc, pc_cnt + 9)
       endif
       pc_rec->pc[pc_cnt]->product_class_cd = pc.product_class_cd
       pc_rec->pc[pc_cnt]->product_cat_cd = pc.product_cat_cd
       pc_rec->pc[pc_cnt]->storage_temp_cd = pc.storage_temp_cd
  with nocounter

for (pc = 1 to pc_cnt)

set found_ind = 0
set same_ind = 1

select into "nl:"
       pi.storage_temp_cd
from 
       product_index pi
where 
       pi.product_class_cd = pc_rec->pc[pc]->product_class_cd 
       and pi.product_cat_cd = pc_rec->pc[pc]->product_cat_cd
detail
       found_ind = 1
       if (pi.storage_temp_cd != pc_rec->pc[pc]->storage_temp_cd)
          same_ind = 0
       endif
with nocounter

if ((curqual > 0)
   and (found_ind = 1) and (same_ind = 0))
   set request->setup_proc[1]->success_ind = 0
   set request->setup_proc[1]->error_msg = "FAILURE"
   GO TO EXIT_SCRIPT
endif
endfor
 
set request->setup_proc[1]->success_ind = 1
set request->setup_proc[1]->error_msg = "SUCCESS"


# EXIT_SCRIPT
execute dm_add_upt_setup_proc_log
call echo(build("pc_cnt     = ", pc_cnt))
call echo(build("success_ind     = ",request->setup_proc[1].success_ind))
call echo(build("error_msg     = ",request->setup_proc[1].error_msg))   

end go

;Generated by GNU enscript 1.6.4.
