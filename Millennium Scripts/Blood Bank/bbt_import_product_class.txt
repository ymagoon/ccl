 ;;Solution_Test/script/PathNet -- BB Transfusion/BBT_IMPORT_PRODUCT_CLASS/bbt_import_product_class.prg Turn on black mode

/*****************************************************************************
      *                                                                      *
      *  Copyright Notice:  (c) 1983 Laboratory Information Systems &        *
      *                              Technology, Inc.                        *
      *       Revision      (c) 1984-1995 Cerner Corporation                 *
      *                                                                      *
      *  Cerner (R) Proprietary Rights Notice:  All rights reserved.         *
      *  This material contains the valuable properties and trade secrets of *
      *  Cerner Corporation of Kansas City, Missouri, United States of       *
      *  America (Cerner), embodying substantial creative efforts and        *
      *  confidential information, ideas and expressions, no part of which   *
      *  may be reproduced or transmitted in any form or by any means, or    *
      *  retained in any storage or retrieval system without the express     *
      *  written permission of Cerner.                                       *
      *                                                                      *
      *  Cerner is a registered mark of Cerner Corporation.                  *
      *                                                                      *
      ***********************************************************************/

/*****************************************************************************

        Author:                 Lisa Grayson
        Date Written:           10/12/96
        Source file name:       BBT_IMPORT_PRODUCT_CLASS
        Object name:            BBT_IMPORT_PRODUCT_CLASS
        Request #:              NONE

        Product:                Blood Bank Transfusion
        Product Team:           Blood Bank
        HNA Version:            500
        CCL Version:            4.0
        
        Program purpose:        Add records to PRODUCT_CLASS
        Tables read:            none
        Tables updated:         PRODUCT_CLASS
        Executing from:         DImport.EXE

        Special Notes: 

******************************************************************************/
 
/*   ************************************************************************
     *                      GENERATED MODIFICATION CONTROL LOG              *
     ************************************************************************
     *                                                                      *
     *Mod Date     Engineer             Comment                             *
     *--- -------- -------------------- ----------------------------------- *
     *000 12/12/96 Lisa Grayson         Initial Release                     *
     ********************  END OF ALL MODCONTROL BLOCKS  *******************/
drop program   bbt_import_product_class:dba go
create program bbt_import_product_class:dba

/*
record requestin
(
1 list_0[*]
  2 Meaning = c12
)
*/

record status_data
(
1 active_ind      = i2
1 active_dt_tm    = dq8
1 inactive_dt_tm  = dq8
)


set max_list    = size(requestin->list_0,5)
set x = 1

#start_loop

if (x > max_list)
   go to exit_script
endif

for (x = x to max_list)
   set success     = 0
   set cdf_meaning = fillstring(12," ")
   set code_value  = 0.0
   set code_display = fillstring(40, " ")

   set code_set = 1606

   select into "nl:"
      from code_value c
   where
      c.cdf_meaning = requestin->list_0[x].meaning and
      c.code_set = 1606
   detail
      code_value = c.code_value
      code_display = c.display
   with counter
   if (curqual = 0)
      go to next_item
   endif

   if (code_value > 0)
      insert into product_class p
        set
         p.product_class_cd  = code_value,
         p.description = code_display,
         p.active_ind       = 1,
         p.updt_id          = 0057,
         p.updt_task        = 0057,
         p.updt_applctx     = 0057,
         p.updt_cnt         = 0,
         p.updt_dt_tm       = cnvtdatetime(curdate,curtime3)
        with nocounter
    
        if (curqual = 0)
            set success = 0
            go to next_item
         endif

   commit
   else
      set success = 0
      go to next_item
   endif

endfor

go to exit_script

#next_item
   rollback
   set x = x + 1
   go to start_loop

#exit_script

end go

;Generated by GNU enscript 1.6.4.
