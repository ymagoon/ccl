 ;;Solution_Test/script/PathNet -- BB Transfusion/Bbt_Reportselection/BBT_GET_INST_NAME.INC Turn on black mode

/*
 * NAME:  bbt_get_inst_name.inc
 * 
 * PURPOSE:  Retrieve Institution Name from preference answer
 *
 * USE:
 *      1.  In calling program (only once, probably at top or bottom):
 *              %i cclsource:bbt_get_inst_name.inc
 *      2.  To Institution Name preference answer:
 *              <String c60> = GET_INST_NAME
 *              if (curqual = 0)
 *                  <error processing>
 *              else
 *                  <continue processing>
 *
 * jow - 03/23/1998
 */


DECLARE GET_INST_NAME(inst_name_dummy) = c60

SUBROUTINE GET_INST_NAME(inst_name_dummy)
    SET inst_name_pref = fillstring(60, " ")

    SET module_cd       = 0.0
    SET process_cd      = 0.0
    SET question_cd     = 0.0


set stat = uar_get_meaning_by_codeset(1660, "BB TRANSF", 1, module_cd)
set stat = uar_get_meaning_by_codeset(1662, "BBTGLOBAL", 1, process_cd)
set stat = uar_get_meaning_by_codeset(1661, "INST NAME", 1, question_cd)

    SELECT INTO "nl:"
        a.answer

    FROM
        answer a

    PLAN    a       WHERE   a.module_cd                         = module_cd
                              AND a.process_cd                  = process_cd
                              AND a.question_cd                 = question_cd
                              AND a.active_ind                  = 1

    DETAIL
        inst_name_pref = a.answer
    
    WITH
        nocounter

    IF (curqual = 0)
        set inc_i18nHandle = 0
	  set inc_h = uar_i18nlocalizationinit(inc_i18nHandle, curprog, "", curcclrev)
        set inst_name_pref = uar_i18ngetmessage(inc_i18nHandle, "inc_inst_not_found", "<< INSTITUTION NAME NOT FOUND >>")
    ENDIF


    RETURN(inst_name_pref)
END             ; end subroutine GET_INST_NAME

;Generated by GNU enscript 1.6.4.
