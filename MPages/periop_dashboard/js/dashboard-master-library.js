/*! jQuery v1.7.2 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cu(a){if(!cj[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),b.appendChild(ck);if(!cl||!ck.createElement)cl=(ck.contentWindow||ck.contentDocument).document,cl.write((f.support.boxModel?"<!doctype html>":"")+"<html><body>"),cl.close();d=cl.createElement(a),cl.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ck)}cj[a]=e}return cj[a]}function ct(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function cs(){cq=b}function cr(){setTimeout(cs,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bD.test(a)?d(a,e):b_(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)});else if(!c&&f.type(b)==="object")for(var e in b)b_(a+"["+e+"]",b[e],c,d);else d(a,b)}function b$(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bZ(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bS,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bZ(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=bZ(a,c,d,e,"*",g));return l}function bY(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bO),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bB(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?1:0,g=4;if(d>0){if(c!=="border")for(;e<g;e+=2)c||(d-=parseFloat(f.css(a,"padding"+bx[e]))||0),c==="margin"?d+=parseFloat(f.css(a,c+bx[e]))||0:d-=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0;return d+"px"}d=by(a,b);if(d<0||d==null)d=a.style[b];if(bt.test(d))return d;d=parseFloat(d)||0;if(c)for(;e<g;e+=2)d+=parseFloat(f.css(a,"padding"+bx[e]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+bx[e]))||0);return d+"px"}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;b.nodeType===1&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?b.outerHTML=a.outerHTML:c!=="input"||a.type!=="checkbox"&&a.type!=="radio"?c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(f.expando),b.removeAttribute("_submit_attached"),b.removeAttribute("_change_attached"))}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c,i[c][d])}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?+d:j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){if(typeof c!="string"||!c)return null;var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h,i){var j,k=d==null,l=0,m=a.length;if(d&&typeof d=="object"){for(l in d)e.access(a,c,l,d[l],1,h,f);g=1}else if(f!==b){j=i===b&&e.isFunction(f),k&&(j?(j=c,c=function(a,b,c){return j.call(e(a),c)}):(c.call(a,f),c=null));if(c)for(;l<m;l++)c(a[l],d,j?f.call(a[l],l,c(a[l],d)):f,i);g=1}return g?a:k?c.call(a):m?c(a[0],d):h},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test("Â ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m,n=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?n(g):h==="function"&&(!a.unique||!p.has(g))&&c.push(g)},o=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,j=!0,m=k||0,k=0,l=c.length;for(;c&&m<l;m++)if(c[m].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}j=!1,c&&(a.once?e===!0?p.disable():c=[]:d&&d.length&&(e=d.shift(),p.fireWith(e[0],e[1])))},p={add:function(){if(c){var a=c.length;n(arguments),j?l=c.length:e&&e!==!0&&(k=a,o(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){j&&f<=l&&(l--,f<=m&&m--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&p.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(j?a.once||d.push([b,c]):(!a.once||!e)&&o(b,c));return this},fire:function(){p.fireWith(this,arguments);return this},fired:function(){return!!i}};return p};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p=c.createElement("div"),q=c.documentElement;p.setAttribute("className","t"),p.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=p.getElementsByTagName("*"),e=p.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=p.getElementsByTagName("input")[0],b={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:p.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},f.boxModel=b.boxModel=c.compatMode==="CSS1Compat",i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete p.test}catch(r){b.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",function(){b.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),i.setAttribute("name","t"),p.appendChild(i),j=c.createDocumentFragment(),j.appendChild(p.lastChild),b.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,j.removeChild(i),j.appendChild(p);if(p.attachEvent)for(n in{submit:1,change:1,focusin:1})m="on"+n,o=m in p,o||(p.setAttribute(m,"return;"),o=typeof p[m]=="function"),b[n+"Bubbles"]=o;j.removeChild(p),j=g=h=p=i=null,f(function(){var d,e,g,h,i,j,l,m,n,q,r,s,t,u=c.getElementsByTagName("body")[0];!u||(m=1,t="padding:0;margin:0;border:",r="position:absolute;top:0;left:0;width:1px;height:1px;",s=t+"0;visibility:hidden;",n="style='"+r+t+"5px solid #000;",q="<div "+n+"display:block;'><div style='"+t+"0;display:block;overflow:hidden;'></div></div>"+"<table "+n+"' cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",d=c.createElement("div"),d.style.cssText=s+"width:0;height:0;position:static;top:0;margin-top:"+m+"px",u.insertBefore(d,u.firstChild),p=c.createElement("div"),d.appendChild(p),p.innerHTML="<table><tr><td style='"+t+"0;display:none'></td><td>t</td></tr></table>",k=p.getElementsByTagName("td"),o=k[0].offsetHeight===0,k[0].style.display="",k[1].style.display="none",b.reliableHiddenOffsets=o&&k[0].offsetHeight===0,a.getComputedStyle&&(p.innerHTML="",l=c.createElement("div"),l.style.width="0",l.style.marginRight="0",p.style.width="2px",p.appendChild(l),b.reliableMarginRight=(parseInt((a.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)===0),typeof p.style.zoom!="undefined"&&(p.innerHTML="",p.style.width=p.style.padding="1px",p.style.border=0,p.style.overflow="hidden",p.style.display="inline",p.style.zoom=1,b.inlineBlockNeedsLayout=p.offsetWidth===3,p.style.display="block",p.style.overflow="visible",p.innerHTML="<div style='width:5px;'></div>",b.shrinkWrapBlocks=p.offsetWidth!==3),p.style.cssText=r+s,p.innerHTML=q,e=p.firstChild,g=e.firstChild,i=e.nextSibling.firstChild.firstChild,j={doesNotAddBorder:g.offsetTop!==5,doesAddBorderForTableAndCells:i.offsetTop===5},g.style.position="fixed",g.style.top="20px",j.fixedPosition=g.offsetTop===20||g.offsetTop===15,g.style.position=g.style.top="",e.style.overflow="hidden",e.style.position="relative",j.subtractsBorderForOverflowNotVisible=g.offsetTop===-5,j.doesNotIncludeMarginInBodyOffset=u.offsetTop!==m,a.getComputedStyle&&(p.style.marginTop="1%",b.pixelMargin=(a.getComputedStyle(p,null)||{marginTop:0}).marginTop!=="1%"),typeof d.style.zoom!="undefined"&&(d.style.zoom=1),u.removeChild(d),l=p=d=null,f.extend(b,j))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h,i,j=this[0],k=0,m=null;if(a===b){if(this.length){m=f.data(j);if(j.nodeType===1&&!f._data(j,"parsedAttrs")){g=j.attributes;for(i=g.length;k<i;k++)h=g[k].name,h.indexOf("data-")===0&&(h=f.camelCase(h.substring(5)),l(j,h,m[h]));f._data(j,"parsedAttrs",!0)}}return m}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!";return f.access(this,function(c){if(c===b){m=this.triggerHandler("getData"+e,[d[0]]),m===b&&j&&(m=f.data(j,a),m=l(j,a,m));return m===b&&d[1]?this.data(d[0]):m}d[1]=c,this.each(function(){var b=f(this);b.triggerHandler("setData"+e,d),f.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1)},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){var d=2;typeof a!="string"&&(c=a,a="fx",d--);if(arguments.length<d)return f.queue(this[0],a);return c===b?this:this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise(c)}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,f.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,f.prop,a,b,arguments.length>1)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.type]||f.valHooks[g.nodeName.toLowerCase()];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h,i=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;i<g;i++)e=d[i],e&&(c=f.propFix[e]||e,h=u.test(e),h||f.attr(a,e,""),a.removeAttribute(v?e:c),h&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0,coords:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/(?:^|\s)hover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(
a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler,g=p.selector),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:g&&G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=f.event.special[c.type]||{},j=[],k,l,m,n,o,p,q,r,s,t,u;g[0]=c,c.delegateTarget=this;if(!i.preDispatch||i.preDispatch.call(this,c)!==!1){if(e&&(!c.button||c.type!=="click")){n=f(this),n.context=this.ownerDocument||this;for(m=c.target;m!=this;m=m.parentNode||this)if(m.disabled!==!0){p={},r=[],n[0]=m;for(k=0;k<e;k++)s=d[k],t=s.selector,p[t]===b&&(p[t]=s.quick?H(m,s.quick):n.is(t)),p[t]&&r.push(s);r.length&&j.push({elem:m,matches:r})}}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){q=j[k],c.currentTarget=q.elem;for(l=0;l<q.matches.length&&!c.isImmediatePropagationStopped();l++){s=q.matches[l];if(h||!c.namespace&&!s.namespace||c.namespace_re&&c.namespace_re.test(s.namespace))c.data=s.data,c.handleObj=s,o=((f.event.special[s.origType]||{}).handle||s.handler).apply(q.elem,g),o!==b&&(c.result=o,o===!1&&(c.preventDefault(),c.stopPropagation()))}}i.postDispatch&&i.postDispatch.call(this,c);return c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9||d===11){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));o.match.globalPOS=p;var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.globalPOS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")[\\s/>]","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){return f.access(this,function(a){return a===b?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f
.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){return f.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return c.nodeType===1?c.innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(;d<e;d++)c=this[d]||{},c.nodeType===1&&(f.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(g){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,function(a,b){b.src?f.ajax({type:"GET",global:!1,url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||f.isXMLDoc(a)||!bc.test("<"+a.nodeName+">")?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g,h,i,j=[];b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);for(var k=0,l;(l=a[k])!=null;k++){typeof l=="number"&&(l+="");if(!l)continue;if(typeof l=="string")if(!_.test(l))l=b.createTextNode(l);else{l=l.replace(Y,"<$1></$2>");var m=(Z.exec(l)||["",""])[1].toLowerCase(),n=bg[m]||bg._default,o=n[0],p=b.createElement("div"),q=bh.childNodes,r;b===c?bh.appendChild(p):U(b).appendChild(p),p.innerHTML=n[1]+l+n[2];while(o--)p=p.lastChild;if(!f.support.tbody){var s=$.test(l),t=m==="table"&&!s?p.firstChild&&p.firstChild.childNodes:n[1]==="<table>"&&!s?p.childNodes:[];for(i=t.length-1;i>=0;--i)f.nodeName(t[i],"tbody")&&!t[i].childNodes.length&&t[i].parentNode.removeChild(t[i])}!f.support.leadingWhitespace&&X.test(l)&&p.insertBefore(b.createTextNode(X.exec(l)[0]),p.firstChild),l=p.childNodes,p&&(p.parentNode.removeChild(p),q.length>0&&(r=q[q.length-1],r&&r.parentNode&&r.parentNode.removeChild(r)))}var u;if(!f.support.appendChecked)if(l[0]&&typeof (u=l.length)=="number")for(i=0;i<u;i++)bn(l[i]);else bn(l);l.nodeType?j.push(l):j=f.merge(j,l)}if(d){g=function(a){return!a.type||be.test(a.type)};for(k=0;j[k];k++){h=j[k];if(e&&f.nodeName(h,"script")&&(!h.type||be.test(h.type)))e.push(h.parentNode?h.parentNode.removeChild(h):h);else{if(h.nodeType===1){var v=f.grep(h.getElementsByTagName("script"),g);j.splice.apply(j,[k+1,0].concat(v))}d.appendChild(h)}}}return j},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bp=/alpha\([^)]*\)/i,bq=/opacity=([^)]*)/,br=/([A-Z]|^ms)/g,bs=/^[\-+]?(?:\d*\.)?\d+$/i,bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,bu=/^([\-+])=([\-+.\de]+)/,bv=/^margin/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Top","Right","Bottom","Left"],by,bz,bA;f.fn.css=function(a,c){return f.access(this,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)},a,c,arguments.length>1)},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=by(a,"opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bu.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(by)return by(a,c)},swap:function(a,b,c){var d={},e,f;for(f in b)d[f]=a.style[f],a.style[f]=b[f];e=c.call(a);for(f in b)a.style[f]=d[f];return e}}),f.curCSS=f.css,c.defaultView&&c.defaultView.getComputedStyle&&(bz=function(a,b){var c,d,e,g,h=a.style;b=b.replace(br,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b))),!f.support.pixelMargin&&e&&bv.test(b)&&bt.test(c)&&(g=h.width,h.width=c,c=e.width,h.width=g);return c}),c.documentElement.currentStyle&&(bA=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f==null&&g&&(e=g[b])&&(f=e),bt.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),by=bz||bA,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){if(c)return a.offsetWidth!==0?bB(a,b,d):f.swap(a,bw,function(){return bB(a,b,d)})},set:function(a,b){return bs.test(b)?b+"px":b}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bq.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bp,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bp.test(g)?g.replace(bp,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,{display:"inline-block"},function(){return b?by(a,"margin-right"):a.style.marginRight})}})}),f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)}),f.each({margin:"",padding:"",border:"Width"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++)f[a+bx[d]+b]=e[d]||e[d-2]||e[0];return f}}});var bC=/%20/g,bD=/\[\]$/,bE=/\r?\n/g,bF=/#.*$/,bG=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bI=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bJ=/^(?:GET|HEAD)$/,bK=/^\/\//,bL=/\?/,bM=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bN=/^(?:select|textarea)/i,bO=/\s+/,bP=/([?&])_=[^&]*/,bQ=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bR=f.fn.load,bS={},bT={},bU,bV,bW=["*/"]+["*"];try{bU=e.href}catch(bX){bU=c.createElement("a"),bU.href="",bU=bU.href}bV=bQ.exec(bU.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bR)return bR.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bM,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bN.test(this.nodeName)||bH.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bE,"\r\n")}}):{name:b.name,value:c.replace(bE,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b$(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b$(a,b);return a},ajaxSettings:{url:bU,isLocal:bI.test(bV[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bW},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bY(bS),ajaxTransport:bY(bT),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?ca(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cb(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bG.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bF,"").replace(bK,bV[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bO),d.crossDomain==null&&(r=bQ.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bV[1]&&r[2]==bV[2]&&(r[3]||(r[1]==="http:"?80:443))==(bV[3]||(bV[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),bZ(bS,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bJ.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bL.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bP,"$1_="+x);d.url=y+(y===d.url?(bL.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bW+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=bZ(bT,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join("&").replace(bC,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=typeof b.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n);try{m.text=h.responseText}catch(a){}try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,co,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cq;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(ct("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),(e===""&&f.css(d,"display")==="none"||!f.contains(d.ownerDocument.documentElement,d))&&f._data(d,"olddisplay",cu(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(ct("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(ct("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o,p,q;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]);if((k=f.cssHooks[g])&&"expand"in k){l=k.expand(a[g]),delete a[g];for(i in l)i in a||(a[i]=l[i])}}for(g in a){h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cu(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cm.test(h)?(q=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),q?(f._data(this,"toggle"+i,q==="show"?"hide":"show"),j[q]()):j[h]()):(m=cn.exec(h),n=j.cur(),m?(o=parseFloat(m[2]),p=m[3]||(f.cssNumber[i]?"":"px"),p!=="px"&&(f.style(this,i,(o||1)+p),n=(o||1)/j.cur()*n,f.style(this,i,n+p)),m[1]&&(o=(m[1]==="-="?-1:1)*o+n),j.custom(n,o,p)):j.custom(n,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:ct("show",1),slideUp:ct("hide",1),slideToggle:ct("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cq||cr(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){f._data(e.elem,"fxshow"+e.prop)===b&&(e.options.hide?f._data(e.elem,"fxshow"+e.prop,e.start):e.options.show&&f._data(e.elem,"fxshow"+e.prop,e.end))},h()&&f.timers.push(h)&&!co&&(co=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cq||cr(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(cp.concat.apply([],cp),function(a,b){b.indexOf("margin")&&(f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cv,cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?cv=function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(e){}if(!d||!f.contains(c,a))return d?{top:d.top,left:d.left}:{top:0,left:0};var g=b.body,h=cy(b),i=c.clientTop||g.clientTop||0,j=c.clientLeft||g.clientLeft||0,k=h.pageYOffset||f.support.boxModel&&c.scrollTop||g.scrollTop,l=h.pageXOffset||f.support.boxModel&&c.scrollLeft||g.scrollLeft,m=d.top+k-i,n=d.left+l-j;return{top:m,left:n}}:cv=function(a,b,c){var d,e=a.offsetParent,g=a,h=b.body,i=b.defaultView,j=i?i.getComputedStyle(a,null):a.currentStyle,k=a.offsetTop,l=a.offsetLeft;while((a=a.parentNode)&&a!==h&&a!==c){if(f.support.fixedPosition&&j.position==="fixed")break;d=i?i.getComputedStyle(a,null):a.currentStyle,k-=a.scrollTop,l-=a.scrollLeft,a===e&&(k+=a.offsetTop,l+=a.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(a.nodeName))&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),g=e,e=a.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&d.overflow!=="visible"&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),j=d}if(j.position==="relative"||j.position==="static")k+=h.offsetTop,l+=h.offsetLeft;f.support.fixedPosition&&j.position==="fixed"&&(k+=Math.max(c.scrollTop,h.scrollTop),l+=Math.max(c.scrollLeft,h.scrollLeft));return{top:k,left:l}},f.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){f.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;if(!d)return null;if(c===d.body)return f.offset.bodyOffset(c);return cv(c,d,d.documentElement)},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);f.fn[a]=function(e){return f.access(this,function(a,e,g){var h=cy(a);if(g===b)return h?c in h?h[c]:f.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:a[e];h?h.scrollTo(d?f(h).scrollLeft():g,d?g:f(h).scrollTop()):a[e]=g},a,e,arguments.length,null)}}),f.each({Height:"height",Width:"width"},function(a,c){var d="client"+a,e="scroll"+a,g="offset"+a;f.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,c,"padding")):this[c]():null},f.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,c,a?"margin":"border")):this[c]():null},f.fn[c]=function(a){return f.access(this,function(a,c,h){var i,j,k,l;if(f.isWindow(a)){i=a.document,j=i.documentElement[d];return f.support.boxModel&&j||i.body&&i.body[d]||j}if(a.nodeType===9){i=a.documentElement;if(i[d]>=i[e])return i[d];return Math.max(a.body[e],i[e],a.body[g],i[g])}if(h===b){k=f.css(a,c),l=parseFloat(k);return f.isNumeric(l)?l:k}f(a).css(c,h)},c,a,arguments.length,null)}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);/*! jQuery UI - v1.10.3 - 2013-06-06
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.menu.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */

(function(e,t){function i(t,i){var a,n,r,o=t.nodeName.toLowerCase();return"area"===o?(a=t.parentNode,n=a.name,t.href&&n&&"map"===a.nodeName.toLowerCase()?(r=e("img[usemap=#"+n+"]")[0],!!r&&s(r)):!1):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o?t.href||i:i)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var a=0,n=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var s,a,n=e(this[0]);n.length&&n[0]!==document;){if(s=n.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(a=parseInt(n.css("zIndex"),10),!isNaN(a)&&0!==a))return a;n=n.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})},removeUniqueId:function(){return this.each(function(){n.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var s=e.attr(t,"tabindex"),a=isNaN(s);return(a||s>=0)&&i(t,!a)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,s){function a(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===s?["Left","Right"]:["Top","Bottom"],r=s.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+s]=function(i){return i===t?o["inner"+s].call(this):this.each(function(){e(this).css(r,a(this,i)+"px")})},e.fn["outer"+s]=function(t,i){return"number"!=typeof t?o["outer"+s].call(this,t):this.each(function(){e(this).css(r,a(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,s){var a,n=e.ui[t].prototype;for(a in s)n.plugins[a]=n.plugins[a]||[],n.plugins[a].push([i,s[a]])},call:function(e,t,i){var s,a=e.plugins[t];if(a&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(s=0;a.length>s;s++)e.options[a[s][0]]&&a[s][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",a=!1;return t[s]>0?!0:(t[s]=1,a=t[s]>0,t[s]=0,a)}})})(jQuery);(function(e,t){var i=0,s=Array.prototype.slice,n=e.cleanData;e.cleanData=function(t){for(var i,s=0;null!=(i=t[s]);s++)try{e(i).triggerHandler("remove")}catch(a){}n(t)},e.widget=function(i,s,n){var a,r,o,h,l={},u=i.split(".")[0];i=i.split(".")[1],a=u+"-"+i,n||(n=s,s=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[u]=e[u]||{},r=e[u][i],o=e[u][i]=function(e,i){return this._createWidget?(arguments.length&&this._createWidget(e,i),t):new o(e,i)},e.extend(o,r,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),h=new s,h.options=e.widget.extend({},h.options),e.each(n,function(i,n){return e.isFunction(n)?(l[i]=function(){var e=function(){return s.prototype[i].apply(this,arguments)},t=function(e){return s.prototype[i].apply(this,e)};return function(){var i,s=this._super,a=this._superApply;return this._super=e,this._superApply=t,i=n.apply(this,arguments),this._super=s,this._superApply=a,i}}(),t):(l[i]=n,t)}),o.prototype=e.widget.extend(h,{widgetEventPrefix:r?h.widgetEventPrefix:i},l,{constructor:o,namespace:u,widgetName:i,widgetFullName:a}),r?(e.each(r._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete r._childConstructors):s._childConstructors.push(o),e.widget.bridge(i,o)},e.widget.extend=function(i){for(var n,a,r=s.call(arguments,1),o=0,h=r.length;h>o;o++)for(n in r[o])a=r[o][n],r[o].hasOwnProperty(n)&&a!==t&&(i[n]=e.isPlainObject(a)?e.isPlainObject(i[n])?e.widget.extend({},i[n],a):e.widget.extend({},a):a);return i},e.widget.bridge=function(i,n){var a=n.prototype.widgetFullName||i;e.fn[i]=function(r){var o="string"==typeof r,h=s.call(arguments,1),l=this;return r=!o&&h.length?e.widget.extend.apply(null,[r].concat(h)):r,o?this.each(function(){var s,n=e.data(this,a);return n?e.isFunction(n[r])&&"_"!==r.charAt(0)?(s=n[r].apply(n,h),s!==n&&s!==t?(l=s&&s.jquery?l.pushStack(s.get()):s,!1):t):e.error("no such method '"+r+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; "+"attempted to call method '"+r+"'")}):this.each(function(){var t=e.data(this,a);t?t.option(r||{})._init():e.data(this,a,new n(r,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,s){s=e(s||this.defaultElement||this)[0],this.element=e(s),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),s!==this&&(e.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===s&&this.destroy()}}),this.document=e(s.style?s.ownerDocument:s.document||s),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,s){var n,a,r,o=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(o={},n=i.split("."),i=n.shift(),n.length){for(a=o[i]=e.widget.extend({},this.options[i]),r=0;n.length-1>r;r++)a[n[r]]=a[n[r]]||{},a=a[n[r]];if(i=n.pop(),s===t)return a[i]===t?null:a[i];a[i]=s}else{if(s===t)return this.options[i]===t?null:this.options[i];o[i]=s}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,s,n){var a,r=this;"boolean"!=typeof i&&(n=s,s=i,i=!1),n?(s=a=e(s),this.bindings=this.bindings.add(s)):(n=s,s=this.element,a=this.widget()),e.each(n,function(n,o){function h(){return i||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):t}"string"!=typeof o&&(h.guid=o.guid=o.guid||h.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),u=l[1]+r.eventNamespace,c=l[2];c?a.delegate(c,u,h):s.bind(u,h)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,r=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(r)&&r.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var r,o=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),r=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),r&&e.effects&&e.effects.effect[o]?s[t](n):o!==t&&s[o]?s[o](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}})})(jQuery);(function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,a="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return n&&!a&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return s._mouseMove(e)},this._mouseUpDelegate=function(e){return s._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);(function(t,e){function i(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function s(e,i){return parseInt(t.css(e,i),10)||0}function n(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(a!==e)return a;var i,s,n=t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=n.children()[0];return t("body").append(n),i=o.offsetWidth,n.css("overflow","scroll"),s=o.offsetWidth,i===s&&(s=n[0].clientWidth),n.remove(),a=i-s},getScrollInfo:function(e){var i=e.isWindow?"":e.element.css("overflow-x"),s=e.isWindow?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,a="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:a?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]);return{element:i,isWindow:s,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s?i.width():i.outerWidth(),height:s?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return f.apply(this,arguments);e=t.extend({},e);var a,p,m,g,v,b,_=t(e.of),y=t.position.getWithinInfo(e.within),w=t.position.getScrollInfo(y),x=(e.collision||"flip").split(" "),k={};return b=n(_),_[0].preventDefault&&(e.at="left top"),p=b.width,m=b.height,g=b.offset,v=t.extend({},g),t.each(["my","at"],function(){var t,i,s=(e[this]||"").split(" ");1===s.length&&(s=l.test(s[0])?s.concat(["center"]):c.test(s[0])?["center"].concat(s):["center","center"]),s[0]=l.test(s[0])?s[0]:"center",s[1]=c.test(s[1])?s[1]:"center",t=u.exec(s[0]),i=u.exec(s[1]),k[this]=[t?t[0]:0,i?i[0]:0],e[this]=[d.exec(s[0])[0],d.exec(s[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?v.left+=p:"center"===e.at[0]&&(v.left+=p/2),"bottom"===e.at[1]?v.top+=m:"center"===e.at[1]&&(v.top+=m/2),a=i(k.at,p,m),v.left+=a[0],v.top+=a[1],this.each(function(){var n,l,c=t(this),u=c.outerWidth(),d=c.outerHeight(),f=s(this,"marginLeft"),b=s(this,"marginTop"),D=u+f+s(this,"marginRight")+w.width,T=d+b+s(this,"marginBottom")+w.height,C=t.extend({},v),M=i(k.my,c.outerWidth(),c.outerHeight());"right"===e.my[0]?C.left-=u:"center"===e.my[0]&&(C.left-=u/2),"bottom"===e.my[1]?C.top-=d:"center"===e.my[1]&&(C.top-=d/2),C.left+=M[0],C.top+=M[1],t.support.offsetFractions||(C.left=h(C.left),C.top=h(C.top)),n={marginLeft:f,marginTop:b},t.each(["left","top"],function(i,s){t.ui.position[x[i]]&&t.ui.position[x[i]][s](C,{targetWidth:p,targetHeight:m,elemWidth:u,elemHeight:d,collisionPosition:n,collisionWidth:D,collisionHeight:T,offset:[a[0]+M[0],a[1]+M[1]],my:e.my,at:e.at,within:y,elem:c})}),e.using&&(l=function(t){var i=g.left-C.left,s=i+p-u,n=g.top-C.top,a=n+m-d,h={target:{element:_,left:g.left,top:g.top,width:p,height:m},element:{element:c,left:C.left,top:C.top,width:u,height:d},horizontal:0>s?"left":i>0?"right":"center",vertical:0>a?"top":n>0?"bottom":"middle"};u>p&&p>r(i+s)&&(h.horizontal="center"),d>m&&m>r(n+a)&&(h.vertical="middle"),h.important=o(r(i),r(s))>o(r(n),r(a))?"horizontal":"vertical",e.using.call(this,t,h)}),c.offset(t.extend(C,{using:l}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-a-n;e.collisionWidth>a?h>0&&0>=l?(i=t.left+h+e.collisionWidth-a-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+a-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-a-n;e.collisionHeight>a?h>0&&0>=l?(i=t.top+h+e.collisionHeight-a-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+a-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-o-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-o-a,(0>i||r(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||u>r(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-o-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,m=-2*e.offset[1];0>c?(s=t.top+p+f+m+e.collisionHeight-o-a,t.top+p+f+m>c&&(0>s||r(c)>s)&&(t.top+=p+f+m)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+m-h,t.top+p+f+m>u&&(i>0||u>r(i))&&(t.top+=p+f+m))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,s,n,a,o=document.getElementsByTagName("body")[0],r=document.createElement("div");e=document.createElement(o?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&t.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in s)e.style[a]=s[a];e.appendChild(r),i=o||document.documentElement,i.insertBefore(e,i.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",n=t(r).offset().left,t.support.offsetFractions=n>10&&11>n,e.innerHTML="",i.removeChild(e)}()})(jQuery);(function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;return n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):"document"===n.containment?(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],undefined):n.containment.constructor===Array?(this.containment=n.containment,undefined):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i),undefined):(this.containment=null,undefined)},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:n.scrollTop(),left:n.scrollLeft()}),{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*s}},_generatePosition:function(t){var i,s,n,a,o=this.options,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=t.pageX,l=t.pageY;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(s=this.relative_container.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var s=e(this).data("ui-draggable"),n=s.options,a=e.extend({},i,{item:s.element});s.sortables=[],e(n.connectToSortable).each(function(){var i=e.data(this,"ui-sortable");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,a))})},stop:function(t,i){var s=e(this).data("ui-draggable"),n=e.extend({},i,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,i){var s=e(this).data("ui-draggable"),n=this;e.each(s.sortables,function(){var a=!1,o=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",t),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",t),s.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),i=e(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor")),t.css("cursor",i.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i){var s=e(i.helper),n=e(this).data("ui-draggable").options;s.css("opacity")&&(n._opacity=s.css("opacity")),s.css("opacity",n.opacity)},stop:function(t,i){var s=e(this).data("ui-draggable").options;s._opacity&&e(i.helper).css("opacity",s._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var i=e(this).data("ui-draggable"),s=i.options,n=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(s.axis&&"x"===s.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-i.overflowOffset.top<s.scrollSensitivity&&(i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-i.overflowOffset.left<s.scrollSensitivity&&(i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(t.pageY-e(document).scrollTop()<s.scrollSensitivity?n=e(document).scrollTop(e(document).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<s.scrollSensitivity&&(n=e(document).scrollTop(e(document).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(t.pageX-e(document).scrollLeft()<s.scrollSensitivity?n=e(document).scrollLeft(e(document).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<s.scrollSensitivity&&(n=e(document).scrollLeft(e(document).scrollLeft()+s.scrollSpeed)))),n!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),i=t.options;t.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=e(this),s=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:s.top,left:s.left})})},drag:function(t,i){var s,n,a,o,r,h,l,u,c,d,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=i.offset.left,v=g+p.helperProportions.width,b=i.offset.top,y=b+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--)r=p.snapElements[c].left,h=r+p.snapElements[c].width,l=p.snapElements[c].top,u=l+p.snapElements[c].height,r-m>v||g>h+m||l-m>y||b>u+m||!e.contains(p.snapElements[c].item.ownerDocument,p.snapElements[c].item)?(p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(s=m>=Math.abs(l-y),n=m>=Math.abs(u-b),a=m>=Math.abs(r-v),o=m>=Math.abs(h-g),s&&(i.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r-p.helperProportions.width}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h}).left-p.margins.left)),d=s||n||a||o,"outer"!==f.snapMode&&(s=m>=Math.abs(l-b),n=m>=Math.abs(u-y),a=m>=Math.abs(r-g),o=m>=Math.abs(h-v),s&&(i.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),n&&(i.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:r}).left-p.margins.left),o&&(i.position.left=p._convertPositionTo("relative",{top:0,left:h-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(s||n||a||o||d)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=s||n||a||o||d)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,i=this.data("ui-draggable").options,s=e.makeArray(e(i.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});s.length&&(t=parseInt(e(s[0]).css("zIndex"),10)||0,e(s).each(function(i){e(this).css("zIndex",t+i)}),this.css("zIndex",t+s.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i){var s=e(i.helper),n=e(this).data("ui-draggable").options;s.css("zIndex")&&(n._zIndex=s.css("zIndex")),s.css("zIndex",n.zIndex)},stop:function(t,i){var s=e(this).data("ui-draggable").options;s._zIndex&&e(i.helper).css("zIndex",s._zIndex)}})})(jQuery);(function(e){function t(e,t,i){return e>t&&t+i>e}e.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,i=e.ui.ddmanager.droppables[this.options.scope];i.length>t;t++)i[t]===this&&i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){"accept"===t&&(this.accept=e.isFunction(i)?i:function(e){return e.is(i)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===s.options.scope&&t.accept.call(t.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(n=!0,!1):undefined}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,i,s){if(!i.offset)return!1;var n,a,o=(e.positionAbs||e.position.absolute).left,r=o+e.helperProportions.width,h=(e.positionAbs||e.position.absolute).top,l=h+e.helperProportions.height,u=i.offset.left,c=u+i.proportions.width,d=i.offset.top,p=d+i.proportions.height;switch(s){case"fit":return o>=u&&c>=r&&h>=d&&p>=l;case"intersect":return o+e.helperProportions.width/2>u&&c>r-e.helperProportions.width/2&&h+e.helperProportions.height/2>d&&p>l-e.helperProportions.height/2;case"pointer":return n=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,a=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,t(a,d,i.proportions.height)&&t(n,u,i.proportions.width);case"touch":return(h>=d&&p>=h||l>=d&&p>=l||d>h&&l>p)&&(o>=u&&c>=o||r>=u&&c>=r||u>o&&r>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions.height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions={width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight})}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===n}),a.length&&(s=e.data(a[0],"ui-droppable"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}}})(jQuery);(function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=e(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),e(this.handles[i]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(i){var s,n,a,o=this.options,r=this.element.position(),h=this.element;return this.resizing=!0,/absolute/.test(h.css("position"))?h.css({position:"absolute",top:h.css("top"),left:h.css("left")}):h.is(".ui-draggable")&&h.css({position:"absolute",top:r.top,left:r.left}),this._renderProxy(),s=t(this.helper.css("left")),n=t(this.helper.css("top")),o.containment&&(s+=e(o.containment).scrollLeft()||0,n+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:s,top:n},this.size=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),height:h.height()},this.originalSize=this._helper?{width:h.outerWidth(),height:h.outerHeight()}:{width:h.width(),height:h.height()},this.originalPosition={left:s,top:n},this.sizeDiff={width:h.outerWidth()-h.width(),height:h.outerHeight()-h.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,a=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===a?this.axis+"-resize":a),h.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(t){var i,s=this.helper,n={},a=this.originalMousePosition,o=this.axis,r=this.position.top,h=this.position.left,l=this.size.width,u=this.size.height,c=t.pageX-a.left||0,d=t.pageY-a.top||0,p=this._change[o];return p?(i=p.apply(this,[t,c,d]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==r&&(n.top=this.position.top+"px"),this.position.left!==h&&(n.left=this.position.left+"px"),this.size.width!==l&&(n.width=this.size.width+"px"),this.size.height!==u&&(n.height=this.size.height+"px"),s.css(n),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&e.ui.hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,s,n,a,o,r=this.options;o={minWidth:i(r.minWidth)?r.minWidth:0,maxWidth:i(r.maxWidth)?r.maxWidth:1/0,minHeight:i(r.minHeight)?r.minHeight:0,maxHeight:i(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,n=o.minWidth/this.aspectRatio,s=o.maxHeight*this.aspectRatio,a=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),n>o.minHeight&&(o.minHeight=n),o.maxWidth>s&&(o.maxWidth=s),o.maxHeight>a&&(o.maxHeight=a)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,s=this.size,n=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(s.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(s.height-e.height),e.left=t.left+(s.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,s=this.axis,n=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,a=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=i(e.width)&&t.minWidth&&t.minWidth>e.width,r=i(e.height)&&t.minHeight&&t.minHeight>e.height,h=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,u=/sw|nw|w/.test(s),c=/nw|ne|n/.test(s);return o&&(e.width=t.minWidth),r&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),a&&(e.height=t.maxHeight),o&&u&&(e.left=h-t.minWidth),n&&u&&(e.left=h-t.maxWidth),r&&c&&(e.top=l-t.minHeight),a&&c&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,s,n,a=this.helper||this.element;for(e=0;this._proportionallyResizeElements.length>e;e++){if(n=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],s=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")],t=0;i.length>t;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(s[t],10)||0);n.css({height:a.height()-this.borderDif[0]-this.borderDif[2]||0,width:a.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).data("ui-resizable"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&e.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var i,s,n,a,o,r,h,l=e(this).data("ui-resizable"),u=l.options,c=l.element,d=u.containment,p=d instanceof e?d.get(0):/parent/.test(d)?c.parent().get(0):d;p&&(l.containerElement=e(p),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(i=e(p),s=[],e(["Top","Right","Left","Bottom"]).each(function(e,n){s[e]=t(i.css("padding"+n))}),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-s[3],width:i.innerWidth()-s[1]},n=l.containerOffset,a=l.containerSize.height,o=l.containerSize.width,r=e.ui.hasScroll(p,"left")?p.scrollWidth:o,h=e.ui.hasScroll(p)?p.scrollHeight:a,l.parentData={element:p,left:n.left,top:n.top,width:r,height:h}))},resize:function(t){var i,s,n,a,o=e(this).data("ui-resizable"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,c={top:0,left:0},d=o.containerElement;d[0]!==document&&/static/.test(d.css("position"))&&(c=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-c.left),u&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?h.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,i=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),s=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-h.top)+o.sizeDiff.height),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a&&(i-=o.parentData.left),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,s=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)})},resize:function(t,i){var s=e(this).data("ui-resizable"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(t,s){e(t).each(function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),a={},o=s&&s.length?s:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(r[t]||0);i&&i>=0&&(a[t]=i||null)}),t.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):e.each(n.alsoResize,function(e,t){h(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),i=t.options,s=t.size,n=t.originalSize,a=t.originalPosition,o=t.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,h=r[0]||1,l=r[1]||1,u=Math.round((s.width-n.width)/h)*h,c=Math.round((s.height-n.height)/l)*l,d=n.width+u,p=n.height+c,f=i.maxWidth&&d>i.maxWidth,m=i.maxHeight&&p>i.maxHeight,g=i.minWidth&&i.minWidth>d,v=i.minHeight&&i.minHeight>p;i.grid=r,g&&(d+=h),v&&(p+=l),f&&(d-=h),m&&(p-=l),/^(se|s|e)$/.test(o)?(t.size.width=d,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=d,t.size.height=p,t.position.top=a.top-c):/^(sw)$/.test(o)?(t.size.width=d,t.size.height=p,t.position.left=a.left-u):(t.size.width=d,t.size.height=p,t.position.top=a.top-c,t.position.left=a.left-u)}})})(jQuery);(function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):undefined}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}})})(jQuery);(function(t){function e(t,e,i){return t>e&&e+i>t}function i(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||i(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,a.widgetName+"-item")===a?(s=t(this),!1):undefined}),t.data(e.target,a.widgetName+"-item")===a&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:e.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:e.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(e.pageY-t(document).scrollTop()<o.scrollSensitivity?r=t(document).scrollTop(t(document).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<o.scrollSensitivity&&(r=t(document).scrollTop(t(document).scrollTop()+o.scrollSpeed)),e.pageX-t(document).scrollLeft()<o.scrollSensitivity?r=t(document).scrollLeft(t(document).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<o.scrollSensitivity&&(r=t(document).scrollLeft(t(document).scrollLeft()+o.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=t.left,o=a+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+l>r&&h>s+l,d="y"===this.options.axis||e+c>a&&o>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var i="x"===this.options.axis||e(this.positionAbs.top+this.offset.click.top,t.top,t.height),s="y"===this.options.axis||e(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=i&&s,a=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return n?this.floating?o&&"right"===o||"down"===a?2:1:a&&("down"===a?2:1):!1},_intersectsWithSides:function(t){var i=e(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),s=e(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"===a&&s||"left"===a&&!s:n&&("down"===n&&i||"up"===n&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,s,n,a,o=[],r=[],h=this._connectWith();if(h&&e)for(i=h.length-1;i>=0;i--)for(n=t(h[i]),s=n.length-1;s>=0;s--)a=t.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&r.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(r.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=r.length-1;i>=0;i--)r[i][0].each(function(){o.push(this)});return t(o)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i]),s=n.length-1;s>=0;s--)a=t.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(u.push([t.isFunction(a.options.items)?a.options.items.call(a.element[0],e,{item:this.currentItem}):t(a.options.items,a.element),a]),this.containers.push(a));for(i=u.length-1;i>=0;i--)for(o=u[i][1],r=u[i][0],s=0,l=r.length;l>s;s++)h=t(r[s]),h.data(this.widgetName+"-item",o),c.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===s?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(n)}):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_contactContainers:function(s){var n,a,o,r,h,l,c,u,d,p,f=null,m=null;for(n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(f&&t.contains(this.containers[n].element[0],f.element[0]))continue;f=this.containers[n],m=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",s,this._uiHash(this)),this.containers[n].containerCache.over=0);if(f)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",s,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(o=1e4,r=null,p=f.floating||i(this.currentItem),h=p?"left":"top",l=p?"width":"height",c=this.positionAbs[h]+this.offset.click[h],a=this.items.length-1;a>=0;a--)t.contains(this.containers[m].element[0],this.items[a].item[0])&&this.items[a].item[0]!==this.currentItem[0]&&(!p||e(this.positionAbs.top+this.offset.click.top,this.items[a].top,this.items[a].height))&&(u=this.items[a].item.offset()[h],d=!1,Math.abs(u-c)>Math.abs(u+this.items[a][l]-c)&&(d=!0,u+=this.items[a][l]),o>Math.abs(u-c)&&(o=Math.abs(u-c),r=this.items[a],this.direction=d?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;r?this._rearrange(s,r,null,!0):this._rearrange(s,null,this.containers[m].element,!0),this._trigger("change",s,this._uiHash()),this.containers[m]._trigger("change",s,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",s,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===n.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===n.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,a=e.pageX,o=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){this.reverting=!1;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||s.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(s.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),i=0;s.length>i;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(i=0;s.length>i;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})})(jQuery);(function(t){var e=0,i={},s={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",s.height=s.paddingTop=s.paddingBottom=s.borderTopWidth=s.borderBottomWidth="show",t.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t(),content:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?(this._activate(e),undefined):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e),undefined)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),a=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(t(e.target).attr("tabIndex",-1),t(a).attr("tabIndex",0),a.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var i,s=this.options,n=s.heightStyle,a=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e);this.active=this._findActive(s.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(e){var i=t(this),s=i.attr("id"),n=i.next(),a=n.attr("id");s||(s=o+"-header-"+e,i.attr("id",s)),a||(a=o+"-panel-"+e,n.attr("id",a)),i.attr("aria-controls",a),n.attr("aria-labelledby",s)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(s.event),"fill"===n?(i=a.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.headers.each(function(){i-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===n&&(i=0,this.headers.next().each(function(){i=Math.max(i,t(this).css("height","").height())}).height(i))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?t():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?t():n,newPanel:r};e.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",e,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?t():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-expanded":"false","aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr("tabIndex",-1):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(t,e,n){var a,o,r,h=this,l=0,c=t.length&&(!e.length||t.index()<e.index()),u=this.options.animate||{},d=c&&u.down||u,p=function(){h._toggleComplete(n)};return"number"==typeof d&&(r=d),"string"==typeof d&&(o=d),o=o||d.easing||u.easing,r=r||d.duration||u.duration,e.length?t.length?(a=t.show().outerHeight(),e.animate(i,{duration:r,easing:o,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(s,{duration:r,easing:o,complete:p,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?l+=i.now:"content"!==h.options.heightStyle&&(i.now=Math.round(a-e.outerHeight()-l),l=0)}}),undefined):e.animate(i,r,o,p):t.animate(s,r,o,p)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}})})(jQuery);(function(t){var e=0;t.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,undefined;e=!1,s=!1,i=!1;var a=t.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:e=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case a.UP:e=!0,this._keyEvent("previous",n);break;case a.DOWN:e=!0,this._keyEvent("next",n);break;case a.ENTER:case a.NUMPAD_ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),undefined;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),undefined):(this._searchTimeout(t),undefined)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,undefined):(clearTimeout(this.searching),this.close(t),this._change(t),undefined)}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(s){s.target===e.element[0]||s.target===i||t.contains(i,s.target)||e.close()})})},menufocus:function(e,i){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),undefined;var s=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",e,{item:s})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):undefined},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var t=this,i=++e;return function(s){i===e&&t.__response(s),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<a>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),this.menu.blur(),undefined):(this.menu[t](e),undefined):(this.search(null,e),undefined)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})})(jQuery);(function(t){var e,i,s,n,a="ui-button ui-widget ui-state-default ui-corner-all",o="ui-state-hover ui-state-active ",r="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",h=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},l=function(e){var i=e.name,s=e.form,n=t([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?t(s).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),n};t.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,h),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var o=this,r=this.options,c="checkbox"===this.type||"radio"===this.type,u=c?"":"ui-state-active",d="ui-state-focus";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(a).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===e&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||t(this).removeClass(u)}).bind("click"+this.eventNamespace,function(t){r.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){o.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){o.buttonElement.removeClass(d)}),c&&(this.element.bind("change"+this.eventNamespace,function(){n||o.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){r.disabled||(n=!1,i=t.pageX,s=t.pageY)}).bind("mouseup"+this.eventNamespace,function(t){r.disabled||(i!==t.pageX||s!==t.pageY)&&(n=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled||n?!1:undefined}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled||n)return!1;t(this).addClass("ui-state-active"),o.buttonElement.attr("aria-pressed","true");var e=o.element[0];l(e).not(e).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(t(this).addClass("ui-state-active"),e=this,o.document.one("mouseup",function(){e=null}),undefined)}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:(t(this).removeClass("ui-state-active"),undefined)}).bind("keydown"+this.eventNamespace,function(e){return r.disabled?!1:((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"),undefined)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(a+" "+o+" "+r).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1),undefined):(this._resetButton(),undefined)},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?l(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),undefined;var e=this.buttonElement.removeClass(r),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):a.push("ui-button-text-only"),e.addClass(a.join(" "))}}),t.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);(function(t,e){function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.dpDiv=s(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){t.datepicker._isDisabledDatepicker(a.inline?e.parent()[0]:a.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))})}function n(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}t.extend(t.ui,{datepicker:{version:"1.10.3"}});var a,r="datepicker";t.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return n(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,a;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),a=this._newInst(t(e),n),a.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,a):n&&this._inlineDatepicker(e,a)},_newInst:function(e,i){var n=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,r,i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,a,r=this._get(i,"appendText"),o=this._get(i,"isRTL");i.append&&i.append.remove(),r&&(i.append=t("<span class='"+this._appendClass+"'>"+r+"</span>"),e[o?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(a?t("<img/>").attr({src:a,alt:n,title:n}):n)),e[o?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,a=new Date(2009,11,20),r=this._get(t,"dateFormat");r.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},a.setMonth(e(this._get(t,r.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(e(this._get(t,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),t.input.attr("size",this._formatDate(t,a).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,r,i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,a,o){var h,l,c,u,d,p=this._dialogInst;return p||(this.uuid+=1,h="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+h+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},t.data(this._dialogInput[0],r,p)),n(p.settings,a||{}),i=i&&i.constructor===Date?this._formatDate(p,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+u,c/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],r,p),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,r);s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,r),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(e){var i,s,n=t(e),a=t.data(e,r);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),a=t.data(e,r);n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,r)}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(i,s,a){var r,o,h,l,c=this._getInst(i);return 2===arguments.length&&"string"==typeof s?"defaults"===s?t.extend({},t.datepicker._defaults):c?"all"===s?t.extend({},c.settings):this._get(c,s):null:(r=s||{},"string"==typeof s&&(r={},r[s]=a),c&&(this._curInst===c&&this._hideDatepicker(),o=this._getDateDatepicker(i,!0),h=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),n(c.settings,r),null!==h&&r.dateFormat!==e&&r.minDate===e&&(c.settings.minDate=this._formatDate(c,h)),null!==l&&r.dateFormat!==e&&r.maxDate===e&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in r&&(r.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(t(i),c),this._autoSize(c),this._setDate(c,o),this._updateAlternate(c),this._updateDatepicker(c)),e)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,a=t.datepicker._getInst(e.target),r=!0,o=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),r=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",a.dpDiv),n[0]&&t.datepicker._selectDay(e.target,a.selectedMonth,a.selectedYear,n[0]),i=t.datepicker._get(a,"onSelect"),i?(s=t.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(a,"stepBigMonths"):-t.datepicker._get(a,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(a,"stepBigMonths"):+t.datepicker._get(a,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),r=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),r=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,o?1:-1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(a,"stepBigMonths"):-t.datepicker._get(a,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),r=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,o?-1:1,"D"),r=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(a,"stepBigMonths"):+t.datepicker._get(a,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),r=e.ctrlKey||e.metaKey;break;default:r=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):r=!1;r&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(i){var s,n,a=t.datepicker._getInst(i.target);return t.datepicker._get(a,"constrainInput")?(s=t.datepicker._possibleChars(t.datepicker._get(a,"dateFormat")),n=String.fromCharCode(null==i.charCode?i.keyCode:i.charCode),i.ctrlKey||i.metaKey||" ">n||!s||s.indexOf(n)>-1):e},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,s,a,r,o,h,l;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),s=t.datepicker._get(i,"beforeShow"),a=s?s.apply(e,[e,i]):{},a!==!1&&(n(i.settings,a),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),r=!1,t(e).parents().each(function(){return r|="fixed"===t(this).css("position"),!r}),o={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),o=t.datepicker._checkOffset(i,o,r),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":r?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"}),i.inline||(h=t.datepicker._get(i,"showAnim"),l=t.datepicker._get(i,"duration"),i.dpDiv.zIndex(t(e).zIndex()+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[h]?i.dpDiv.show(h,t.datepicker._get(i,"showOptions"),l):i.dpDiv[h||"show"](h?l:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,a=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,s=this._getNumberOfMonths(e),n=s[1],r=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",r*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),a=e.dpDiv.outerHeight(),r=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-r:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+o?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+o):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,a,o=this._curInst;!o||e&&o!==t.data(e,r)||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){t.datepicker._tidyDialog(o)},t.effects&&(t.effects.effect[i]||t.effects[i])?o.dpDiv.hide(i,t.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(e,i,s,n){var a,r=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||(a=this._getInst(r[0]),a.selectedDay=a.currentDay=t("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(e,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,a=this._get(e,"altField");a&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(a).each(function(){t(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(i,s,n){if(null==i||null==s)throw"Invalid arguments";if(s="object"==typeof s?""+s:s+"",""===s)return null;var a,r,o,h,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,p=(n?n.dayNames:null)||this._defaults.dayNames,f=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,m=(n?n.monthNames:null)||this._defaults.monthNames,g=-1,v=-1,_=-1,b=-1,y=!1,x=function(t){var e=i.length>a+1&&i.charAt(a+1)===t;return e&&a++,e},k=function(t){var e=x(t),i="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n=RegExp("^\\d{1,"+i+"}"),a=s.substring(l).match(n);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},w=function(i,n,a){var r=-1,o=t.map(x(i)?a:n,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(o,function(t,i){var n=i[1];return s.substr(l,n.length).toLowerCase()===n.toLowerCase()?(r=i[0],l+=n.length,!1):e}),-1!==r)return r+1;throw"Unknown name at position "+l},D=function(){if(s.charAt(l)!==i.charAt(a))throw"Unexpected literal at position "+l;l++};for(a=0;i.length>a;a++)if(y)"'"!==i.charAt(a)||x("'")?D():y=!1;else switch(i.charAt(a)){case"d":_=k("d");break;case"D":w("D",d,p);break;case"o":b=k("o");break;case"m":v=k("m");break;case"M":v=w("M",f,m);break;case"y":g=k("y");break;case"@":h=new Date(k("@")),g=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"!":h=new Date((k("!")-this._ticksTo1970)/1e4),g=h.getFullYear(),v=h.getMonth()+1,_=h.getDate();break;case"'":x("'")?D():y=!0;break;default:D()}if(s.length>l&&(o=s.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=g?0:-100)),b>-1)for(v=1,_=b;;){if(r=this._getDaysInMonth(g,v-1),r>=_)break;v++,_-=r}if(h=this._daylightSavingAdjust(new Date(g,v-1,_)),h.getFullYear()!==g||h.getMonth()+1!==v||h.getDate()!==_)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,o=(i?i.monthNames:null)||this._defaults.monthNames,h=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},l=function(t,e,i){var s=""+e;if(h(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return h(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||h("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=l("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,a);break;case"o":u+=l("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=l("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),r,o);break;case"y":u+=h("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":h("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,i){return t.settings[i]!==e?t.settings[i]:this._defaults[i]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),a=n,r=this._getFormatConfig(t);try{a=this.parseDate(i,s,r)||n}catch(o){s=e?"":s}t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),t.currentDay=s?a.getDate():0,t.currentMonth=s?a.getMonth():0,t.currentYear=s?a.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},a=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,a=n.getFullYear(),r=n.getMonth(),o=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":r+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,r));break;case"y":case"Y":a+=parseInt(l[1],10),o=Math.min(o,t.datepicker._getDaysInMonth(a,r))}l=h.exec(i)}return new Date(a,r,o)},r=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return r=r&&"Invalid Date"==""+r?s:r,r&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,a=t.selectedYear,r=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=r.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=r.getMonth(),t.drawYear=t.selectedYear=t.currentYear=r.getFullYear(),n===t.selectedMonth&&a===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,a,r,o,h,l,c,u,d,p,f,m,g,v,_,b,y,x,k,w,D,T,C,M,S,N,I,P,A,z,H,E,F,O,W,j,R=new Date,L=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),Y=this._get(t,"isRTL"),B=this._get(t,"showButtonPanel"),J=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),Q=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),U=this._get(t,"stepMonths"),q=1!==Q[0]||1!==Q[1],X=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(t,"min"),$=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,te=t.drawYear;if(0>Z&&(Z+=12,te--),$)for(e=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-Q[0]*Q[1]+1,$.getDate())),e=G&&G>e?G:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-U,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+U,1)),this._getFormatConfig(t)):n,a=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",r=this._get(t,"currentText"),o=this._get(t,"gotoCurrent")&&t.currentDay?X:L,r=K?this.formatDate(r,o,this._getFormatConfig(t)):r,h=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(t,o)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+r+"</button>":"")+(Y?"":h)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),m=this._get(t,"monthNamesShort"),g=this._get(t,"beforeShowDay"),v=this._get(t,"showOtherMonths"),_=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;Q[0]>k;k++){for(w="",this.maxRows=4,D=0;Q[1]>D;D++){if(T=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),C=" ui-corner-all",M="",q){if(M+="<div class='ui-datepicker-group",Q[1]>1)switch(D){case 0:M+=" ui-datepicker-group-first",C=" ui-corner-"+(Y?"right":"left");break;case Q[1]-1:M+=" ui-datepicker-group-last",C=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",C=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===k?Y?a:s:"")+(/all|right/.test(C)&&0===k?Y?s:a:"")+this._generateMonthYearHeader(t,Z,te,G,$,k>0||D>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",S=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+c)%7,S+="<th"+((x+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[N]+"'>"+p[N]+"</span></th>";for(M+=S+"</tr></thead><tbody>",I=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,I)),P=(this._getFirstDayOfMonth(te,Z)-c+7)%7,A=Math.ceil((P+I)/7),z=q?this.maxRows>A?this.maxRows:A:A,this.maxRows=z,H=this._daylightSavingAdjust(new Date(te,Z,1-P)),E=0;z>E;E++){for(M+="<tr>",F=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(H)+"</td>":"",x=0;7>x;x++)O=g?g.apply(t.input?t.input[0]:null,[H]):[!0,""],W=H.getMonth()!==Z,j=W&&!_||!O[0]||G&&G>H||$&&H>$,F+="<td class='"+((x+c+6)%7>=5?" ui-datepicker-week-end":"")+(W?" ui-datepicker-other-month":"")+(H.getTime()===T.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===H.getTime()&&b.getTime()===T.getTime()?" "+this._dayOverClass:"")+(j?" "+this._unselectableClass+" ui-state-disabled":"")+(W&&!v?"":" "+O[1]+(H.getTime()===X.getTime()?" "+this._currentClass:"")+(H.getTime()===L.getTime()?" ui-datepicker-today":""))+"'"+(W&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(j?"":" data-handler='selectDay' data-event='click' data-month='"+H.getMonth()+"' data-year='"+H.getFullYear()+"'")+">"+(W&&!v?"&#xa0;":j?"<span class='ui-state-default'>"+H.getDate()+"</span>":"<a class='ui-state-default"+(H.getTime()===L.getTime()?" ui-state-highlight":"")+(H.getTime()===X.getTime()?" ui-state-active":"")+(W?" ui-priority-secondary":"")+"' href='#'>"+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H);M+=F+"</tr>"}Z++,Z>11&&(Z=0,te++),M+="</tbody></table>"+(q?"</div>"+(Q[0]>0&&D===Q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),w+=M}y+=w}return y+=l,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,a,r,o){var h,l,c,u,d,p,f,m,g=this._get(t,"changeMonth"),v=this._get(t,"changeYear"),_=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(a||!g)y+="<span class='ui-datepicker-month'>"+r[e]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!h||c>=s.getMonth())&&(!l||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+o[c]+"</option>");y+="</select>"}if(_||(b+=y+(!a&&g&&v?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);
return isNaN(e)?d:e},f=p(u[0]),m=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),_&&(b+=(!a&&g&&v?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"===i?e:0),n=t.drawMonth+("M"===i?e:0),a=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),r=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,a)));t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),a=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(t,a)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),a=this._getMinMaxDate(t,"max"),r=null,o=null,h=this._get(t,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),r=parseInt(i[0],10),o=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=s),i[1].match(/[+\-].*/)&&(o+=s)),(!n||e.getTime()>=n.getTime())&&(!a||e.getTime()<=a.getTime())&&(!r||e.getFullYear()>=r)&&(!o||o>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new i,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.10.3"})(jQuery);(function(t){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};t.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||t(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!e&&this._trigger("focus",t),i},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),undefined):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._trigger("open"),undefined)},_focusTabbable:function(){var t=this.element.find("[autofocus]");t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),undefined;if(e.keyCode===t.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(n.focus(1),e.preventDefault()):(s.focus(1),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),undefined):(t.each(i,function(i,s){var n,a;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(e.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,t("<button></button>",s).button(a).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),undefined)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,a){s.position=[a.position.left-i.document.scrollLeft(),a.position.top-i.document.scrollTop()],t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(a))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,a){s.height=t(this).height(),s.width=t(this).width(),t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(a))}}).css("position",a)},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(s){var n=this,a=!1,o={};t.each(s,function(t,s){n._setOption(t,s),t in e&&(a=!0),t in i&&(o[t]=s)}),a&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,e){var i,s,n=this.uiDialog;"dialogClass"===t&&n.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=n.is(":data(ui-draggable)"),i&&!e&&n.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(s=n.is(":data(ui-resizable)"),s&&!e&&n.resizable("destroy"),s&&"string"==typeof e&&n.resizable("option","handles",e),s||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=this,i=this.widgetFullName;t.ui.dialog.overlayInstances||this._delay(function(){t.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(s){e._allowInteraction(s)||(s.preventDefault(),t(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),t.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(t.ui.dialog.overlayInstances--,t.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),t.ui.dialog.overlayInstances=0,t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{_position:function(){var e,i=this.options.position,s=[],n=[0,0];i?(("string"==typeof i||"object"==typeof i&&"0"in i)&&(s=i.split?i.split(" "):[i[0],i[1]],1===s.length&&(s[1]=s[0]),t.each(["left","top"],function(t,e){+s[t]===s[t]&&(n[t]=s[t],s[t]=e)}),i={my:s[0]+(0>n[0]?n[0]:"+"+n[0])+" "+s[1]+(0>n[1]?n[1]:"+"+n[1]),at:s.join(" ")}),i=t.extend({},t.ui.dialog.prototype.options.position,i)):i=t.ui.dialog.prototype.options.position,e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.position(i),e||this.uiDialog.hide()}})})(jQuery);(function(t){t.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,t.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(e){var i=t(e.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(e),i.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var i=t(e.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){t(e.target).closest(".ui-menu").length||this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,a,o,r,h=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:h=!1,n=this.previousFilter||"",a=String.fromCharCode(e.keyCode),o=!1,clearTimeout(this.filterTimer),a===n?o=!0:a=n+a,r=RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())}),s=o&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s,s.length||(a=String.fromCharCode(e.keyCode),r=RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())})),s.length?(this.focus(e,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}h&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i=this.options.icons.submenu,s=this.element.find(this.options.menus);s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),s=e.prev("a"),n=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",s.attr("id"))}),e=s.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=t(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),this._super(t,e)},focus:function(t,e){var i,s;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=e.height(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),undefined):(this.next(e),undefined)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item").first())),undefined):(this.next(e),undefined)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)}})})(jQuery);(function(t,e){t.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),e)},_constrainedValue:function(t){return t===e&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}})})(jQuery);(function(t){var e=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)o.push(a);this.handles=n.add(t(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=t([])},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,a,o,r,h,l,u=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-u.values(e));(n>i||n===i&&(e===u._lastChangedValue||u.values(e)===c.min))&&(n=i,a=t(this),o=e)}),r=this._start(e,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-a.width()/2,top:e.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,a;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>s||1===e&&s>i)&&(i=s),i!==this.values(e)&&(n=this.values(),n[e]=i,a=this._trigger("slide",t,{handle:this.handles[e],value:i,values:n}),s=this.values(e?0:1),a!==!1&&this.values(e,i,!0))):i!==this.value()&&(a=this._trigger("slide",t,{handle:this.handles[e],value:i}),a!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),undefined):this._value()},values:function(e,i){var s,n,a;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),undefined;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(i){var s,n,a,o,r=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(i.target).addClass("ui-state-active"),s=this._start(i,r),s===!1))return}switch(o=this.options.step,n=a=this.options.values&&this.options.values.length?this.values(r):this.value(),i.keyCode){case t.ui.keyCode.HOME:a=this._valueMin();break;case t.ui.keyCode.END:a=this._valueMax();break;case t.ui.keyCode.PAGE_UP:a=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:a=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(n===this._valueMax())return;a=this._trimAlignValue(n+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n===this._valueMin())return;a=this._trimAlignValue(n-o)}this._slide(i,r,a)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})})(jQuery);(function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,this.element.val(this._format(i)),void 0}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(e(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})})(jQuery);(function(t,e){function i(){return++n}function s(t){return t.hash.length>1&&decodeURIComponent(t.href.replace(a,""))===decodeURIComponent(location.href.replace(a,""))}var n=0,a=/#.*$/;t.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var i=this.options.active,s=this.options.collapsible,n=location.hash.substring(1);return null===i&&(n&&this.tabs.each(function(s,a){return t(a).attr("aria-controls")===n?(i=s,!1):e}),null===i&&(i=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===i||-1===i)&&(i=this.tabs.length?0:!1)),i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),-1===i&&(i=s?!1:0)),!s&&i===!1&&this.anchors.length&&(i=0),i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(i){var s=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(s),a=!0;if(!this._handlePageNav(i)){switch(i.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:a=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return i.preventDefault(),clearTimeout(this.activating),this._activate(n),e;case t.ui.keyCode.ENTER:return i.preventDefault(),clearTimeout(this.activating),this._activate(n===this.options.active?!1:n),e;default:return}i.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,a),i.ctrlKey||(s.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(i){return i.altKey&&i.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):i.altKey&&i.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):e},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,i){return"active"===t?(this._activate(i),e):"disabled"===t?(this._setupDisabled(i),e):(this._super(t,i),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",i),i||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(i),"heightStyle"===t&&this._setupHeightStyle(i),e)},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var a,o,r,h=t(n).uniqueId().attr("id"),l=t(n).closest("li"),u=l.attr("aria-controls");s(n)?(a=n.hash,o=e.element.find(e._sanitizeSelector(a))):(r=e._tabId(l),a="#"+r,o=e.element.find(a),o.length||(o=e._createPanel(r),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),u&&l.data("ui-tabs-aria-controls",u),l.attr({"aria-controls":a.substring(1),"aria-labelledby":h}),o.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,s=0;i=this.tabs[s];s++)e===!0||-1!==t.inArray(s,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s=this.element.parent();"fill"===e?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?t():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):t(),u={oldTab:s,oldPanel:l,newTab:r?t():a,newPanel:h};e.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",e,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?t():a,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),e),this._toggle(e,u))},_toggle:function(e,i){function s(){a.running=!1,a._trigger("activate",e,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var s=this.options.disabled;s!==!1&&(i===e?s=!1:(i=this._getIndex(i),s=t.isArray(s)?t.map(s,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(s))},disable:function(i){var s=this.options.disabled;if(s!==!0){if(i===e)s=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,s))return;s=t.isArray(s)?t.merge([i],s).sort():[i]}this._setupDisabled(s)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),o=a.find(".ui-tabs-anchor"),r=this._getPanelForTab(a),h={tab:a,panel:r};s(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){r.html(t),n._trigger("load",i,h)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href"),beforeSend:function(e,a){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:a},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})})(jQuery);(function(t){function e(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")}var s=0;t.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var s=this;return"disabled"===e?(this[i?"_disable":"_enable"](),this.options[e]=i,void 0):(this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e)}),void 0)},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,a=e?e.type:null;return"string"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){t.data("ui-tooltip-open")&&n._delay(function(){e&&(e.type=a),this._open(e,t,i)})}),i&&this._open(e,t,i),void 0)},_open:function(i,s,n){function a(t){l.of=t,o.is(":hidden")||o.position(l)}var o,r,h,l=t.extend({},this.options.position);if(n){if(o=this._find(s),o.length)return o.find(".ui-tooltip-content").html(n),void 0;s.is("[title]")&&(i&&"mouseover"===i.type?s.attr("title",""):s.removeAttr("title")),o=this._tooltip(s),e(s,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:a}),a(i)):o.position(t.extend({of:s},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){o.is(":visible")&&(a(l.of),clearInterval(h))},t.fx.interval)),this._trigger("open",i,{tooltip:o}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=s[0],this.close(i,!0)}},remove:function(){this._removeTooltip(o)}},i&&"mouseover"!==i.type||(r.mouseleave="close"),i&&"focusin"!==i.type||(r.focusout="close"),this._on(!0,s,r)}},close:function(e){var s=this,n=t(e?e.currentTarget:this.element),a=this._find(n);this.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),i(n),a.stop(!0),this._hide(a,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:a}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+s++,n=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),this.tooltips[i]=e,n},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})}})})(jQuery);(function(t,e){var i="ui-effects-";t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(t,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[c[l].cache]=o[c[l].cache],n=s._rgba=o._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,a.transparent),s):a[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=l.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(n,o,r,h){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(o),o=e);var u=this,d=t.type(n),p=this._rgba=[];return o!==e&&(n=[n,o,r,h],d="array"),"string"===d?this.parse(s(n)||a._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof l?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var a=s.cache;f(s.props,function(t,e){if(!u[a]&&s.to){if("alpha"===t||null==n[t])return;u[a]=s.to(u._rgba)}u[a][e.idx]=i(n[t],e,!0)}),u[a]&&0>t.inArray(null,u[a].slice(0,3))&&(u[a][3]=1,s.from&&(u._rgba=s.from(u[a])))}),this):e},is:function(t){var i=l(t),s=!0,n=this;return f(c,function(t,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=l(t),n=s._space(),a=c[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(t,n){var a=n.idx,o=r[a],l=s[a],c=u[n.type]||{};null!==l&&(null===o?h[a]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),h[a]=i((l-o)*e+o,n)))}),this[n](h)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(e)._rgba;return l(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,a=t[2]/255,o=t[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],a=t[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,e+1/3)),Math.round(255*n(r,o,e)),Math.round(255*n(r,o,e-1/3)),a]},f(c,function(s,n){var a=n.props,o=n.cache,h=n.to,c=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===e)return this[o].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[o].slice();return f(a,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=l(c(d)),n[o]=d,n):l(d)},f(a,function(e,i){l.fn[e]||(l.fn[e]=function(n){var a,o=t.type(n),h="alpha"===e?this._hsla?"hsla":"rgba":s,l=this[h](),c=l[i.idx];return"undefined"===o?c:("function"===o&&(n=n.call(this,c),o=t.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=c+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var a,o,r="";if("transparent"!==n&&("string"!==t.type(n)||(a=s(n)))){if(n=l(a||n),!d.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&o&&o.style;)try{r=t.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(h){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=l(e.elem,i),e.end=l(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},a=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function s(e,i){var s,n,o={};for(s in i)n=i[s],e[s]!==n&&(a[s]||(t.fx.step[s]||!isNaN(parseFloat(n)))&&(o[s]=n));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,a,o,r){var h=t.speed(a,o,r);return this.queue(function(){var a,o=t(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var e=t(this);return{el:e,start:i(this)}}),a=function(){t.each(n,function(t,i){e[i]&&o[i+"Class"](e[i])})},a(),l=l.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=t.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){a(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,a){return s?t.effects.animateClass.call(this,{add:i},s,n,a):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,a){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,a):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(i){return function(s,n,a,o,r){return"boolean"==typeof n||n===e?a?t.effects.animateClass.call(this,n?{add:s}:{remove:s},a,o,r):i.apply(this,arguments):t.effects.animateClass.call(this,{toggle:s},n,a,o)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,a){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,a)}})}(),function(){function s(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function n(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.3",save:function(t,e){for(var s=0;e.length>s;s++)null!==e[s]&&t.data(i+e[s],t[0].style[e[s]])},restore:function(t,s){var n,a;for(a=0;s.length>a;a++)null!==s[a]&&(n=t.data(i+s[a]),n===e&&(n=""),t.css(s[a],n))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return e.wrap(s),(e[0]===a||t.contains(e[0],a))&&t(a).focus(),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var a=e.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),t.fn.extend({effect:function(){function e(e){function s(){t.isFunction(a)&&a.call(n[0]),t.isFunction(e)&&e()}var n=t(this),a=i.complete,r=i.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),s()):o.call(n[0],i,s)}var i=s.apply(this,arguments),n=i.mode,a=i.queue,o=t.effects.effect[i.effect];return t.fx.off||!o?n?this[n](i.duration,i.complete):this.each(function(){i.complete&&i.complete.call(this)}):a===!1?this.each(e):this.queue(a||"fx",e)},show:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(t.fn.show),hide:function(t){return function(e){if(n(e))return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(t.fn.hide),toggle:function(t){return function(e){if(n(e)||"boolean"==typeof e)return t.apply(this,arguments);var i=s.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}()})(jQuery);(function(t){var e=/up|down|vertical/,i=/up|left|vertical|horizontal/;t.effects.effect.blind=function(s,n){var a,o,r,h=t(this),l=["position","top","bottom","left","right","height","width"],c=t.effects.setMode(h,s.mode||"hide"),u=s.direction||"up",d=e.test(u),p=d?"height":"width",f=d?"top":"left",m=i.test(u),g={},v="show"===c;h.parent().is(".ui-effects-wrapper")?t.effects.save(h.parent(),l):t.effects.save(h,l),h.show(),a=t.effects.createWrapper(h).css({overflow:"hidden"}),o=a[p](),r=parseFloat(a.css(f))||0,g[p]=v?o:0,m||(h.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),g[f]=v?r:o+r),v&&(a.css(p,0),m||a.css(f,r+o)),a.animate(g,{duration:s.duration,easing:s.easing,queue:!1,complete:function(){"hide"===c&&h.hide(),t.effects.restore(h,l),t.effects.removeWrapper(h),n()}})}})(jQuery);(function(t){t.effects.effect.bounce=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"effect"),l="hide"===h,c="show"===h,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||l?1:0),m=e.duration/f,g=e.easing,v="up"===u||"down"===u?"top":"left",_="up"===u||"left"===u,b=o.queue(),y=b.length;for((c||l)&&r.push("opacity"),t.effects.save(o,r),o.show(),t.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),c&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,_?2*-d:2*d).animate(a,m,g)),l&&(d/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(_?"-=":"+=")+d,o.animate(n,m,g).animate(a,m,g),d=l?2*d:d/2;l&&(n={opacity:0},n[v]=(_?"-=":"+=")+d,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,f+1))),o.dequeue()}})(jQuery);(function(t){t.effects.effect.clip=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"hide"),l="show"===h,c=e.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};t.effects.save(o,r),o.show(),s=t.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[d](),l&&(n.css(d,0),n.css(p,a/2)),f[d]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})}})(jQuery);(function(t){t.effects.effect.drop=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(n,e.mode||"hide"),r="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h?"pos":"neg",u={opacity:r?1:0};t.effects.save(n,a),n.show(),t.effects.createWrapper(n),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===c?-s:s),u[l]=(r?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}})}})(jQuery);(function(t){t.effects.effect.explode=function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),m||p.hide(),i()}var a,o,r,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),_=Math.ceil(p.outerHeight()/u),b=[];for(a=0;u>a;a++)for(h=g.top+a*_,c=a-(u-1)/2,o=0;d>o;o++)r=g.left+o*v,l=o-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*_}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:_,left:r+(m?l*v:0),top:h+(m?c*_:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:c*_),opacity:m?1:0},e.duration||500,e.easing,s)}})(jQuery);(function(t){t.effects.effect.fade=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}})(jQuery);(function(t){t.effects.effect.fold=function(e,i){var s,n,a=t(this),o=["position","top","bottom","left","right","height","width"],r=t.effects.setMode(a,e.mode||"hide"),h="show"===r,l="hide"===r,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=h!==d,f=p?["width","height"]:["height","width"],m=e.duration/2,g={},v={};t.effects.save(a,o),a.show(),s=t.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],u&&(c=parseInt(u[1],10)/100*n[l?0:1]),h&&s.css(d?{height:0,width:c}:{height:c,width:0}),g[f[0]]=h?n[0]:c,v[f[1]]=h?n[1]:0,s.animate(g,m,e.easing).animate(v,m,e.easing,function(){l&&a.hide(),t.effects.restore(a,o),t.effects.removeWrapper(a),i()})}})(jQuery);(function(t){t.effects.effect.highlight=function(e,i){var s=t(this),n=["backgroundImage","backgroundColor","opacity"],a=t.effects.setMode(s,e.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),t.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&s.hide(),t.effects.restore(s,n),i()}})}})(jQuery);(function(t){t.effects.effect.pulsate=function(e,i){var s,n=t(this),a=t.effects.setMode(n,e.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(e.times||5)+(h?1:0),c=e.duration/l,u=0,d=n.queue(),p=d.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),u=1),s=1;l>s;s++)n.animate({opacity:u},c,e.easing),u=1-u;n.animate({opacity:u},c,e.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,l+1))),n.dequeue()}})(jQuery);(function(t){t.effects.effect.puff=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"hide"),a="hide"===n,o=parseInt(e.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(e)},t.effects.effect.scale=function(e,i){var s=t(this),n=t.extend(!0,{},e),a=t.effects.setMode(s,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===a?0:100),r=e.direction||"both",h=e.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},c={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=e.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*c.y,width:l.width*c.x,outerHeight:l.outerHeight*c.y,outerWidth:l.outerWidth*c.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},t.effects.effect.size=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(o,e.mode||"effect"),f=e.restore||"effect"!==p,m=e.scale||"both",g=e.origin||["middle","center"],v=o.css("position"),_=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===p?(o.from=e.to||b,o.to=e.from||s):(o.from=e.from||("show"===p?b:s),o.to=e.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(_=_.concat(u),o.from=t.effects.setTransition(o,u,a.from.y,o.from),o.to=t.effects.setTransition(o,u,a.to.y,o.to)),a.from.x!==a.to.x&&(_=_.concat(d),o.from=t.effects.setTransition(o,d,a.from.x,o.from),o.to=t.effects.setTransition(o,d,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(_=_.concat(c).concat(l),o.from=t.effects.setTransition(o,c,a.from.y,o.from),o.to=t.effects.setTransition(o,c,a.to.y,o.to)),t.effects.save(o,_),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=t.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),l=r.concat(u).concat(d),o.find("*[width]").each(function(){var i=t(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=t.effects.setTransition(i,u,a.from.y,i.from),i.to=t.effects.setTransition(i,u,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=t.effects.setTransition(i,d,a.from.x,i.from),i.to=t.effects.setTransition(i,d,a.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),t.effects.restore(o,_),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],function(t,e){o.css(e,function(e,i){var s=parseInt(i,10),n=t?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),t.effects.removeWrapper(o),i()}})}})(jQuery);(function(t){t.effects.effect.shake=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(n,e.mode||"effect"),r=e.direction||"left",h=e.distance||20,l=e.times||3,c=2*l+1,u=Math.round(e.duration/c),d="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),_=v.length;for(t.effects.save(n,a),n.show(),t.effects.createWrapper(n),f[d]=(p?"-=":"+=")+h,m[d]=(p?"+=":"-=")+2*h,g[d]=(p?"-=":"+=")+2*h,n.animate(f,u,e.easing),s=1;l>s;s++)n.animate(m,u,e.easing).animate(g,u,e.easing);n.animate(m,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}),_>1&&v.splice.apply(v,[1,0].concat(v.splice(_,c+1))),n.dequeue()}})(jQuery);(function(t){t.effects.effect.slide=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(n,e.mode||"show"),r="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u={};t.effects.save(n,a),n.show(),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,c?isNaN(s)?"-"+s:-s:s),u[l]=(r?c?"+=":"-=":c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}})}})(jQuery);(function(t){t.effects.effect.transfer=function(e,i){var s=t(this),n=t(e.to),a="fixed"===n.css("position"),o=t("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),c={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-r,left:u.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(H){var r;H.fn.emptyForce=function(){for(var ab=0,ac;(ac=H(this)[ab])!=null;ab++){if(ac.nodeType===1){H.cleanData(ac.getElementsByTagName("*"))}if(H.jqplot.use_excanvas){ac.outerHTML=""}else{while(ac.firstChild){ac.removeChild(ac.firstChild)}}ac=null}return H(this)};H.fn.removeChildForce=function(ab){while(ab.firstChild){this.removeChildForce(ab.firstChild);ab.removeChild(ab.firstChild)}};H.fn.jqplot=function(){var ab=[];var ad=[];for(var ae=0,ac=arguments.length;ae<ac;ae++){if(H.isArray(arguments[ae])){ab.push(arguments[ae])}else{if(H.isPlainObject(arguments[ae])){ad.push(arguments[ae])}}}return this.each(function(ah){var am,al,ak=H(this),ag=ab.length,af=ad.length,aj,ai;if(ah<ag){aj=ab[ah]}else{aj=ag?ab[ag-1]:null}if(ah<af){ai=ad[ah]}else{ai=af?ad[af-1]:null}am=ak.attr("id");if(am===r){am="jqplot_target_"+H.jqplot.targetCounter++;ak.attr("id",am)}al=H.jqplot(am,aj,ai);ak.data("jqplot",al)})};H.jqplot=function(ah,ae,ac){var ad=null,ab=null;if(arguments.length===3){ad=ae;ab=ac}else{if(arguments.length===2){if(H.isArray(ae)){ad=ae}else{if(H.isPlainObject(ae)){ab=ae}}}}if(ad===null&&ab!==null&&ab.data){ad=ab.data}var ag=new N();H("#"+ah).removeClass("jqplot-error");if(H.jqplot.config.catchErrors){try{ag.init(ah,ad,ab);ag.draw();ag.themeEngine.init.call(ag);return ag}catch(af){var ai=H.jqplot.config.errorMessage||af.message;H("#"+ah).append('<div class="jqplot-error-message">'+ai+"</div>");H("#"+ah).addClass("jqplot-error");document.getElementById(ah).style.background=H.jqplot.config.errorBackground;document.getElementById(ah).style.border=H.jqplot.config.errorBorder;document.getElementById(ah).style.fontFamily=H.jqplot.config.errorFontFamily;document.getElementById(ah).style.fontSize=H.jqplot.config.errorFontSize;document.getElementById(ah).style.fontStyle=H.jqplot.config.errorFontStyle;document.getElementById(ah).style.fontWeight=H.jqplot.config.errorFontWeight}}else{ag.init(ah,ad,ab);ag.draw();ag.themeEngine.init.call(ag);return ag}};H.jqplot.version="1.0.4";H.jqplot.revision="1121";H.jqplot.targetCounter=1;H.jqplot.CanvasManager=function(){if(typeof H.jqplot.CanvasManager.canvases=="undefined"){H.jqplot.CanvasManager.canvases=[];H.jqplot.CanvasManager.free=[]}var ab=[];this.getCanvas=function(){var ae;var ad=true;if(!H.jqplot.use_excanvas){for(var af=0,ac=H.jqplot.CanvasManager.canvases.length;af<ac;af++){if(H.jqplot.CanvasManager.free[af]===true){ad=false;ae=H.jqplot.CanvasManager.canvases[af];H.jqplot.CanvasManager.free[af]=false;ab.push(af);break}}}if(ad){ae=document.createElement("canvas");ab.push(H.jqplot.CanvasManager.canvases.length);H.jqplot.CanvasManager.canvases.push(ae);H.jqplot.CanvasManager.free.push(false)}return ae};this.initCanvas=function(ac){if(H.jqplot.use_excanvas){return window.G_vmlCanvasManager.initElement(ac)}return ac};this.freeAllCanvases=function(){for(var ad=0,ac=ab.length;ad<ac;ad++){this.freeCanvas(ab[ad])}ab=[]};this.freeCanvas=function(ac){if(H.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==r){window.G_vmlCanvasManager.uninitElement(H.jqplot.CanvasManager.canvases[ac]);H.jqplot.CanvasManager.canvases[ac]=null}else{var ad=H.jqplot.CanvasManager.canvases[ac];ad.getContext("2d").clearRect(0,0,ad.width,ad.height);H(ad).unbind().removeAttr("class").removeAttr("style");H(ad).css({left:"",top:"",position:""});ad.width=0;ad.height=0;H.jqplot.CanvasManager.free[ac]=true}}};H.jqplot.log=function(){if(window.console){window.console.log.apply(window.console,arguments)}};H.jqplot.config={addDomReference:false,enablePlugins:false,defaultHeight:300,defaultWidth:400,UTCAdjust:false,timezoneOffset:new Date(new Date().getTimezoneOffset()*60000),errorMessage:"",errorBackground:"",errorBorder:"",errorFontFamily:"",errorFontSize:"",errorFontStyle:"",errorFontWeight:"",catchErrors:false,defaultTickFormatString:"%.1f",defaultColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc","#c747a3","#cddf54","#FBD178","#26B4E3","#bd70c7"],defaultNegativeColors:["#498991","#C08840","#9F9274","#546D61","#646C4A","#6F6621","#6E3F5F","#4F64B0","#A89050","#C45923","#187399","#945381","#959E5C","#C7AF7B","#478396","#907294"],dashLength:4,gapLength:4,dotGapLength:2.5,srcLocation:"jqplot/src/",pluginLocation:"jqplot/src/plugins/"};H.jqplot.arrayMax=function(ab){return Math.max.apply(Math,ab)};H.jqplot.arrayMin=function(ab){return Math.min.apply(Math,ab)};H.jqplot.enablePlugins=H.jqplot.config.enablePlugins;H.jqplot.support_canvas=function(){if(typeof H.jqplot.support_canvas.result=="undefined"){H.jqplot.support_canvas.result=!!document.createElement("canvas").getContext}return H.jqplot.support_canvas.result};H.jqplot.support_canvas_text=function(){if(typeof H.jqplot.support_canvas_text.result=="undefined"){if(window.G_vmlCanvasManager!==r&&window.G_vmlCanvasManager._version>887){H.jqplot.support_canvas_text.result=true}else{H.jqplot.support_canvas_text.result=!!(document.createElement("canvas").getContext&&typeof document.createElement("canvas").getContext("2d").fillText=="function")}}return H.jqplot.support_canvas_text.result};H.jqplot.use_excanvas=(H.browser.msie&&!H.jqplot.support_canvas())?true:false;H.jqplot.preInitHooks=[];H.jqplot.postInitHooks=[];H.jqplot.preParseOptionsHooks=[];H.jqplot.postParseOptionsHooks=[];H.jqplot.preDrawHooks=[];H.jqplot.postDrawHooks=[];H.jqplot.preDrawSeriesHooks=[];H.jqplot.postDrawSeriesHooks=[];H.jqplot.preDrawLegendHooks=[];H.jqplot.addLegendRowHooks=[];H.jqplot.preSeriesInitHooks=[];H.jqplot.postSeriesInitHooks=[];H.jqplot.preParseSeriesOptionsHooks=[];H.jqplot.postParseSeriesOptionsHooks=[];H.jqplot.eventListenerHooks=[];H.jqplot.preDrawSeriesShadowHooks=[];H.jqplot.postDrawSeriesShadowHooks=[];H.jqplot.ElemContainer=function(){this._elem;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null}};H.jqplot.ElemContainer.prototype.createElement=function(ae,ag,ac,ad,ah){this._offsets=ag;var ab=ac||"jqplot";var af=document.createElement(ae);this._elem=H(af);this._elem.addClass(ab);this._elem.css(ad);this._elem.attr(ah);af=null;return this._elem};H.jqplot.ElemContainer.prototype.getWidth=function(){if(this._elem){return this._elem.outerWidth(true)}else{return null}};H.jqplot.ElemContainer.prototype.getHeight=function(){if(this._elem){return this._elem.outerHeight(true)}else{return null}};H.jqplot.ElemContainer.prototype.getPosition=function(){if(this._elem){return this._elem.position()}else{return{top:null,left:null,bottom:null,right:null}}};H.jqplot.ElemContainer.prototype.getTop=function(){return this.getPosition().top};H.jqplot.ElemContainer.prototype.getLeft=function(){return this.getPosition().left};H.jqplot.ElemContainer.prototype.getBottom=function(){return this._elem.css("bottom")};H.jqplot.ElemContainer.prototype.getRight=function(){return this._elem.css("right")};function s(ab){H.jqplot.ElemContainer.call(this);this.name=ab;this._series=[];this.show=false;this.tickRenderer=H.jqplot.AxisTickRenderer;this.tickOptions={};this.labelRenderer=H.jqplot.AxisLabelRenderer;this.labelOptions={};this.label=null;this.showLabel=true;this.min=null;this.max=null;this.autoscale=false;this.pad=1.2;this.padMax=null;this.padMin=null;this.ticks=[];this.numberTicks;this.tickInterval;this.renderer=H.jqplot.LinearAxisRenderer;this.rendererOptions={};this.showTicks=true;this.showTickMarks=true;this.showMinorTicks=true;this.drawMajorGridlines=true;this.drawMinorGridlines=false;this.drawMajorTickMarks=true;this.drawMinorTickMarks=true;this.useSeriesColor=false;this.borderWidth=null;this.borderColor=null;this.scaleToHiddenSeries=false;this._dataBounds={min:null,max:null};this._intervalStats=[];this._offsets={min:null,max:null};this._ticks=[];this._label=null;this.syncTicks=null;this.tickSpacing=75;this._min=null;this._max=null;this._tickInterval=null;this._numberTicks=null;this.__ticks=null;this._options={}}s.prototype=new H.jqplot.ElemContainer();s.prototype.constructor=s;s.prototype.init=function(){if(H.isFunction(this.renderer)){this.renderer=new this.renderer()}this.tickOptions.axis=this.name;if(this.tickOptions.showMark==null){this.tickOptions.showMark=this.showTicks}if(this.tickOptions.showMark==null){this.tickOptions.showMark=this.showTickMarks}if(this.tickOptions.showLabel==null){this.tickOptions.showLabel=this.showTicks}if(this.label==null||this.label==""){this.showLabel=false}else{this.labelOptions.label=this.label}if(this.showLabel==false){this.labelOptions.show=false}if(this.pad==0){this.pad=1}if(this.padMax==0){this.padMax=1}if(this.padMin==0){this.padMin=1}if(this.padMax==null){this.padMax=(this.pad-1)/2+1}if(this.padMin==null){this.padMin=(this.pad-1)/2+1}this.pad=this.padMax+this.padMin-1;if(this.min!=null||this.max!=null){this.autoscale=false}if(this.syncTicks==null&&this.name.indexOf("y")>-1){this.syncTicks=true}else{if(this.syncTicks==null){this.syncTicks=false}}this.renderer.init.call(this,this.rendererOptions)};s.prototype.draw=function(ab,ac){if(this.__ticks){this.__ticks=null}return this.renderer.draw.call(this,ab,ac)};s.prototype.set=function(){this.renderer.set.call(this)};s.prototype.pack=function(ac,ab){if(this.show){this.renderer.pack.call(this,ac,ab)}if(this._min==null){this._min=this.min;this._max=this.max;this._tickInterval=this.tickInterval;this._numberTicks=this.numberTicks;this.__ticks=this._ticks}};s.prototype.reset=function(){this.renderer.reset.call(this)};s.prototype.resetScale=function(ab){H.extend(true,this,{min:null,max:null,numberTicks:null,tickInterval:null,_ticks:[],ticks:[]},ab);this.resetDataBounds()};s.prototype.resetDataBounds=function(){var ai=this._dataBounds;ai.min=null;ai.max=null;var ac,aj,ag;var ad=(this.show)?true:false;for(var af=0;af<this._series.length;af++){aj=this._series[af];if(aj.show||this.scaleToHiddenSeries){ag=aj._plotData;if(aj._type==="line"&&aj.renderer.bands.show&&this.name.charAt(0)!=="x"){ag=[[0,aj.renderer.bands._min],[1,aj.renderer.bands._max]]}var ab=1,ah=1;if(aj._type!=null&&aj._type=="ohlc"){ab=3;ah=2}for(var ae=0,ac=ag.length;ae<ac;ae++){if(this.name=="xaxis"||this.name=="x2axis"){if((ag[ae][0]!=null&&ag[ae][0]<ai.min)||ai.min==null){ai.min=ag[ae][0]}if((ag[ae][0]!=null&&ag[ae][0]>ai.max)||ai.max==null){ai.max=ag[ae][0]}}else{if((ag[ae][ab]!=null&&ag[ae][ab]<ai.min)||ai.min==null){ai.min=ag[ae][ab]}if((ag[ae][ah]!=null&&ag[ae][ah]>ai.max)||ai.max==null){ai.max=ag[ae][ah]}}}if(ad&&aj.renderer.constructor!==H.jqplot.BarRenderer){ad=false}else{if(ad&&this._options.hasOwnProperty("forceTickAt0")&&this._options.forceTickAt0==false){ad=false}else{if(ad&&aj.renderer.constructor===H.jqplot.BarRenderer){if(aj.barDirection=="vertical"&&this.name!="xaxis"&&this.name!="x2axis"){if(this._options.pad!=null||this._options.padMin!=null){ad=false}}else{if(aj.barDirection=="horizontal"&&(this.name=="xaxis"||this.name=="x2axis")){if(this._options.pad!=null||this._options.padMin!=null){ad=false}}}}}}}}if(ad&&this.renderer.constructor===H.jqplot.LinearAxisRenderer&&ai.min>=0){this.padMin=1;this.forceTickAt0=true}};function n(ab){H.jqplot.ElemContainer.call(this);this.show=false;this.location="ne";this.labels=[];this.showLabels=true;this.showSwatches=true;this.placement="insideGrid";this.xoffset=0;this.yoffset=0;this.border;this.background;this.textColor;this.fontFamily;this.fontSize;this.rowSpacing="0.5em";this.renderer=H.jqplot.TableLegendRenderer;this.rendererOptions={};this.preDraw=false;this.marginTop=null;this.marginRight=null;this.marginBottom=null;this.marginLeft=null;this.escapeHtml=false;this._series=[];H.extend(true,this,ab)}n.prototype=new H.jqplot.ElemContainer();n.prototype.constructor=n;n.prototype.setOptions=function(ab){H.extend(true,this,ab);if(this.placement=="inside"){this.placement="insideGrid"}if(this.xoffset>0){if(this.placement=="insideGrid"){switch(this.location){case"nw":case"w":case"sw":if(this.marginLeft==null){this.marginLeft=this.xoffset+"px"}this.marginRight="0px";break;case"ne":case"e":case"se":default:if(this.marginRight==null){this.marginRight=this.xoffset+"px"}this.marginLeft="0px";break}}else{if(this.placement=="outside"){switch(this.location){case"nw":case"w":case"sw":if(this.marginRight==null){this.marginRight=this.xoffset+"px"}this.marginLeft="0px";break;case"ne":case"e":case"se":default:if(this.marginLeft==null){this.marginLeft=this.xoffset+"px"}this.marginRight="0px";break}}}this.xoffset=0}if(this.yoffset>0){if(this.placement=="outside"){switch(this.location){case"sw":case"s":case"se":if(this.marginTop==null){this.marginTop=this.yoffset+"px"}this.marginBottom="0px";break;case"ne":case"n":case"nw":default:if(this.marginBottom==null){this.marginBottom=this.yoffset+"px"}this.marginTop="0px";break}}else{if(this.placement=="insideGrid"){switch(this.location){case"sw":case"s":case"se":if(this.marginBottom==null){this.marginBottom=this.yoffset+"px"}this.marginTop="0px";break;case"ne":case"n":case"nw":default:if(this.marginTop==null){this.marginTop=this.yoffset+"px"}this.marginBottom="0px";break}}}this.yoffset=0}};n.prototype.init=function(){if(H.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};n.prototype.draw=function(ac,ad){for(var ab=0;ab<H.jqplot.preDrawLegendHooks.length;ab++){H.jqplot.preDrawLegendHooks[ab].call(this,ac)}return this.renderer.draw.call(this,ac,ad)};n.prototype.pack=function(ab){this.renderer.pack.call(this,ab)};function u(ab){H.jqplot.ElemContainer.call(this);this.text=ab;this.show=true;this.fontFamily;this.fontSize;this.textAlign;this.textColor;this.renderer=H.jqplot.DivTitleRenderer;this.rendererOptions={};this.escapeHtml=false}u.prototype=new H.jqplot.ElemContainer();u.prototype.constructor=u;u.prototype.init=function(){if(H.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};u.prototype.draw=function(ab){return this.renderer.draw.call(this,ab)};u.prototype.pack=function(){this.renderer.pack.call(this)};function O(ab){ab=ab||{};H.jqplot.ElemContainer.call(this);this.show=true;this.xaxis="xaxis";this._xaxis;this.yaxis="yaxis";this._yaxis;this.gridBorderWidth=2;this.renderer=H.jqplot.LineRenderer;this.rendererOptions={};this.data=[];this.gridData=[];this.label="";this.showLabel=true;this.color;this.negativeColor;this.lineWidth=2.5;this.lineJoin="round";this.lineCap="round";this.linePattern="solid";this.shadow=true;this.shadowAngle=45;this.shadowOffset=1.25;this.shadowDepth=3;this.shadowAlpha="0.1";this.breakOnNull=false;this.markerRenderer=H.jqplot.MarkerRenderer;this.markerOptions={};this.showLine=true;this.showMarker=true;this.index;this.fill=false;this.fillColor;this.fillAlpha;this.fillAndStroke=false;this.disableStack=false;this._stack=false;this.neighborThreshold=4;this.fillToZero=false;this.fillToValue=0;this.fillAxis="y";this.useNegativeColors=true;this._stackData=[];this._plotData=[];this._plotValues={x:[],y:[]};this._intervals={x:{},y:{}};this._prevPlotData=[];this._prevGridData=[];this._stackAxis="y";this._primaryAxis="_xaxis";this.canvas=new H.jqplot.GenericCanvas();this.shadowCanvas=new H.jqplot.GenericCanvas();this.plugins={};this._sumy=0;this._sumx=0;this._type=""}O.prototype=new H.jqplot.ElemContainer();O.prototype.constructor=O;O.prototype.init=function(ae,ai,ag){this.index=ae;this.gridBorderWidth=ai;var ah=this.data;var ad=[],af,ab;for(af=0,ab=ah.length;af<ab;af++){if(!this.breakOnNull){if(ah[af]==null||ah[af][0]==null||ah[af][1]==null){continue}else{ad.push(ah[af])}}else{ad.push(ah[af])}}this.data=ad;if(!this.color){this.color=ag.colorGenerator.get(this.index)}if(!this.negativeColor){this.negativeColor=ag.negativeColorGenerator.get(this.index)}if(!this.fillColor){this.fillColor=this.color}if(this.fillAlpha){var ac=H.jqplot.normalize2rgb(this.fillColor);var ac=H.jqplot.getColorComponents(ac);this.fillColor="rgba("+ac[0]+","+ac[1]+","+ac[2]+","+this.fillAlpha+")"}if(H.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions,ag);this.markerRenderer=new this.markerRenderer();if(!this.markerOptions.color){this.markerOptions.color=this.color}if(this.markerOptions.show==null){this.markerOptions.show=this.showMarker}this.showMarker=this.markerOptions.show;this.markerRenderer.init(this.markerOptions)};O.prototype.draw=function(ah,ae,ag){var ac=(ae==r)?{}:ae;ah=(ah==r)?this.canvas._ctx:ah;var ab,af,ad;for(ab=0;ab<H.jqplot.preDrawSeriesHooks.length;ab++){H.jqplot.preDrawSeriesHooks[ab].call(this,ah,ac)}if(this.show){this.renderer.setGridData.call(this,ag);if(!ac.preventJqPlotSeriesDrawTrigger){H(ah.canvas).trigger("jqplotSeriesDraw",[this.data,this.gridData])}af=[];if(ac.data){af=ac.data}else{if(!this._stack){af=this.data}else{af=this._plotData}}ad=ac.gridData||this.renderer.makeGridData.call(this,af,ag);if(this._type==="line"&&this.renderer.smooth&&this.renderer._smoothedData.length){ad=this.renderer._smoothedData}this.renderer.draw.call(this,ah,ad,ac,ag)}for(ab=0;ab<H.jqplot.postDrawSeriesHooks.length;ab++){H.jqplot.postDrawSeriesHooks[ab].call(this,ah,ac,ag)}ah=ae=ag=ab=af=ad=null};O.prototype.drawShadow=function(ah,ae,ag){var ac=(ae==r)?{}:ae;ah=(ah==r)?this.shadowCanvas._ctx:ah;var ab,af,ad;for(ab=0;ab<H.jqplot.preDrawSeriesShadowHooks.length;ab++){H.jqplot.preDrawSeriesShadowHooks[ab].call(this,ah,ac)}if(this.shadow){this.renderer.setGridData.call(this,ag);af=[];if(ac.data){af=ac.data}else{if(!this._stack){af=this.data}else{af=this._plotData}}ad=ac.gridData||this.renderer.makeGridData.call(this,af,ag);this.renderer.drawShadow.call(this,ah,ad,ac,ag)}for(ab=0;ab<H.jqplot.postDrawSeriesShadowHooks.length;ab++){H.jqplot.postDrawSeriesShadowHooks[ab].call(this,ah,ac)}ah=ae=ag=ab=af=ad=null};O.prototype.toggleDisplay=function(ac,ae){var ab,ad;if(ac.data.series){ab=ac.data.series}else{ab=this}if(ac.data.speed){ad=ac.data.speed}if(ad){if(ab.canvas._elem.is(":hidden")||!ab.show){ab.show=true;ab.canvas._elem.removeClass("jqplot-series-hidden");if(ab.shadowCanvas._elem){ab.shadowCanvas._elem.fadeIn(ad)}ab.canvas._elem.fadeIn(ad,ae);ab.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+ab.index).fadeIn(ad)}else{ab.show=false;ab.canvas._elem.addClass("jqplot-series-hidden");if(ab.shadowCanvas._elem){ab.shadowCanvas._elem.fadeOut(ad)}ab.canvas._elem.fadeOut(ad,ae);ab.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+ab.index).fadeOut(ad)}}else{if(ab.canvas._elem.is(":hidden")||!ab.show){ab.show=true;ab.canvas._elem.removeClass("jqplot-series-hidden");if(ab.shadowCanvas._elem){ab.shadowCanvas._elem.show()}ab.canvas._elem.show(0,ae);ab.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+ab.index).show()}else{ab.show=false;ab.canvas._elem.addClass("jqplot-series-hidden");if(ab.shadowCanvas._elem){ab.shadowCanvas._elem.hide()}ab.canvas._elem.hide(0,ae);ab.canvas._elem.nextAll(".jqplot-point-label.jqplot-series-"+ab.index).hide()}}};function I(){H.jqplot.ElemContainer.call(this);this.drawGridlines=true;this.gridLineColor="#cccccc";this.gridLineWidth=1;this.background="#fffdf6";this.borderColor="#999999";this.borderWidth=2;this.drawBorder=true;this.shadow=true;this.shadowAngle=45;this.shadowOffset=1.5;this.shadowWidth=3;this.shadowDepth=3;this.shadowColor=null;this.shadowAlpha="0.07";this._left;this._top;this._right;this._bottom;this._width;this._height;this._axes=[];this.renderer=H.jqplot.CanvasGridRenderer;this.rendererOptions={};this._offsets={top:null,bottom:null,left:null,right:null}}I.prototype=new H.jqplot.ElemContainer();I.prototype.constructor=I;I.prototype.init=function(){if(H.isFunction(this.renderer)){this.renderer=new this.renderer()}this.renderer.init.call(this,this.rendererOptions)};I.prototype.createElement=function(ab,ac){this._offsets=ab;return this.renderer.createElement.call(this,ac)};I.prototype.draw=function(){this.renderer.draw.call(this)};H.jqplot.GenericCanvas=function(){H.jqplot.ElemContainer.call(this);this._ctx};H.jqplot.GenericCanvas.prototype=new H.jqplot.ElemContainer();H.jqplot.GenericCanvas.prototype.constructor=H.jqplot.GenericCanvas;H.jqplot.GenericCanvas.prototype.createElement=function(af,ad,ac,ag){this._offsets=af;var ab="jqplot";if(ad!=r){ab=ad}var ae;ae=ag.canvasManager.getCanvas();if(ac!=null){this._plotDimensions=ac}ae.width=this._plotDimensions.width-this._offsets.left-this._offsets.right;ae.height=this._plotDimensions.height-this._offsets.top-this._offsets.bottom;this._elem=H(ae);this._elem.css({position:"absolute",left:this._offsets.left,top:this._offsets.top});this._elem.addClass(ab);ae=ag.canvasManager.initCanvas(ae);ae=null;return this._elem};H.jqplot.GenericCanvas.prototype.setContext=function(){this._ctx=this._elem.get(0).getContext("2d");return this._ctx};H.jqplot.GenericCanvas.prototype.resetCanvas=function(){if(this._elem){if(H.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==r){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce()}this._ctx=null};H.jqplot.HooksManager=function(){this.hooks=[];this.args=[]};H.jqplot.HooksManager.prototype.addOnce=function(ae,ac){ac=ac||[];var af=false;for(var ad=0,ab=this.hooks.length;ad<ab;ad++){if(this.hooks[ad]==ae){af=true}}if(!af){this.hooks.push(ae);this.args.push(ac)}};H.jqplot.HooksManager.prototype.add=function(ac,ab){ab=ab||[];this.hooks.push(ac);this.args.push(ab)};H.jqplot.EventListenerManager=function(){this.hooks=[]};H.jqplot.EventListenerManager.prototype.addOnce=function(af,ae){var ag=false,ad,ac;for(var ac=0,ab=this.hooks.length;ac<ab;ac++){ad=this.hooks[ac];if(ad[0]==af&&ad[1]==ae){ag=true}}if(!ag){this.hooks.push([af,ae])}};H.jqplot.EventListenerManager.prototype.add=function(ac,ab){this.hooks.push([ac,ab])};var Q=["yMidAxis","xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];function N(){this.animate=false;this.animateReplot=false;this.axes={xaxis:new s("xaxis"),yaxis:new s("yaxis"),x2axis:new s("x2axis"),y2axis:new s("y2axis"),y3axis:new s("y3axis"),y4axis:new s("y4axis"),y5axis:new s("y5axis"),y6axis:new s("y6axis"),y7axis:new s("y7axis"),y8axis:new s("y8axis"),y9axis:new s("y9axis"),yMidAxis:new s("yMidAxis")};this.baseCanvas=new H.jqplot.GenericCanvas();this.captureRightClick=false;this.data=[];this.dataRenderer;this.dataRendererOptions;this.defaults={axesDefaults:{},axes:{xaxis:{},yaxis:{},x2axis:{},y2axis:{},y3axis:{},y4axis:{},y5axis:{},y6axis:{},y7axis:{},y8axis:{},y9axis:{},yMidAxis:{}},seriesDefaults:{},series:[]};this.defaultAxisStart=1;this.drawIfHidden=false;this.eventCanvas=new H.jqplot.GenericCanvas();this.fillBetween={series1:null,series2:null,color:null,baseSeries:0,fill:true};this.fontFamily;this.fontSize;this.grid=new I();this.legend=new n();this.negativeSeriesColors=H.jqplot.config.defaultNegativeColors;this.noDataIndicator={show:false,indicator:"Loading Data...",axes:{xaxis:{min:0,max:10,tickInterval:2,show:true},yaxis:{min:0,max:12,tickInterval:3,show:true}}};this.options={};this.previousSeriesStack=[];this.plugins={};this.series=[];this.seriesStack=[];this.seriesColors=H.jqplot.config.defaultColors;this.sortData=true;this.stackSeries=false;this.syncXTicks=true;this.syncYTicks=true;this.target=null;this.targetId=null;this.textColor;this.title=new u();this._drawCount=0;this._sumy=0;this._sumx=0;this._stackData=[];this._plotData=[];this._width=null;this._height=null;this._plotDimensions={height:null,width:null};this._gridPadding={top:null,right:null,bottom:null,left:null};this._defaultGridPadding={top:10,right:10,bottom:23,left:10};this._addDomReference=H.jqplot.config.addDomReference;this.preInitHooks=new H.jqplot.HooksManager();this.postInitHooks=new H.jqplot.HooksManager();this.preParseOptionsHooks=new H.jqplot.HooksManager();this.postParseOptionsHooks=new H.jqplot.HooksManager();this.preDrawHooks=new H.jqplot.HooksManager();this.postDrawHooks=new H.jqplot.HooksManager();this.preDrawSeriesHooks=new H.jqplot.HooksManager();this.postDrawSeriesHooks=new H.jqplot.HooksManager();this.preDrawLegendHooks=new H.jqplot.HooksManager();this.addLegendRowHooks=new H.jqplot.HooksManager();this.preSeriesInitHooks=new H.jqplot.HooksManager();this.postSeriesInitHooks=new H.jqplot.HooksManager();this.preParseSeriesOptionsHooks=new H.jqplot.HooksManager();this.postParseSeriesOptionsHooks=new H.jqplot.HooksManager();this.eventListenerHooks=new H.jqplot.EventListenerManager();this.preDrawSeriesShadowHooks=new H.jqplot.HooksManager();this.postDrawSeriesShadowHooks=new H.jqplot.HooksManager();this.colorGenerator=new H.jqplot.ColorGenerator();this.negativeColorGenerator=new H.jqplot.ColorGenerator();this.canvasManager=new H.jqplot.CanvasManager();this.themeEngine=new H.jqplot.ThemeEngine();var ad=0;this.init=function(ao,al,aq){aq=aq||{};for(var am=0;am<H.jqplot.preInitHooks.length;am++){H.jqplot.preInitHooks[am].call(this,ao,al,aq)}for(var am=0;am<this.preInitHooks.hooks.length;am++){this.preInitHooks.hooks[am].call(this,ao,al,aq)}this.targetId="#"+ao;this.target=H("#"+ao);if(this._addDomReference){this.target.data("jqplot",this)}this.target.removeClass("jqplot-error");if(!this.target.get(0)){throw"No plot target specified"}if(this.target.css("position")=="static"){this.target.css("position","relative")}if(!this.target.hasClass("jqplot-target")){this.target.addClass("jqplot-target")}if(!this.target.height()){var an;if(aq&&aq.height){an=parseInt(aq.height,10)}else{if(this.target.attr("data-height")){an=parseInt(this.target.attr("data-height"),10)}else{an=parseInt(H.jqplot.config.defaultHeight,10)}}this._height=an;this.target.css("height",an+"px")}else{this._height=an=this.target.height()}if(!this.target.width()){var ap;if(aq&&aq.width){ap=parseInt(aq.width,10)}else{if(this.target.attr("data-width")){ap=parseInt(this.target.attr("data-width"),10)}else{ap=parseInt(H.jqplot.config.defaultWidth,10)}}this._width=ap;this.target.css("width",ap+"px")}else{this._width=ap=this.target.width()}for(var am=0,aj=Q.length;am<aj;am++){this.axes[Q[am]]=new s(Q[am])}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;if(this._height<=0||this._width<=0||!this._height||!this._width){throw"Canvas dimension not set"}if(aq.dataRenderer&&H.isFunction(aq.dataRenderer)){if(aq.dataRendererOptions){this.dataRendererOptions=aq.dataRendererOptions}this.dataRenderer=aq.dataRenderer;al=this.dataRenderer(al,this,this.dataRendererOptions)}if(aq.noDataIndicator&&H.isPlainObject(aq.noDataIndicator)){H.extend(true,this.noDataIndicator,aq.noDataIndicator)}if(al==null||H.isArray(al)==false||al.length==0||H.isArray(al[0])==false||al[0].length==0){if(this.noDataIndicator.show==false){throw"No Data"}else{for(var af in this.noDataIndicator.axes){for(var ah in this.noDataIndicator.axes[af]){this.axes[af][ah]=this.noDataIndicator.axes[af][ah]}}this.postDrawHooks.add(function(){var ax=this.eventCanvas.getHeight();var au=this.eventCanvas.getWidth();var at=H('<div class="jqplot-noData-container" style="position:absolute;"></div>');this.target.append(at);at.height(ax);at.width(au);at.css("top",this.eventCanvas._offsets.top);at.css("left",this.eventCanvas._offsets.left);var aw=H('<div class="jqplot-noData-contents" style="text-align:center; position:relative; margin-left:auto; margin-right:auto;"></div>');at.append(aw);aw.html(this.noDataIndicator.indicator);var av=aw.height();var ar=aw.width();aw.height(av);aw.width(ar);aw.css("top",(ax-av)/2+"px")})}}this.data=H.extend(true,[],al);this.parseOptions(aq);if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)}if(this.fontSize){this.target.css("font-size",this.fontSize)}this.title.init();this.legend.init();this._sumy=0;this._sumx=0;this.computePlotData();for(var am=0;am<this.series.length;am++){this.seriesStack.push(am);this.previousSeriesStack.push(am);this.series[am].shadowCanvas._plotDimensions=this._plotDimensions;this.series[am].canvas._plotDimensions=this._plotDimensions;for(var ak=0;ak<H.jqplot.preSeriesInitHooks.length;ak++){H.jqplot.preSeriesInitHooks[ak].call(this.series[am],ao,this.data,this.options.seriesDefaults,this.options.series[am],this)}for(var ak=0;ak<this.preSeriesInitHooks.hooks.length;ak++){this.preSeriesInitHooks.hooks[ak].call(this.series[am],ao,this.data,this.options.seriesDefaults,this.options.series[am],this)}this.series[am]._plotDimensions=this._plotDimensions;this.series[am].init(am,this.grid.borderWidth,this);for(var ak=0;ak<H.jqplot.postSeriesInitHooks.length;ak++){H.jqplot.postSeriesInitHooks[ak].call(this.series[am],ao,this.data,this.options.seriesDefaults,this.options.series[am],this)}for(var ak=0;ak<this.postSeriesInitHooks.hooks.length;ak++){this.postSeriesInitHooks.hooks[ak].call(this.series[am],ao,this.data,this.options.seriesDefaults,this.options.series[am],this)}this._sumy+=this.series[am]._sumy;this._sumx+=this.series[am]._sumx}var ag,ai;for(var am=0,aj=Q.length;am<aj;am++){ag=Q[am];ai=this.axes[ag];ai._plotDimensions=this._plotDimensions;ai.init();if(this.axes[ag].borderColor==null){if(ag.charAt(0)!=="x"&&ai.useSeriesColor===true&&ai.show){ai.borderColor=ai._series[0].color}else{ai.borderColor=this.grid.borderColor}}}if(this.sortData){ab(this.series)}this.grid.init();this.grid._axes=this.axes;this.legend._series=this.series;for(var am=0;am<H.jqplot.postInitHooks.length;am++){H.jqplot.postInitHooks[am].call(this,ao,this.data,aq)}for(var am=0;am<this.postInitHooks.hooks.length;am++){this.postInitHooks.hooks[am].call(this,ao,this.data,aq)}};this.resetAxesScale=function(ak,ag){var ai=ag||{};var aj=ak||this.axes;if(aj===true){aj=this.axes}if(H.isArray(aj)){for(var ah=0;ah<aj.length;ah++){this.axes[aj[ah]].resetScale(ai[aj[ah]])}}else{if(typeof(aj)==="object"){for(var af in aj){this.axes[af].resetScale(ai[af])}}}};this.reInitialize=function(an,af){var ar=H.extend(true,{},this.options,af);var ap=this.targetId.substr(1);var al=(an==null)?this.data:an;for(var ao=0;ao<H.jqplot.preInitHooks.length;ao++){H.jqplot.preInitHooks[ao].call(this,ap,al,ar)}for(var ao=0;ao<this.preInitHooks.hooks.length;ao++){this.preInitHooks.hooks[ao].call(this,ap,al,ar)}this._height=this.target.height();this._width=this.target.width();if(this._height<=0||this._width<=0||!this._height||!this._width){throw"Target dimension not set"}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;var ag,aq,am,ai;for(var ao=0,ak=Q.length;ao<ak;ao++){ag=Q[ao];ai=this.axes[ag];aq=ai._ticks;for(var am=0,aj=aq.length;am<aj;am++){var ah=aq[am]._elem;if(ah){if(H.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==r){window.G_vmlCanvasManager.uninitElement(ah.get(0))}ah.emptyForce();ah=null;aq._elem=null}}aq=null;delete ai.ticks;delete ai._ticks;this.axes[ag]=new s(ag);this.axes[ag]._plotWidth=this._width;this.axes[ag]._plotHeight=this._height}if(an){if(ar.dataRenderer&&H.isFunction(ar.dataRenderer)){if(ar.dataRendererOptions){this.dataRendererOptions=ar.dataRendererOptions}this.dataRenderer=ar.dataRenderer;an=this.dataRenderer(an,this,this.dataRendererOptions)}this.data=H.extend(true,[],an)}if(af){this.parseOptions(ar)}this.title._plotWidth=this._width;if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)}if(this.fontSize){this.target.css("font-size",this.fontSize)}this.title.init();this.legend.init();this._sumy=0;this._sumx=0;this.seriesStack=[];this.previousSeriesStack=[];this.computePlotData();for(var ao=0,ak=this.series.length;ao<ak;ao++){this.seriesStack.push(ao);this.previousSeriesStack.push(ao);this.series[ao].shadowCanvas._plotDimensions=this._plotDimensions;this.series[ao].canvas._plotDimensions=this._plotDimensions;for(var am=0;am<H.jqplot.preSeriesInitHooks.length;am++){H.jqplot.preSeriesInitHooks[am].call(this.series[ao],ap,this.data,this.options.seriesDefaults,this.options.series[ao],this)}for(var am=0;am<this.preSeriesInitHooks.hooks.length;am++){this.preSeriesInitHooks.hooks[am].call(this.series[ao],ap,this.data,this.options.seriesDefaults,this.options.series[ao],this)}this.series[ao]._plotDimensions=this._plotDimensions;this.series[ao].init(ao,this.grid.borderWidth,this);for(var am=0;am<H.jqplot.postSeriesInitHooks.length;am++){H.jqplot.postSeriesInitHooks[am].call(this.series[ao],ap,this.data,this.options.seriesDefaults,this.options.series[ao],this)}for(var am=0;am<this.postSeriesInitHooks.hooks.length;am++){this.postSeriesInitHooks.hooks[am].call(this.series[ao],ap,this.data,this.options.seriesDefaults,this.options.series[ao],this)}this._sumy+=this.series[ao]._sumy;this._sumx+=this.series[ao]._sumx}for(var ao=0,ak=Q.length;ao<ak;ao++){ag=Q[ao];ai=this.axes[ag];ai._plotDimensions=this._plotDimensions;ai.init();if(ai.borderColor==null){if(ag.charAt(0)!=="x"&&ai.useSeriesColor===true&&ai.show){ai.borderColor=ai._series[0].color}else{ai.borderColor=this.grid.borderColor}}}if(this.sortData){ab(this.series)}this.grid.init();this.grid._axes=this.axes;this.legend._series=this.series;for(var ao=0,ak=H.jqplot.postInitHooks.length;ao<ak;ao++){H.jqplot.postInitHooks[ao].call(this,ap,this.data,ar)}for(var ao=0,ak=this.postInitHooks.hooks.length;ao<ak;ao++){this.postInitHooks.hooks[ao].call(this,ap,this.data,ar)}};this.quickInit=function(){this._height=this.target.height();this._width=this.target.width();if(this._height<=0||this._width<=0||!this._height||!this._width){throw"Target dimension not set"}this._plotDimensions.height=this._height;this._plotDimensions.width=this._width;this.grid._plotDimensions=this._plotDimensions;this.title._plotDimensions=this._plotDimensions;this.baseCanvas._plotDimensions=this._plotDimensions;this.eventCanvas._plotDimensions=this._plotDimensions;this.legend._plotDimensions=this._plotDimensions;for(var ak in this.axes){this.axes[ak]._plotWidth=this._width;this.axes[ak]._plotHeight=this._height}this.title._plotWidth=this._width;if(this.textColor){this.target.css("color",this.textColor)}if(this.fontFamily){this.target.css("font-family",this.fontFamily)}if(this.fontSize){this.target.css("font-size",this.fontSize)}this._sumy=0;this._sumx=0;this.computePlotData();for(var ai=0;ai<this.series.length;ai++){if(this.series[ai]._type==="line"&&this.series[ai].renderer.bands.show){this.series[ai].renderer.initBands.call(this.series[ai],this.series[ai].renderer.options,this)}this.series[ai]._plotDimensions=this._plotDimensions;this.series[ai].canvas._plotDimensions=this._plotDimensions;this._sumy+=this.series[ai]._sumy;this._sumx+=this.series[ai]._sumx}var ag;for(var af=0;af<12;af++){ag=Q[af];var ah=this.axes[ag]._ticks;for(var ai=0;ai<ah.length;ai++){var aj=ah[ai]._elem;if(aj){if(H.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==r){window.G_vmlCanvasManager.uninitElement(aj.get(0))}aj.emptyForce();aj=null;ah._elem=null}}ah=null;this.axes[ag]._plotDimensions=this._plotDimensions;this.axes[ag]._ticks=[]}if(this.sortData){ab(this.series)}this.grid._axes=this.axes;this.legend._series=this.series};function ab(aj){var an,ao,ap,af,am;for(var ak=0;ak<aj.length;ak++){var ag;var al=[aj[ak].data,aj[ak]._stackData,aj[ak]._plotData,aj[ak]._prevPlotData];for(var ah=0;ah<4;ah++){ag=true;an=al[ah];if(aj[ak]._stackAxis=="x"){for(var ai=0;ai<an.length;ai++){if(typeof(an[ai][1])!="number"){ag=false;break}}if(ag){an.sort(function(ar,aq){return ar[1]-aq[1]})}}else{for(var ai=0;ai<an.length;ai++){if(typeof(an[ai][0])!="number"){ag=false;break}}if(ag){an.sort(function(ar,aq){return ar[0]-aq[0]})}}}}}this.computePlotData=function(){this._plotData=[];this._stackData=[];var am,an,ai;for(an=0,ai=this.series.length;an<ai;an++){am=this.series[an];this._plotData.push([]);this._stackData.push([]);var ag=am.data;this._plotData[an]=H.extend(true,[],ag);this._stackData[an]=H.extend(true,[],ag);am._plotData=this._plotData[an];am._stackData=this._stackData[an];var aq={x:[],y:[]};if(this.stackSeries&&!am.disableStack){am._stack=true;var ao=(am._stackAxis==="x")?0:1;for(var aj=0,af=ag.length;aj<af;aj++){var ap=ag[aj][ao];if(ap==null){ap=0}this._plotData[an][aj][ao]=ap;this._stackData[an][aj][ao]=ap;if(an>0){for(var ak=an;ak--;){var ah=this._plotData[ak][aj][ao];if(ap*ah>=0){this._plotData[an][aj][ao]+=ah;this._stackData[an][aj][ao]+=ah;break}}}}}else{for(var al=0;al<am.data.length;al++){aq.x.push(am.data[al][0]);aq.y.push(am.data[al][1])}this._stackData.push(am.data);this.series[an]._stackData=am.data;this._plotData.push(am.data);am._plotData=am.data;am._plotValues=aq}if(an>0){am._prevPlotData=this.series[an-1]._plotData}am._sumy=0;am._sumx=0;for(al=am.data.length-1;al>-1;al--){am._sumy+=am.data[al][1];am._sumx+=am.data[al][0]}}};this.populatePlotData=function(an,ao){this._plotData=[];this._stackData=[];an._stackData=[];an._plotData=[];var ar={x:[],y:[]};if(this.stackSeries&&!an.disableStack){an._stack=true;var aq=(an._stackAxis==="x")?0:1;var at=H.extend(true,[],an.data);var au=H.extend(true,[],an.data);var ah,ag,ai,ap,af;for(var al=0;al<ao;al++){var aj=this.series[al].data;for(var ak=0;ak<aj.length;ak++){ai=aj[ak];ah=(ai[0]!=null)?ai[0]:0;ag=(ai[1]!=null)?ai[1]:0;at[ak][0]+=ah;at[ak][1]+=ag;ap=(aq)?ag:ah;if(an.data[ak][aq]*ap>=0){au[ak][aq]+=ap}}}for(var am=0;am<au.length;am++){ar.x.push(au[am][0]);ar.y.push(au[am][1])}this._plotData.push(au);this._stackData.push(at);an._stackData=at;an._plotData=au;an._plotValues=ar}else{for(var am=0;am<an.data.length;am++){ar.x.push(an.data[am][0]);ar.y.push(an.data[am][1])}this._stackData.push(an.data);this.series[ao]._stackData=an.data;this._plotData.push(an.data);an._plotData=an.data;an._plotValues=ar}if(ao>0){an._prevPlotData=this.series[ao-1]._plotData}an._sumy=0;an._sumx=0;for(am=an.data.length-1;am>-1;am--){an._sumy+=an.data[am][1];an._sumx+=an.data[am][0]}};this.getNextSeriesColor=(function(ag){var af=0;var ah=ag.seriesColors;return function(){if(af<ah.length){return ah[af++]}else{af=0;return ah[af++]}}})(this);this.parseOptions=function(ar){for(var am=0;am<this.preParseOptionsHooks.hooks.length;am++){this.preParseOptionsHooks.hooks[am].call(this,ar)}for(var am=0;am<H.jqplot.preParseOptionsHooks.length;am++){H.jqplot.preParseOptionsHooks[am].call(this,ar)}this.options=H.extend(true,{},this.defaults,ar);var ag=this.options;this.animate=ag.animate;this.animateReplot=ag.animateReplot;this.stackSeries=ag.stackSeries;if(H.isPlainObject(ag.fillBetween)){var aq=["series1","series2","color","baseSeries","fill"],an;for(var am=0,ak=aq.length;am<ak;am++){an=aq[am];if(ag.fillBetween[an]!=null){this.fillBetween[an]=ag.fillBetween[an]}}}if(ag.seriesColors){this.seriesColors=ag.seriesColors}if(ag.negativeSeriesColors){this.negativeSeriesColors=ag.negativeSeriesColors}if(ag.captureRightClick){this.captureRightClick=ag.captureRightClick}this.defaultAxisStart=(ar&&ar.defaultAxisStart!=null)?ar.defaultAxisStart:this.defaultAxisStart;this.colorGenerator.setColors(this.seriesColors);this.negativeColorGenerator.setColors(this.negativeSeriesColors);H.extend(true,this._gridPadding,ag.gridPadding);this.sortData=(ag.sortData!=null)?ag.sortData:this.sortData;for(var am=0;am<12;am++){var ah=Q[am];var aj=this.axes[ah];aj._options=H.extend(true,{},ag.axesDefaults,ag.axes[ah]);H.extend(true,aj,ag.axesDefaults,ag.axes[ah]);aj._plotWidth=this._width;aj._plotHeight=this._height}var ap=function(ax,av,ay){var au=[];var aw,at;av=av||"vertical";if(!H.isArray(ax[0])){for(aw=0,at=ax.length;aw<at;aw++){if(av=="vertical"){au.push([ay+aw,ax[aw]])}else{au.push([ax[aw],ay+aw])}}}else{H.extend(true,au,ax)}return au};var ao=0;this.series=[];for(var am=0;am<this.data.length;am++){var af=H.extend(true,{index:am},{seriesColors:this.seriesColors,negativeSeriesColors:this.negativeSeriesColors},this.options.seriesDefaults,this.options.series[am],{rendererOptions:{animation:{show:this.animate}}});var aq=new O(af);for(var al=0;al<H.jqplot.preParseSeriesOptionsHooks.length;al++){H.jqplot.preParseSeriesOptionsHooks[al].call(aq,this.options.seriesDefaults,this.options.series[am])}for(var al=0;al<this.preParseSeriesOptionsHooks.hooks.length;al++){this.preParseSeriesOptionsHooks.hooks[al].call(aq,this.options.seriesDefaults,this.options.series[am])}H.extend(true,aq,af);var ai="vertical";if(aq.renderer===H.jqplot.BarRenderer&&aq.rendererOptions&&aq.rendererOptions.barDirection=="horizontal"){ai="horizontal";aq._stackAxis="x";aq._primaryAxis="_yaxis"}aq.data=ap(this.data[am],ai,this.defaultAxisStart);switch(aq.xaxis){case"xaxis":aq._xaxis=this.axes.xaxis;break;case"x2axis":aq._xaxis=this.axes.x2axis;break;default:break}aq._yaxis=this.axes[aq.yaxis];aq._xaxis._series.push(aq);aq._yaxis._series.push(aq);if(aq.show){aq._xaxis.show=true;aq._yaxis.show=true}else{if(aq._xaxis.scaleToHiddenSeries){aq._xaxis.show=true}if(aq._yaxis.scaleToHiddenSeries){aq._yaxis.show=true}}if(!aq.label){aq.label="Series "+(am+1).toString()}this.series.push(aq);for(var al=0;al<H.jqplot.postParseSeriesOptionsHooks.length;al++){H.jqplot.postParseSeriesOptionsHooks[al].call(this.series[am],this.options.seriesDefaults,this.options.series[am])}for(var al=0;al<this.postParseSeriesOptionsHooks.hooks.length;al++){this.postParseSeriesOptionsHooks.hooks[al].call(this.series[am],this.options.seriesDefaults,this.options.series[am])}}H.extend(true,this.grid,this.options.grid);for(var am=0,ak=Q.length;am<ak;am++){var ah=Q[am];var aj=this.axes[ah];if(aj.borderWidth==null){aj.borderWidth=this.grid.borderWidth}}if(typeof this.options.title=="string"){this.title.text=this.options.title}else{if(typeof this.options.title=="object"){H.extend(true,this.title,this.options.title)}}this.title._plotWidth=this._width;this.legend.setOptions(this.options.legend);for(var am=0;am<H.jqplot.postParseOptionsHooks.length;am++){H.jqplot.postParseOptionsHooks[am].call(this,ar)}for(var am=0;am<this.postParseOptionsHooks.hooks.length;am++){this.postParseOptionsHooks.hooks[am].call(this,ar)}};this.destroy=function(){this.canvasManager.freeAllCanvases();if(this.eventCanvas&&this.eventCanvas._elem){this.eventCanvas._elem.unbind()}this.target.empty();this.target[0].innerHTML=""};this.replot=function(ag){var ah=ag||{};var aj=ah.data||null;var af=(ah.clear===false)?false:true;var ai=ah.resetAxes||false;delete ah.data;delete ah.clear;delete ah.resetAxes;this.target.trigger("jqplotPreReplot");if(af){this.destroy()}if(aj||!H.isEmptyObject(ah)){this.reInitialize(aj,ah)}else{this.quickInit()}if(ai){this.resetAxesScale(ai,ah.axes)}this.draw();this.target.trigger("jqplotPostReplot")};this.redraw=function(af){af=(af!=null)?af:true;this.target.trigger("jqplotPreRedraw");if(af){this.canvasManager.freeAllCanvases();this.eventCanvas._elem.unbind();this.target.empty()}for(var ah in this.axes){this.axes[ah]._ticks=[]}this.computePlotData();this._sumy=0;this._sumx=0;for(var ag=0,ai=this.series.length;ag<ai;ag++){this._sumy+=this.series[ag]._sumy;this._sumx+=this.series[ag]._sumx}this.draw();this.target.trigger("jqplotPostRedraw")};this.draw=function(){if(this.drawIfHidden||this.target.is(":visible")){this.target.trigger("jqplotPreDraw");var aB,az,ay,ai;for(aB=0,ay=H.jqplot.preDrawHooks.length;aB<ay;aB++){H.jqplot.preDrawHooks[aB].call(this)}for(aB=0,ay=this.preDrawHooks.length;aB<ay;aB++){this.preDrawHooks.hooks[aB].apply(this,this.preDrawSeriesHooks.args[aB])}this.target.append(this.baseCanvas.createElement({left:0,right:0,top:0,bottom:0},"jqplot-base-canvas",null,this));this.baseCanvas.setContext();this.target.append(this.title.draw());this.title.pack({top:0,left:0});var aF=this.legend.draw({},this);var af={top:0,left:0,bottom:0,right:0};if(this.legend.placement=="outsideGrid"){this.target.append(aF);switch(this.legend.location){case"n":af.top+=this.legend.getHeight();break;case"s":af.bottom+=this.legend.getHeight();break;case"ne":case"e":case"se":af.right+=this.legend.getWidth();break;case"nw":case"w":case"sw":af.left+=this.legend.getWidth();break;default:af.right+=this.legend.getWidth();break}aF=aF.detach()}var al=this.axes;var aG;for(aB=0;aB<12;aB++){aG=Q[aB];this.target.append(al[aG].draw(this.baseCanvas._ctx,this));al[aG].set()}if(al.yaxis.show){af.left+=al.yaxis.getWidth()}var aA=["y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis"];var ar=[0,0,0,0,0,0,0,0];var av=0;var au;for(au=0;au<8;au++){if(al[aA[au]].show){av+=al[aA[au]].getWidth();ar[au]=av}}af.right+=av;if(al.x2axis.show){af.top+=al.x2axis.getHeight()}if(this.title.show){af.top+=this.title.getHeight()}if(al.xaxis.show){af.bottom+=al.xaxis.getHeight()}if(this.options.gridDimensions&&H.isPlainObject(this.options.gridDimensions)){var am=parseInt(this.options.gridDimensions.width,10)||0;var aC=parseInt(this.options.gridDimensions.height,10)||0;var ah=(this._width-af.left-af.right-am)/2;var aE=(this._height-af.top-af.bottom-aC)/2;if(aE>=0&&ah>=0){af.top+=aE;af.bottom+=aE;af.left+=ah;af.right+=ah}}var ag=["top","bottom","left","right"];for(var au in ag){if(this._gridPadding[ag[au]]==null&&af[ag[au]]>0){this._gridPadding[ag[au]]=af[ag[au]]}else{if(this._gridPadding[ag[au]]==null){this._gridPadding[ag[au]]=this._defaultGridPadding[ag[au]]}}}var at=this._gridPadding;if(this.legend.placement==="outsideGrid"){at={top:this.title.getHeight(),left:0,right:0,bottom:0};if(this.legend.location==="s"){at.left=this._gridPadding.left;at.right=this._gridPadding.right}}al.xaxis.pack({position:"absolute",bottom:this._gridPadding.bottom-al.xaxis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right});al.yaxis.pack({position:"absolute",top:0,left:this._gridPadding.left-al.yaxis.getWidth(),height:this._height},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top});al.x2axis.pack({position:"absolute",top:this._gridPadding.top-al.x2axis.getHeight(),left:0,width:this._width},{min:this._gridPadding.left,max:this._width-this._gridPadding.right});for(aB=8;aB>0;aB--){al[aA[aB-1]].pack({position:"absolute",top:0,right:this._gridPadding.right-ar[aB-1]},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top})}var an=(this._width-this._gridPadding.left-this._gridPadding.right)/2+this._gridPadding.left-al.yMidAxis.getWidth()/2;al.yMidAxis.pack({position:"absolute",top:0,left:an,zIndex:9,textAlign:"center"},{min:this._height-this._gridPadding.bottom,max:this._gridPadding.top});this.target.append(this.grid.createElement(this._gridPadding,this));this.grid.draw();var ak=this.series;var aD=ak.length;for(aB=0,ay=aD;aB<ay;aB++){az=this.seriesStack[aB];this.target.append(ak[az].shadowCanvas.createElement(this._gridPadding,"jqplot-series-shadowCanvas",null,this));ak[az].shadowCanvas.setContext();ak[az].shadowCanvas._elem.data("seriesIndex",az)}for(aB=0,ay=aD;aB<ay;aB++){az=this.seriesStack[aB];this.target.append(ak[az].canvas.createElement(this._gridPadding,"jqplot-series-canvas",null,this));ak[az].canvas.setContext();ak[az].canvas._elem.data("seriesIndex",az)}this.target.append(this.eventCanvas.createElement(this._gridPadding,"jqplot-event-canvas",null,this));this.eventCanvas.setContext();this.eventCanvas._ctx.fillStyle="rgba(0,0,0,0)";this.eventCanvas._ctx.fillRect(0,0,this.eventCanvas._ctx.canvas.width,this.eventCanvas._ctx.canvas.height);this.bindCustomEvents();if(this.legend.preDraw){this.eventCanvas._elem.before(aF);this.legend.pack(at);if(this.legend._elem){this.drawSeries({legendInfo:{location:this.legend.location,placement:this.legend.placement,width:this.legend.getWidth(),height:this.legend.getHeight(),xoffset:this.legend.xoffset,yoffset:this.legend.yoffset}})}else{this.drawSeries()}}else{this.drawSeries();if(aD){H(ak[aD-1].canvas._elem).after(aF)}this.legend.pack(at)}for(var aB=0,ay=H.jqplot.eventListenerHooks.length;aB<ay;aB++){this.eventCanvas._elem.bind(H.jqplot.eventListenerHooks[aB][0],{plot:this},H.jqplot.eventListenerHooks[aB][1])}for(var aB=0,ay=this.eventListenerHooks.hooks.length;aB<ay;aB++){this.eventCanvas._elem.bind(this.eventListenerHooks.hooks[aB][0],{plot:this},this.eventListenerHooks.hooks[aB][1])}var aq=this.fillBetween;if(aq.fill&&aq.series1!==aq.series2&&aq.series1<aD&&aq.series2<aD&&ak[aq.series1]._type==="line"&&ak[aq.series2]._type==="line"){this.doFillBetweenLines()}for(var aB=0,ay=H.jqplot.postDrawHooks.length;aB<ay;aB++){H.jqplot.postDrawHooks[aB].call(this)}for(var aB=0,ay=this.postDrawHooks.hooks.length;aB<ay;aB++){this.postDrawHooks.hooks[aB].apply(this,this.postDrawHooks.args[aB])}if(this.target.is(":visible")){this._drawCount+=1}var ao,ap,aw,aj;for(aB=0,ay=aD;aB<ay;aB++){ao=ak[aB];ap=ao.renderer;aw=".jqplot-point-label.jqplot-series-"+aB;if(ap.animation&&ap.animation._supported&&ap.animation.show&&(this._drawCount<2||this.animateReplot)){aj=this.target.find(aw);aj.stop(true,true).hide();ao.canvas._elem.stop(true,true).hide();ao.shadowCanvas._elem.stop(true,true).hide();ao.canvas._elem.jqplotEffect("blind",{mode:"show",direction:ap.animation.direction},ap.animation.speed);ao.shadowCanvas._elem.jqplotEffect("blind",{mode:"show",direction:ap.animation.direction},ap.animation.speed);aj.fadeIn(ap.animation.speed*0.8)}}aj=null;this.target.trigger("jqplotPostDraw",[this])}};N.prototype.doFillBetweenLines=function(){var ah=this.fillBetween;var aq=ah.series1;var ao=ah.series2;var ap=(aq<ao)?aq:ao;var an=(ao>aq)?ao:aq;var al=this.series[ap];var ak=this.series[an];if(ak.renderer.smooth){var aj=ak.renderer._smoothedData.slice(0).reverse()}else{var aj=ak.gridData.slice(0).reverse()}if(al.renderer.smooth){var am=al.renderer._smoothedData.concat(aj)}else{var am=al.gridData.concat(aj)}var ai=(ah.color!==null)?ah.color:this.series[aq].fillColor;var ar=(ah.baseSeries!==null)?ah.baseSeries:ap;var ag=this.series[ar].renderer.shapeRenderer;var af={fillStyle:ai,fill:true,closePath:true};ag.draw(al.shadowCanvas._ctx,am,af)};this.bindCustomEvents=function(){this.eventCanvas._elem.bind("click",{plot:this},this.onClick);this.eventCanvas._elem.bind("dblclick",{plot:this},this.onDblClick);this.eventCanvas._elem.bind("mousedown",{plot:this},this.onMouseDown);this.eventCanvas._elem.bind("mousemove",{plot:this},this.onMouseMove);this.eventCanvas._elem.bind("mouseenter",{plot:this},this.onMouseEnter);this.eventCanvas._elem.bind("mouseleave",{plot:this},this.onMouseLeave);if(this.captureRightClick){this.eventCanvas._elem.bind("mouseup",{plot:this},this.onRightClick);this.eventCanvas._elem.get(0).oncontextmenu=function(){return false}}else{this.eventCanvas._elem.bind("mouseup",{plot:this},this.onMouseUp)}};function ac(ao){var am=ao.data.plot;var ai=am.eventCanvas._elem.offset();var al={x:ao.pageX-ai.left,y:ao.pageY-ai.top};var aj={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null,yMidAxis:null};var ak=["xaxis","yaxis","x2axis","y2axis","y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];var af=am.axes;var ag,ah;for(ag=11;ag>0;ag--){ah=ak[ag-1];if(af[ah].show){aj[ah]=af[ah].series_p2u(al[ah.charAt(0)])}}return{offsets:ai,gridPos:al,dataPos:aj}}function ae(af,ag){var ak=ag.series;var aQ,aO,aN,aI,aJ,aD,aC,ap,an,at,au,aE;var aM,aR,aK,al,aB,aG,aP;var ah,aH;for(aN=ag.seriesStack.length-1;aN>=0;aN--){aQ=ag.seriesStack[aN];aI=ak[aQ];aP=aI._highlightThreshold;switch(aI.renderer.constructor){case H.jqplot.BarRenderer:aD=af.x;aC=af.y;for(aO=0;aO<aI._barPoints.length;aO++){aB=aI._barPoints[aO];aK=aI.gridData[aO];if(aD>aB[0][0]&&aD<aB[2][0]&&aC>aB[2][1]&&aC<aB[0][1]){return{seriesIndex:aI.index,pointIndex:aO,gridData:aK,data:aI.data[aO],points:aI._barPoints[aO]}}}break;case H.jqplot.PyramidRenderer:aD=af.x;aC=af.y;for(aO=0;aO<aI._barPoints.length;aO++){aB=aI._barPoints[aO];aK=aI.gridData[aO];if(aD>aB[0][0]+aP[0][0]&&aD<aB[2][0]+aP[2][0]&&aC>aB[2][1]&&aC<aB[0][1]){return{seriesIndex:aI.index,pointIndex:aO,gridData:aK,data:aI.data[aO],points:aI._barPoints[aO]}}}break;case H.jqplot.DonutRenderer:at=aI.startAngle/180*Math.PI;aD=af.x-aI._center[0];aC=af.y-aI._center[1];aJ=Math.sqrt(Math.pow(aD,2)+Math.pow(aC,2));if(aD>0&&-aC>=0){ap=2*Math.PI-Math.atan(-aC/aD)}else{if(aD>0&&-aC<0){ap=-Math.atan(-aC/aD)}else{if(aD<0){ap=Math.PI-Math.atan(-aC/aD)}else{if(aD==0&&-aC>0){ap=3*Math.PI/2}else{if(aD==0&&-aC<0){ap=Math.PI/2}else{if(aD==0&&aC==0){ap=0}}}}}}if(at){ap-=at;if(ap<0){ap+=2*Math.PI}else{if(ap>2*Math.PI){ap-=2*Math.PI}}}an=aI.sliceMargin/180*Math.PI;if(aJ<aI._radius&&aJ>aI._innerRadius){for(aO=0;aO<aI.gridData.length;aO++){au=(aO>0)?aI.gridData[aO-1][1]+an:an;aE=aI.gridData[aO][1];if(ap>au&&ap<aE){return{seriesIndex:aI.index,pointIndex:aO,gridData:aI.gridData[aO],data:aI.data[aO]}}}}break;case H.jqplot.PieRenderer:at=aI.startAngle/180*Math.PI;aD=af.x-aI._center[0];aC=af.y-aI._center[1];aJ=Math.sqrt(Math.pow(aD,2)+Math.pow(aC,2));if(aD>0&&-aC>=0){ap=2*Math.PI-Math.atan(-aC/aD)}else{if(aD>0&&-aC<0){ap=-Math.atan(-aC/aD)}else{if(aD<0){ap=Math.PI-Math.atan(-aC/aD)}else{if(aD==0&&-aC>0){ap=3*Math.PI/2}else{if(aD==0&&-aC<0){ap=Math.PI/2}else{if(aD==0&&aC==0){ap=0}}}}}}if(at){ap-=at;if(ap<0){ap+=2*Math.PI}else{if(ap>2*Math.PI){ap-=2*Math.PI}}}an=aI.sliceMargin/180*Math.PI;if(aJ<aI._radius){for(aO=0;aO<aI.gridData.length;aO++){au=(aO>0)?aI.gridData[aO-1][1]+an:an;aE=aI.gridData[aO][1];if(ap>au&&ap<aE){return{seriesIndex:aI.index,pointIndex:aO,gridData:aI.gridData[aO],data:aI.data[aO]}}}}break;case H.jqplot.BubbleRenderer:aD=af.x;aC=af.y;var az=null;if(aI.show){for(var aO=0;aO<aI.gridData.length;aO++){aK=aI.gridData[aO];aR=Math.sqrt((aD-aK[0])*(aD-aK[0])+(aC-aK[1])*(aC-aK[1]));if(aR<=aK[2]&&(aR<=aM||aM==null)){aM=aR;az={seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}if(az!=null){return az}}break;case H.jqplot.FunnelRenderer:aD=af.x;aC=af.y;var aF=aI._vertices,aj=aF[0],ai=aF[aF.length-1],am,ay,ar;function aL(aU,aW,aV){var aT=(aW[1]-aV[1])/(aW[0]-aV[0]);var aS=aW[1]-aT*aW[0];var aX=aU+aW[1];return[(aX-aS)/aT,aX]}am=aL(aC,aj[0],ai[3]);ay=aL(aC,aj[1],ai[2]);for(aO=0;aO<aF.length;aO++){ar=aF[aO];if(aC>=ar[0][1]&&aC<=ar[3][1]&&aD>=am[0]&&aD<=ay[0]){return{seriesIndex:aI.index,pointIndex:aO,gridData:null,data:aI.data[aO]}}}break;case H.jqplot.LineRenderer:aD=af.x;aC=af.y;aJ=aI.renderer;if(aI.show){if((aI.fill||(aI.renderer.bands.show&&aI.renderer.bands.fill))&&(!ag.plugins.highlighter||!ag.plugins.highlighter.show)){var aq=false;if(aD>aI._boundingBox[0][0]&&aD<aI._boundingBox[1][0]&&aC>aI._boundingBox[1][1]&&aC<aI._boundingBox[0][1]){var ax=aI._areaPoints.length;var aA;var aO=ax-1;for(var aA=0;aA<ax;aA++){var aw=[aI._areaPoints[aA][0],aI._areaPoints[aA][1]];var av=[aI._areaPoints[aO][0],aI._areaPoints[aO][1]];if(aw[1]<aC&&av[1]>=aC||av[1]<aC&&aw[1]>=aC){if(aw[0]+(aC-aw[1])/(av[1]-aw[1])*(av[0]-aw[0])<aD){aq=!aq}}aO=aA}}if(aq){return{seriesIndex:aQ,pointIndex:null,gridData:aI.gridData,data:aI.data,points:aI._areaPoints}}break}else{aH=aI.markerRenderer.size/2+aI.neighborThreshold;ah=(aH>0)?aH:0;for(var aO=0;aO<aI.gridData.length;aO++){aK=aI.gridData[aO];if(aJ.constructor==H.jqplot.OHLCRenderer){if(aJ.candleStick){var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._bodyWidth/2&&aD<=aK[0]+aJ._bodyWidth/2&&aC>=ao(aI.data[aO][2])&&aC<=ao(aI.data[aO][3])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}else{if(!aJ.hlc){var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._tickLength&&aD<=aK[0]+aJ._tickLength&&aC>=ao(aI.data[aO][2])&&aC<=ao(aI.data[aO][3])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}else{var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._tickLength&&aD<=aK[0]+aJ._tickLength&&aC>=ao(aI.data[aO][1])&&aC<=ao(aI.data[aO][2])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}}}else{if(aK[0]!=null&&aK[1]!=null){aR=Math.sqrt((aD-aK[0])*(aD-aK[0])+(aC-aK[1])*(aC-aK[1]));if(aR<=ah&&(aR<=aM||aM==null)){aM=aR;return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}}}}}break;default:aD=af.x;aC=af.y;aJ=aI.renderer;if(aI.show){aH=aI.markerRenderer.size/2+aI.neighborThreshold;ah=(aH>0)?aH:0;for(var aO=0;aO<aI.gridData.length;aO++){aK=aI.gridData[aO];if(aJ.constructor==H.jqplot.OHLCRenderer){if(aJ.candleStick){var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._bodyWidth/2&&aD<=aK[0]+aJ._bodyWidth/2&&aC>=ao(aI.data[aO][2])&&aC<=ao(aI.data[aO][3])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}else{if(!aJ.hlc){var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._tickLength&&aD<=aK[0]+aJ._tickLength&&aC>=ao(aI.data[aO][2])&&aC<=ao(aI.data[aO][3])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}else{var ao=aI._yaxis.series_u2p;if(aD>=aK[0]-aJ._tickLength&&aD<=aK[0]+aJ._tickLength&&aC>=ao(aI.data[aO][1])&&aC<=ao(aI.data[aO][2])){return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}}}else{aR=Math.sqrt((aD-aK[0])*(aD-aK[0])+(aC-aK[1])*(aC-aK[1]));if(aR<=ah&&(aR<=aM||aM==null)){aM=aR;return{seriesIndex:aQ,pointIndex:aO,gridData:aK,data:aI.data[aO]}}}}}break}}return null}this.onClick=function(ah){var ag=ac(ah);var aj=ah.data.plot;var ai=ae(ag.gridPos,aj);var af=H.Event("jqplotClick");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])};this.onDblClick=function(ah){var ag=ac(ah);var aj=ah.data.plot;var ai=ae(ag.gridPos,aj);var af=H.Event("jqplotDblClick");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])};this.onMouseDown=function(ah){var ag=ac(ah);var aj=ah.data.plot;var ai=ae(ag.gridPos,aj);var af=H.Event("jqplotMouseDown");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])};this.onMouseUp=function(ah){var ag=ac(ah);var af=H.Event("jqplotMouseUp");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,null,ah.data.plot])};this.onRightClick=function(ah){var ag=ac(ah);var aj=ah.data.plot;var ai=ae(ag.gridPos,aj);if(aj.captureRightClick){if(ah.which==3){var af=H.Event("jqplotRightClick");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])}else{var af=H.Event("jqplotMouseUp");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])}}};this.onMouseMove=function(ah){var ag=ac(ah);var aj=ah.data.plot;var ai=ae(ag.gridPos,aj);var af=H.Event("jqplotMouseMove");af.pageX=ah.pageX;af.pageY=ah.pageY;H(this).trigger(af,[ag.gridPos,ag.dataPos,ai,aj])};this.onMouseEnter=function(ah){var ag=ac(ah);var ai=ah.data.plot;var af=H.Event("jqplotMouseEnter");af.pageX=ah.pageX;af.pageY=ah.pageY;af.relatedTarget=ah.relatedTarget;H(this).trigger(af,[ag.gridPos,ag.dataPos,null,ai])};this.onMouseLeave=function(ah){var ag=ac(ah);var ai=ah.data.plot;var af=H.Event("jqplotMouseLeave");af.pageX=ah.pageX;af.pageY=ah.pageY;af.relatedTarget=ah.relatedTarget;H(this).trigger(af,[ag.gridPos,ag.dataPos,null,ai])};this.drawSeries=function(ah,af){var aj,ai,ag;af=(typeof(ah)==="number"&&af==null)?ah:af;ah=(typeof(ah)==="object")?ah:{};if(af!=r){ai=this.series[af];ag=ai.shadowCanvas._ctx;ag.clearRect(0,0,ag.canvas.width,ag.canvas.height);ai.drawShadow(ag,ah,this);ag=ai.canvas._ctx;ag.clearRect(0,0,ag.canvas.width,ag.canvas.height);ai.draw(ag,ah,this);if(ai.renderer.constructor==H.jqplot.BezierCurveRenderer){if(af<this.series.length-1){this.drawSeries(af+1)}}}else{for(aj=0;aj<this.series.length;aj++){ai=this.series[aj];ag=ai.shadowCanvas._ctx;ag.clearRect(0,0,ag.canvas.width,ag.canvas.height);ai.drawShadow(ag,ah,this);ag=ai.canvas._ctx;ag.clearRect(0,0,ag.canvas.width,ag.canvas.height);ai.draw(ag,ah,this)}}ah=af=aj=ai=ag=null};this.moveSeriesToFront=function(ag){ag=parseInt(ag,10);var aj=H.inArray(ag,this.seriesStack);if(aj==-1){return}if(aj==this.seriesStack.length-1){this.previousSeriesStack=this.seriesStack.slice(0);return}var af=this.seriesStack[this.seriesStack.length-1];var ai=this.series[ag].canvas._elem.detach();var ah=this.series[ag].shadowCanvas._elem.detach();this.series[af].shadowCanvas._elem.after(ah);this.series[af].canvas._elem.after(ai);this.previousSeriesStack=this.seriesStack.slice(0);this.seriesStack.splice(aj,1);this.seriesStack.push(ag)};this.moveSeriesToBack=function(ag){ag=parseInt(ag,10);var aj=H.inArray(ag,this.seriesStack);if(aj==0||aj==-1){return}var af=this.seriesStack[0];var ai=this.series[ag].canvas._elem.detach();var ah=this.series[ag].shadowCanvas._elem.detach();this.series[af].shadowCanvas._elem.before(ah);this.series[af].canvas._elem.before(ai);this.previousSeriesStack=this.seriesStack.slice(0);this.seriesStack.splice(aj,1);this.seriesStack.unshift(ag)};this.restorePreviousSeriesOrder=function(){var al,ak,aj,ai,ah,af,ag;if(this.seriesStack==this.previousSeriesStack){return}for(al=1;al<this.previousSeriesStack.length;al++){af=this.previousSeriesStack[al];ag=this.previousSeriesStack[al-1];aj=this.series[af].canvas._elem.detach();ai=this.series[af].shadowCanvas._elem.detach();this.series[ag].shadowCanvas._elem.after(ai);this.series[ag].canvas._elem.after(aj)}ah=this.seriesStack.slice(0);this.seriesStack=this.previousSeriesStack.slice(0);this.previousSeriesStack=ah};this.restoreOriginalSeriesOrder=function(){var aj,ai,af=[],ah,ag;for(aj=0;aj<this.series.length;aj++){af.push(aj)}if(this.seriesStack==af){return}this.previousSeriesStack=this.seriesStack.slice(0);this.seriesStack=af;for(aj=1;aj<this.seriesStack.length;aj++){ah=this.series[aj].canvas._elem.detach();ag=this.series[aj].shadowCanvas._elem.detach();this.series[aj-1].shadowCanvas._elem.after(ag);this.series[aj-1].canvas._elem.after(ah)}};this.activateTheme=function(af){this.themeEngine.activate(this,af)}}H.jqplot.computeHighlightColors=function(ac){var ae;if(H.isArray(ac)){ae=[];for(var ag=0;ag<ac.length;ag++){var af=H.jqplot.getColorComponents(ac[ag]);var ab=[af[0],af[1],af[2]];var ah=ab[0]+ab[1]+ab[2];for(var ad=0;ad<3;ad++){ab[ad]=(ah>660)?ab[ad]*0.85:0.73*ab[ad]+90;ab[ad]=parseInt(ab[ad],10);(ab[ad]>255)?255:ab[ad]}ab[3]=0.3+0.35*af[3];ae.push("rgba("+ab[0]+","+ab[1]+","+ab[2]+","+ab[3]+")")}}else{var af=H.jqplot.getColorComponents(ac);var ab=[af[0],af[1],af[2]];var ah=ab[0]+ab[1]+ab[2];for(var ad=0;ad<3;ad++){ab[ad]=(ah>660)?ab[ad]*0.85:0.73*ab[ad]+90;ab[ad]=parseInt(ab[ad],10);(ab[ad]>255)?255:ab[ad]}ab[3]=0.3+0.35*af[3];ae="rgba("+ab[0]+","+ab[1]+","+ab[2]+","+ab[3]+")"}return ae};H.jqplot.ColorGenerator=function(ac){ac=ac||H.jqplot.config.defaultColors;var ab=0;this.next=function(){if(ab<ac.length){return ac[ab++]}else{ab=0;return ac[ab++]}};this.previous=function(){if(ab>0){return ac[ab--]}else{ab=ac.length-1;return ac[ab]}};this.get=function(ae){var ad=ae-ac.length*Math.floor(ae/ac.length);return ac[ad]};this.setColors=function(ad){ac=ad};this.reset=function(){ab=0};this.getIndex=function(){return ab};this.setIndex=function(ad){ab=ad}};H.jqplot.hex2rgb=function(ad,ab){ad=ad.replace("#","");if(ad.length==3){ad=ad.charAt(0)+ad.charAt(0)+ad.charAt(1)+ad.charAt(1)+ad.charAt(2)+ad.charAt(2)}var ac;ac="rgba("+parseInt(ad.slice(0,2),16)+", "+parseInt(ad.slice(2,4),16)+", "+parseInt(ad.slice(4,6),16);if(ab){ac+=", "+ab}ac+=")";return ac};H.jqplot.rgb2hex=function(ag){var ad=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *(?:, *[0-9.]*)?\)/;var ab=ag.match(ad);var af="#";for(var ae=1;ae<4;ae++){var ac;if(ab[ae].search(/%/)!=-1){ac=parseInt(255*ab[ae]/100,10).toString(16);if(ac.length==1){ac="0"+ac}}else{ac=parseInt(ab[ae],10).toString(16);if(ac.length==1){ac="0"+ac}}af+=ac}return af};H.jqplot.normalize2rgb=function(ac,ab){if(ac.search(/^ *rgba?\(/)!=-1){return ac}else{if(ac.search(/^ *#?[0-9a-fA-F]?[0-9a-fA-F]/)!=-1){return H.jqplot.hex2rgb(ac,ab)}else{throw"invalid color spec"}}};H.jqplot.getColorComponents=function(ag){ag=H.jqplot.colorKeywordMap[ag]||ag;var ae=H.jqplot.normalize2rgb(ag);var ad=/rgba?\( *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *, *([0-9]{1,3}\.?[0-9]*%?) *,? *([0-9.]* *)?\)/;var ab=ae.match(ad);var ac=[];for(var af=1;af<4;af++){if(ab[af].search(/%/)!=-1){ac[af-1]=parseInt(255*ab[af]/100,10)}else{ac[af-1]=parseInt(ab[af],10)}}ac[3]=parseFloat(ab[4])?parseFloat(ab[4]):1;return ac};H.jqplot.colorKeywordMap={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb( 0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb( 0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb( 0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb( 95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(220, 20, 60)",cyan:"rgb( 0, 255, 255)",darkblue:"rgb( 0, 0, 139)",darkcyan:"rgb( 0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb( 0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb( 85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb( 72, 61, 139)",darkslategray:"rgb( 47, 79, 79)",darkslategrey:"rgb( 47, 79, 79)",darkturquoise:"rgb( 0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb( 0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb( 30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb( 34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb( 0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb( 75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb( 32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb( 0, 255, 0)",limegreen:"rgb( 50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb( 0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb( 60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb( 0, 250, 154)",mediumturquoise:"rgb( 72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb( 25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb( 0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb( 65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb( 46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb( 0, 255, 127)",steelblue:"rgb( 70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb( 0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb( 64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)"};H.jqplot.AxisLabelRenderer=function(ab){H.jqplot.ElemContainer.call(this);this.axis;this.show=true;this.label="";this.fontFamily=null;this.fontSize=null;this.textColor=null;this._elem;this.escapeHTML=false;H.extend(true,this,ab)};H.jqplot.AxisLabelRenderer.prototype=new H.jqplot.ElemContainer();H.jqplot.AxisLabelRenderer.prototype.constructor=H.jqplot.AxisLabelRenderer;H.jqplot.AxisLabelRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.AxisLabelRenderer.prototype.draw=function(ab,ac){if(this._elem){this._elem.emptyForce();this._elem=null}this._elem=H('<div style="position:absolute;" class="jqplot-'+this.axis+'-label"></div>');if(Number(this.label)){this._elem.css("white-space","nowrap")}if(!this.escapeHTML){this._elem.html(this.label)}else{this._elem.text(this.label)}if(this.fontFamily){this._elem.css("font-family",this.fontFamily)}if(this.fontSize){this._elem.css("font-size",this.fontSize)}if(this.textColor){this._elem.css("color",this.textColor)}return this._elem};H.jqplot.AxisLabelRenderer.prototype.pack=function(){};H.jqplot.AxisTickRenderer=function(ab){H.jqplot.ElemContainer.call(this);this.mark="outside";this.axis;this.showMark=true;this.showGridline=true;this.isMinorTick=false;this.size=4;this.markSize=6;this.show=true;this.showLabel=true;this.label=null;this.value=null;this._styles={};this.formatter=H.jqplot.DefaultTickFormatter;this.prefix="";this.suffix="";this.formatString="";this.fontFamily;this.fontSize;this.textColor;this.escapeHTML=false;this._elem;this._breakTick=false;H.extend(true,this,ab)};H.jqplot.AxisTickRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.AxisTickRenderer.prototype=new H.jqplot.ElemContainer();H.jqplot.AxisTickRenderer.prototype.constructor=H.jqplot.AxisTickRenderer;H.jqplot.AxisTickRenderer.prototype.setTick=function(ab,ad,ac){this.value=ab;this.axis=ad;if(ac){this.isMinorTick=true}return this};H.jqplot.AxisTickRenderer.prototype.draw=function(){if(this.label===null){this.label=this.prefix+this.formatter(this.formatString,this.value)+this.suffix}var ac={position:"absolute"};if(Number(this.label)){ac.whitSpace="nowrap"}if(this._elem){this._elem.emptyForce();this._elem=null}this._elem=H(document.createElement("div"));this._elem.addClass("jqplot-"+this.axis+"-tick");if(!this.escapeHTML){this._elem.html(this.label)}else{this._elem.text(this.label)}this._elem.css(ac);for(var ab in this._styles){this._elem.css(ab,this._styles[ab])}if(this.fontFamily){this._elem.css("font-family",this.fontFamily)}if(this.fontSize){this._elem.css("font-size",this.fontSize)}if(this.textColor){this._elem.css("color",this.textColor)}if(this._breakTick){this._elem.addClass("jqplot-breakTick")}return this._elem};H.jqplot.DefaultTickFormatter=function(ab,ac){if(typeof ac=="number"){if(!ab){ab=H.jqplot.config.defaultTickFormatString}return H.jqplot.sprintf(ab,ac)}else{return String(ac)}};H.jqplot.PercentTickFormatter=function(ab,ac){if(typeof ac=="number"){ac=100*ac;if(!ab){ab=H.jqplot.config.defaultTickFormatString}return H.jqplot.sprintf(ab,ac)}else{return String(ac)}};H.jqplot.AxisTickRenderer.prototype.pack=function(){};H.jqplot.CanvasGridRenderer=function(){this.shadowRenderer=new H.jqplot.ShadowRenderer()};H.jqplot.CanvasGridRenderer.prototype.init=function(ac){this._ctx;H.extend(true,this,ac);var ab={lineJoin:"miter",lineCap:"round",fill:false,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.shadowWidth,closePath:false,strokeStyle:this.shadowColor};this.renderer.shadowRenderer.init(ab)};H.jqplot.CanvasGridRenderer.prototype.createElement=function(ae){var ad;if(this._elem){if(H.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==r){ad=this._elem.get(0);window.G_vmlCanvasManager.uninitElement(ad);ad=null}this._elem.emptyForce();this._elem=null}ad=ae.canvasManager.getCanvas();var ab=this._plotDimensions.width;var ac=this._plotDimensions.height;ad.width=ab;ad.height=ac;this._elem=H(ad);this._elem.addClass("jqplot-grid-canvas");this._elem.css({position:"absolute",left:0,top:0});ad=ae.canvasManager.initCanvas(ad);this._top=this._offsets.top;this._bottom=ac-this._offsets.bottom;this._left=this._offsets.left;this._right=ab-this._offsets.right;this._width=this._right-this._left;this._height=this._bottom-this._top;ad=null;return this._elem};H.jqplot.CanvasGridRenderer.prototype.draw=function(){this._ctx=this._elem.get(0).getContext("2d");var am=this._ctx;var ap=this._axes;am.save();am.clearRect(0,0,this._plotDimensions.width,this._plotDimensions.height);am.fillStyle=this.backgroundColor||this.background;am.fillRect(this._left,this._top,this._width,this._height);am.save();am.lineJoin="miter";am.lineCap="butt";am.lineWidth=this.gridLineWidth;am.strokeStyle=this.gridLineColor;var at,ar,aj,ak;var ag=["xaxis","yaxis","x2axis","y2axis"];for(var aq=4;aq>0;aq--){var aw=ag[aq-1];var ab=ap[aw];var au=ab._ticks;var al=au.length;if(ab.show){if(ab.drawBaseline){var av={};if(ab.baselineWidth!==null){av.lineWidth=ab.baselineWidth}if(ab.baselineColor!==null){av.strokeStyle=ab.baselineColor}switch(aw){case"xaxis":ai(this._left,this._bottom,this._right,this._bottom,av);break;case"yaxis":ai(this._left,this._bottom,this._left,this._top,av);break;case"x2axis":ai(this._left,this._bottom,this._right,this._bottom,av);break;case"y2axis":ai(this._right,this._bottom,this._right,this._top,av);break}}for(var an=al;an>0;an--){var ah=au[an-1];if(ah.show){var ae=Math.round(ab.u2p(ah.value))+0.5;switch(aw){case"xaxis":if(ah.showGridline&&this.drawGridlines&&((!ah.isMinorTick&&ab.drawMajorGridlines)||(ah.isMinorTick&&ab.drawMinorGridlines))){ai(ae,this._top,ae,this._bottom)}if(ah.showMark&&ah.mark&&((!ah.isMinorTick&&ab.drawMajorTickMarks)||(ah.isMinorTick&&ab.drawMinorTickMarks))){aj=ah.markSize;ak=ah.mark;var ae=Math.round(ab.u2p(ah.value))+0.5;switch(ak){case"outside":at=this._bottom;ar=this._bottom+aj;break;case"inside":at=this._bottom-aj;ar=this._bottom;break;case"cross":at=this._bottom-aj;ar=this._bottom+aj;break;default:at=this._bottom;ar=this._bottom+aj;break}if(this.shadow){this.renderer.shadowRenderer.draw(am,[[ae,at],[ae,ar]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:this.gridLineWidth*0.75,depth:2,fill:false,closePath:false})}ai(ae,at,ae,ar)}break;case"yaxis":if(ah.showGridline&&this.drawGridlines&&((!ah.isMinorTick&&ab.drawMajorGridlines)||(ah.isMinorTick&&ab.drawMinorGridlines))){ai(this._right,ae,this._left,ae)}if(ah.showMark&&ah.mark&&((!ah.isMinorTick&&ab.drawMajorTickMarks)||(ah.isMinorTick&&ab.drawMinorTickMarks))){aj=ah.markSize;ak=ah.mark;var ae=Math.round(ab.u2p(ah.value))+0.5;switch(ak){case"outside":at=this._left-aj;ar=this._left;break;case"inside":at=this._left;ar=this._left+aj;break;case"cross":at=this._left-aj;ar=this._left+aj;break;default:at=this._left-aj;ar=this._left;break}if(this.shadow){this.renderer.shadowRenderer.draw(am,[[at,ae],[ar,ae]],{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})}ai(at,ae,ar,ae,{strokeStyle:ab.borderColor})}break;case"x2axis":if(ah.showGridline&&this.drawGridlines&&((!ah.isMinorTick&&ab.drawMajorGridlines)||(ah.isMinorTick&&ab.drawMinorGridlines))){ai(ae,this._bottom,ae,this._top)}if(ah.showMark&&ah.mark&&((!ah.isMinorTick&&ab.drawMajorTickMarks)||(ah.isMinorTick&&ab.drawMinorTickMarks))){aj=ah.markSize;ak=ah.mark;var ae=Math.round(ab.u2p(ah.value))+0.5;switch(ak){case"outside":at=this._top-aj;ar=this._top;break;case"inside":at=this._top;ar=this._top+aj;break;case"cross":at=this._top-aj;ar=this._top+aj;break;default:at=this._top-aj;ar=this._top;break}if(this.shadow){this.renderer.shadowRenderer.draw(am,[[ae,at],[ae,ar]],{lineCap:"butt",lineWidth:this.gridLineWidth,offset:this.gridLineWidth*0.75,depth:2,fill:false,closePath:false})}ai(ae,at,ae,ar)}break;case"y2axis":if(ah.showGridline&&this.drawGridlines&&((!ah.isMinorTick&&ab.drawMajorGridlines)||(ah.isMinorTick&&ab.drawMinorGridlines))){ai(this._left,ae,this._right,ae)}if(ah.showMark&&ah.mark&&((!ah.isMinorTick&&ab.drawMajorTickMarks)||(ah.isMinorTick&&ab.drawMinorTickMarks))){aj=ah.markSize;ak=ah.mark;var ae=Math.round(ab.u2p(ah.value))+0.5;switch(ak){case"outside":at=this._right;ar=this._right+aj;break;case"inside":at=this._right-aj;ar=this._right;break;case"cross":at=this._right-aj;ar=this._right+aj;break;default:at=this._right;ar=this._right+aj;break}if(this.shadow){this.renderer.shadowRenderer.draw(am,[[at,ae],[ar,ae]],{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})}ai(at,ae,ar,ae,{strokeStyle:ab.borderColor})}break;default:break}}}ah=null}ab=null;au=null}ag=["y3axis","y4axis","y5axis","y6axis","y7axis","y8axis","y9axis","yMidAxis"];for(var aq=7;aq>0;aq--){var ab=ap[ag[aq-1]];var au=ab._ticks;if(ab.show){var ac=au[ab.numberTicks-1];var af=au[0];var ad=ab.getLeft();var ao=[[ad,ac.getTop()+ac.getHeight()/2],[ad,af.getTop()+af.getHeight()/2+1]];if(this.shadow){this.renderer.shadowRenderer.draw(am,ao,{lineCap:"butt",fill:false,closePath:false})}ai(ao[0][0],ao[0][1],ao[1][0],ao[1][1],{lineCap:"butt",strokeStyle:ab.borderColor,lineWidth:ab.borderWidth});for(var an=au.length;an>0;an--){var ah=au[an-1];aj=ah.markSize;ak=ah.mark;var ae=Math.round(ab.u2p(ah.value))+0.5;if(ah.showMark&&ah.mark){switch(ak){case"outside":at=ad;ar=ad+aj;break;case"inside":at=ad-aj;ar=ad;break;case"cross":at=ad-aj;ar=ad+aj;break;default:at=ad;ar=ad+aj;break}ao=[[at,ae],[ar,ae]];if(this.shadow){this.renderer.shadowRenderer.draw(am,ao,{lineCap:"butt",lineWidth:this.gridLineWidth*1.5,offset:this.gridLineWidth*0.75,fill:false,closePath:false})}ai(at,ae,ar,ae,{strokeStyle:ab.borderColor})}ah=null}af=null}ab=null;au=null}am.restore();function ai(aB,aA,ay,ax,az){am.save();az=az||{};if(az.lineWidth==null||az.lineWidth!=0){H.extend(true,am,az);am.beginPath();am.moveTo(aB,aA);am.lineTo(ay,ax);am.stroke();am.restore()}}if(this.shadow){var ao=[[this._left,this._bottom],[this._right,this._bottom],[this._right,this._top]];this.renderer.shadowRenderer.draw(am,ao)}if(this.borderWidth!=0&&this.drawBorder){ai(this._left,this._top,this._right,this._top,{lineCap:"round",strokeStyle:ap.x2axis.borderColor,lineWidth:ap.x2axis.borderWidth});ai(this._right,this._top,this._right,this._bottom,{lineCap:"round",strokeStyle:ap.y2axis.borderColor,lineWidth:ap.y2axis.borderWidth});ai(this._right,this._bottom,this._left,this._bottom,{lineCap:"round",strokeStyle:ap.xaxis.borderColor,lineWidth:ap.xaxis.borderWidth});ai(this._left,this._bottom,this._left,this._top,{lineCap:"round",strokeStyle:ap.yaxis.borderColor,lineWidth:ap.yaxis.borderWidth})}am.restore();am=null;ap=null};H.jqplot.DivTitleRenderer=function(){};H.jqplot.DivTitleRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.DivTitleRenderer.prototype.draw=function(){if(this._elem){this._elem.emptyForce();this._elem=null}var ae=this.renderer;var ad=document.createElement("div");this._elem=H(ad);this._elem.addClass("jqplot-title");if(!this.text){this.show=false;this._elem.height(0);this._elem.width(0)}else{if(this.text){var ab;if(this.color){ab=this.color}else{if(this.textColor){ab=this.textColor}}var ac={position:"absolute",top:"0px",left:"0px"};if(this._plotWidth){ac.width=this._plotWidth+"px"}if(this.fontSize){ac.fontSize=this.fontSize}if(typeof this.textAlign==="string"){ac.textAlign=this.textAlign}else{ac.textAlign="center"}if(ab){ac.color=ab}if(this.paddingBottom){ac.paddingBottom=this.paddingBottom}if(this.fontFamily){ac.fontFamily=this.fontFamily}this._elem.css(ac);if(this.escapeHtml){this._elem.text(this.text)}else{this._elem.html(this.text)}}}ad=null;return this._elem};H.jqplot.DivTitleRenderer.prototype.pack=function(){};var o=0.1;H.jqplot.LinePattern=function(ap,ak){var aj={dotted:[o,H.jqplot.config.dotGapLength],dashed:[H.jqplot.config.dashLength,H.jqplot.config.gapLength],solid:null};if(typeof ak==="string"){if(ak[0]==="."||ak[0]==="-"){var aq=ak;ak=[];for(var ai=0,af=aq.length;ai<af;ai++){if(aq[ai]==="."){ak.push(o)}else{if(aq[ai]==="-"){ak.push(H.jqplot.config.dashLength)}else{continue}}ak.push(H.jqplot.config.gapLength)}}else{ak=aj[ak]}}if(!(ak&&ak.length)){return ap}var ae=0;var al=ak[0];var an=0;var am=0;var ah=0;var ab=0;var ao=function(ar,at){ap.moveTo(ar,at);an=ar;am=at;ah=ar;ab=at};var ad=function(ar,ay){var aw=ap.lineWidth;var au=ar-an;var at=ay-am;var av=Math.sqrt(au*au+at*at);if((av>0)&&(aw>0)){au/=av;at/=av;while(true){var ax=aw*al;if(ax<av){an+=ax*au;am+=ax*at;if((ae&1)==0){ap.lineTo(an,am)}else{ap.moveTo(an,am)}av-=ax;ae++;if(ae>=ak.length){ae=0}al=ak[ae]}else{an=ar;am=ay;if((ae&1)==0){ap.lineTo(an,am)}else{ap.moveTo(an,am)}al-=av/aw;break}}}};var ac=function(){ap.beginPath()};var ag=function(){ad(ah,ab)};return{moveTo:ao,lineTo:ad,beginPath:ac,closePath:ag}};H.jqplot.LineRenderer=function(){this.shapeRenderer=new H.jqplot.ShapeRenderer();this.shadowRenderer=new H.jqplot.ShadowRenderer()};H.jqplot.LineRenderer.prototype.init=function(ac,ah){ac=ac||{};this._type="line";this.renderer.animation={show:false,direction:"left",speed:2500,_supported:true};this.renderer.smooth=false;this.renderer.tension=null;this.renderer.constrainSmoothing=true;this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];this.renderer.bandData=[];this.renderer.bands={show:false,hiData:[],lowData:[],color:this.color,showLines:false,fill:true,fillColor:null,_min:null,_max:null,interval:"3%"};var af={highlightMouseOver:ac.highlightMouseOver,highlightMouseDown:ac.highlightMouseDown,highlightColor:ac.highlightColor};delete (ac.highlightMouseOver);delete (ac.highlightMouseDown);delete (ac.highlightColor);H.extend(true,this.renderer,ac);this.renderer.options=ac;if(this.renderer.bandData.length>1&&(!ac.bands||ac.bands.show==null)){this.renderer.bands.show=true}else{if(ac.bands&&ac.bands.show==null&&ac.bands.interval!=null){this.renderer.bands.show=true}}if(this.fill){this.renderer.bands.show=false}if(this.renderer.bands.show){this.renderer.initBands.call(this,this.renderer.options,ah)}if(this._stack){this.renderer.smooth=false}var ag={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:false,strokeStyle:this.color,fillStyle:this.fillColor,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};this.renderer.shapeRenderer.init(ag);var ad=ac.shadowOffset;if(ad==null){if(this.lineWidth>2.5){ad=1.25*(1+(Math.atan((this.lineWidth/2.5))/0.785398163-1)*0.6)}else{ad=1.25*Math.atan((this.lineWidth/2.5))/0.785398163}}var ab={lineJoin:this.lineJoin,lineCap:this.lineCap,fill:this.fill,isarc:false,angle:this.shadowAngle,offset:ad,alpha:this.shadowAlpha,depth:this.shadowDepth,lineWidth:this.lineWidth,linePattern:this.linePattern,closePath:this.fill};this.renderer.shadowRenderer.init(ab);this._areaPoints=[];this._boundingBox=[[],[]];if(!this.isTrendline&&this.fill||this.renderer.bands.show){this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColor=null;if(af.highlightMouseDown&&af.highlightMouseOver==null){af.highlightMouseOver=false}H.extend(true,this,{highlightMouseOver:af.highlightMouseOver,highlightMouseDown:af.highlightMouseDown,highlightColor:af.highlightColor});if(!this.highlightColor){var ae=(this.renderer.bands.show)?this.renderer.bands.fillColor:this.fillColor;this.highlightColor=H.jqplot.computeHighlightColors(ae)}if(this.highlighter){this.highlighter.show=false}}if(!this.isTrendline&&ah){ah.plugins.lineRenderer={};ah.postInitHooks.addOnce(v);ah.postDrawHooks.addOnce(Z);ah.eventListenerHooks.addOnce("jqplotMouseMove",g);ah.eventListenerHooks.addOnce("jqplotMouseDown",d);ah.eventListenerHooks.addOnce("jqplotMouseUp",Y);ah.eventListenerHooks.addOnce("jqplotClick",f);ah.eventListenerHooks.addOnce("jqplotRightClick",p)}};H.jqplot.LineRenderer.prototype.initBands=function(ae,ao){var af=ae.bandData||[];var ah=this.renderer.bands;ah.hiData=[];ah.lowData=[];var av=this.data;ah._max=null;ah._min=null;if(af.length==2){if(H.isArray(af[0][0])){var ai;var ab=0,al=0;for(var ap=0,am=af[0].length;ap<am;ap++){ai=af[0][ap];if((ai[1]!=null&&ai[1]>ah._max)||ah._max==null){ah._max=ai[1]}if((ai[1]!=null&&ai[1]<ah._min)||ah._min==null){ah._min=ai[1]}}for(var ap=0,am=af[1].length;ap<am;ap++){ai=af[1][ap];if((ai[1]!=null&&ai[1]>ah._max)||ah._max==null){ah._max=ai[1];al=1}if((ai[1]!=null&&ai[1]<ah._min)||ah._min==null){ah._min=ai[1];ab=1}}if(al===ab){ah.show=false}ah.hiData=af[al];ah.lowData=af[ab]}else{if(af[0].length===av.length&&af[1].length===av.length){var ad=(af[0][0]>af[1][0])?0:1;var aw=(ad)?0:1;for(var ap=0,am=av.length;ap<am;ap++){ah.hiData.push([av[ap][0],af[ad][ap]]);ah.lowData.push([av[ap][0],af[aw][ap]])}}else{ah.show=false}}}else{if(af.length>2&&!H.isArray(af[0][0])){var ad=(af[0][0]>af[0][1])?0:1;var aw=(ad)?0:1;for(var ap=0,am=af.length;ap<am;ap++){ah.hiData.push([av[ap][0],af[ap][ad]]);ah.lowData.push([av[ap][0],af[ap][aw]])}}else{var ak=ah.interval;var au=null;var at=null;var ac=null;var an=null;if(H.isArray(ak)){au=ak[0];at=ak[1]}else{au=ak}if(isNaN(au)){if(au.charAt(au.length-1)==="%"){ac="multiply";au=parseFloat(au)/100+1}}else{au=parseFloat(au);ac="add"}if(at!==null&&isNaN(at)){if(at.charAt(at.length-1)==="%"){an="multiply";at=parseFloat(at)/100+1}}else{if(at!==null){at=parseFloat(at);an="add"}}if(au!==null){if(at===null){at=-au;an=ac;if(an==="multiply"){at+=2}}if(au<at){var aq=au;au=at;at=aq;aq=ac;ac=an;an=aq}for(var ap=0,am=av.length;ap<am;ap++){switch(ac){case"add":ah.hiData.push([av[ap][0],av[ap][1]+au]);break;case"multiply":ah.hiData.push([av[ap][0],av[ap][1]*au]);break}switch(an){case"add":ah.lowData.push([av[ap][0],av[ap][1]+at]);break;case"multiply":ah.lowData.push([av[ap][0],av[ap][1]*at]);break}}}else{ah.show=false}}}var ag=ah.hiData;var aj=ah.lowData;for(var ap=0,am=ag.length;ap<am;ap++){if((ag[ap][1]!=null&&ag[ap][1]>ah._max)||ah._max==null){ah._max=ag[ap][1]}}for(var ap=0,am=aj.length;ap<am;ap++){if((aj[ap][1]!=null&&aj[ap][1]<ah._min)||ah._min==null){ah._min=aj[ap][1]}}if(ah.fillColor===null){var ar=H.jqplot.getColorComponents(ah.color);ar[3]=ar[3]*0.5;ah.fillColor="rgba("+ar[0]+", "+ar[1]+", "+ar[2]+", "+ar[3]+")"}};function G(ac,ab){return(3.4182054+ab)*Math.pow(ac,-0.3534992)}function k(ad,ac){var ab=Math.sqrt(Math.pow((ac[0]-ad[0]),2)+Math.pow((ac[1]-ad[1]),2));return 5.7648*Math.log(ab)+7.4456}function w(ab){var ac=(Math.exp(2*ab)-1)/(Math.exp(2*ab)+1);return ac}function F(aD){var am=this.renderer.smooth;var ax=this.canvas.getWidth();var ah=this._xaxis.series_p2u;var aA=this._yaxis.series_p2u;var az=null;var ag=null;var at=aD.length/ax;var ad=[];var ar=[];if(!isNaN(parseFloat(am))){az=parseFloat(am)}else{az=G(at,0.5)}var ap=[];var ae=[];for(var ay=0,au=aD.length;ay<au;ay++){ap.push(aD[ay][1]);ae.push(aD[ay][0])}function ao(aE,aF){if(aE-aF==0){return Math.pow(10,10)}else{return aE-aF}}var aq,al,ak,aj;var ab=aD.length-1;for(var af=1,av=aD.length;af<av;af++){var ac=[];var an=[];for(var aw=0;aw<2;aw++){var ay=af-1+aw;if(ay==0||ay==ab){ac[aw]=Math.pow(10,10)}else{if(ap[ay+1]-ap[ay]==0||ap[ay]-ap[ay-1]==0){ac[aw]=0}else{if(((ae[ay+1]-ae[ay])/(ap[ay+1]-ap[ay])+(ae[ay]-ae[ay-1])/(ap[ay]-ap[ay-1]))==0){ac[aw]=0}else{if((ap[ay+1]-ap[ay])*(ap[ay]-ap[ay-1])<0){ac[aw]=0}else{ac[aw]=2/(ao(ae[ay+1],ae[ay])/(ap[ay+1]-ap[ay])+ao(ae[ay],ae[ay-1])/(ap[ay]-ap[ay-1]))}}}}}if(af==1){ac[0]=3/2*(ap[1]-ap[0])/ao(ae[1],ae[0])-ac[1]/2}else{if(af==ab){ac[1]=3/2*(ap[ab]-ap[ab-1])/ao(ae[ab],ae[ab-1])-ac[0]/2}}an[0]=-2*(ac[1]+2*ac[0])/ao(ae[af],ae[af-1])+6*(ap[af]-ap[af-1])/Math.pow(ao(ae[af],ae[af-1]),2);an[1]=2*(2*ac[1]+ac[0])/ao(ae[af],ae[af-1])-6*(ap[af]-ap[af-1])/Math.pow(ao(ae[af],ae[af-1]),2);aj=1/6*(an[1]-an[0])/ao(ae[af],ae[af-1]);ak=1/2*(ae[af]*an[0]-ae[af-1]*an[1])/ao(ae[af],ae[af-1]);al=(ap[af]-ap[af-1]-ak*(Math.pow(ae[af],2)-Math.pow(ae[af-1],2))-aj*(Math.pow(ae[af],3)-Math.pow(ae[af-1],3)))/ao(ae[af],ae[af-1]);aq=ap[af-1]-al*ae[af-1]-ak*Math.pow(ae[af-1],2)-aj*Math.pow(ae[af-1],3);var aC=(ae[af]-ae[af-1])/az;var aB,ai;for(var aw=0,au=az;aw<au;aw++){aB=[];ai=ae[af-1]+aw*aC;aB.push(ai);aB.push(aq+al*ai+ak*Math.pow(ai,2)+aj*Math.pow(ai,3));ad.push(aB);ar.push([ah(aB[0]),aA(aB[1])])}}ad.push(aD[ay]);ar.push([ah(aD[ay][0]),aA(aD[ay][1])]);return[ad,ar]}function B(aj){var ai=this.renderer.smooth;var aO=this.renderer.tension;var ab=this.canvas.getWidth();var aB=this._xaxis.series_p2u;var ak=this._yaxis.series_p2u;var aC=null;var aD=null;var aN=null;var aI=null;var aG=null;var am=null;var aL=null;var ag=null;var aE,aF,ax,aw,au,ar;var ae,ac,ao,an;var av,at,aH;var ap=[];var ad=[];var af=aj.length/ab;var aM,aq,az,aA,ay;var al=[];var ah=[];if(!isNaN(parseFloat(ai))){aC=parseFloat(ai)}else{aC=G(af,0.5)}if(!isNaN(parseFloat(aO))){aO=parseFloat(aO)}for(var aK=0,aJ=aj.length-1;aK<aJ;aK++){if(aO===null){am=Math.abs((aj[aK+1][1]-aj[aK][1])/(aj[aK+1][0]-aj[aK][0]));aM=0.3;aq=0.6;az=(aq-aM)/2;aA=2.5;ay=-1.4;ag=am/aA+ay;aI=az*w(ag)-az*w(ay)+aM;if(aK>0){aL=Math.abs((aj[aK][1]-aj[aK-1][1])/(aj[aK][0]-aj[aK-1][0]))}ag=aL/aA+ay;aG=az*w(ag)-az*w(ay)+aM;aN=(aI+aG)/2}else{aN=aO}for(aE=0;aE<aC;aE++){aF=aE/aC;ax=(1+2*aF)*Math.pow((1-aF),2);aw=aF*Math.pow((1-aF),2);au=Math.pow(aF,2)*(3-2*aF);ar=Math.pow(aF,2)*(aF-1);if(aj[aK-1]){ae=aN*(aj[aK+1][0]-aj[aK-1][0]);ac=aN*(aj[aK+1][1]-aj[aK-1][1])}else{ae=aN*(aj[aK+1][0]-aj[aK][0]);ac=aN*(aj[aK+1][1]-aj[aK][1])}if(aj[aK+2]){ao=aN*(aj[aK+2][0]-aj[aK][0]);an=aN*(aj[aK+2][1]-aj[aK][1])}else{ao=aN*(aj[aK+1][0]-aj[aK][0]);an=aN*(aj[aK+1][1]-aj[aK][1])}av=ax*aj[aK][0]+au*aj[aK+1][0]+aw*ae+ar*ao;at=ax*aj[aK][1]+au*aj[aK+1][1]+aw*ac+ar*an;aH=[av,at];al.push(aH);ah.push([aB(av),ak(at)])}}al.push(aj[aJ]);ah.push([aB(aj[aJ][0]),ak(aj[aJ][1])]);return[al,ah]}H.jqplot.LineRenderer.prototype.setGridData=function(aj){var af=this._xaxis.series_u2p;var ab=this._yaxis.series_u2p;var ag=this._plotData;var ak=this._prevPlotData;this.gridData=[];this._prevGridData=[];this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];var ae=this.renderer.bands;var ac=false;for(var ah=0,ad=ag.length;ah<ad;ah++){if(ag[ah][0]!=null&&ag[ah][1]!=null){this.gridData.push([af.call(this._xaxis,ag[ah][0]),ab.call(this._yaxis,ag[ah][1])])}else{if(ag[ah][0]==null){ac=true;this.gridData.push([null,ab.call(this._yaxis,ag[ah][1])])}else{if(ag[ah][1]==null){ac=true;this.gridData.push([af.call(this._xaxis,ag[ah][0]),null])}}}if(ak[ah]!=null&&ak[ah][0]!=null&&ak[ah][1]!=null){this._prevGridData.push([af.call(this._xaxis,ak[ah][0]),ab.call(this._yaxis,ak[ah][1])])}else{if(ak[ah]!=null&&ak[ah][0]==null){this._prevGridData.push([null,ab.call(this._yaxis,ak[ah][1])])}else{if(ak[ah]!=null&&ak[ah][0]!=null&&ak[ah][1]==null){this._prevGridData.push([af.call(this._xaxis,ak[ah][0]),null])}}}}if(ac){this.renderer.smooth=false;if(this._type==="line"){ae.show=false}}if(this._type==="line"&&ae.show){for(var ah=0,ad=ae.hiData.length;ah<ad;ah++){this.renderer._hiBandGridData.push([af.call(this._xaxis,ae.hiData[ah][0]),ab.call(this._yaxis,ae.hiData[ah][1])])}for(var ah=0,ad=ae.lowData.length;ah<ad;ah++){this.renderer._lowBandGridData.push([af.call(this._xaxis,ae.lowData[ah][0]),ab.call(this._yaxis,ae.lowData[ah][1])])}}if(this._type==="line"&&this.renderer.smooth&&this.gridData.length>2){var ai;if(this.renderer.constrainSmoothing){ai=F.call(this,this.gridData);this.renderer._smoothedData=ai[0];this.renderer._smoothedPlotData=ai[1];if(ae.show){ai=F.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=ai[0];ai=F.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=ai[0]}ai=null}else{ai=B.call(this,this.gridData);this.renderer._smoothedData=ai[0];this.renderer._smoothedPlotData=ai[1];if(ae.show){ai=B.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=ai[0];ai=B.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=ai[0]}ai=null}}};H.jqplot.LineRenderer.prototype.makeGridData=function(ai,ak){var ag=this._xaxis.series_u2p;var ab=this._yaxis.series_u2p;var al=[];var ad=[];this.renderer._smoothedData=[];this.renderer._smoothedPlotData=[];this.renderer._hiBandGridData=[];this.renderer._lowBandGridData=[];this.renderer._hiBandSmoothedData=[];this.renderer._lowBandSmoothedData=[];var af=this.renderer.bands;var ac=false;for(var ah=0;ah<ai.length;ah++){if(ai[ah][0]!=null&&ai[ah][1]!=null){al.push([ag.call(this._xaxis,ai[ah][0]),ab.call(this._yaxis,ai[ah][1])])}else{if(ai[ah][0]==null){ac=true;al.push([null,ab.call(this._yaxis,ai[ah][1])])}else{if(ai[ah][1]==null){ac=true;al.push([ag.call(this._xaxis,ai[ah][0]),null])}}}}if(ac){this.renderer.smooth=false;if(this._type==="line"){af.show=false}}if(this._type==="line"&&af.show){for(var ah=0,ae=af.hiData.length;ah<ae;ah++){this.renderer._hiBandGridData.push([ag.call(this._xaxis,af.hiData[ah][0]),ab.call(this._yaxis,af.hiData[ah][1])])}for(var ah=0,ae=af.lowData.length;ah<ae;ah++){this.renderer._lowBandGridData.push([ag.call(this._xaxis,af.lowData[ah][0]),ab.call(this._yaxis,af.lowData[ah][1])])}}if(this._type==="line"&&this.renderer.smooth&&al.length>2){var aj;if(this.renderer.constrainSmoothing){aj=F.call(this,al);this.renderer._smoothedData=aj[0];this.renderer._smoothedPlotData=aj[1];if(af.show){aj=F.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=aj[0];aj=F.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=aj[0]}aj=null}else{aj=B.call(this,al);this.renderer._smoothedData=aj[0];this.renderer._smoothedPlotData=aj[1];if(af.show){aj=B.call(this,this.renderer._hiBandGridData);this.renderer._hiBandSmoothedData=aj[0];aj=B.call(this,this.renderer._lowBandGridData);this.renderer._lowBandSmoothedData=aj[0]}aj=null}}return al};H.jqplot.LineRenderer.prototype.draw=function(aq,aC,ac,av){var aw;var ak=H.extend(true,{},ac);var ae=(ak.shadow!=r)?ak.shadow:this.shadow;var aD=(ak.showLine!=r)?ak.showLine:this.showLine;var au=(ak.fill!=r)?ak.fill:this.fill;var ab=(ak.fillAndStroke!=r)?ak.fillAndStroke:this.fillAndStroke;var al,ar,ao,ay;aq.save();if(aC.length){if(aD){if(au){if(this.fillToZero){var az=this.negativeColor;if(!this.useNegativeColors){az=ak.fillStyle}var ai=false;var aj=ak.fillStyle;if(ab){var aB=aC.slice(0)}if(this.index==0||!this._stack){var ap=[];var aF=(this.renderer.smooth)?this.renderer._smoothedPlotData:this._plotData;this._areaPoints=[];var aA=this._yaxis.series_u2p(this.fillToValue);var ad=this._xaxis.series_u2p(this.fillToValue);ak.closePath=true;if(this.fillAxis=="y"){ap.push([aC[0][0],aA]);this._areaPoints.push([aC[0][0],aA]);for(var aw=0;aw<aC.length-1;aw++){ap.push(aC[aw]);this._areaPoints.push(aC[aw]);if(aF[aw][1]*aF[aw+1][1]<0){if(aF[aw][1]<0){ai=true;ak.fillStyle=az}else{ai=false;ak.fillStyle=aj}var ah=aC[aw][0]+(aC[aw+1][0]-aC[aw][0])*(aA-aC[aw][1])/(aC[aw+1][1]-aC[aw][1]);ap.push([ah,aA]);this._areaPoints.push([ah,aA]);if(ae){this.renderer.shadowRenderer.draw(aq,ap,ak)}this.renderer.shapeRenderer.draw(aq,ap,ak);ap=[[ah,aA]]}}if(aF[aC.length-1][1]<0){ai=true;ak.fillStyle=az}else{ai=false;ak.fillStyle=aj}ap.push(aC[aC.length-1]);this._areaPoints.push(aC[aC.length-1]);ap.push([aC[aC.length-1][0],aA]);this._areaPoints.push([aC[aC.length-1][0],aA])}if(ae){this.renderer.shadowRenderer.draw(aq,ap,ak)}this.renderer.shapeRenderer.draw(aq,ap,ak)}else{var an=this._prevGridData;for(var aw=an.length;aw>0;aw--){aC.push(an[aw-1])}if(ae){this.renderer.shadowRenderer.draw(aq,aC,ak)}this._areaPoints=aC;this.renderer.shapeRenderer.draw(aq,aC,ak)}}else{if(ab){var aB=aC.slice(0)}if(this.index==0||!this._stack){var af=aq.canvas.height;aC.unshift([aC[0][0],af]);var ax=aC.length;aC.push([aC[ax-1][0],af])}else{var an=this._prevGridData;for(var aw=an.length;aw>0;aw--){aC.push(an[aw-1])}}this._areaPoints=aC;if(ae){this.renderer.shadowRenderer.draw(aq,aC,ak)}this.renderer.shapeRenderer.draw(aq,aC,ak)}if(ab){var at=H.extend(true,{},ak,{fill:false,closePath:false});this.renderer.shapeRenderer.draw(aq,aB,at);if(this.markerRenderer.show){if(this.renderer.smooth){aB=this.gridData}for(aw=0;aw<aB.length;aw++){this.markerRenderer.draw(aB[aw][0],aB[aw][1],aq,ak.markerOptions)}}}}else{if(this.renderer.bands.show){var ag;var aE=H.extend(true,{},ak);if(this.renderer.bands.showLines){ag=(this.renderer.smooth)?this.renderer._hiBandSmoothedData:this.renderer._hiBandGridData;this.renderer.shapeRenderer.draw(aq,ag,ak);ag=(this.renderer.smooth)?this.renderer._lowBandSmoothedData:this.renderer._lowBandGridData;this.renderer.shapeRenderer.draw(aq,ag,aE)}if(this.renderer.bands.fill){if(this.renderer.smooth){ag=this.renderer._hiBandSmoothedData.concat(this.renderer._lowBandSmoothedData.reverse())}else{ag=this.renderer._hiBandGridData.concat(this.renderer._lowBandGridData.reverse())}this._areaPoints=ag;aE.closePath=true;aE.fill=true;aE.fillStyle=this.renderer.bands.fillColor;this.renderer.shapeRenderer.draw(aq,ag,aE)}}if(ae){this.renderer.shadowRenderer.draw(aq,aC,ak)}this.renderer.shapeRenderer.draw(aq,aC,ak)}}var al=ao=ar=ay=null;for(aw=0;aw<this._areaPoints.length;aw++){var am=this._areaPoints[aw];if(al>am[0]||al==null){al=am[0]}if(ay<am[1]||ay==null){ay=am[1]}if(ao<am[0]||ao==null){ao=am[0]}if(ar>am[1]||ar==null){ar=am[1]}}if(this.type==="line"&&this.renderer.bands.show){ay=this._yaxis.series_u2p(this.renderer.bands._min);ar=this._yaxis.series_u2p(this.renderer.bands._max)}this._boundingBox=[[al,ay],[ao,ar]];if(this.markerRenderer.show&&!au){if(this.renderer.smooth){aC=this.gridData}for(aw=0;aw<aC.length;aw++){if(aC[aw][0]!=null&&aC[aw][1]!=null){this.markerRenderer.draw(aC[aw][0],aC[aw][1],aq,ak.markerOptions)}}}}aq.restore()};H.jqplot.LineRenderer.prototype.drawShadow=function(ab,ad,ac){};function v(ae,ad,ab){for(var ac=0;ac<this.series.length;ac++){if(this.series[ac].renderer.constructor==H.jqplot.LineRenderer){if(this.series[ac].highlightMouseOver){this.series[ac].highlightMouseDown=false}}}}function Z(){if(this.plugins.lineRenderer&&this.plugins.lineRenderer.highlightCanvas){this.plugins.lineRenderer.highlightCanvas.resetCanvas();this.plugins.lineRenderer.highlightCanvas=null}this.plugins.lineRenderer.highlightedSeriesIndex=null;this.plugins.lineRenderer.highlightCanvas=new H.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.lineRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-lineRenderer-highlight-canvas",this._plotDimensions,this));this.plugins.lineRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(ab){V(ab.data.plot)})}function X(ah,ag,ae,ad){var ac=ah.series[ag];var ab=ah.plugins.lineRenderer.highlightCanvas;ab._ctx.clearRect(0,0,ab._ctx.canvas.width,ab._ctx.canvas.height);ac._highlightedPoint=ae;ah.plugins.lineRenderer.highlightedSeriesIndex=ag;var af={fillStyle:ac.highlightColor};if(ac.type==="line"&&ac.renderer.bands.show){af.fill=true;af.closePath=true}ac.renderer.shapeRenderer.draw(ab._ctx,ad,af);ab=null}function V(ad){var ab=ad.plugins.lineRenderer.highlightCanvas;ab._ctx.clearRect(0,0,ab._ctx.canvas.width,ab._ctx.canvas.height);for(var ac=0;ac<ad.series.length;ac++){ad.series[ac]._highlightedPoint=null}ad.plugins.lineRenderer.highlightedSeriesIndex=null;ad.target.trigger("jqplotDataUnhighlight");ab=null}function g(af,ae,ai,ah,ag){if(ah){var ad=[ah.seriesIndex,ah.pointIndex,ah.data];var ac=jQuery.Event("jqplotDataMouseOver");ac.pageX=af.pageX;ac.pageY=af.pageY;ag.target.trigger(ac,ad);if(ag.series[ad[0]].highlightMouseOver&&!(ad[0]==ag.plugins.lineRenderer.highlightedSeriesIndex)){var ab=jQuery.Event("jqplotDataHighlight");ab.which=af.which;ab.pageX=af.pageX;ab.pageY=af.pageY;ag.target.trigger(ab,ad);X(ag,ah.seriesIndex,ah.pointIndex,ah.points)}}else{if(ah==null){V(ag)}}}function d(ae,ad,ah,ag,af){if(ag){var ac=[ag.seriesIndex,ag.pointIndex,ag.data];if(af.series[ac[0]].highlightMouseDown&&!(ac[0]==af.plugins.lineRenderer.highlightedSeriesIndex)){var ab=jQuery.Event("jqplotDataHighlight");ab.which=ae.which;ab.pageX=ae.pageX;ab.pageY=ae.pageY;af.target.trigger(ab,ac);X(af,ag.seriesIndex,ag.pointIndex,ag.points)}}else{if(ag==null){V(af)}}}function Y(ad,ac,ag,af,ae){var ab=ae.plugins.lineRenderer.highlightedSeriesIndex;if(ab!=null&&ae.series[ab].highlightMouseDown){V(ae)}}function f(ae,ad,ah,ag,af){if(ag){var ac=[ag.seriesIndex,ag.pointIndex,ag.data];var ab=jQuery.Event("jqplotDataClick");ab.which=ae.which;ab.pageX=ae.pageX;ab.pageY=ae.pageY;af.target.trigger(ab,ac)}}function p(af,ae,ai,ah,ag){if(ah){var ad=[ah.seriesIndex,ah.pointIndex,ah.data];var ab=ag.plugins.lineRenderer.highlightedSeriesIndex;if(ab!=null&&ag.series[ab].highlightMouseDown){V(ag)}var ac=jQuery.Event("jqplotDataRightClick");ac.which=af.which;ac.pageX=af.pageX;ac.pageY=af.pageY;ag.target.trigger(ac,ad)}}H.jqplot.LinearAxisRenderer=function(){};H.jqplot.LinearAxisRenderer.prototype.init=function(ab){this.breakPoints=null;this.breakTickLabel="&asymp;";this.drawBaseline=true;this.baselineWidth=null;this.baselineColor=null;this.forceTickAt0=false;this.forceTickAt100=false;this.tickInset=0;this.minorTicks=0;this.alignTicks=false;this._autoFormatString="";this._overrideFormatString=false;this._scalefact=1;H.extend(true,this,ab);if(this.breakPoints){if(!H.isArray(this.breakPoints)){this.breakPoints=null}else{if(this.breakPoints.length<2||this.breakPoints[1]<=this.breakPoints[0]){this.breakPoints=null}}}if(this.numberTicks!=null&&this.numberTicks<2){this.numberTicks=2}this.resetDataBounds()};H.jqplot.LinearAxisRenderer.prototype.draw=function(ab,ai){if(this.show){this.renderer.createTicks.call(this,ai);var ah=0;var ac;if(this._elem){this._elem.emptyForce();this._elem=null}this._elem=H(document.createElement("div"));this._elem.addClass("jqplot-axis jqplot-"+this.name);this._elem.css("position","absolute");if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var ag=this._label.draw(ab,ai);ag.appendTo(this._elem);ag=null}var af=this._ticks;var ae;for(var ad=0;ad<af.length;ad++){ae=af[ad];if(ae.show&&ae.showLabel&&(!ae.isMinorTick||this.showMinorTicks)){this._elem.append(ae.draw(ab,ai))}}ae=null;af=null}return this._elem};H.jqplot.LinearAxisRenderer.prototype.reset=function(){this.min=this._options.min;this.max=this._options.max;this.tickInterval=this._options.tickInterval;this.numberTicks=this._options.numberTicks;this._autoFormatString="";if(this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString){this.tickOptions.formatString=""}};H.jqplot.LinearAxisRenderer.prototype.set=function(){var ai=0;var ad;var ac=0;var ah=0;var ab=(this._label==null)?false:this._label.show;if(this.show){var ag=this._ticks;var af;for(var ae=0;ae<ag.length;ae++){af=ag[ae];if(!af._breakTick&&af.show&&af.showLabel&&(!af.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){ad=af._elem.outerHeight(true)}else{ad=af._elem.outerWidth(true)}if(ad>ai){ai=ad}}}af=null;ag=null;if(ab){ac=this._label._elem.outerWidth(true);ah=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){ai=ai+ah;this._elem.css({height:ai+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){ai=ai+ah;this._elem.css({height:ai+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){ai=ai+ac;this._elem.css({width:ai+"px",left:"0px",top:"0px"});if(ab&&this._label.constructor==H.jqplot.AxisLabelRenderer){this._label._elem.css("width",ac+"px")}}else{ai=ai+ac;this._elem.css({width:ai+"px",right:"0px",top:"0px"});if(ab&&this._label.constructor==H.jqplot.AxisLabelRenderer){this._label._elem.css("width",ac+"px")}}}}}};H.jqplot.LinearAxisRenderer.prototype.createTicks=function(ad){var aN=this._ticks;var aE=this.ticks;var at=this.name;var av=this._dataBounds;var ab=(this.name.charAt(0)==="x")?this._plotDimensions.width:this._plotDimensions.height;var ah;var a0,aC;var aj,ai;var aY,aU;var aB=this.min;var aZ=this.max;var aQ=this.numberTicks;var a4=this.tickInterval;var ag=30;this._scalefact=(Math.max(ab,ag+1)-ag)/300;if(aE.length){for(aU=0;aU<aE.length;aU++){var aI=aE[aU];var aO=new this.tickRenderer(this.tickOptions);if(H.isArray(aI)){aO.value=aI[0];if(this.breakPoints){if(aI[0]==this.breakPoints[0]){aO.label=this.breakTickLabel;aO._breakTick=true;aO.showGridline=false;aO.showMark=false}else{if(aI[0]>this.breakPoints[0]&&aI[0]<=this.breakPoints[1]){aO.show=false;aO.showGridline=false;aO.label=aI[1]}else{aO.label=aI[1]}}}else{aO.label=aI[1]}aO.setTick(aI[0],this.name);this._ticks.push(aO)}else{if(H.isPlainObject(aI)){H.extend(true,aO,aI);aO.axis=this.name;this._ticks.push(aO)}else{aO.value=aI;if(this.breakPoints){if(aI==this.breakPoints[0]){aO.label=this.breakTickLabel;aO._breakTick=true;aO.showGridline=false;aO.showMark=false}else{if(aI>this.breakPoints[0]&&aI<=this.breakPoints[1]){aO.show=false;aO.showGridline=false}}}aO.setTick(aI,this.name);this._ticks.push(aO)}}}this.numberTicks=aE.length;this.min=this._ticks[0].value;this.max=this._ticks[this.numberTicks-1].value;this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{if(at=="xaxis"||at=="x2axis"){ab=this._plotDimensions.width}else{ab=this._plotDimensions.height}var aq=this.numberTicks;if(this.alignTicks){if(this.name==="x2axis"&&ad.axes.xaxis.show){aq=ad.axes.xaxis.numberTicks}else{if(this.name.charAt(0)==="y"&&this.name!=="yaxis"&&this.name!=="yMidAxis"&&ad.axes.yaxis.show){aq=ad.axes.yaxis.numberTicks}}}a0=((this.min!=null)?this.min:av.min);aC=((this.max!=null)?this.max:av.max);var ao=aC-a0;var aM,ar;var am;if(this.tickOptions==null||!this.tickOptions.formatString){this._overrideFormatString=true}if(this.min==null||this.max==null&&this.tickInterval==null&&!this.autoscale){if(this.forceTickAt0){if(a0>0){a0=0}if(aC<0){aC=0}}if(this.forceTickAt100){if(a0>100){a0=100}if(aC<100){aC=100}}var ay=false,aV=false;if(this.min!=null){ay=true}else{if(this.max!=null){aV=true}}var aJ=H.jqplot.LinearTickGenerator(a0,aC,this._scalefact,aq,ay,aV);var ap=(this.min!=null)?a0:a0+ao*(this.padMin-1);var aK=(this.max!=null)?aC:aC-ao*(this.padMax-1);if(a0<ap||aC>aK){ap=(this.min!=null)?a0:a0-ao*(this.padMin-1);aK=(this.max!=null)?aC:aC+ao*(this.padMax-1);aJ=H.jqplot.LinearTickGenerator(ap,aK,this._scalefact,aq,ay,aV)}this.min=aJ[0];this.max=aJ[1];this.numberTicks=aJ[2];this._autoFormatString=aJ[3];this.tickInterval=aJ[4]}else{if(a0==aC){var ac=0.05;if(a0>0){ac=Math.max(Math.log(a0)/Math.LN10,0.05)}a0-=ac;aC+=ac}if(this.autoscale&&this.min==null&&this.max==null){var ae,af,al;var aw=false;var aH=false;var au={min:null,max:null,average:null,stddev:null};for(var aU=0;aU<this._series.length;aU++){var aP=this._series[aU];var ax=(aP.fillAxis=="x")?aP._xaxis.name:aP._yaxis.name;if(this.name==ax){var aL=aP._plotValues[aP.fillAxis];var aA=aL[0];var aW=aL[0];for(var aT=1;aT<aL.length;aT++){if(aL[aT]<aA){aA=aL[aT]}else{if(aL[aT]>aW){aW=aL[aT]}}}var an=(aW-aA)/aW;if(aP.renderer.constructor==H.jqplot.BarRenderer){if(aA>=0&&(aP.fillToZero||an>0.1)){aw=true}else{aw=false;if(aP.fill&&aP.fillToZero&&aA<0&&aW>0){aH=true}else{aH=false}}}else{if(aP.fill){if(aA>=0&&(aP.fillToZero||an>0.1)){aw=true}else{if(aA<0&&aW>0&&aP.fillToZero){aw=false;aH=true}else{aw=false;aH=false}}}else{if(aA<0){aw=false}}}}}if(aw){this.numberTicks=2+Math.ceil((ab-(this.tickSpacing-1))/this.tickSpacing);this.min=0;aB=0;af=aC/(this.numberTicks-1);am=Math.pow(10,Math.abs(Math.floor(Math.log(af)/Math.LN10)));if(af/am==parseInt(af/am,10)){af+=am}this.tickInterval=Math.ceil(af/am)*am;this.max=this.tickInterval*(this.numberTicks-1)}else{if(aH){this.numberTicks=2+Math.ceil((ab-(this.tickSpacing-1))/this.tickSpacing);var aD=Math.ceil(Math.abs(a0)/ao*(this.numberTicks-1));var a3=this.numberTicks-1-aD;af=Math.max(Math.abs(a0/aD),Math.abs(aC/a3));am=Math.pow(10,Math.abs(Math.floor(Math.log(af)/Math.LN10)));this.tickInterval=Math.ceil(af/am)*am;this.max=this.tickInterval*a3;this.min=-this.tickInterval*aD}else{if(this.numberTicks==null){if(this.tickInterval){this.numberTicks=3+Math.ceil(ao/this.tickInterval)}else{this.numberTicks=2+Math.ceil((ab-(this.tickSpacing-1))/this.tickSpacing)}}if(this.tickInterval==null){af=ao/(this.numberTicks-1);if(af<1){am=Math.pow(10,Math.abs(Math.floor(Math.log(af)/Math.LN10)))}else{am=1}this.tickInterval=Math.ceil(af*am*this.pad)/am}else{am=1/this.tickInterval}ae=this.tickInterval*(this.numberTicks-1);al=(ae-ao)/2;if(this.min==null){this.min=Math.floor(am*(a0-al))/am}if(this.max==null){this.max=this.min+ae}}}var az=H.jqplot.getSignificantFigures(this.tickInterval);var aG;if(az.digitsLeft>=az.significantDigits){aG="%d"}else{var am=Math.max(0,5-az.digitsLeft);am=Math.min(am,az.digitsRight);aG="%."+am+"f"}this._autoFormatString=aG}else{aM=(this.min!=null)?this.min:a0-ao*(this.padMin-1);ar=(this.max!=null)?this.max:aC+ao*(this.padMax-1);ao=ar-aM;if(this.numberTicks==null){if(this.tickInterval!=null){this.numberTicks=Math.ceil((ar-aM)/this.tickInterval)+1}else{if(ab>100){this.numberTicks=parseInt(3+(ab-100)/75,10)}else{this.numberTicks=2}}}if(this.tickInterval==null){this.tickInterval=ao/(this.numberTicks-1)}if(this.max==null){ar=aM+this.tickInterval*(this.numberTicks-1)}if(this.min==null){aM=ar-this.tickInterval*(this.numberTicks-1)}var az=H.jqplot.getSignificantFigures(this.tickInterval);var aG;if(az.digitsLeft>=az.significantDigits){aG="%d"}else{var am=Math.max(0,5-az.digitsLeft);am=Math.min(am,az.digitsRight);aG="%."+am+"f"}this._autoFormatString=aG;this.min=aM;this.max=ar}if(this.renderer.constructor==H.jqplot.LinearAxisRenderer&&this._autoFormatString==""){ao=this.max-this.min;var a1=new this.tickRenderer(this.tickOptions);var aF=a1.formatString||H.jqplot.config.defaultTickFormatString;var aF=aF.match(H.jqplot.sprintf.regex)[0];var aX=0;if(aF){if(aF.search(/[fFeEgGpP]/)>-1){var aS=aF.match(/\%\.(\d{0,})?[eEfFgGpP]/);if(aS){aX=parseInt(aS[1],10)}else{aX=6}}else{if(aF.search(/[di]/)>-1){aX=0}}var ak=Math.pow(10,-aX);if(this.tickInterval<ak){if(aQ==null&&a4==null){this.tickInterval=ak;if(aZ==null&&aB==null){this.min=Math.floor(this._dataBounds.min/ak)*ak;if(this.min==this._dataBounds.min){this.min=this._dataBounds.min-this.tickInterval}this.max=Math.ceil(this._dataBounds.max/ak)*ak;if(this.max==this._dataBounds.max){this.max=this._dataBounds.max+this.tickInterval}var aR=(this.max-this.min)/this.tickInterval;aR=aR.toFixed(11);aR=Math.ceil(aR);this.numberTicks=aR+1}else{if(aZ==null){var aR=(this._dataBounds.max-this.min)/this.tickInterval;aR=aR.toFixed(11);this.numberTicks=Math.ceil(aR)+2;this.max=this.min+this.tickInterval*(this.numberTicks-1)}else{if(aB==null){var aR=(this.max-this._dataBounds.min)/this.tickInterval;aR=aR.toFixed(11);this.numberTicks=Math.ceil(aR)+2;this.min=this.max-this.tickInterval*(this.numberTicks-1)}else{this.numberTicks=Math.ceil((aZ-aB)/this.tickInterval)+1;this.min=Math.floor(aB*Math.pow(10,aX))/Math.pow(10,aX);this.max=Math.ceil(aZ*Math.pow(10,aX))/Math.pow(10,aX);this.numberTicks=Math.ceil((this.max-this.min)/this.tickInterval)+1}}}}}}}}if(this._overrideFormatString&&this._autoFormatString!=""){this.tickOptions=this.tickOptions||{};this.tickOptions.formatString=this._autoFormatString}var aO,a2;for(var aU=0;aU<this.numberTicks;aU++){aY=this.min+aU*this.tickInterval;aO=new this.tickRenderer(this.tickOptions);aO.setTick(aY,this.name);this._ticks.push(aO);if(aU<this.numberTicks-1){for(var aT=0;aT<this.minorTicks;aT++){aY+=this.tickInterval/(this.minorTicks+1);a2=H.extend(true,{},this.tickOptions,{name:this.name,value:aY,label:"",isMinorTick:true});aO=new this.tickRenderer(a2);this._ticks.push(aO)}}aO=null}}if(this.tickInset){this.min=this.min-this.tickInset*this.tickInterval;this.max=this.max+this.tickInset*this.tickInterval}aN=null};H.jqplot.LinearAxisRenderer.prototype.resetTickValues=function(ad){if(H.isArray(ad)&&ad.length==this._ticks.length){var ac;for(var ab=0;ab<ad.length;ab++){ac=this._ticks[ab];ac.value=ad[ab];ac.label=ac.formatter(ac.formatString,ad[ab]);ac.label=ac.prefix+ac.label;ac._elem.html(ac.label)}ac=null;this.min=H.jqplot.arrayMin(ad);this.max=H.jqplot.arrayMax(ad);this.pack()}};H.jqplot.LinearAxisRenderer.prototype.pack=function(ad,ac){ad=ad||{};ac=ac||this._offsets;var ar=this._ticks;var an=this.max;var am=this.min;var ai=ac.max;var ag=ac.min;var ak=(this._label==null)?false:this._label.show;for(var al in ad){this._elem.css(al,ad[al])}this._offsets=ac;var ae=ai-ag;var af=an-am;if(this.breakPoints){af=af-this.breakPoints[1]+this.breakPoints[0];this.p2u=function(au){return(au-ag)*af/ae+am};this.u2p=function(au){if(au>this.breakPoints[0]&&au<this.breakPoints[1]){au=this.breakPoints[0]}if(au<=this.breakPoints[0]){return(au-am)*ae/af+ag}else{return(au-this.breakPoints[1]+this.breakPoints[0]-am)*ae/af+ag}};if(this.name.charAt(0)=="x"){this.series_u2p=function(au){if(au>this.breakPoints[0]&&au<this.breakPoints[1]){au=this.breakPoints[0]}if(au<=this.breakPoints[0]){return(au-am)*ae/af}else{return(au-this.breakPoints[1]+this.breakPoints[0]-am)*ae/af}};this.series_p2u=function(au){return au*af/ae+am}}else{this.series_u2p=function(au){if(au>this.breakPoints[0]&&au<this.breakPoints[1]){au=this.breakPoints[0]}if(au>=this.breakPoints[1]){return(au-an)*ae/af}else{return(au+this.breakPoints[1]-this.breakPoints[0]-an)*ae/af}};this.series_p2u=function(au){return au*af/ae+an}}}else{this.p2u=function(au){return(au-ag)*af/ae+am};this.u2p=function(au){return(au-am)*ae/af+ag};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(au){return(au-am)*ae/af};this.series_p2u=function(au){return au*af/ae+am}}else{this.series_u2p=function(au){return(au-an)*ae/af};this.series_p2u=function(au){return au*af/ae+an}}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(var ao=0;ao<ar.length;ao++){var aj=ar[ao];if(aj.show&&aj.showLabel){var ab;if(aj.constructor==H.jqplot.CanvasAxisTickRenderer&&aj.angle){var aq=(this.name=="xaxis")?1:-1;switch(aj.labelPosition){case"auto":if(aq*aj.angle<0){ab=-aj.getWidth()+aj._textRenderer.height*Math.sin(-aj._textRenderer.angle)/2}else{ab=-aj._textRenderer.height*Math.sin(aj._textRenderer.angle)/2}break;case"end":ab=-aj.getWidth()+aj._textRenderer.height*Math.sin(-aj._textRenderer.angle)/2;break;case"start":ab=-aj._textRenderer.height*Math.sin(aj._textRenderer.angle)/2;break;case"middle":ab=-aj.getWidth()/2+aj._textRenderer.height*Math.sin(-aj._textRenderer.angle)/2;break;default:ab=-aj.getWidth()/2+aj._textRenderer.height*Math.sin(-aj._textRenderer.angle)/2;break}}else{ab=-aj.getWidth()/2}var at=this.u2p(aj.value)+ab+"px";aj._elem.css("left",at);aj.pack()}}if(ak){var ah=this._label._elem.outerWidth(true);this._label._elem.css("left",ag+ae/2-ah/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px")}else{this._label._elem.css("top","0px")}this._label.pack()}}else{for(var ao=0;ao<ar.length;ao++){var aj=ar[ao];if(aj.show&&aj.showLabel){var ab;if(aj.constructor==H.jqplot.CanvasAxisTickRenderer&&aj.angle){var aq=(this.name=="yaxis")?1:-1;switch(aj.labelPosition){case"auto":case"end":if(aq*aj.angle<0){ab=-aj._textRenderer.height*Math.cos(-aj._textRenderer.angle)/2}else{ab=-aj.getHeight()+aj._textRenderer.height*Math.cos(aj._textRenderer.angle)/2}break;case"start":if(aj.angle>0){ab=-aj._textRenderer.height*Math.cos(-aj._textRenderer.angle)/2}else{ab=-aj.getHeight()+aj._textRenderer.height*Math.cos(aj._textRenderer.angle)/2}break;case"middle":ab=-aj.getHeight()/2;break;default:ab=-aj.getHeight()/2;break}}else{ab=-aj.getHeight()/2}var at=this.u2p(aj.value)+ab+"px";aj._elem.css("top",at);aj.pack()}}if(ak){var ap=this._label._elem.outerHeight(true);this._label._elem.css("top",ai-ae/2-ap/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px")}else{this._label._elem.css("right","0px")}this._label.pack()}}}ar=null};function h(ac){var ab;ac=Math.abs(ac);if(ac>=10){ab="%d"}else{if(ac>1){if(ac===parseInt(ac,10)){ab="%d"}else{ab="%.1f"}}else{var ad=-Math.floor(Math.log(ac)/Math.LN10);ab="%."+ad+"f"}}return ab}var a=[0.1,0.2,0.3,0.4,0.5,0.8,1,2,3,4,5];var b=function(ac){var ab=a.indexOf(ac);if(ab>0){return a[ab-1]}else{return a[a.length-1]/100}};var i=function(ac){var ab=a.indexOf(ac);if(ab<a.length-1){return a[ab+1]}else{return a[0]*100}};function c(af,an,am){var ak=Math.floor(am/2);var ac=Math.ceil(am*1.5);var ae=Number.MAX_VALUE;var ab=(an-af);var aq;var aj;var al;var ar=H.jqplot.getSignificantFigures;var ap;var ah;var ai;var ao;for(var ag=0,ad=ac-ak+1;ag<ad;ag++){ai=ak+ag;aq=ab/(ai-1);aj=ar(aq);aq=Math.abs(am-ai)+aj.digitsRight;if(aq<ae){ae=aq;al=ai;ao=aj.digitsRight}else{if(aq===ae){if(aj.digitsRight<ao){al=ai;ao=aj.digitsRight}}}}ap=Math.max(ao,Math.max(ar(af).digitsRight,ar(an).digitsRight));if(ap===0){ah="%d"}else{ah="%."+ap+"f"}aq=ab/(al-1);return[af,an,al,ah,aq]}function S(ac,af){af=af||7;var ae=ac/(af-1);var ad=Math.pow(10,Math.floor(Math.log(ae)/Math.LN10));var ag=ae/ad;var ab;if(ad<1){if(ag>5){ab=10*ad}else{if(ag>2){ab=5*ad}else{if(ag>1){ab=2*ad}else{ab=ad}}}}else{if(ag>5){ab=10*ad}else{if(ag>4){ab=5*ad}else{if(ag>3){ab=4*ad}else{if(ag>2){ab=3*ad}else{if(ag>1){ab=2*ad}else{ab=ad}}}}}}return ab}function M(ac,ab){ab=ab||1;var ae=Math.floor(Math.log(ac)/Math.LN10);var ag=Math.pow(10,ae);var af=ac/ag;var ad;af=af/ab;if(af<=0.38){ad=0.1}else{if(af<=1.6){ad=0.2}else{if(af<=4){ad=0.5}else{if(af<=8){ad=1}else{if(af<=16){ad=2}else{ad=5}}}}}return ad*ag}function t(ad,ac){var af=Math.floor(Math.log(ad)/Math.LN10);var ah=Math.pow(10,af);var ag=ad/ah;var ab;var ae;ag=ag/ac;if(ag<=0.38){ae=0.1}else{if(ag<=1.6){ae=0.2}else{if(ag<=4){ae=0.5}else{if(ag<=8){ae=1}else{if(ag<=16){ae=2}else{ae=5}}}}}ab=ae*ah;return[ab,ae,ah]}H.jqplot.LinearTickGenerator=function(ah,ak,ad,ae,ai,al){ai=(ai===null)?false:ai;al=(al===null||ai)?false:al;if(ah===ak){ak=(ak)?0:1}ad=ad||1;if(ak<ah){var am=ak;ak=ah;ah=am}var ac=[];var ap=M(ak-ah,ad);var ao=H.jqplot.getSignificantFigures;if(ae==null){if(!ai&&!al){ac[0]=Math.floor(ah/ap)*ap;ac[1]=Math.ceil(ak/ap)*ap;ac[2]=Math.round((ac[1]-ac[0])/ap+1);ac[3]=h(ap);ac[4]=ap}else{if(ai){ac[0]=ah;ac[2]=Math.ceil((ak-ah)/ap+1);ac[1]=ah+(ac[2]-1)*ap;var an=ao(ah).digitsRight;var aj=ao(ap).digitsRight;if(an<aj){ac[3]=h(ap)}else{ac[3]="%."+an+"f"}ac[4]=ap}else{if(al){ac[1]=ak;ac[2]=Math.ceil((ak-ah)/ap+1);ac[0]=ak-(ac[2]-1)*ap;var af=ao(ak).digitsRight;var aj=ao(ap).digitsRight;if(af<aj){ac[3]=h(ap)}else{ac[3]="%."+af+"f"}ac[4]=ap}}}}else{var ag=[];ag[0]=Math.floor(ah/ap)*ap;ag[1]=Math.ceil(ak/ap)*ap;ag[2]=Math.round((ag[1]-ag[0])/ap+1);ag[3]=h(ap);ag[4]=ap;if(ag[2]===ae){ac=ag}else{var ab=S(ag[1]-ag[0],ae);ac[0]=ag[0];ac[2]=ae;ac[4]=ab;ac[3]=h(ab);ac[1]=ac[0]+(ac[2]-1)*ac[4]}}return ac};H.jqplot.LinearTickGenerator.bestLinearInterval=M;H.jqplot.LinearTickGenerator.bestInterval=S;H.jqplot.LinearTickGenerator.bestLinearComponents=t;H.jqplot.LinearTickGenerator.bestConstrainedInterval=c;H.jqplot.MarkerRenderer=function(ab){this.show=true;this.style="filledCircle";this.lineWidth=2;this.size=9;this.color="#666666";this.shadow=true;this.shadowAngle=45;this.shadowOffset=1;this.shadowDepth=3;this.shadowAlpha="0.07";this.shadowRenderer=new H.jqplot.ShadowRenderer();this.shapeRenderer=new H.jqplot.ShapeRenderer();H.extend(true,this,ab)};H.jqplot.MarkerRenderer.prototype.init=function(ab){H.extend(true,this,ab);var ad={angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,lineWidth:this.lineWidth,depth:this.shadowDepth,closePath:true};if(this.style.indexOf("filled")!=-1){ad.fill=true}if(this.style.indexOf("ircle")!=-1){ad.isarc=true;ad.closePath=false}this.shadowRenderer.init(ad);var ac={fill:false,isarc:false,strokeStyle:this.color,fillStyle:this.color,lineWidth:this.lineWidth,closePath:true};if(this.style.indexOf("filled")!=-1){ac.fill=true}if(this.style.indexOf("ircle")!=-1){ac.isarc=true;ac.closePath=false}this.shapeRenderer.init(ac)};H.jqplot.MarkerRenderer.prototype.drawDiamond=function(ad,ac,ag,af,ai){var ab=1.2;var aj=this.size/2/ab;var ah=this.size/2*ab;var ae=[[ad-aj,ac],[ad,ac+ah],[ad+aj,ac],[ad,ac-ah]];if(this.shadow){this.shadowRenderer.draw(ag,ae)}this.shapeRenderer.draw(ag,ae,ai)};H.jqplot.MarkerRenderer.prototype.drawPlus=function(ae,ad,ah,ag,ak){var ac=1;var al=this.size/2*ac;var ai=this.size/2*ac;var aj=[[ae,ad-ai],[ae,ad+ai]];var af=[[ae+al,ad],[ae-al,ad]];var ab=H.extend(true,{},this.options,{closePath:false});if(this.shadow){this.shadowRenderer.draw(ah,aj,{closePath:false});this.shadowRenderer.draw(ah,af,{closePath:false})}this.shapeRenderer.draw(ah,aj,ab);this.shapeRenderer.draw(ah,af,ab)};H.jqplot.MarkerRenderer.prototype.drawX=function(ae,ad,ah,ag,ak){var ac=1;var al=this.size/2*ac;var ai=this.size/2*ac;var ab=H.extend(true,{},this.options,{closePath:false});var aj=[[ae-al,ad-ai],[ae+al,ad+ai]];var af=[[ae-al,ad+ai],[ae+al,ad-ai]];if(this.shadow){this.shadowRenderer.draw(ah,aj,{closePath:false});this.shadowRenderer.draw(ah,af,{closePath:false})}this.shapeRenderer.draw(ah,aj,ab);this.shapeRenderer.draw(ah,af,ab)};H.jqplot.MarkerRenderer.prototype.drawDash=function(ad,ac,ag,af,ai){var ab=1;var aj=this.size/2*ab;var ah=this.size/2*ab;var ae=[[ad-aj,ac],[ad+aj,ac]];if(this.shadow){this.shadowRenderer.draw(ag,ae)}this.shapeRenderer.draw(ag,ae,ai)};H.jqplot.MarkerRenderer.prototype.drawLine=function(ag,af,ab,ae,ac){var ad=[ag,af];if(this.shadow){this.shadowRenderer.draw(ab,ad)}this.shapeRenderer.draw(ab,ad,ac)};H.jqplot.MarkerRenderer.prototype.drawSquare=function(ad,ac,ag,af,ai){var ab=1;var aj=this.size/2/ab;var ah=this.size/2*ab;var ae=[[ad-aj,ac-ah],[ad-aj,ac+ah],[ad+aj,ac+ah],[ad+aj,ac-ah]];if(this.shadow){this.shadowRenderer.draw(ag,ae)}this.shapeRenderer.draw(ag,ae,ai)};H.jqplot.MarkerRenderer.prototype.drawCircle=function(ac,ai,ae,ah,af){var ab=this.size/2;var ad=2*Math.PI;var ag=[ac,ai,ab,0,ad,true];if(this.shadow){this.shadowRenderer.draw(ae,ag)}this.shapeRenderer.draw(ae,ag,af)};H.jqplot.MarkerRenderer.prototype.draw=function(ab,ae,ac,ad){ad=ad||{};if(ad.show==null||ad.show!=false){if(ad.color&&!ad.fillStyle){ad.fillStyle=ad.color}if(ad.color&&!ad.strokeStyle){ad.strokeStyle=ad.color}switch(this.style){case"diamond":this.drawDiamond(ab,ae,ac,false,ad);break;case"filledDiamond":this.drawDiamond(ab,ae,ac,true,ad);break;case"circle":this.drawCircle(ab,ae,ac,false,ad);break;case"filledCircle":this.drawCircle(ab,ae,ac,true,ad);break;case"square":this.drawSquare(ab,ae,ac,false,ad);break;case"filledSquare":this.drawSquare(ab,ae,ac,true,ad);break;case"x":this.drawX(ab,ae,ac,true,ad);break;case"plus":this.drawPlus(ab,ae,ac,true,ad);break;case"dash":this.drawDash(ab,ae,ac,true,ad);break;case"line":this.drawLine(ab,ae,ac,false,ad);break;default:this.drawDiamond(ab,ae,ac,false,ad);break}}};H.jqplot.ShadowRenderer=function(ab){this.angle=45;this.offset=1;this.alpha=0.07;this.lineWidth=1.5;this.lineJoin="miter";this.lineCap="round";this.closePath=false;this.fill=false;this.depth=3;this.strokeStyle="rgba(0,0,0,0.1)";this.isarc=false;H.extend(true,this,ab)};H.jqplot.ShadowRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.ShadowRenderer.prototype.draw=function(ao,am,aq){ao.save();var ab=(aq!=null)?aq:{};var an=(ab.fill!=null)?ab.fill:this.fill;var aj=(ab.fillRect!=null)?ab.fillRect:this.fillRect;var ai=(ab.closePath!=null)?ab.closePath:this.closePath;var af=(ab.offset!=null)?ab.offset:this.offset;var ad=(ab.alpha!=null)?ab.alpha:this.alpha;var ah=(ab.depth!=null)?ab.depth:this.depth;var ap=(ab.isarc!=null)?ab.isarc:this.isarc;var ak=(ab.linePattern!=null)?ab.linePattern:this.linePattern;ao.lineWidth=(ab.lineWidth!=null)?ab.lineWidth:this.lineWidth;ao.lineJoin=(ab.lineJoin!=null)?ab.lineJoin:this.lineJoin;ao.lineCap=(ab.lineCap!=null)?ab.lineCap:this.lineCap;ao.strokeStyle=ab.strokeStyle||this.strokeStyle||"rgba(0,0,0,"+ad+")";ao.fillStyle=ab.fillStyle||this.fillStyle||"rgba(0,0,0,"+ad+")";for(var ae=0;ae<ah;ae++){var al=H.jqplot.LinePattern(ao,ak);ao.translate(Math.cos(this.angle*Math.PI/180)*af,Math.sin(this.angle*Math.PI/180)*af);al.beginPath();if(ap){ao.arc(am[0],am[1],am[2],am[3],am[4],true)}else{if(aj){if(aj){ao.fillRect(am[0],am[1],am[2],am[3])}}else{if(am&&am.length){var ac=true;for(var ag=0;ag<am.length;ag++){if(am[ag][0]!=null&&am[ag][1]!=null){if(ac){al.moveTo(am[ag][0],am[ag][1]);ac=false}else{al.lineTo(am[ag][0],am[ag][1])}}else{ac=true}}}}}if(ai){al.closePath()}if(an){ao.fill()}else{ao.stroke()}}ao.restore()};H.jqplot.ShapeRenderer=function(ab){this.lineWidth=1.5;this.linePattern="solid";this.lineJoin="miter";this.lineCap="round";this.closePath=false;this.fill=false;this.isarc=false;this.fillRect=false;this.strokeRect=false;this.clearRect=false;this.strokeStyle="#999999";this.fillStyle="#999999";H.extend(true,this,ab)};H.jqplot.ShapeRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.ShapeRenderer.prototype.draw=function(am,ak,ao){am.save();var ab=(ao!=null)?ao:{};var al=(ab.fill!=null)?ab.fill:this.fill;var ag=(ab.closePath!=null)?ab.closePath:this.closePath;var ah=(ab.fillRect!=null)?ab.fillRect:this.fillRect;var ae=(ab.strokeRect!=null)?ab.strokeRect:this.strokeRect;var ac=(ab.clearRect!=null)?ab.clearRect:this.clearRect;var an=(ab.isarc!=null)?ab.isarc:this.isarc;var ai=(ab.linePattern!=null)?ab.linePattern:this.linePattern;var aj=H.jqplot.LinePattern(am,ai);am.lineWidth=ab.lineWidth||this.lineWidth;am.lineJoin=ab.lineJoin||this.lineJoin;am.lineCap=ab.lineCap||this.lineCap;am.strokeStyle=(ab.strokeStyle||ab.color)||this.strokeStyle;am.fillStyle=ab.fillStyle||this.fillStyle;am.beginPath();if(an){am.arc(ak[0],ak[1],ak[2],ak[3],ak[4],true);if(ag){am.closePath()}if(al){am.fill()}else{am.stroke()}am.restore();return}else{if(ac){am.clearRect(ak[0],ak[1],ak[2],ak[3]);am.restore();return}else{if(ah||ae){if(ah){am.fillRect(ak[0],ak[1],ak[2],ak[3])}if(ae){am.strokeRect(ak[0],ak[1],ak[2],ak[3]);am.restore();return}}else{if(ak&&ak.length){var ad=true;for(var af=0;af<ak.length;af++){if(ak[af][0]!=null&&ak[af][1]!=null){if(ad){aj.moveTo(ak[af][0],ak[af][1]);ad=false}else{aj.lineTo(ak[af][0],ak[af][1])}}else{ad=true}}if(ag){aj.closePath()}if(al){am.fill()}else{am.stroke()}}}}}am.restore()};H.jqplot.TableLegendRenderer=function(){};H.jqplot.TableLegendRenderer.prototype.init=function(ab){H.extend(true,this,ab)};H.jqplot.TableLegendRenderer.prototype.addrow=function(ak,ae,ab,ai){var af=(ab)?this.rowSpacing+"px":"0px";var aj;var ad;var ac;var ah;var ag;ac=document.createElement("tr");aj=H(ac);aj.addClass("jqplot-table-legend");ac=null;if(ai){aj.prependTo(this._elem)}else{aj.appendTo(this._elem)}if(this.showSwatches){ad=H(document.createElement("td"));ad.addClass("jqplot-table-legend jqplot-table-legend-swatch");ad.css({textAlign:"center",paddingTop:af});ah=H(document.createElement("div"));ah.addClass("jqplot-table-legend-swatch-outline");ag=H(document.createElement("div"));ag.addClass("jqplot-table-legend-swatch");ag.css({backgroundColor:ae,borderColor:ae});aj.append(ad.append(ah.append(ag)))}if(this.showLabels){ad=H(document.createElement("td"));ad.addClass("jqplot-table-legend jqplot-table-legend-label");ad.css("paddingTop",af);aj.append(ad);if(this.escapeHtml){ad.text(ak)}else{ad.html(ak)}}ad=null;ah=null;ag=null;aj=null;ac=null};H.jqplot.TableLegendRenderer.prototype.draw=function(){if(this._elem){this._elem.emptyForce();this._elem=null}if(this.show){var ag=this._series;var ac=document.createElement("table");this._elem=H(ac);this._elem.addClass("jqplot-table-legend");var al={position:"absolute"};if(this.background){al.background=this.background}if(this.border){al.border=this.border}if(this.fontSize){al.fontSize=this.fontSize}if(this.fontFamily){al.fontFamily=this.fontFamily}if(this.textColor){al.textColor=this.textColor}if(this.marginTop!=null){al.marginTop=this.marginTop}if(this.marginBottom!=null){al.marginBottom=this.marginBottom}if(this.marginLeft!=null){al.marginLeft=this.marginLeft}if(this.marginRight!=null){al.marginRight=this.marginRight}var ab=false,ai=false,ak;for(var ah=0;ah<ag.length;ah++){ak=ag[ah];if(ak._stack||ak.renderer.constructor==H.jqplot.BezierCurveRenderer){ai=true}if(ak.show&&ak.showLabel){var af=this.labels[ah]||ak.label.toString();if(af){var ad=ak.color;if(ai&&ah<ag.length-1){ab=true}else{if(ai&&ah==ag.length-1){ab=false}}this.renderer.addrow.call(this,af,ad,ab,ai);ab=true}for(var ae=0;ae<H.jqplot.addLegendRowHooks.length;ae++){var aj=H.jqplot.addLegendRowHooks[ae].call(this,ak);if(aj){this.renderer.addrow.call(this,aj.label,aj.color,ab);ab=true}}af=null}}}return this._elem};H.jqplot.TableLegendRenderer.prototype.pack=function(ad){if(this.show){if(this.placement=="insideGrid"){switch(this.location){case"nw":var ac=ad.left;var ab=ad.top;this._elem.css("left",ac);this._elem.css("top",ab);break;case"n":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;var ab=ad.top;this._elem.css("left",ac);this._elem.css("top",ab);break;case"ne":var ac=ad.right;var ab=ad.top;this._elem.css({right:ac,top:ab});break;case"e":var ac=ad.right;var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({right:ac,top:ab});break;case"se":var ac=ad.right;var ab=ad.bottom;this._elem.css({right:ac,bottom:ab});break;case"s":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;var ab=ad.bottom;this._elem.css({left:ac,bottom:ab});break;case"sw":var ac=ad.left;var ab=ad.bottom;this._elem.css({left:ac,bottom:ab});break;case"w":var ac=ad.left;var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({left:ac,top:ab});break;default:var ac=ad.right;var ab=ad.bottom;this._elem.css({right:ac,bottom:ab});break}}else{if(this.placement=="outside"){switch(this.location){case"nw":var ac=this._plotDimensions.width-ad.left;var ab=ad.top;this._elem.css("right",ac);this._elem.css("top",ab);break;case"n":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;var ab=this._plotDimensions.height-ad.top;this._elem.css("left",ac);this._elem.css("bottom",ab);break;case"ne":var ac=this._plotDimensions.width-ad.right;var ab=ad.top;this._elem.css({left:ac,top:ab});break;case"e":var ac=this._plotDimensions.width-ad.right;var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({left:ac,top:ab});break;case"se":var ac=this._plotDimensions.width-ad.right;var ab=ad.bottom;this._elem.css({left:ac,bottom:ab});break;case"s":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;var ab=this._plotDimensions.height-ad.bottom;this._elem.css({left:ac,top:ab});break;case"sw":var ac=this._plotDimensions.width-ad.left;var ab=ad.bottom;this._elem.css({right:ac,bottom:ab});break;case"w":var ac=this._plotDimensions.width-ad.left;var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({right:ac,top:ab});break;default:var ac=ad.right;var ab=ad.bottom;this._elem.css({right:ac,bottom:ab});break}}else{switch(this.location){case"nw":this._elem.css({left:0,top:ad.top});break;case"n":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;this._elem.css({left:ac,top:ad.top});break;case"ne":this._elem.css({right:0,top:ad.top});break;case"e":var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({right:ad.right,top:ab});break;case"se":this._elem.css({right:ad.right,bottom:ad.bottom});break;case"s":var ac=(ad.left+(this._plotDimensions.width-ad.right))/2-this.getWidth()/2;this._elem.css({left:ac,bottom:ad.bottom});break;case"sw":this._elem.css({left:ad.left,bottom:ad.bottom});break;case"w":var ab=(ad.top+(this._plotDimensions.height-ad.bottom))/2-this.getHeight()/2;this._elem.css({left:ad.left,top:ab});break;default:this._elem.css({right:ad.right,bottom:ad.bottom});break}}}}};H.jqplot.ThemeEngine=function(){this.themes={};this.activeTheme=null};H.jqplot.ThemeEngine.prototype.init=function(){var ae=new H.jqplot.Theme({_name:"Default"});var ah,ac,ag;for(ah in ae.target){if(ah=="textColor"){ae.target[ah]=this.target.css("color")}else{ae.target[ah]=this.target.css(ah)}}if(this.title.show&&this.title._elem){for(ah in ae.title){if(ah=="textColor"){ae.title[ah]=this.title._elem.css("color")}else{ae.title[ah]=this.title._elem.css(ah)}}}for(ah in ae.grid){ae.grid[ah]=this.grid[ah]}if(ae.grid.backgroundColor==null&&this.grid.background!=null){ae.grid.backgroundColor=this.grid.background}if(this.legend.show&&this.legend._elem){for(ah in ae.legend){if(ah=="textColor"){ae.legend[ah]=this.legend._elem.css("color")}else{ae.legend[ah]=this.legend._elem.css(ah)}}}var ad;for(ac=0;ac<this.series.length;ac++){ad=this.series[ac];if(ad.renderer.constructor==H.jqplot.LineRenderer){ae.series.push(new m())}else{if(ad.renderer.constructor==H.jqplot.BarRenderer){ae.series.push(new P())}else{if(ad.renderer.constructor==H.jqplot.PieRenderer){ae.series.push(new e())}else{if(ad.renderer.constructor==H.jqplot.DonutRenderer){ae.series.push(new C())}else{if(ad.renderer.constructor==H.jqplot.FunnelRenderer){ae.series.push(new U())}else{if(ad.renderer.constructor==H.jqplot.MeterGaugeRenderer){ae.series.push(new z())}else{ae.series.push({})}}}}}}for(ah in ae.series[ac]){ae.series[ac][ah]=ad[ah]}}var ab,af;for(ah in this.axes){af=this.axes[ah];ab=ae.axes[ah]=new L();ab.borderColor=af.borderColor;ab.borderWidth=af.borderWidth;if(af._ticks&&af._ticks[0]){for(ag in ab.ticks){if(af._ticks[0].hasOwnProperty(ag)){ab.ticks[ag]=af._ticks[0][ag]}else{if(af._ticks[0]._elem){ab.ticks[ag]=af._ticks[0]._elem.css(ag)}}}}if(af._label&&af._label.show){for(ag in ab.label){if(af._label[ag]){ab.label[ag]=af._label[ag]}else{if(af._label._elem){if(ag=="textColor"){ab.label[ag]=af._label._elem.css("color")}else{ab.label[ag]=af._label._elem.css(ag)}}}}}}this.themeEngine._add(ae);this.themeEngine.activeTheme=this.themeEngine.themes[ae._name]};H.jqplot.ThemeEngine.prototype.get=function(ab){if(!ab){return this.activeTheme}else{return this.themes[ab]}};function K(ac,ab){return ac-ab}H.jqplot.ThemeEngine.prototype.getThemeNames=function(){var ab=[];for(var ac in this.themes){ab.push(ac)}return ab.sort(K)};H.jqplot.ThemeEngine.prototype.getThemes=function(){var ac=[];var ab=[];for(var ae in this.themes){ac.push(ae)}ac.sort(K);for(var ad=0;ad<ac.length;ad++){ab.push(this.themes[ac[ad]])}return ab};H.jqplot.ThemeEngine.prototype.activate=function(ao,au){var ab=false;if(!au&&this.activeTheme&&this.activeTheme._name){au=this.activeTheme._name}if(!this.themes.hasOwnProperty(au)){throw new Error("No theme of that name")}else{var ag=this.themes[au];this.activeTheme=ag;var at,am=false,al=false;var ac=["xaxis","x2axis","yaxis","y2axis"];for(ap=0;ap<ac.length;ap++){var ah=ac[ap];if(ag.axesStyles.borderColor!=null){ao.axes[ah].borderColor=ag.axesStyles.borderColor}if(ag.axesStyles.borderWidth!=null){ao.axes[ah].borderWidth=ag.axesStyles.borderWidth}}for(var ar in ao.axes){var ae=ao.axes[ar];if(ae.show){var ak=ag.axes[ar]||{};var ai=ag.axesStyles;var af=H.jqplot.extend(true,{},ak,ai);at=(ag.axesStyles.borderColor!=null)?ag.axesStyles.borderColor:af.borderColor;if(af.borderColor!=null){ae.borderColor=af.borderColor;ab=true}at=(ag.axesStyles.borderWidth!=null)?ag.axesStyles.borderWidth:af.borderWidth;if(af.borderWidth!=null){ae.borderWidth=af.borderWidth;ab=true}if(ae._ticks&&ae._ticks[0]){for(var ad in af.ticks){at=af.ticks[ad];if(at!=null){ae.tickOptions[ad]=at;ae._ticks=[];ab=true}}}if(ae._label&&ae._label.show){for(var ad in af.label){at=af.label[ad];if(at!=null){ae.labelOptions[ad]=at;ab=true}}}}}for(var an in ag.grid){if(ag.grid[an]!=null){ao.grid[an]=ag.grid[an]}}if(!ab){ao.grid.draw()}if(ao.legend.show){for(an in ag.legend){if(ag.legend[an]!=null){ao.legend[an]=ag.legend[an]}}}if(ao.title.show){for(an in ag.title){if(ag.title[an]!=null){ao.title[an]=ag.title[an]}}}var ap;for(ap=0;ap<ag.series.length;ap++){var aj={};var aq=false;for(an in ag.series[ap]){at=(ag.seriesStyles[an]!=null)?ag.seriesStyles[an]:ag.series[ap][an];if(at!=null){aj[an]=at;if(an=="color"){ao.series[ap].renderer.shapeRenderer.fillStyle=at;ao.series[ap].renderer.shapeRenderer.strokeStyle=at;ao.series[ap][an]=at}else{if((an=="lineWidth")||(an=="linePattern")){ao.series[ap].renderer.shapeRenderer[an]=at;ao.series[ap][an]=at}else{if(an=="markerOptions"){R(ao.series[ap].markerOptions,at);R(ao.series[ap].markerRenderer,at)}else{ao.series[ap][an]=at}}}ab=true}}}if(ab){ao.target.empty();ao.draw()}for(an in ag.target){if(ag.target[an]!=null){ao.target.css(an,ag.target[an])}}}};H.jqplot.ThemeEngine.prototype._add=function(ac,ab){if(ab){ac._name=ab}if(!ac._name){ac._name=Date.parse(new Date())}if(!this.themes.hasOwnProperty(ac._name)){this.themes[ac._name]=ac}else{throw new Error("jqplot.ThemeEngine Error: Theme already in use")}};H.jqplot.ThemeEngine.prototype.remove=function(ab){if(ab=="Default"){return false}return delete this.themes[ab]};H.jqplot.ThemeEngine.prototype.newTheme=function(ab,ad){if(typeof(ab)=="object"){ad=ad||ab;ab=null}if(ad&&ad._name){ab=ad._name}else{ab=ab||Date.parse(new Date())}var ac=this.copy(this.themes.Default._name,ab);H.jqplot.extend(ac,ad);return ac};function x(ad){if(ad==null||typeof(ad)!="object"){return ad}var ab=new ad.constructor();for(var ac in ad){ab[ac]=x(ad[ac])}return ab}H.jqplot.clone=x;function R(ad,ac){if(ac==null||typeof(ac)!="object"){return}for(var ab in ac){if(ab=="highlightColors"){ad[ab]=x(ac[ab])}if(ac[ab]!=null&&typeof(ac[ab])=="object"){if(!ad.hasOwnProperty(ab)){ad[ab]={}}R(ad[ab],ac[ab])}else{ad[ab]=ac[ab]}}}H.jqplot.merge=R;H.jqplot.extend=function(){var ag=arguments[0]||{},ae=1,af=arguments.length,ab=false,ad;if(typeof ag==="boolean"){ab=ag;ag=arguments[1]||{};ae=2}if(typeof ag!=="object"&&!toString.call(ag)==="[object Function]"){ag={}}for(;ae<af;ae++){if((ad=arguments[ae])!=null){for(var ac in ad){var ah=ag[ac],ai=ad[ac];if(ag===ai){continue}if(ab&&ai&&typeof ai==="object"&&!ai.nodeType){ag[ac]=H.jqplot.extend(ab,ah||(ai.length!=null?[]:{}),ai)}else{if(ai!==r){ag[ac]=ai}}}}}return ag};H.jqplot.ThemeEngine.prototype.rename=function(ac,ab){if(ac=="Default"||ab=="Default"){throw new Error("jqplot.ThemeEngine Error: Cannot rename from/to Default")}if(this.themes.hasOwnProperty(ab)){throw new Error("jqplot.ThemeEngine Error: New name already in use.")}else{if(this.themes.hasOwnProperty(ac)){var ad=this.copy(ac,ab);this.remove(ac);return ad}}throw new Error("jqplot.ThemeEngine Error: Old name or new name invalid")};H.jqplot.ThemeEngine.prototype.copy=function(ab,ad,af){if(ad=="Default"){throw new Error("jqplot.ThemeEngine Error: Cannot copy over Default theme")}if(!this.themes.hasOwnProperty(ab)){var ac="jqplot.ThemeEngine Error: Source name invalid";throw new Error(ac)}if(this.themes.hasOwnProperty(ad)){var ac="jqplot.ThemeEngine Error: Target name invalid";throw new Error(ac)}else{var ae=x(this.themes[ab]);ae._name=ad;H.jqplot.extend(true,ae,af);this._add(ae);return ae}};H.jqplot.Theme=function(ab,ac){if(typeof(ab)=="object"){ac=ac||ab;ab=null}ab=ab||Date.parse(new Date());this._name=ab;this.target={backgroundColor:null};this.legend={textColor:null,fontFamily:null,fontSize:null,border:null,background:null};this.title={textColor:null,fontFamily:null,fontSize:null,textAlign:null};this.seriesStyles={};this.series=[];this.grid={drawGridlines:null,gridLineColor:null,gridLineWidth:null,backgroundColor:null,borderColor:null,borderWidth:null,shadow:null};this.axesStyles={label:{},ticks:{}};this.axes={};if(typeof(ac)=="string"){this._name=ac}else{if(typeof(ac)=="object"){H.jqplot.extend(true,this,ac)}}};var L=function(){this.borderColor=null;this.borderWidth=null;this.ticks=new l();this.label=new q()};var l=function(){this.show=null;this.showGridline=null;this.showLabel=null;this.showMark=null;this.size=null;this.textColor=null;this.whiteSpace=null;this.fontSize=null;this.fontFamily=null};var q=function(){this.textColor=null;this.whiteSpace=null;this.fontSize=null;this.fontFamily=null;this.fontWeight=null};var m=function(){this.color=null;this.lineWidth=null;this.linePattern=null;this.shadow=null;this.fillColor=null;this.showMarker=null;this.markerOptions=new E()};var E=function(){this.show=null;this.style=null;this.lineWidth=null;this.size=null;this.color=null;this.shadow=null};var P=function(){this.color=null;this.seriesColors=null;this.lineWidth=null;this.shadow=null;this.barPadding=null;this.barMargin=null;this.barWidth=null;this.highlightColors=null};var e=function(){this.seriesColors=null;this.padding=null;this.sliceMargin=null;this.fill=null;this.shadow=null;this.startAngle=null;this.lineWidth=null;this.highlightColors=null};var C=function(){this.seriesColors=null;this.padding=null;this.sliceMargin=null;this.fill=null;this.shadow=null;this.startAngle=null;this.lineWidth=null;this.innerDiameter=null;this.thickness=null;this.ringMargin=null;this.highlightColors=null};var U=function(){this.color=null;this.lineWidth=null;this.shadow=null;this.padding=null;this.sectionMargin=null;this.seriesColors=null;this.highlightColors=null};var z=function(){this.padding=null;this.backgroundColor=null;this.ringColor=null;this.tickColor=null;this.ringWidth=null;this.intervalColors=null;this.intervalInnerRadius=null;this.intervalOuterRadius=null;this.hubRadius=null;this.needleThickness=null;this.needlePad=null};H.fn.jqplotChildText=function(){return H(this).contents().filter(function(){return this.nodeType==3}).text()};H.fn.jqplotGetComputedFontStyle=function(){var ae=window.getComputedStyle?window.getComputedStyle(this[0],""):this[0].currentStyle;var ac=ae["font-style"]?["font-style","font-weight","font-size","font-family"]:["fontStyle","fontWeight","fontSize","fontFamily"];var af=[];for(var ad=0;ad<ac.length;++ad){var ab=String(ae[ac[ad]]);if(ab&&ab!="normal"){af.push(ab)}}return af.join(" ")};H.fn.jqplotToImageCanvas=function(ad){ad=ad||{};var ao=(ad.x_offset==null)?0:ad.x_offset;var aq=(ad.y_offset==null)?0:ad.y_offset;var af=(ad.backgroundColor==null)?"rgb(255,255,255)":ad.backgroundColor;if(H(this).width()==0||H(this).height()==0){return null}if(H.jqplot.use_excanvas){return null}var ah=document.createElement("canvas");var au=H(this).outerHeight(true);var am=H(this).outerWidth(true);var ag=H(this).offset();var ai=ag.left;var ak=ag.top;var an=0,al=0;var ar=["jqplot-table-legend","jqplot-xaxis-tick","jqplot-x2axis-tick","jqplot-yaxis-tick","jqplot-y2axis-tick","jqplot-y3axis-tick","jqplot-y4axis-tick","jqplot-y5axis-tick","jqplot-y6axis-tick","jqplot-y7axis-tick","jqplot-y8axis-tick","jqplot-y9axis-tick","jqplot-xaxis-label","jqplot-x2axis-label","jqplot-yaxis-label","jqplot-y2axis-label","jqplot-y3axis-label","jqplot-y4axis-label","jqplot-y5axis-label","jqplot-y6axis-label","jqplot-y7axis-label","jqplot-y8axis-label","jqplot-y9axis-label"];var aj,ab,ac,av;for(var at=0;at<ar.length;at++){H(this).find("."+ar[at]).each(function(){aj=H(this).offset().top-ak;ab=H(this).offset().left-ai;av=ab+H(this).outerWidth(true)+an;ac=aj+H(this).outerHeight(true)+al;if(ab<-an){am=am-an-ab;an=-ab}if(aj<-al){au=au-al-aj;al=-aj}if(av>am){am=av}if(ac>au){au=ac}})}ah.width=am+Number(ao);ah.height=au+Number(aq);var ae=ah.getContext("2d");ae.save();ae.fillStyle=af;ae.fillRect(0,0,ah.width,ah.height);ae.restore();ae.translate(an,al);ae.textAlign="left";ae.textBaseline="top";function aw(ay){var az=parseInt(H(ay).css("line-height"),10);if(isNaN(az)){az=parseInt(H(ay).css("font-size"),10)*1.2}return az}function ax(az,ay,aM,aA,aI,aB){var aK=aw(az);var aE=H(az).innerWidth();var aF=H(az).innerHeight();var aH=aM.split(/\s+/);var aL=aH.length;var aJ="";var aG=[];var aO=aI;var aN=aA;for(var aD=0;aD<aL;aD++){aJ+=aH[aD];if(ay.measureText(aJ).width>aE){aG.push(aD);aJ="";aD--}}if(aG.length===0){if(H(az).css("textAlign")==="center"){aN=aA+(aB-ay.measureText(aJ).width)/2-an}ay.fillText(aM,aN,aI)}else{aJ=aH.slice(0,aG[0]).join(" ");if(H(az).css("textAlign")==="center"){aN=aA+(aB-ay.measureText(aJ).width)/2-an}ay.fillText(aJ,aN,aO);aO+=aK;for(var aD=1,aC=aG.length;aD<aC;aD++){aJ=aH.slice(aG[aD-1],aG[aD]).join(" ");if(H(az).css("textAlign")==="center"){aN=aA+(aB-ay.measureText(aJ).width)/2-an}ay.fillText(aJ,aN,aO);aO+=aK}aJ=aH.slice(aG[aD-1],aH.length).join(" ");if(H(az).css("textAlign")==="center"){aN=aA+(aB-ay.measureText(aJ).width)/2-an}ay.fillText(aJ,aN,aO)}}function ap(aA,aD,ay){var aH=aA.tagName.toLowerCase();var az=H(aA).position();var aE=window.getComputedStyle?window.getComputedStyle(aA,""):aA.currentStyle;var aC=aD+az.left+parseInt(aE.marginLeft,10)+parseInt(aE.borderLeftWidth,10)+parseInt(aE.paddingLeft,10);var aF=ay+az.top+parseInt(aE.marginTop,10)+parseInt(aE.borderTopWidth,10)+parseInt(aE.paddingTop,10);var aG=ah.width;if((aH=="div"||aH=="span")&&!H(aA).hasClass("jqplot-highlighter-tooltip")){H(aA).children().each(function(){ap(this,aC,aF)});var aI=H(aA).jqplotChildText();if(aI){ae.font=H(aA).jqplotGetComputedFontStyle();ae.fillStyle=H(aA).css("color");ax(aA,ae,aI,aC,aF,aG)}}else{if(aH==="table"&&H(aA).hasClass("jqplot-table-legend")){ae.strokeStyle=H(aA).css("border-top-color");ae.fillStyle=H(aA).css("background-color");ae.fillRect(aC,aF,H(aA).innerWidth(),H(aA).innerHeight());if(parseInt(H(aA).css("border-top-width"),10)>0){ae.strokeRect(aC,aF,H(aA).innerWidth(),H(aA).innerHeight())}H(aA).find("div.jqplot-table-legend-swatch-outline").each(function(){var aO=H(this);ae.strokeStyle=aO.css("border-top-color");var aK=aC+aO.position().left;var aL=aF+aO.position().top;ae.strokeRect(aK,aL,aO.innerWidth(),aO.innerHeight());aK+=parseInt(aO.css("padding-left"),10);aL+=parseInt(aO.css("padding-top"),10);var aN=aO.innerHeight()-2*parseInt(aO.css("padding-top"),10);var aJ=aO.innerWidth()-2*parseInt(aO.css("padding-left"),10);var aM=aO.children("div.jqplot-table-legend-swatch");ae.fillStyle=aM.css("background-color");ae.fillRect(aK,aL,aJ,aN)});H(aA).find("td.jqplot-table-legend-label").each(function(){var aL=H(this);var aJ=aC+aL.position().left;var aK=aF+aL.position().top+parseInt(aL.css("padding-top"),10);ae.font=aL.jqplotGetComputedFontStyle();ae.fillStyle=aL.css("color");ax(aL,ae,aL.text(),aJ,aK,aG)});var aB=null}else{if(aH=="canvas"){ae.drawImage(aA,aC,aF)}}}}H(this).children().each(function(){ap(this,ao,aq)});return ah};H.fn.jqplotToImageStr=function(ac){var ab=H(this).jqplotToImageCanvas(ac);if(ab){return ab.toDataURL("image/png")}else{return null}};H.fn.jqplotToImageElem=function(ab){var ac=document.createElement("img");var ad=H(this).jqplotToImageStr(ab);ac.src=ad;return ac};H.fn.jqplotToImageElemStr=function(ab){var ac="<img src="+H(this).jqplotToImageStr(ab)+" />";return ac};H.fn.jqplotSaveImage=function(){var ab=H(this).jqplotToImageStr({});if(ab){window.location.href=ab.replace("image/png","image/octet-stream")}};H.fn.jqplotViewImage=function(){var ac=H(this).jqplotToImageElemStr({});var ad=H(this).jqplotToImageStr({});if(ac){var ab=window.open("");ab.document.open("image/png");ab.document.write(ac);ab.document.close();ab=null}};var aa=function(){this.syntax=aa.config.syntax;this._type="jsDate";this.proxy=new Date();this.options={};this.locale=aa.regional.getLocale();this.formatString="";this.defaultCentury=aa.config.defaultCentury;switch(arguments.length){case 0:break;case 1:if(j(arguments[0])=="[object Object]"&&arguments[0]._type!="jsDate"){var ad=this.options=arguments[0];this.syntax=ad.syntax||this.syntax;this.defaultCentury=ad.defaultCentury||this.defaultCentury;this.proxy=aa.createDate(ad.date)}else{this.proxy=aa.createDate(arguments[0])}break;default:var ab=[];for(var ac=0;ac<arguments.length;ac++){ab.push(arguments[ac])}this.proxy=new Date();this.proxy.setFullYear.apply(this.proxy,ab.slice(0,3));if(ab.slice(3).length){this.proxy.setHours.apply(this.proxy,ab.slice(3))}break}};aa.config={defaultLocale:"en",syntax:"perl",defaultCentury:1900};aa.prototype.add=function(ad,ac){var ab=A[ac]||A.day;if(typeof ab=="number"){this.proxy.setTime(this.proxy.getTime()+(ab*ad))}else{ab.add(this,ad)}return this};aa.prototype.clone=function(){return new aa(this.proxy.getTime())};aa.prototype.getUtcOffset=function(){return this.proxy.getTimezoneOffset()*60000};aa.prototype.diff=function(ac,af,ab){ac=new aa(ac);if(ac===null){return null}var ad=A[af]||A.day;if(typeof ad=="number"){var ae=(this.proxy.getTime()-ac.proxy.getTime())/ad}else{var ae=ad.diff(this.proxy,ac.proxy)}return(ab?ae:Math[ae>0?"floor":"ceil"](ae))};aa.prototype.getAbbrDayName=function(){return aa.regional[this.locale]["dayNamesShort"][this.proxy.getDay()]};aa.prototype.getAbbrMonthName=function(){return aa.regional[this.locale]["monthNamesShort"][this.proxy.getMonth()]};aa.prototype.getAMPM=function(){return this.proxy.getHours()>=12?"PM":"AM"};aa.prototype.getAmPm=function(){return this.proxy.getHours()>=12?"pm":"am"};aa.prototype.getCentury=function(){return parseInt(this.proxy.getFullYear()/100,10)};aa.prototype.getDate=function(){return this.proxy.getDate()};aa.prototype.getDay=function(){return this.proxy.getDay()};aa.prototype.getDayOfWeek=function(){var ab=this.proxy.getDay();return ab===0?7:ab};aa.prototype.getDayOfYear=function(){var ac=this.proxy;var ab=ac-new Date(""+ac.getFullYear()+"/1/1 GMT");ab+=ac.getTimezoneOffset()*60000;ac=null;return parseInt(ab/60000/60/24,10)+1};aa.prototype.getDayName=function(){return aa.regional[this.locale]["dayNames"][this.proxy.getDay()]};aa.prototype.getFullWeekOfYear=function(){var ae=this.proxy;var ab=this.getDayOfYear();var ad=6-ae.getDay();var ac=parseInt((ab+ad)/7,10);return ac};aa.prototype.getFullYear=function(){return this.proxy.getFullYear()};aa.prototype.getGmtOffset=function(){var ab=this.proxy.getTimezoneOffset()/60;var ac=ab<0?"+":"-";ab=Math.abs(ab);return ac+J(Math.floor(ab),2)+":"+J((ab%1)*60,2)};aa.prototype.getHours=function(){return this.proxy.getHours()};aa.prototype.getHours12=function(){var ab=this.proxy.getHours();return ab>12?ab-12:(ab==0?12:ab)};aa.prototype.getIsoWeek=function(){var ae=this.proxy;var ad=ae.getWeekOfYear();var ab=(new Date(""+ae.getFullYear()+"/1/1")).getDay();var ac=ad+(ab>4||ab<=1?0:1);if(ac==53&&(new Date(""+ae.getFullYear()+"/12/31")).getDay()<4){ac=1}else{if(ac===0){ae=new aa(new Date(""+(ae.getFullYear()-1)+"/12/31"));ac=ae.getIsoWeek()}}ae=null;return ac};aa.prototype.getMilliseconds=function(){return this.proxy.getMilliseconds()};aa.prototype.getMinutes=function(){return this.proxy.getMinutes()};aa.prototype.getMonth=function(){return this.proxy.getMonth()};aa.prototype.getMonthName=function(){return aa.regional[this.locale]["monthNames"][this.proxy.getMonth()]};aa.prototype.getMonthNumber=function(){return this.proxy.getMonth()+1};aa.prototype.getSeconds=function(){return this.proxy.getSeconds()};aa.prototype.getShortYear=function(){return this.proxy.getYear()%100};aa.prototype.getTime=function(){return this.proxy.getTime()};aa.prototype.getTimezoneAbbr=function(){return this.proxy.toString().replace(/^.*\(([^)]+)\)$/,"$1")};aa.prototype.getTimezoneName=function(){var ab=/(?:\((.+)\)$| ([A-Z]{3}) )/.exec(this.toString());return ab[1]||ab[2]||"GMT"+this.getGmtOffset()};aa.prototype.getTimezoneOffset=function(){return this.proxy.getTimezoneOffset()};aa.prototype.getWeekOfYear=function(){var ab=this.getDayOfYear();var ad=7-this.getDayOfWeek();var ac=parseInt((ab+ad)/7,10);return ac};aa.prototype.getUnix=function(){return Math.round(this.proxy.getTime()/1000,0)};aa.prototype.getYear=function(){return this.proxy.getYear()};aa.prototype.next=function(ab){ab=ab||"day";return this.clone().add(1,ab)};aa.prototype.set=function(){switch(arguments.length){case 0:this.proxy=new Date();break;case 1:if(j(arguments[0])=="[object Object]"&&arguments[0]._type!="jsDate"){var ad=this.options=arguments[0];this.syntax=ad.syntax||this.syntax;this.defaultCentury=ad.defaultCentury||this.defaultCentury;this.proxy=aa.createDate(ad.date)}else{this.proxy=aa.createDate(arguments[0])}break;default:var ab=[];for(var ac=0;ac<arguments.length;ac++){ab.push(arguments[ac])}this.proxy=new Date();this.proxy.setFullYear.apply(this.proxy,ab.slice(0,3));if(ab.slice(3).length){this.proxy.setHours.apply(this.proxy,ab.slice(3))}break}return this};aa.prototype.setDate=function(ab){this.proxy.setDate(ab);return this};aa.prototype.setFullYear=function(){this.proxy.setFullYear.apply(this.proxy,arguments);return this};aa.prototype.setHours=function(){this.proxy.setHours.apply(this.proxy,arguments);return this};aa.prototype.setMilliseconds=function(ab){this.proxy.setMilliseconds(ab);return this};aa.prototype.setMinutes=function(){this.proxy.setMinutes.apply(this.proxy,arguments);return this};aa.prototype.setMonth=function(){this.proxy.setMonth.apply(this.proxy,arguments);return this};aa.prototype.setSeconds=function(){this.proxy.setSeconds.apply(this.proxy,arguments);return this};aa.prototype.setTime=function(ab){this.proxy.setTime(ab);return this};aa.prototype.setYear=function(){this.proxy.setYear.apply(this.proxy,arguments);return this};aa.prototype.strftime=function(ab){ab=ab||this.formatString||aa.regional[this.locale]["formatString"];return aa.strftime(this,ab,this.syntax)};aa.prototype.toString=function(){return this.proxy.toString()};aa.prototype.toYmdInt=function(){return(this.proxy.getFullYear()*10000)+(this.getMonthNumber()*100)+this.proxy.getDate()};aa.regional={en:{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],formatString:"%Y-%m-%d %H:%M:%S"},fr:{monthNames:["Janvier","FÃ©vrier","Mars","Avril","Mai","Juin","Juillet","AoÃ»t","Septembre","Octobre","Novembre","DÃ©cembre"],monthNamesShort:["Jan","FÃ©v","Mar","Avr","Mai","Jun","Jul","AoÃ»","Sep","Oct","Nov","DÃ©c"],dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],formatString:"%Y-%m-%d %H:%M:%S"},de:{monthNames:["Januar","Februar","MÃ¤rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthNamesShort:["Jan","Feb","MÃ¤r","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],dayNames:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],dayNamesShort:["So","Mo","Di","Mi","Do","Fr","Sa"],formatString:"%Y-%m-%d %H:%M:%S"},es:{monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dayNames:["Domingo","Lunes","Martes","Mi&eacute;rcoles","Jueves","Viernes","S&aacute;bado"],dayNamesShort:["Dom","Lun","Mar","Mi&eacute;","Juv","Vie","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},ru:{monthNames:["Ð¯Ð½Ð²Ð°ÑÑ","Ð¤ÐµÐ²ÑÐ°Ð»Ñ","ÐÐ°ÑÑ","Ð?Ð¿ÑÐµÐ»Ñ","ÐÐ°Ð¹","ÐÑÐ½Ñ","ÐÑÐ»Ñ","Ð?Ð²Ð³ÑÑ?Ñ","Ð¡ÐµÐ½ÑÑ?Ð±ÑÑ","ÐÐºÑÑ?Ð±ÑÑ","Ð?Ð¾Ñ?Ð±ÑÑ","ÐÐµÐºÐ°Ð±ÑÑ"],monthNamesShort:["Ð¯Ð½Ð²","Ð¤ÐµÐ²","ÐÐ°Ñ","Ð?Ð¿Ñ","ÐÐ°Ð¹","ÐÑÐ½","ÐÑÐ»","Ð?Ð²Ð³","Ð¡ÐµÐ½","ÐÐºÑ","Ð?Ð¾Ñ?","ÐÐµÐº"],dayNames:["Ð²Ð¾Ñ?ÐºÑÐµÑ?ÐµÐ½ÑÐµ","Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»ÑÐ½Ð¸Ðº","Ð²ÑÐ¾ÑÐ½Ð¸Ðº","Ñ?ÑÐµÐ´Ð°","ÑÐµÑÐ²ÐµÑÐ³","Ð¿Ñ?ÑÐ½Ð¸ÑÐ°","Ñ?ÑÐ±Ð±Ð¾ÑÐ°"],dayNamesShort:["Ð²Ñ?Ðº","Ð¿Ð½Ð´","Ð²ÑÑ","Ñ?ÑÐ´","ÑÑÐ²","Ð¿ÑÐ½","Ñ?Ð±Ñ"],formatString:"%Y-%m-%d %H:%M:%S"},ar:{monthNames:["ÙØ§ÙÙÙ Ø§ÙØ«Ø§ÙÙ","Ø´Ø¨Ø§Ø·","Ø¢Ø°Ø§Ø±","ÙÙØ³Ø§Ù","Ø¢Ø°Ø§Ø±","Ø­Ø²ÙØ±Ø§Ù","ØªÙÙØ²","Ø¢Ø¨","Ø£ÙÙÙÙ","ØªØ´Ø±ÙÙ Ø§ÙØ£ÙÙ","ØªØ´Ø±ÙÙ Ø§ÙØ«Ø§ÙÙ","ÙØ§ÙÙÙ Ø§ÙØ£ÙÙ"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["Ø§ÙØ³Ø¨Øª","Ø§ÙØ£Ø­Ø¯","Ø§ÙØ§Ø«ÙÙÙ","Ø§ÙØ«ÙØ§Ø«Ø§Ø¡","Ø§ÙØ£Ø±Ø¨Ø¹Ø§Ø¡","Ø§ÙØ®ÙÙØ³","Ø§ÙØ¬ÙØ¹Ø©"],dayNamesShort:["Ø³Ø¨Øª","Ø£Ø­Ø¯","Ø§Ø«ÙÙÙ","Ø«ÙØ§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®ÙÙØ³","Ø¬ÙØ¹Ø©"],formatString:"%Y-%m-%d %H:%M:%S"},pt:{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"},"pt-BR":{monthNames:["Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Ter&ccedil;a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S&aacute;bado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","S&aacute;b"],formatString:"%Y-%m-%d %H:%M:%S"}};aa.regional["en-US"]=aa.regional["en-GB"]=aa.regional.en;aa.regional.getLocale=function(){var ab=aa.config.defaultLocale;if(document&&document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang){ab=document.getElementsByTagName("html")[0].lang;if(!aa.regional.hasOwnProperty(ab)){ab=aa.config.defaultLocale}}return ab};var y=24*60*60*1000;var J=function(ab,ae){ab=String(ab);var ac=ae-ab.length;var ad=String(Math.pow(10,ac)).slice(1);return ad.concat(ab)};var A={millisecond:1,second:1000,minute:60*1000,hour:60*60*1000,day:y,week:7*y,month:{add:function(ad,ab){A.year.add(ad,Math[ab>0?"floor":"ceil"](ab/12));var ac=ad.getMonth()+(ab%12);if(ac==12){ac=0;ad.setYear(ad.getFullYear()+1)}else{if(ac==-1){ac=11;ad.setYear(ad.getFullYear()-1)}}ad.setMonth(ac)},diff:function(af,ad){var ab=af.getFullYear()-ad.getFullYear();var ac=af.getMonth()-ad.getMonth()+(ab*12);var ae=af.getDate()-ad.getDate();return ac+(ae/30)}},year:{add:function(ac,ab){ac.setYear(ac.getFullYear()+Math[ab>0?"floor":"ceil"](ab))},diff:function(ac,ab){return A.month.diff(ac,ab)/12}}};for(var T in A){if(T.substring(T.length-1)!="s"){A[T+"s"]=A[T]}}var D=function(af,ae,ac){if(aa.formats[ac]["shortcuts"][ae]){return aa.strftime(af,aa.formats[ac]["shortcuts"][ae],ac)}else{var ab=(aa.formats[ac]["codes"][ae]||"").split(".");var ad=af["get"+ab[0]]?af["get"+ab[0]]():"";if(ab[1]){ad=J(ad,ab[1])}return ad}};aa.strftime=function(ah,ae,ad,ai){var ac="perl";var ag=aa.regional.getLocale();if(ad&&aa.formats.hasOwnProperty(ad)){ac=ad}else{if(ad&&aa.regional.hasOwnProperty(ad)){ag=ad}}if(ai&&aa.formats.hasOwnProperty(ai)){ac=ai}else{if(ai&&aa.regional.hasOwnProperty(ai)){ag=ai}}if(j(ah)!="[object Object]"||ah._type!="jsDate"){ah=new aa(ah);ah.locale=ag}if(!ae){ae=ah.formatString||aa.regional[ag]["formatString"]}var ab=ae||"%Y-%m-%d",aj="",af;while(ab.length>0){if(af=ab.match(aa.formats[ac].codes.matcher)){aj+=ab.slice(0,af.index);aj+=(af[1]||"")+D(ah,af[2],ac);ab=ab.slice(af.index+af[0].length)}else{aj+=ab;ab=""}}return aj};aa.formats={ISO:"%Y-%m-%dT%H:%M:%S.%N%G",SQL:"%Y-%m-%d %H:%M:%S"};aa.formats.perl={codes:{matcher:/()%(#?(%|[a-z]))/i,Y:"FullYear",y:"ShortYear.2",m:"MonthNumber.2","#m":"MonthNumber",B:"MonthName",b:"AbbrMonthName",d:"Date.2","#d":"Date",e:"Date",A:"DayName",a:"AbbrDayName",w:"Day",H:"Hours.2","#H":"Hours",I:"Hours12.2","#I":"Hours12",p:"AMPM",M:"Minutes.2","#M":"Minutes",S:"Seconds.2","#S":"Seconds",s:"Unix",N:"Milliseconds.3","#N":"Milliseconds",O:"TimezoneOffset",Z:"TimezoneName",G:"GmtOffset"},shortcuts:{F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",D:"%m/%d/%y","#c":"%a %b %e %H:%M:%S %Y",v:"%e-%b-%Y",R:"%H:%M",r:"%I:%M:%S %p",t:"\t",n:"\n","%":"%"}};aa.formats.php={codes:{matcher:/()%((%|[a-z]))/i,a:"AbbrDayName",A:"DayName",d:"Date.2",e:"Date",j:"DayOfYear.3",u:"DayOfWeek",w:"Day",U:"FullWeekOfYear.2",V:"IsoWeek.2",W:"WeekOfYear.2",b:"AbbrMonthName",B:"MonthName",m:"MonthNumber.2",h:"AbbrMonthName",C:"Century.2",y:"ShortYear.2",Y:"FullYear",H:"Hours.2",I:"Hours12.2",l:"Hours12",p:"AMPM",P:"AmPm",M:"Minutes.2",S:"Seconds.2",s:"Unix",O:"TimezoneOffset",z:"GmtOffset",Z:"TimezoneAbbr"},shortcuts:{D:"%m/%d/%y",F:"%Y-%m-%d",T:"%H:%M:%S",X:"%H:%M:%S",x:"%m/%d/%y",R:"%H:%M",r:"%I:%M:%S %p",t:"\t",n:"\n","%":"%"}};aa.createDate=function(ad){if(ad==null){return new Date()}if(ad instanceof Date){return ad}if(typeof ad=="number"){return new Date(ad)}var ai=String(ad).replace(/^\s*(.+)\s*$/g,"$1");ai=ai.replace(/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,4})/,"$1/$2/$3");ai=ai.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{4})/i,"$1 $2 $3");var ah=ai.match(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i);if(ah&&ah.length>3){var am=parseFloat(ah[3]);var ag=aa.config.defaultCentury+am;ag=String(ag);ai=ai.replace(/^(3[01]|[0-2]?\d)[-\/]([a-z]{3,})[-\/](\d{2})\D*/i,ah[1]+" "+ah[2]+" "+ag)}ah=ai.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})[^0-9]/);function al(aq,ap){var aw=parseFloat(ap[1]);var av=parseFloat(ap[2]);var au=parseFloat(ap[3]);var at=aa.config.defaultCentury;var ao,an,ax,ar;if(aw>31){an=au;ax=av;ao=at+aw}else{an=av;ax=aw;ao=at+au}ar=ax+"/"+an+"/"+ao;return aq.replace(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})/,ar)}if(ah&&ah.length>3){ai=al(ai,ah)}var ah=ai.match(/^([0-9]{1,2})[-\/]([0-9]{1,2})[-\/]([0-9]{1,2})$/);if(ah&&ah.length>3){ai=al(ai,ah)}var af=0;var ac=aa.matchers.length;var ak,ab,aj=ai,ae;while(af<ac){ab=Date.parse(aj);if(!isNaN(ab)){return new Date(ab)}ak=aa.matchers[af];if(typeof ak=="function"){ae=ak.call(aa,aj);if(ae instanceof Date){return ae}}else{aj=ai.replace(ak[0],ak[1])}af++}return NaN};aa.daysInMonth=function(ab,ac){if(ac==2){return new Date(ab,1,29).getDate()==29?29:28}return[r,31,r,31,30,31,30,31,31,30,31,30,31][ac]};aa.matchers=[[/(3[01]|[0-2]\d)\s*\.\s*(1[0-2]|0\d)\s*\.\s*([1-9]\d{3})/,"$2/$1/$3"],[/([1-9]\d{3})\s*-\s*(1[0-2]|0\d)\s*-\s*(3[01]|[0-2]\d)/,"$2/$3/$1"],function(ae){var ac=ae.match(/^(?:(.+)\s+)?([012]?\d)(?:\s*\:\s*(\d\d))?(?:\s*\:\s*(\d\d(\.\d*)?))?\s*(am|pm)?\s*$/i);if(ac){if(ac[1]){var ad=this.createDate(ac[1]);if(isNaN(ad)){return}}else{var ad=new Date();ad.setMilliseconds(0)}var ab=parseFloat(ac[2]);if(ac[6]){ab=ac[6].toLowerCase()=="am"?(ab==12?0:ab):(ab==12?12:ab+12)}ad.setHours(ab,parseInt(ac[3]||0,10),parseInt(ac[4]||0,10),((parseFloat(ac[5]||0))||0)*1000);return ad}else{return ae}},function(ae){var ac=ae.match(/^(?:(.+))[T|\s+]([012]\d)(?:\:(\d\d))(?:\:(\d\d))(?:\.\d+)([\+\-]\d\d\:\d\d)$/i);if(ac){if(ac[1]){var ad=this.createDate(ac[1]);if(isNaN(ad)){return}}else{var ad=new Date();ad.setMilliseconds(0)}var ab=parseFloat(ac[2]);ad.setHours(ab,parseInt(ac[3],10),parseInt(ac[4],10),parseFloat(ac[5])*1000);return ad}else{return ae}},function(af){var ad=af.match(/^([0-3]?\d)\s*[-\/.\s]{1}\s*([a-zA-Z]{3,9})\s*[-\/.\s]{1}\s*([0-3]?\d)$/);if(ad){var ae=new Date();var ag=aa.config.defaultCentury;var ai=parseFloat(ad[1]);var ah=parseFloat(ad[3]);var ac,ab,aj;if(ai>31){ab=ah;ac=ag+ai}else{ab=ai;ac=ag+ah}var aj=W(ad[2],aa.regional[aa.regional.getLocale()]["monthNamesShort"]);if(aj==-1){aj=W(ad[2],aa.regional[aa.regional.getLocale()]["monthNames"])}ae.setFullYear(ac,aj,ab);ae.setHours(0,0,0,0);return ae}else{return af}}];function W(ad,ae){if(ae.indexOf){return ae.indexOf(ad)}for(var ab=0,ac=ae.length;ab<ac;ab++){if(ae[ab]===ad){return ab}}return -1}function j(ab){if(ab===null){return"[object Null]"}return Object.prototype.toString.call(ab)}H.jsDate=aa;H.jqplot.sprintf=function(){function ah(an,aj,ak,am){var al=(an.length>=aj)?"":Array(1+aj-an.length>>>0).join(ak);return am?an+al:al+an}function ae(al){var ak=new String(al);for(var aj=10;aj>0;aj--){if(ak==(ak=ak.replace(/^(\d+)(\d{3})/,"$1"+H.jqplot.sprintf.thousandsSeparator+"$2"))){break}}return ak}function ad(ao,an,aq,al,am,ak){var ap=al-ao.length;if(ap>0){var aj=" ";if(ak){aj="&nbsp;"}if(aq||!am){ao=ah(ao,al,aj,aq)}else{ao=ao.slice(0,an.length)+ah("",ap,"0",true)+ao.slice(an.length)}}return ao}function ai(ar,ak,ap,al,aj,ao,aq,an){var am=ar>>>0;ap=ap&&am&&{"2":"0b","8":"0","16":"0x"}[ak]||"";ar=ap+ah(am.toString(ak),ao||0,"0",false);return ad(ar,ap,al,aj,aq,an)}function ab(an,ao,al,aj,am,ak){if(aj!=null){an=an.slice(0,aj)}return ad(an,"",ao,al,am,ak)}var ac=arguments,af=0,ag=ac[af++];return ag.replace(H.jqplot.sprintf.regex,function(aG,aq,ar,av,aI,aD,ao){if(aG=="%%"){return"%"}var ax=false,at="",au=false,aF=false,ap=false,an=false;for(var aC=0;ar&&aC<ar.length;aC++){switch(ar.charAt(aC)){case" ":at=" ";break;case"+":at="+";break;case"-":ax=true;break;case"0":au=true;break;case"#":aF=true;break;case"&":ap=true;break;case"'":an=true;break}}if(!av){av=0}else{if(av=="*"){av=+ac[af++]}else{if(av.charAt(0)=="*"){av=+ac[av.slice(1,-1)]}else{av=+av}}}if(av<0){av=-av;ax=true}if(!isFinite(av)){throw new Error("$.jqplot.sprintf: (minimum-)width must be finite")}if(!aD){aD="fFeE".indexOf(ao)>-1?6:(ao=="d")?0:void (0)}else{if(aD=="*"){aD=+ac[af++]}else{if(aD.charAt(0)=="*"){aD=+ac[aD.slice(1,-1)]}else{aD=+aD}}}var az=aq?ac[aq.slice(0,-1)]:ac[af++];switch(ao){case"s":if(az==null){return""}return ab(String(az),ax,av,aD,au,ap);case"c":return ab(String.fromCharCode(+az),ax,av,aD,au,ap);case"b":return ai(az,2,aF,ax,av,aD,au,ap);case"o":return ai(az,8,aF,ax,av,aD,au,ap);case"x":return ai(az,16,aF,ax,av,aD,au,ap);case"X":return ai(az,16,aF,ax,av,aD,au,ap).toUpperCase();case"u":return ai(az,10,aF,ax,av,aD,au,ap);case"i":var al=parseInt(+az,10);if(isNaN(al)){return""}var aB=al<0?"-":at;var aE=an?ae(String(Math.abs(al))):String(Math.abs(al));az=aB+ah(aE,aD,"0",false);return ad(az,aB,ax,av,au,ap);case"d":var al=Math.round(+az);if(isNaN(al)){return""}var aB=al<0?"-":at;var aE=an?ae(String(Math.abs(al))):String(Math.abs(al));az=aB+ah(aE,aD,"0",false);return ad(az,aB,ax,av,au,ap);case"e":case"E":case"f":case"F":case"g":case"G":var al=+az;if(isNaN(al)){return""}var aB=al<0?"-":at;var am=["toExponential","toFixed","toPrecision"]["efg".indexOf(ao.toLowerCase())];var aH=["toString","toUpperCase"]["eEfFgG".indexOf(ao)%2];var aE=Math.abs(al)[am](aD);aE=an?ae(aE):aE;az=aB+aE;var aw=ad(az,aB,ax,av,au,ap)[aH]();if(H.jqplot.sprintf.decimalMark!=="."&&H.jqplot.sprintf.decimalMark!==H.jqplot.sprintf.thousandsSeparator){return aw.replace(/\./,H.jqplot.sprintf.decimalMark)}else{return aw}case"p":case"P":var al=+az;if(isNaN(al)){return""}var aB=al<0?"-":at;var ay=String(Number(Math.abs(al)).toExponential()).split(/e|E/);var ak=(ay[0].indexOf(".")!=-1)?ay[0].length-1:ay[0].length;var aA=(ay[1]<0)?-ay[1]-1:0;if(Math.abs(al)<1){if(ak+aA<=aD){az=aB+Math.abs(al).toPrecision(ak)}else{if(ak<=aD-1){az=aB+Math.abs(al).toExponential(ak-1)}else{az=aB+Math.abs(al).toExponential(aD-1)}}}else{var aj=(ak<=aD)?ak:aD;az=aB+Math.abs(al).toPrecision(aj)}var aH=["toString","toUpperCase"]["pP".indexOf(ao)%2];return ad(az,aB,ax,av,au,ap)[aH]();case"n":return"";default:return aG}})};H.jqplot.sprintf.thousandsSeparator=",";H.jqplot.sprintf.decimalMark=".";H.jqplot.sprintf.regex=/%%|%(\d+\$)?([-+#0&\' ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([nAscboxXuidfegpEGP])/g;H.jqplot.getSignificantFigures=function(af){var ah=String(Number(Math.abs(af)).toExponential()).split(/e|E/);var ag=(ah[0].indexOf(".")!=-1)?ah[0].length-1:ah[0].length;var ac=(ah[1]<0)?-ah[1]-1:0;var ab=parseInt(ah[1],10);var ad=(ab+1>0)?ab+1:0;var ae=(ag<=ad)?0:ag-ab-1;return{significantDigits:ag,digitsLeft:ad,digitsRight:ae,zeros:ac,exponent:ab}};H.jqplot.getPrecision=function(ab){return H.jqplot.getSignificantFigures(ab).digitsRight}})(jQuery);var backCompat=$.uiBackCompat!==false;$.jqplot.effects={effect:{}};var dataSpace="jqplot.storage.";$.extend($.jqplot.effects,{version:"1.9pre",save:function(b,c){for(var a=0;a<c.length;a++){if(c[a]!==null){b.data(dataSpace+c[a],b[0].style[c[a]])}}},restore:function(b,c){for(var a=0;a<c.length;a++){if(c[a]!==null){b.css(c[a],b.data(dataSpace+c[a]))}}},setMode:function(a,b){if(b==="toggle"){b=a.is(":hidden")?"show":"hide"}return b},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper")){return b.parent()}var c={width:b.outerWidth(true),height:b.outerHeight(true),"float":b.css("float")},e=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),a={width:b.width(),height:b.height()},d=document.activeElement;b.wrap(e);if(b[0]===d||$.contains(b[0],d)){$(d).focus()}e=b.parent();if(b.css("position")==="static"){e.css({position:"relative"});b.css({position:"relative"})}else{$.extend(c,{position:b.css("position"),zIndex:b.css("z-index")});$.each(["top","left","bottom","right"],function(f,g){c[g]=b.css(g);if(isNaN(parseInt(c[g],10))){c[g]="auto"}});b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}b.css(a);return e.css(c).show()},removeWrapper:function(a){var b=document.activeElement;if(a.parent().is(".ui-effects-wrapper")){a.parent().replaceWith(a);if(a[0]===b||$.contains(a[0],b)){$(b).focus()}}return a}});function _normalizeArguments(b,a,c,d){if($.isPlainObject(b)){return b}b={effect:b};if(a===undefined){a={}}if($.isFunction(a)){d=a;c=null;a={}}if($.type(a)==="number"||$.fx.speeds[a]){d=c;c=a;a={}}if($.isFunction(c)){d=c;c=null}if(a){$.extend(b,a)}c=c||a.duration;b.duration=$.fx.off?0:typeof c==="number"?c:c in $.fx.speeds?$.fx.speeds[c]:$.fx.speeds._default;b.complete=d||a.complete;return b}function standardSpeed(a){if(!a||typeof a==="number"||$.fx.speeds[a]){return true}if(typeof a==="string"&&!$.jqplot.effects.effect[a]){if(backCompat&&$.jqplot.effects[a]){return false}return true}return false}$.fn.extend({jqplotEffect:function(i,j,b,h){var g=_normalizeArguments.apply(this,arguments),d=g.mode,e=g.queue,f=$.jqplot.effects.effect[g.effect],a=!f&&backCompat&&$.jqplot.effects[g.effect];if($.fx.off||!(f||a)){if(d){return this[d](g.duration,g.complete)}else{return this.each(function(){if(g.complete){g.complete.call(this)}})}}function c(m){var n=$(this),l=g.complete,o=g.mode;function k(){if($.isFunction(l)){l.call(n[0])}if($.isFunction(m)){m()}}if(n.is(":hidden")?o==="hide":o==="show"){k()}else{f.call(n[0],g,k)}}if(f){return e===false?this.each(c):this.queue(e||"fx",c)}else{return a.call(this,{options:g,duration:g.duration,callback:g.complete,mode:g.mode})}}});var rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/;$.jqplot.effects.effect.blind=function(c,h){var d=$(this),k=["position","top","bottom","left","right","height","width"],i=$.jqplot.effects.setMode(d,c.mode||"hide"),m=c.direction||"up",f=rvertical.test(m),e=f?"height":"width",j=f?"top":"left",p=rpositivemotion.test(m),g={},n=i==="show",b,a,l;if(d.parent().is(".ui-effects-wrapper")){$.jqplot.effects.save(d.parent(),k)}else{$.jqplot.effects.save(d,k)}d.show();l=parseInt(d.css("top"),10);b=$.jqplot.effects.createWrapper(d).css({overflow:"hidden"});a=f?b[e]()+l:b[e]();g[e]=n?String(a):"0";if(!p){d.css(f?"bottom":"right",0).css(f?"top":"left","").css({position:"absolute"});g[j]=n?"0":String(a)}if(n){b.css(e,0);if(!p){b.css(j,a)}}b.animate(g,{duration:c.duration,easing:c.easing,queue:false,complete:function(){if(i==="hide"){d.hide()}$.jqplot.effects.restore(d,k);$.jqplot.effects.removeWrapper(d);h()}})};/* 
* jqGrid  4.5.4 - jQuery Grid 
* Copyright (c) 2008, Tony Tomov, tony@trirand.com 
* Dual licensed under the MIT and GPL licenses 
* http://www.opensource.org/licenses/mit-license.php 
* http://www.gnu.org/licenses/gpl-2.0.html 
* Date:2013-10-06 
* Modules: grid.base.js; jquery.fmatter.js; grid.custom.js; grid.common.js; grid.formedit.js; grid.filter.js; grid.inlinedit.js; grid.celledit.js; jqModal.js; jqDnR.js; grid.subgrid.js; grid.grouping.js; grid.treegrid.js; grid.import.js; JsonXml.js; grid.tbltogrid.js; grid.jqueryui.js; 
*/
(function(b){b.jgrid=b.jgrid||{};b.extend(b.jgrid,{version:"4.5.3",htmlDecode:function(b){return b&&("&nbsp;"===b||"&#160;"===b||1===b.length&&160===b.charCodeAt(0))?"":!b?b:(""+b).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},htmlEncode:function(b){return!b?b:(""+b).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},format:function(d){var g=b.makeArray(arguments).slice(1);null==d&&(d="");return d.replace(/\{(\d+)\}/g,
function(b,e){return g[e]})},msie:"Microsoft Internet Explorer"===navigator.appName,msiever:function(){var b=-1;null!=/MSIE ([0-9]{1,}[.0-9]{0,})/.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));return b},getCellIndex:function(d){d=b(d);if(d.is("tr"))return-1;d=(!d.is("td")&&!d.is("th")?d.closest("td,th"):d)[0];return b.jgrid.msie?b.inArray(d,d.parentNode.cells):d.cellIndex},stripHtml:function(b){var b=""+b,g=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return b?(b=b.replace(g,""))&&"&nbsp;"!==b&&"&#160;"!==
b?b.replace(/\"/g,"'"):"":b},stripPref:function(d,g){var c=b.type(d);if("string"===c||"number"===c)d=""+d,g=""!==d?(""+g).replace(""+d,""):g;return g},parse:function(d){"while(1);"===d.substr(0,9)&&(d=d.substr(9));"/*"===d.substr(0,2)&&(d=d.substr(2,d.length-4));d||(d="{}");return!0===b.jgrid.useJSON&&"object"===typeof JSON&&"function"===typeof JSON.parse?JSON.parse(d):eval("("+d+")")},parseDate:function(d,g,c,e){var a=/^\/Date\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\)\/$/,i="string"===typeof g?
g.match(a):null,a=function(a,b){a=""+a;for(b=parseInt(b,10)||2;a.length<b;)a="0"+a;return a},f={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},h=0,j,k,h=function(a,b){0===a?12===b&&(b=0):12!==b&&(b+=12);return b};void 0===e&&(e=b.jgrid.formatter.date);void 0===e.parseRe&&(e.parseRe=/[Tt\\\/:_;.,\t\s-]/);e.masks.hasOwnProperty(d)&&(d=e.masks[d]);if(g&&null!=g)if(!isNaN(g-0)&&"u"===(""+d).toLowerCase())h=new Date(1E3*parseFloat(g));else if(g.constructor===Date)h=g;else if(null!==i)h=new Date(parseInt(i[1],10)),i[3]&&
(d=60*Number(i[5])+Number(i[6]),d*="-"===i[4]?1:-1,d-=h.getTimezoneOffset(),h.setTime(Number(Number(h)+6E4*d)));else{g=(""+g).replace(/\\T/g,"T").replace(/\\t/,"t").split(e.parseRe);d=d.replace(/\\T/g,"T").replace(/\\t/,"t").split(e.parseRe);j=0;for(k=d.length;j<k;j++)"M"===d[j]&&(i=b.inArray(g[j],e.monthNames),-1!==i&&12>i&&(g[j]=i+1,f.m=g[j])),"F"===d[j]&&(i=b.inArray(g[j],e.monthNames,12),-1!==i&&11<i&&(g[j]=i+1-12,f.m=g[j])),"a"===d[j]&&(i=b.inArray(g[j],e.AmPm),-1!==i&&2>i&&g[j]===e.AmPm[i]&&
(g[j]=i,f.h=h(g[j],f.h))),"A"===d[j]&&(i=b.inArray(g[j],e.AmPm),-1!==i&&1<i&&g[j]===e.AmPm[i]&&(g[j]=i-2,f.h=h(g[j],f.h))),"g"===d[j]&&(f.h=parseInt(g[j],10)),void 0!==g[j]&&(f[d[j].toLowerCase()]=parseInt(g[j],10));f.f&&(f.m=f.f);if(0===f.m&&0===f.y&&0===f.d)return"&#160;";f.m=parseInt(f.m,10)-1;h=f.y;70<=h&&99>=h?f.y=1900+f.y:0<=h&&69>=h&&(f.y=2E3+f.y);h=new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u)}else h=new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u);if(void 0===c)return h;e.masks.hasOwnProperty(c)?c=e.masks[c]:
c||(c="Y-m-d");d=h.getHours();g=h.getMinutes();f=h.getDate();i=h.getMonth()+1;j=h.getTimezoneOffset();k=h.getSeconds();var m=h.getMilliseconds(),n=h.getDay(),l=h.getFullYear(),r=(n+6)%7+1,u=(new Date(l,i-1,f)-new Date(l,0,1))/864E5,E={d:a(f),D:e.dayNames[n],j:f,l:e.dayNames[n+7],N:r,S:e.S(f),w:n,z:u,W:5>r?Math.floor((u+r-1)/7)+1:Math.floor((u+r-1)/7)||(4>((new Date(l-1,0,1)).getDay()+6)%7?53:52),F:e.monthNames[i-1+12],m:a(i),M:e.monthNames[i-1],n:i,t:"?",L:"?",o:"?",Y:l,y:(""+l).substring(2),a:12>
d?e.AmPm[0]:e.AmPm[1],A:12>d?e.AmPm[2]:e.AmPm[3],B:"?",g:d%12||12,G:d,h:a(d%12||12),H:a(d),i:a(g),s:a(k),u:m,e:"?",I:"?",O:(0<j?"-":"+")+a(100*Math.floor(Math.abs(j)/60)+Math.abs(j)%60,4),P:"?",T:((""+h).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(h/1E3)};return c.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(a){return E.hasOwnProperty(a)?
E[a]:a.substring(1)})},jqID:function(b){return(""+b).replace(/[!"#$%&'()*+,.\/:; <=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(d){return(d||b.jgrid.uidPref)+b.jgrid.guid++},getAccessor:function(b,g){var c,e,a=[],i;if("function"===typeof g)return g(b);c=b[g];if(void 0===c)try{if("string"===typeof g&&(a=g.split(".")),i=a.length)for(c=b;c&&i--;)e=a.shift(),c=c[e]}catch(f){}return c},getXmlData:function(d,g,c){var e="string"===typeof g?g.match(/^(.*)\[(\w+)\]$/):null;if("function"===
typeof g)return g(d);if(e&&e[2])return e[1]?b(e[1],d).attr(e[2]):b(d).attr(e[2]);d=b(g,d);return c?d:0<d.length?b(d).text():void 0},cellWidth:function(){var d=b("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable' style='width:5px;'><tr class='jqgrow'><td style='width:5px;display:block;'></td></tr></table></div>"),g=d.appendTo("body").find("td").width();d.remove();return 0.1<Math.abs(g-5)},cell_width:!0,ajaxOptions:{},from:function(d){return new function(d,c){"string"===typeof d&&
(d=b.data(d));var e=this,a=d,i=!0,f=!1,h=c,j=/[\$,%]/g,k=null,m=null,n=0,l=!1,r="",u=[],E=!0;if("object"===typeof d&&d.push)0<d.length&&(E="object"!==typeof d[0]?!1:!0);else throw"data provides is not an array";this._hasData=function(){return null===a?!1:0===a.length?!1:!0};this._getStr=function(a){var b=[];f&&b.push("jQuery.trim(");b.push("String("+a+")");f&&b.push(")");i||b.push(".toLowerCase()");return b.join("")};this._strComp=function(a){return"string"===typeof a?".toString()":""};this._group=
function(a,b){return{field:a.toString(),unique:b,items:[]}};this._toStr=function(a){f&&(a=b.trim(a));a=a.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return i?a:a.toLowerCase()};this._funcLoop=function(e){var d=[];b.each(a,function(a,b){d.push(e(b))});return d};this._append=function(a){var b;h=null===h?"":h+(""===r?" && ":r);for(b=0;b<n;b++)h+="(";l&&(h+="!");h+="("+a+")";l=!1;r="";n=0};this._setCommand=function(a,b){k=a;m=b};this._resetNegate=function(){l=!1};this._repeatCommand=function(a,
b){return null===k?e:null!==a&&null!==b?k(a,b):null===m||!E?k(a):k(m,a)};this._equals=function(a,b){return 0===e._compare(a,b,1)};this._compare=function(a,b,e){var d=Object.prototype.toString;void 0===e&&(e=1);void 0===a&&(a=null);void 0===b&&(b=null);if(null===a&&null===b)return 0;if(null===a&&null!==b)return 1;if(null!==a&&null===b)return-1;if("[object Date]"===d.call(a)&&"[object Date]"===d.call(b))return a<b?-e:a>b?e:0;!i&&"number"!==typeof a&&"number"!==typeof b&&(a=""+a,b=""+b);return a<b?-e:
a>b?e:0};this._performSort=function(){0!==u.length&&(a=e._doSort(a,0))};this._doSort=function(a,b){var d=u[b].by,i=u[b].dir,f=u[b].type,c=u[b].datefmt;if(b===u.length-1)return e._getOrder(a,d,i,f,c);b++;for(var d=e._getGroup(a,d,i,f,c),i=[],g,f=0;f<d.length;f++){g=e._doSort(d[f].items,b);for(c=0;c<g.length;c++)i.push(g[c])}return i};this._getOrder=function(a,d,f,c,g){var h=[],k=[],m="a"===f?1:-1,n,l;void 0===c&&(c="text");l="float"===c||"number"===c||"currency"===c||"numeric"===c?function(a){a=parseFloat((""+
a).replace(j,""));return isNaN(a)?0:a}:"int"===c||"integer"===c?function(a){return a?parseFloat((""+a).replace(j,"")):0}:"date"===c||"datetime"===c?function(a){return b.jgrid.parseDate(g,a).getTime()}:b.isFunction(c)?c:function(a){a=a?b.trim(""+a):"";return i?a:a.toLowerCase()};b.each(a,function(a,e){n=""!==d?b.jgrid.getAccessor(e,d):e;void 0===n&&(n="");n=l(n,e);k.push({vSort:n,index:a})});k.sort(function(a,b){a=a.vSort;b=b.vSort;return e._compare(a,b,m)});for(var c=0,u=a.length;c<u;)f=k[c].index,
h.push(a[f]),c++;return h};this._getGroup=function(a,d,c,i,f){var g=[],h=null,j=null,k;b.each(e._getOrder(a,d,c,i,f),function(a,c){k=b.jgrid.getAccessor(c,d);null==k&&(k="");e._equals(j,k)||(j=k,null!==h&&g.push(h),h=e._group(d,k));h.items.push(c)});null!==h&&g.push(h);return g};this.ignoreCase=function(){i=!1;return e};this.useCase=function(){i=!0;return e};this.trim=function(){f=!0;return e};this.noTrim=function(){f=!1;return e};this.execute=function(){var d=h,c=[];if(null===d)return e;b.each(a,
function(){eval(d)&&c.push(this)});a=c;return e};this.data=function(){return a};this.select=function(d){e._performSort();if(!e._hasData())return[];e.execute();if(b.isFunction(d)){var c=[];b.each(a,function(a,b){c.push(d(b))});return c}return a};this.hasMatch=function(){if(!e._hasData())return!1;e.execute();return 0<a.length};this.andNot=function(a,b,d){l=!l;return e.and(a,b,d)};this.orNot=function(a,b,d){l=!l;return e.or(a,b,d)};this.not=function(a,b,d){return e.andNot(a,b,d)};this.and=function(a,
b,d){r=" && ";return void 0===a?e:e._repeatCommand(a,b,d)};this.or=function(a,b,d){r=" || ";return void 0===a?e:e._repeatCommand(a,b,d)};this.orBegin=function(){n++;return e};this.orEnd=function(){null!==h&&(h+=")");return e};this.isNot=function(a){l=!l;return e.is(a)};this.is=function(a){e._append("this."+a);e._resetNegate();return e};this._compareValues=function(a,d,c,i,f){var g;g=E?"jQuery.jgrid.getAccessor(this,'"+d+"')":"this";void 0===c&&(c=null);var h=c,k=void 0===f.stype?"text":f.stype;if(null!==
c)switch(k){case "int":case "integer":h=isNaN(Number(h))||""===h?"0":h;g="parseInt("+g+",10)";h="parseInt("+h+",10)";break;case "float":case "number":case "numeric":h=(""+h).replace(j,"");h=isNaN(Number(h))||""===h?"0":h;g="parseFloat("+g+")";h="parseFloat("+h+")";break;case "date":case "datetime":h=""+b.jgrid.parseDate(f.newfmt||"Y-m-d",h).getTime();g='jQuery.jgrid.parseDate("'+f.srcfmt+'",'+g+").getTime()";break;default:g=e._getStr(g),h=e._getStr('"'+e._toStr(h)+'"')}e._append(g+" "+i+" "+h);e._setCommand(a,
d);e._resetNegate();return e};this.equals=function(a,b,d){return e._compareValues(e.equals,a,b,"==",d)};this.notEquals=function(a,b,d){return e._compareValues(e.equals,a,b,"!==",d)};this.isNull=function(a,b,d){return e._compareValues(e.equals,a,null,"===",d)};this.greater=function(a,b,d){return e._compareValues(e.greater,a,b,">",d)};this.less=function(a,b,d){return e._compareValues(e.less,a,b,"<",d)};this.greaterOrEquals=function(a,b,d){return e._compareValues(e.greaterOrEquals,a,b,">=",d)};this.lessOrEquals=
function(a,b,d){return e._compareValues(e.lessOrEquals,a,b,"<=",d)};this.startsWith=function(a,d){var c=null==d?a:d,c=f?b.trim(c.toString()).length:c.toString().length;E?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr(0,"+c+") == "+e._getStr('"'+e._toStr(d)+'"')):(c=f?b.trim(d.toString()).length:d.toString().length,e._append(e._getStr("this")+".substr(0,"+c+") == "+e._getStr('"'+e._toStr(a)+'"')));e._setCommand(e.startsWith,a);e._resetNegate();return e};this.endsWith=function(a,
d){var c=null==d?a:d,c=f?b.trim(c.toString()).length:c.toString().length;E?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".substr("+e._getStr("jQuery.jgrid.getAccessor(this,'"+a+"')")+".length-"+c+","+c+') == "'+e._toStr(d)+'"'):e._append(e._getStr("this")+".substr("+e._getStr("this")+'.length-"'+e._toStr(a)+'".length,"'+e._toStr(a)+'".length) == "'+e._toStr(a)+'"');e._setCommand(e.endsWith,a);e._resetNegate();return e};this.contains=function(a,b){E?e._append(e._getStr("jQuery.jgrid.getAccessor(this,'"+
a+"')")+'.indexOf("'+e._toStr(b)+'",0) > -1'):e._append(e._getStr("this")+'.indexOf("'+e._toStr(a)+'",0) > -1');e._setCommand(e.contains,a);e._resetNegate();return e};this.groupBy=function(b,d,c,i){return!e._hasData()?null:e._getGroup(a,b,d,c,i)};this.orderBy=function(a,d,c,i){d=null==d?"a":b.trim(d.toString().toLowerCase());null==c&&(c="text");null==i&&(i="Y-m-d");if("desc"===d||"descending"===d)d="d";if("asc"===d||"ascending"===d)d="a";u.push({by:a,dir:d,type:c,datefmt:i});return e};return e}(d,
null)},getMethod:function(d){return this.getAccessor(b.fn.jqGrid,d)},extend:function(d){b.extend(b.fn.jqGrid,d);this.no_legacy_api||b.fn.extend(d)}});b.fn.jqGrid=function(d){if("string"===typeof d){var g=b.jgrid.getMethod(d);if(!g)throw"jqGrid - No such method: "+d;var c=b.makeArray(arguments).slice(1);return g.apply(this,c)}return this.each(function(){if(!this.grid){var e=b.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],
colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,onInitGrid:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,
viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,
loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:!1,rownumWidth:25,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},
grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus",displayField:[]},ignoreCase:!1,cmTemplate:{},idPrefix:"",multiSort:!1},b.jgrid.defaults,d||{}),a=this,c={headers:[],cols:[],footers:[],dragStart:function(c,d,f){this.resizing={idx:c,startX:d.clientX,sOL:d.clientX-6};this.hDiv.style.cursor="col-resize";this.curGbox=
b("#rs_m"+b.jgrid.jqID(e.id),"#gbox_"+b.jgrid.jqID(e.id));this.curGbox.css({display:"block",left:d.clientX-6,top:f[1],height:f[2]});b(a).triggerHandler("jqGridResizeStart",[d,c]);b.isFunction(e.resizeStart)&&e.resizeStart.call(a,d,c);document.onselectstart=function(){return!1}},dragMove:function(a){if(this.resizing){var b=a.clientX-this.resizing.startX,a=this.headers[this.resizing.idx],c="ltr"===e.direction?a.width+b:a.width-b,d;33<c&&(this.curGbox.css({left:this.resizing.sOL+b}),!0===e.forceFit?
(d=this.headers[this.resizing.idx+e.nv],b="ltr"===e.direction?d.width-b:d.width+b,33<b&&(a.newWidth=c,d.newWidth=b)):(this.newWidth="ltr"===e.direction?e.tblwidth+b:e.tblwidth-b,a.newWidth=c))}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var c=this.resizing.idx,d=this.headers[c].newWidth||this.headers[c].width,d=parseInt(d,10);this.resizing=!1;b("#rs_m"+b.jgrid.jqID(e.id)).css("display","none");e.colModel[c].width=d;this.headers[c].width=d;this.headers[c].el.style.width=
d+"px";this.cols[c].style.width=d+"px";0<this.footers.length&&(this.footers[c].style.width=d+"px");!0===e.forceFit?(d=this.headers[c+e.nv].newWidth||this.headers[c+e.nv].width,this.headers[c+e.nv].width=d,this.headers[c+e.nv].el.style.width=d+"px",this.cols[c+e.nv].style.width=d+"px",0<this.footers.length&&(this.footers[c+e.nv].style.width=d+"px"),e.colModel[c+e.nv].width=d):(e.tblwidth=this.newWidth||e.tblwidth,b("table:first",this.bDiv).css("width",e.tblwidth+"px"),b("table:first",this.hDiv).css("width",
e.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,e.footerrow&&(b("table:first",this.sDiv).css("width",e.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));b(a).triggerHandler("jqGridResizeStop",[d,c]);b.isFunction(e.resizeStop)&&e.resizeStop.call(a,d,c)}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){c.timer&&clearTimeout(c.timer);c.timer=null;var a=b(c.bDiv).height();if(a){var d=b("table:first",c.bDiv),f,g;if(d[0].rows.length)try{g=(f=d[0].rows[1])?
b(f).outerHeight()||c.prevRowHeight:c.prevRowHeight}catch(va){g=c.prevRowHeight}if(g){c.prevRowHeight=g;var h=e.rowNum;f=c.scrollTop=c.bDiv.scrollTop;var j=Math.round(d.position().top)-f,k=j+d.height();g*=h;var B,F,A;if(k<a&&0>=j&&(void 0===e.lastpage||parseInt((k+f+g-1)/g,10)<=e.lastpage))F=parseInt((a-k+g-1)/g,10),0<=k||2>F||!0===e.scroll?(B=Math.round((k+f)/g)+1,j=-1):j=1;0<j&&(B=parseInt(f/g,10)+1,F=parseInt((f+a)/g,10)+2-B,A=!0);if(F&&(!e.lastpage||!(B>e.lastpage||1===e.lastpage||B===e.page&&
B===e.lastpage)))c.hDiv.loading?c.timer=setTimeout(c.populateVisible,e.scrollTimeout):(e.page=B,A&&(c.selectionPreserver(d[0]),c.emptyRows.call(d[0],!1,!1)),c.populate(F))}}},scrollGrid:function(a){if(e.scroll){var b=c.bDiv.scrollTop;void 0===c.scrollTop&&(c.scrollTop=0);b!==c.scrollTop&&(c.scrollTop=b,c.timer&&clearTimeout(c.timer),c.timer=setTimeout(c.populateVisible,e.scrollTimeout))}c.hDiv.scrollLeft=c.bDiv.scrollLeft;e.footerrow&&(c.sDiv.scrollLeft=c.bDiv.scrollLeft);a&&a.stopPropagation()},
selectionPreserver:function(a){var c=a.p,d=c.selrow,e=c.selarrrow?b.makeArray(c.selarrrow):null,f=a.grid.bDiv.scrollLeft,g=function(){var h;c.selrow=null;c.selarrrow=[];if(c.multiselect&&e&&0<e.length)for(h=0;h<e.length;h++)e[h]!==d&&b(a).jqGrid("setSelection",e[h],!1,null);d&&b(a).jqGrid("setSelection",d,!1,null);a.grid.bDiv.scrollLeft=f;b(a).unbind(".selectionPreserver",g)};b(a).bind("jqGridGridComplete.selectionPreserver",g)}};if("TABLE"!==this.tagName.toUpperCase())alert("Element is not a table");
else if(void 0!==document.documentMode&&5>=document.documentMode)alert("Grid can not be used in this ('quirks') mode!");else{b(this).empty().attr("tabindex","0");this.p=e;this.p.useProp=!!b.fn.prop;var f,g;if(0===this.p.colNames.length)for(f=0;f<this.p.colModel.length;f++)this.p.colNames[f]=this.p.colModel[f].label||this.p.colModel[f].name;if(this.p.colNames.length!==this.p.colModel.length)alert(b.jgrid.errors.model);else{var j=b("<div class='ui-jqgrid-view'></div>"),k=b.jgrid.msie;a.p.direction=
b.trim(a.p.direction.toLowerCase());-1===b.inArray(a.p.direction,["ltr","rtl"])&&(a.p.direction="ltr");g=a.p.direction;b(j).insertBefore(this);b(this).removeClass("scroll").appendTo(j);var m=b("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");b(m).attr({id:"gbox_"+this.id,dir:g}).insertBefore(j);b(j).attr("id","gview_"+this.id).appendTo(m);b("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").insertBefore(j);b("<div class='loading ui-state-default ui-state-active' id='load_"+
this.id+"'>"+this.p.loadtext+"</div>").insertBefore(j);b(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var n=function(a,b){a=parseInt(a,10);return isNaN(a)?b||0:a},l=function(d,e,f,g,h,j){var R=a.p.colModel[d],k=R.align,B='style="',F=R.classes,A=R.name,t=[];k&&(B=B+("text-align:"+k+";"));R.hidden===true&&(B=B+"display:none;");if(e===0)B=B+("width: "+c.headers[d].width+"px;");else if(R.cellattr&&b.isFunction(R.cellattr))if((d=
R.cellattr.call(a,h,f,g,R,j))&&typeof d==="string"){d=d.replace(/style/i,"style").replace(/title/i,"title");if(d.indexOf("title")>-1)R.title=false;d.indexOf("class")>-1&&(F=void 0);t=d.replace("-style","-sti").split(/style/);if(t.length===2){t[1]=b.trim(t[1].replace("-sti","-style").replace("=",""));if(t[1].indexOf("'")===0||t[1].indexOf('"')===0)t[1]=t[1].substring(1);B=B+t[1].replace(/'/gi,'"')}else B=B+'"'}if(!t.length){t[0]="";B=B+'"'}B=B+((F!==void 0?' class="'+F+'"':"")+(R.title&&f?' title="'+
b.jgrid.stripHtml(f)+'"':""));B=B+(' aria-describedby="'+a.p.id+"_"+A+'"');return B+t[0]},r=function(c){return c==null||c===""?"&#160;":a.p.autoencode?b.jgrid.htmlEncode(c):""+c},u=function(c,d,e,f,g){var h=a.p.colModel[e];if(h.formatter!==void 0){c=""+a.p.idPrefix!==""?b.jgrid.stripPref(a.p.idPrefix,c):c;c={rowId:c,colModel:h,gid:a.p.id,pos:e};d=b.isFunction(h.formatter)?h.formatter.call(a,d,c,f,g):b.fmatter?b.fn.fmatter.call(a,h.formatter,d,c,f,g):r(d)}else d=r(d);return d},E=function(a,b,c,d,e,
f){b=u(a,b,c,e,"add");return'<td role="gridcell" '+l(c,d,b,e,a,f)+">"+b+"</td>"},T=function(b,c,d,e){e='<input role="checkbox" type="checkbox" id="jqg_'+a.p.id+"_"+b+'" class="cbox" name="jqg_'+a.p.id+"_"+b+'"'+(e?'checked="checked"':"")+"/>";return'<td role="gridcell" '+l(c,d,"",null,b,true)+">"+e+"</td>"},L=function(a,b,c,d){c=(parseInt(c,10)-1)*parseInt(d,10)+1+b;return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+l(a,b,c,null,b,true)+">"+c+"</td>"},ba=function(b){var c,d=[],e=
0,f;for(f=0;f<a.p.colModel.length;f++){c=a.p.colModel[f];if(c.name!=="cb"&&c.name!=="subgrid"&&c.name!=="rn"){d[e]=b==="local"?c.name:b==="xml"||b==="xmlstring"?c.xmlmap||c.name:c.jsonmap||c.name;if(a.p.keyIndex!==false&&c.key===true)a.p.keyName=d[e];e++}}return d},V=function(c){var d=a.p.remapColumns;if(!d||!d.length)d=b.map(a.p.colModel,function(a,b){return b});c&&(d=b.map(d,function(a){return a<c?null:a-c}));return d},W=function(a,c){var d;if(this.p.deepempty)b(this.rows).slice(1).remove();else{d=
this.rows.length>0?this.rows[0]:null;b(this.firstChild).empty().append(d)}if(a&&this.p.scroll){b(this.grid.bDiv.firstChild).css({height:"auto"});b(this.grid.bDiv.firstChild.firstChild).css({height:0,display:"none"});if(this.grid.bDiv.scrollTop!==0)this.grid.bDiv.scrollTop=0}if(c===true&&this.p.treeGrid){this.p.data=[];this.p._index={}}},P=function(){var c=a.p.data.length,d,e,f;d=a.p.rownumbers===true?1:0;e=a.p.multiselect===true?1:0;f=a.p.subGrid===true?1:0;d=a.p.keyIndex===false||a.p.loadonce===
true?a.p.localReader.id:a.p.colModel[a.p.keyIndex+e+f+d].name;for(e=0;e<c;e++){f=b.jgrid.getAccessor(a.p.data[e],d);f===void 0&&(f=""+(e+1));a.p._index[f]=e}},Z=function(c,d,e,f,g,h){var i="-1",j="",k,d=d?"display:none;":"",e="ui-widget-content jqgrow ui-row-"+a.p.direction+(e?" "+e:"")+(h?" ui-state-highlight":""),h=b(a).triggerHandler("jqGridRowAttr",[f,g,c]);typeof h!=="object"&&(h=b.isFunction(a.p.rowattr)?a.p.rowattr.call(a,f,g,c):{});if(!b.isEmptyObject(h)){if(h.hasOwnProperty("id")){c=h.id;
delete h.id}if(h.hasOwnProperty("tabindex")){i=h.tabindex;delete h.tabindex}if(h.hasOwnProperty("style")){d=d+h.style;delete h.style}if(h.hasOwnProperty("class")){e=e+(" "+h["class"]);delete h["class"]}try{delete h.role}catch(F){}for(k in h)h.hasOwnProperty(k)&&(j=j+(" "+k+"="+h[k]))}return'<tr role="row" id="'+c+'" tabindex="'+i+'" class="'+e+'"'+(d===""?"":' style="'+d+'"')+j+">"},H=function(c,d,e,f,g){var h=new Date,i=a.p.datatype!=="local"&&a.p.loadonce||a.p.datatype==="xmlstring",j=a.p.xmlReader,
k=a.p.datatype==="local"?"local":"xml";if(i){a.p.data=[];a.p._index={};a.p.localReader.id="_id_"}a.p.reccount=0;if(b.isXMLDoc(c)){if(a.p.treeANode===-1&&!a.p.scroll){W.call(a,false,true);e=1}else e=e>1?e:1;var F=b(a),A,t,m=0,l,q=a.p.multiselect===true?1:0,v=0,u,O=a.p.rownumbers===true?1:0,r,o=[],$,s={},y,C,p=[],I=a.p.altRows===true?a.p.altclass:"",w;if(a.p.subGrid===true){v=1;u=b.jgrid.getMethod("addSubGridCell")}j.repeatitems||(o=ba(k));r=a.p.keyIndex===false?b.isFunction(j.id)?j.id.call(a,c):j.id:
a.p.keyIndex;if(o.length>0&&!isNaN(r))r=a.p.keyName;k=(""+r).indexOf("[")===-1?o.length?function(a,c){return b(r,a).text()||c}:function(a,c){return b(j.cell,a).eq(r).text()||c}:function(a,b){return a.getAttribute(r.replace(/[\[\]]/g,""))||b};a.p.userData={};a.p.page=n(b.jgrid.getXmlData(c,j.page),a.p.page);a.p.lastpage=n(b.jgrid.getXmlData(c,j.total),1);a.p.records=n(b.jgrid.getXmlData(c,j.records));b.isFunction(j.userdata)?a.p.userData=j.userdata.call(a,c)||{}:b.jgrid.getXmlData(c,j.userdata,true).each(function(){a.p.userData[this.getAttribute("name")]=
b(this).text()});c=b.jgrid.getXmlData(c,j.root,true);(c=b.jgrid.getXmlData(c,j.row,true))||(c=[]);var z=c.length,J=0,x=[],D=parseInt(a.p.rowNum,10),G=a.p.scroll?b.jgrid.randId():1;if(z>0&&a.p.page<=0)a.p.page=1;if(c&&z){g&&(D=D*(g+1));var g=b.isFunction(a.p.afterInsertRow),H=false,K;if(a.p.grouping){H=a.p.groupingView.groupCollapse===true;K=b.jgrid.getMethod("groupingPrepare")}for(;J<z;){y=c[J];C=k(y,G+J);C=a.p.idPrefix+C;A=e===0?0:e+1;w=(A+J)%2===1?I:"";var M=p.length;p.push("");O&&p.push(L(0,J,
a.p.page,a.p.rowNum));q&&p.push(T(C,O,J,false));v&&p.push(u.call(F,q+O,J+e));if(j.repeatitems){$||($=V(q+v+O));var P=b.jgrid.getXmlData(y,j.cell,true);b.each($,function(b){var c=P[this];if(!c)return false;l=c.textContent||c.text;s[a.p.colModel[b+q+v+O].name]=l;p.push(E(C,l,b+q+v+O,J+e,y,s))})}else for(A=0;A<o.length;A++){l=b.jgrid.getXmlData(y,o[A]);s[a.p.colModel[A+q+v+O].name]=l;p.push(E(C,l,A+q+v+O,J+e,y,s))}p[M]=Z(C,H,w,s,y,false);p.push("</tr>");if(a.p.grouping){x=K.call(F,p,x,s,J);p=[]}if(i||
a.p.treeGrid===true){s._id_=b.jgrid.stripPref(a.p.idPrefix,C);a.p.data.push(s);a.p._index[s._id_]=a.p.data.length-1}if(a.p.gridview===false){b("tbody:first",d).append(p.join(""));F.triggerHandler("jqGridAfterInsertRow",[C,s,y]);g&&a.p.afterInsertRow.call(a,C,s,y);p=[]}s={};m++;J++;if(m===D)break}}if(a.p.gridview===true){t=a.p.treeANode>-1?a.p.treeANode:0;if(a.p.grouping){F.jqGrid("groupingRender",x,a.p.colModel.length);x=null}else a.p.treeGrid===true&&t>0?b(a.rows[t]).after(p.join("")):b("tbody:first",
d).append(p.join(""))}if(a.p.subGrid===true)try{F.jqGrid("addSubGrid",q+O)}catch(Q){}a.p.totaltime=new Date-h;if(m>0&&a.p.records===0)a.p.records=z;p=null;if(a.p.treeGrid===true)try{F.jqGrid("setTreeNode",t+1,m+t+1)}catch(S){}if(!a.p.treeGrid&&!a.p.scroll)a.grid.bDiv.scrollTop=0;a.p.reccount=m;a.p.treeANode=-1;a.p.userDataOnFooter&&F.jqGrid("footerData","set",a.p.userData,true);if(i){a.p.records=z;a.p.lastpage=Math.ceil(z/D)}f||a.updatepager(false,true);if(i)for(;m<z;){y=c[m];C=k(y,m+G);C=a.p.idPrefix+
C;if(j.repeatitems){$||($=V(q+v+O));var N=b.jgrid.getXmlData(y,j.cell,true);b.each($,function(b){var c=N[this];if(!c)return false;l=c.textContent||c.text;s[a.p.colModel[b+q+v+O].name]=l})}else for(A=0;A<o.length;A++){l=b.jgrid.getXmlData(y,o[A]);s[a.p.colModel[A+q+v+O].name]=l}s._id_=b.jgrid.stripPref(a.p.idPrefix,C);a.p.data.push(s);a.p._index[s._id_]=a.p.data.length-1;s={};m++}}},U=function(c,d,e,f,g){var h=new Date;if(c){if(a.p.treeANode===-1&&!a.p.scroll){W.call(a,false,true);e=1}else e=e>1?e:
1;var i,j=a.p.datatype!=="local"&&a.p.loadonce||a.p.datatype==="jsonstring";if(j){a.p.data=[];a.p._index={};a.p.localReader.id="_id_"}a.p.reccount=0;if(a.p.datatype==="local"){d=a.p.localReader;i="local"}else{d=a.p.jsonReader;i="json"}var k=b(a),m=0,A,t,l,r=[],q=a.p.multiselect?1:0,v=a.p.subGrid===true?1:0,u,o=a.p.rownumbers===true?1:0,z=V(q+v+o);i=ba(i);var w,x,s,y={},C,p,I=[],D=a.p.altRows===true?a.p.altclass:"",G;a.p.page=n(b.jgrid.getAccessor(c,d.page),a.p.page);a.p.lastpage=n(b.jgrid.getAccessor(c,
d.total),1);a.p.records=n(b.jgrid.getAccessor(c,d.records));a.p.userData=b.jgrid.getAccessor(c,d.userdata)||{};v&&(u=b.jgrid.getMethod("addSubGridCell"));s=a.p.keyIndex===false?b.isFunction(d.id)?d.id.call(a,c):d.id:a.p.keyIndex;if(!d.repeatitems){r=i;if(r.length>0&&!isNaN(s))s=a.p.keyName}x=b.jgrid.getAccessor(c,d.root);x==null&&b.isArray(c)&&(x=c);x||(x=[]);c=x.length;t=0;if(c>0&&a.p.page<=0)a.p.page=1;var J=parseInt(a.p.rowNum,10),H=a.p.scroll?b.jgrid.randId():1,K=false,M;g&&(J=J*(g+1));a.p.datatype===
"local"&&!a.p.deselectAfterSort&&(K=true);var P=b.isFunction(a.p.afterInsertRow),N=[],Q=false,S;if(a.p.grouping){Q=a.p.groupingView.groupCollapse===true;S=b.jgrid.getMethod("groupingPrepare")}for(;t<c;){g=x[t];p=b.jgrid.getAccessor(g,s);if(p===void 0){typeof s==="number"&&a.p.colModel[s+q+v+o]!=null&&(p=b.jgrid.getAccessor(g,a.p.colModel[s+q+v+o].name));if(p===void 0){p=H+t;if(r.length===0&&d.cell){A=b.jgrid.getAccessor(g,d.cell)||g;p=A!=null&&A[s]!==void 0?A[s]:p}}}p=a.p.idPrefix+p;A=e===1?0:e;G=
(A+t)%2===1?D:"";K&&(M=a.p.multiselect?b.inArray(p,a.p.selarrrow)!==-1:p===a.p.selrow);var U=I.length;I.push("");o&&I.push(L(0,t,a.p.page,a.p.rowNum));q&&I.push(T(p,o,t,M));v&&I.push(u.call(k,q+o,t+e));w=i;if(d.repeatitems){d.cell&&(g=b.jgrid.getAccessor(g,d.cell)||g);b.isArray(g)&&(w=z)}for(l=0;l<w.length;l++){A=b.jgrid.getAccessor(g,w[l]);y[a.p.colModel[l+q+v+o].name]=A;I.push(E(p,A,l+q+v+o,t+e,g,y))}I[U]=Z(p,Q,G,y,g,M);I.push("</tr>");if(a.p.grouping){N=S.call(k,I,N,y,t);I=[]}if(j||a.p.treeGrid===
true){y._id_=b.jgrid.stripPref(a.p.idPrefix,p);a.p.data.push(y);a.p._index[y._id_]=a.p.data.length-1}if(a.p.gridview===false){b("#"+b.jgrid.jqID(a.p.id)+" tbody:first").append(I.join(""));k.triggerHandler("jqGridAfterInsertRow",[p,y,g]);P&&a.p.afterInsertRow.call(a,p,y,g);I=[]}y={};m++;t++;if(m===J)break}if(a.p.gridview===true){C=a.p.treeANode>-1?a.p.treeANode:0;a.p.grouping?k.jqGrid("groupingRender",N,a.p.colModel.length):a.p.treeGrid===true&&C>0?b(a.rows[C]).after(I.join("")):b("#"+b.jgrid.jqID(a.p.id)+
" tbody:first").append(I.join(""))}if(a.p.subGrid===true)try{k.jqGrid("addSubGrid",q+o)}catch(X){}a.p.totaltime=new Date-h;if(m>0&&a.p.records===0)a.p.records=c;if(a.p.treeGrid===true)try{k.jqGrid("setTreeNode",C+1,m+C+1)}catch(Y){}if(!a.p.treeGrid&&!a.p.scroll)a.grid.bDiv.scrollTop=0;a.p.reccount=m;a.p.treeANode=-1;a.p.userDataOnFooter&&k.jqGrid("footerData","set",a.p.userData,true);if(j){a.p.records=c;a.p.lastpage=Math.ceil(c/J)}f||a.updatepager(false,true);if(j)for(;m<c&&x[m];){g=x[m];p=b.jgrid.getAccessor(g,
s);if(p===void 0){typeof s==="number"&&a.p.colModel[s+q+v+o]!=null&&(p=b.jgrid.getAccessor(g,a.p.colModel[s+q+v+o].name));if(p===void 0){p=H+m;if(r.length===0&&d.cell){e=b.jgrid.getAccessor(g,d.cell)||g;p=e!=null&&e[s]!==void 0?e[s]:p}}}if(g){p=a.p.idPrefix+p;w=i;if(d.repeatitems){d.cell&&(g=b.jgrid.getAccessor(g,d.cell)||g);b.isArray(g)&&(w=z)}for(l=0;l<w.length;l++)y[a.p.colModel[l+q+v+o].name]=b.jgrid.getAccessor(g,w[l]);y._id_=b.jgrid.stripPref(a.p.idPrefix,p);a.p.data.push(y);a.p._index[y._id_]=
a.p.data.length-1;y={}}m++}}},ka=function(){function c(a){var b=0,d,e,g,h,i;if(a.groups!=null){(e=a.groups.length&&a.groupOp.toString().toUpperCase()==="OR")&&q.orBegin();for(d=0;d<a.groups.length;d++){b>0&&e&&q.or();try{c(a.groups[d])}catch(j){alert(j)}b++}e&&q.orEnd()}if(a.rules!=null)try{(g=a.rules.length&&a.groupOp.toString().toUpperCase()==="OR")&&q.orBegin();for(d=0;d<a.rules.length;d++){i=a.rules[d];h=a.groupOp.toString().toUpperCase();if(o[i.op]&&i.field){b>0&&h&&h==="OR"&&(q=q.or());q=o[i.op](q,
h)(i.field,i.data,f[i.field])}b++}g&&q.orEnd()}catch(ra){alert(ra)}}var d=a.p.multiSort?[]:"",e=[],g=false,f={},h=[],i=[],j,k,m;if(b.isArray(a.p.data)){var l=a.p.grouping?a.p.groupingView:false,t,n;b.each(a.p.colModel,function(){k=this.sorttype||"text";if(k==="date"||k==="datetime"){if(this.formatter&&typeof this.formatter==="string"&&this.formatter==="date"){j=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:b.jgrid.formatter.date.srcformat;m=this.formatoptions&&this.formatoptions.newformat?
this.formatoptions.newformat:b.jgrid.formatter.date.newformat}else j=m=this.datefmt||"Y-m-d";f[this.name]={stype:k,srcfmt:j,newfmt:m}}else f[this.name]={stype:k,srcfmt:"",newfmt:""};if(a.p.grouping){n=0;for(t=l.groupField.length;n<t;n++)if(this.name===l.groupField[n]){var c=this.name;if(this.index)c=this.index;h[n]=f[c];i[n]=c}}if(a.p.multiSort){if(this.lso){d.push(this.name);c=this.lso.split("-");e.push(c[c.length-1])}}else if(!g&&(this.index===a.p.sortname||this.name===a.p.sortname)){d=this.name;
g=true}});if(a.p.treeGrid)b(a).jqGrid("SortTree",d,a.p.sortorder,f[d].stype||"text",f[d].srcfmt||"");else{var o={eq:function(a){return a.equals},ne:function(a){return a.notEquals},lt:function(a){return a.less},le:function(a){return a.lessOrEquals},gt:function(a){return a.greater},ge:function(a){return a.greaterOrEquals},cn:function(a){return a.contains},nc:function(a,b){return b==="OR"?a.orNot().contains:a.andNot().contains},bw:function(a){return a.startsWith},bn:function(a,b){return b==="OR"?a.orNot().startsWith:
a.andNot().startsWith},en:function(a,b){return b==="OR"?a.orNot().endsWith:a.andNot().endsWith},ew:function(a){return a.endsWith},ni:function(a,b){return b==="OR"?a.orNot().equals:a.andNot().equals},"in":function(a){return a.equals},nu:function(a){return a.isNull},nn:function(a,b){return b==="OR"?a.orNot().isNull:a.andNot().isNull}},q=b.jgrid.from(a.p.data);a.p.ignoreCase&&(q=q.ignoreCase());if(a.p.search===true){var v=a.p.postData.filters;if(v){typeof v==="string"&&(v=b.jgrid.parse(v));c(v)}else try{q=
o[a.p.postData.searchOper](q)(a.p.postData.searchField,a.p.postData.searchString,f[a.p.postData.searchField])}catch(r){}}if(a.p.grouping)for(n=0;n<t;n++)q.orderBy(i[n],l.groupOrder[n],h[n].stype,h[n].srcfmt);a.p.multiSort?b.each(d,function(a){q.orderBy(this,e[a],f[this].stype,f[this].srcfmt)}):d&&a.p.sortorder&&g&&(a.p.sortorder.toUpperCase()==="DESC"?q.orderBy(a.p.sortname,"d",f[d].stype,f[d].srcfmt):q.orderBy(a.p.sortname,"a",f[d].stype,f[d].srcfmt));var v=q.select(),u=parseInt(a.p.rowNum,10),x=
v.length,w=parseInt(a.p.page,10),z=Math.ceil(x/u),s={},v=v.slice((w-1)*u,w*u),f=q=null;s[a.p.localReader.total]=z;s[a.p.localReader.page]=w;s[a.p.localReader.records]=x;s[a.p.localReader.root]=v;s[a.p.localReader.userdata]=a.p.userData;v=null;return s}}},S=function(){a.grid.hDiv.loading=true;if(!a.p.hiddengrid)switch(a.p.loadui){case "enable":b("#load_"+b.jgrid.jqID(a.p.id)).show();break;case "block":b("#lui_"+b.jgrid.jqID(a.p.id)).show();b("#load_"+b.jgrid.jqID(a.p.id)).show()}},Q=function(){a.grid.hDiv.loading=
false;switch(a.p.loadui){case "enable":b("#load_"+b.jgrid.jqID(a.p.id)).hide();break;case "block":b("#lui_"+b.jgrid.jqID(a.p.id)).hide();b("#load_"+b.jgrid.jqID(a.p.id)).hide()}},M=function(c){if(!a.grid.hDiv.loading){var d=a.p.scroll&&c===false,e={},g,f=a.p.prmNames;if(a.p.page<=0)a.p.page=Math.min(1,a.p.lastpage);if(f.search!==null)e[f.search]=a.p.search;f.nd!==null&&(e[f.nd]=(new Date).getTime());if(f.rows!==null)e[f.rows]=a.p.rowNum;if(f.page!==null)e[f.page]=a.p.page;if(f.sort!==null)e[f.sort]=
a.p.sortname;if(f.order!==null)e[f.order]=a.p.sortorder;if(a.p.rowTotal!==null&&f.totalrows!==null)e[f.totalrows]=a.p.rowTotal;var h=b.isFunction(a.p.loadComplete),i=h?a.p.loadComplete:null,j=0,c=c||1;if(c>1)if(f.npage!==null){e[f.npage]=c;j=c-1;c=1}else i=function(b){a.p.page++;a.grid.hDiv.loading=false;h&&a.p.loadComplete.call(a,b);M(c-1)};else f.npage!==null&&delete a.p.postData[f.npage];if(a.p.grouping){b(a).jqGrid("groupingSetup");var k=a.p.groupingView,m,n="";for(m=0;m<k.groupField.length;m++){var l=
k.groupField[m];b.each(a.p.colModel,function(a,b){if(b.name===l&&b.index)l=b.index});n=n+(l+" "+k.groupOrder[m]+", ")}e[f.sort]=n+e[f.sort]}b.extend(a.p.postData,e);var o=!a.p.scroll?1:a.rows.length-1,e=b(a).triggerHandler("jqGridBeforeRequest");if(!(e===false||e==="stop"))if(b.isFunction(a.p.datatype))a.p.datatype.call(a,a.p.postData,"load_"+a.p.id,o,c,j);else{if(b.isFunction(a.p.beforeRequest)){e=a.p.beforeRequest.call(a);e===void 0&&(e=true);if(e===false)return}g=a.p.datatype.toLowerCase();switch(g){case "json":case "jsonp":case "xml":case "script":b.ajax(b.extend({url:a.p.url,
type:a.p.mtype,dataType:g,data:b.isFunction(a.p.serializeGridData)?a.p.serializeGridData.call(a,a.p.postData):a.p.postData,success:function(e,f,h){if(b.isFunction(a.p.beforeProcessing)&&a.p.beforeProcessing.call(a,e,f,h)===false)Q();else{g==="xml"?H(e,a.grid.bDiv,o,c>1,j):U(e,a.grid.bDiv,o,c>1,j);b(a).triggerHandler("jqGridLoadComplete",[e]);i&&i.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",[e]);d&&a.grid.populateVisible();if(a.p.loadonce||a.p.treeGrid)a.p.datatype="local";c===1&&Q()}},
error:function(d,e,f){b.isFunction(a.p.loadError)&&a.p.loadError.call(a,d,e,f);c===1&&Q()},beforeSend:function(c,d){var e=true;b.isFunction(a.p.loadBeforeSend)&&(e=a.p.loadBeforeSend.call(a,c,d));e===void 0&&(e=true);if(e===false)return false;S()}},b.jgrid.ajaxOptions,a.p.ajaxGridOptions));break;case "xmlstring":S();e=typeof a.p.datastr!=="string"?a.p.datastr:b.parseXML(a.p.datastr);H(e,a.grid.bDiv);b(a).triggerHandler("jqGridLoadComplete",[e]);h&&a.p.loadComplete.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",
[e]);a.p.datatype="local";a.p.datastr=null;Q();break;case "jsonstring":S();e=typeof a.p.datastr==="string"?b.jgrid.parse(a.p.datastr):a.p.datastr;U(e,a.grid.bDiv);b(a).triggerHandler("jqGridLoadComplete",[e]);h&&a.p.loadComplete.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",[e]);a.p.datatype="local";a.p.datastr=null;Q();break;case "local":case "clientside":S();a.p.datatype="local";e=ka();U(e,a.grid.bDiv,o,c>1,j);b(a).triggerHandler("jqGridLoadComplete",[e]);i&&i.call(a,e);b(a).triggerHandler("jqGridAfterLoadComplete",
[e]);d&&a.grid.populateVisible();Q()}}}},ea=function(c){b("#cb_"+b.jgrid.jqID(a.p.id),a.grid.hDiv)[a.p.useProp?"prop":"attr"]("checked",c);if(a.p.frozenColumns&&a.p.id+"_frozen")b("#cb_"+b.jgrid.jqID(a.p.id),a.grid.fhDiv)[a.p.useProp?"prop":"attr"]("checked",c)},la=function(c,d){var e="",f="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",i="",j,k,m,l,o=function(c){var d;b.isFunction(a.p.onPaging)&&(d=a.p.onPaging.call(a,c));if(d==="stop")return false;
a.p.selrow=null;if(a.p.multiselect){a.p.selarrrow=[];ea(false)}a.p.savedRow=[];return true},c=c.substr(1),d=d+("_"+c);j="pg_"+c;k=c+"_left";m=c+"_center";l=c+"_right";b("#"+b.jgrid.jqID(c)).append("<div id='"+j+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+k+"' align='left'></td><td id='"+m+"' align='center' style='white-space:pre;'></td><td id='"+l+"' align='right'></td></tr></tbody></table></div>").attr("dir",
"ltr");if(a.p.rowList.length>0){i="<td dir='"+g+"'>";i=i+"<select class='ui-pg-selbox' role='listbox'>";for(k=0;k<a.p.rowList.length;k++)i=i+('<option role="option" value="'+a.p.rowList[k]+'"'+(a.p.rowNum===a.p.rowList[k]?' selected="selected"':"")+">"+a.p.rowList[k]+"</option>");i=i+"</select></td>"}g==="rtl"&&(f=f+i);a.p.pginput===true&&(e="<td dir='"+g+"'>"+b.jgrid.format(a.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+
b.jgrid.jqID(c)+"'></span>")+"</td>");if(a.p.pgbuttons===true){k=["first"+d,"prev"+d,"next"+d,"last"+d];g==="rtl"&&k.reverse();f=f+("<td id='"+k[0]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>");f=f+("<td id='"+k[1]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>");f=f+(e!==""?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+e+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":
"")+("<td id='"+k[2]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>");f=f+("<td id='"+k[3]+"' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>")}else e!==""&&(f=f+e);g==="ltr"&&(f=f+i);f=f+"</tr></tbody></table>";a.p.viewrecords===true&&b("td#"+c+"_"+a.p.recordpos,"#"+j).append("<div dir='"+g+"' style='text-align:"+a.p.recordpos+"' class='ui-paging-info'></div>");b("td#"+c+"_"+a.p.pagerpos,"#"+j).append(f);i=b(".ui-jqgrid").css("font-size")||
"11px";b(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+i+";visibility:hidden;' ></div>");f=b(f).clone().appendTo("#testpg").width();b("#testpg").remove();if(f>0){e!==""&&(f=f+50);b("td#"+c+"_"+a.p.pagerpos,"#"+j).width(f)}a.p._nvtd=[];a.p._nvtd[0]=f?Math.floor((a.p.width-f)/2):Math.floor(a.p.width/3);a.p._nvtd[1]=0;f=null;b(".ui-pg-selbox","#"+j).bind("change",function(){if(!o("records"))return false;a.p.page=Math.round(a.p.rowNum*(a.p.page-
1)/this.value-0.5)+1;a.p.rowNum=this.value;a.p.pager&&b(".ui-pg-selbox",a.p.pager).val(this.value);a.p.toppager&&b(".ui-pg-selbox",a.p.toppager).val(this.value);M();return false});if(a.p.pgbuttons===true){b(".ui-pg-button","#"+j).hover(function(){if(b(this).hasClass("ui-state-disabled"))this.style.cursor="default";else{b(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(){if(!b(this).hasClass("ui-state-disabled")){b(this).removeClass("ui-state-hover");this.style.cursor="default"}});
b("#first"+b.jgrid.jqID(d)+", #prev"+b.jgrid.jqID(d)+", #next"+b.jgrid.jqID(d)+", #last"+b.jgrid.jqID(d)).click(function(){var b=n(a.p.page,1),c=n(a.p.lastpage,1),e=false,f=true,g=true,h=true,i=true;if(c===0||c===1)i=h=g=f=false;else if(c>1&&b>=1)if(b===1)g=f=false;else{if(b===c)i=h=false}else if(c>1&&b===0){i=h=false;b=c-1}if(!o(this.id))return false;if(this.id==="first"+d&&f){a.p.page=1;e=true}if(this.id==="prev"+d&&g){a.p.page=b-1;e=true}if(this.id==="next"+d&&h){a.p.page=b+1;e=true}if(this.id===
"last"+d&&i){a.p.page=c;e=true}e&&M();return false})}a.p.pginput===true&&b("input.ui-pg-input","#"+j).keypress(function(c){if((c.charCode||c.keyCode||0)===13){if(!o("user"))return false;b(this).val(n(b(this).val(),1));a.p.page=b(this).val()>0?b(this).val():a.p.page;M();return false}return this})},sa=function(c,d){var e,f="",g=a.p.colModel,h=false,i;i=a.p.frozenColumns?d:a.grid.headers[c].el;var j="";b("span.ui-grid-ico-sort",i).addClass("ui-state-disabled");b(i).attr("aria-selected","false");if(g[c].lso)if(g[c].lso===
"asc"){g[c].lso=g[c].lso+"-desc";j="desc"}else if(g[c].lso==="desc"){g[c].lso=g[c].lso+"-asc";j="asc"}else{if(g[c].lso==="asc-desc"||g[c].lso==="desc-asc")g[c].lso=""}else g[c].lso=j=g[c].firstsortorder||"asc";if(j){b("span.s-ico",i).show();b("span.ui-icon-"+j,i).removeClass("ui-state-disabled");b(i).attr("aria-selected","true")}else a.p.viewsortcols[0]||b("span.s-ico",i).hide();a.p.sortorder="";b.each(g,function(b){if(this.lso){b>0&&h&&(f=f+", ");e=this.lso.split("-");f=f+(g[b].index||g[b].name);
f=f+(" "+e[e.length-1]);h=true;a.p.sortorder=e[e.length-1]}});i=f.lastIndexOf(a.p.sortorder);f=f.substring(0,i);a.p.sortname=f},ma=function(c,d,e,f,g){if(a.p.colModel[d].sortable&&!(a.p.savedRow.length>0)){if(!e){if(a.p.lastsort===d)if(a.p.sortorder==="asc")a.p.sortorder="desc";else{if(a.p.sortorder==="desc")a.p.sortorder="asc"}else a.p.sortorder=a.p.colModel[d].firstsortorder||"asc";a.p.page=1}if(a.p.multiSort)sa(d,g);else{if(f){if(a.p.lastsort===d&&a.p.sortorder===f&&!e)return;a.p.sortorder=f}e=
a.grid.headers[a.p.lastsort].el;g=a.p.frozenColumns?g:a.grid.headers[d].el;b("span.ui-grid-ico-sort",e).addClass("ui-state-disabled");b(e).attr("aria-selected","false");if(a.p.frozenColumns){a.grid.fhDiv.find("span.ui-grid-ico-sort").addClass("ui-state-disabled");a.grid.fhDiv.find("th").attr("aria-selected","false")}b("span.ui-icon-"+a.p.sortorder,g).removeClass("ui-state-disabled");b(g).attr("aria-selected","true");if(!a.p.viewsortcols[0]&&a.p.lastsort!==d){a.p.frozenColumns&&a.grid.fhDiv.find("span.s-ico").hide();
b("span.s-ico",e).hide();b("span.s-ico",g).show()}c=c.substring(5+a.p.id.length+1);a.p.sortname=a.p.colModel[d].index||c}if(b(a).triggerHandler("jqGridSortCol",[a.p.sortname,d,a.p.sortorder])==="stop")a.p.lastsort=d;else if(b.isFunction(a.p.onSortCol)&&a.p.onSortCol.call(a,a.p.sortname,d,a.p.sortorder)==="stop")a.p.lastsort=d;else{if(a.p.datatype==="local")a.p.deselectAfterSort&&b(a).jqGrid("resetSelection");else{a.p.selrow=null;a.p.multiselect&&ea(false);a.p.selarrrow=[];a.p.savedRow=[]}if(a.p.scroll){g=
a.grid.bDiv.scrollLeft;W.call(a,true,false);a.grid.hDiv.scrollLeft=g}a.p.subGrid&&a.p.datatype==="local"&&b("td.sgexpanded","#"+b.jgrid.jqID(a.p.id)).each(function(){b(this).trigger("click")});M();a.p.lastsort=d;if(a.p.sortname!==c&&d)a.p.lastsort=d}}},ta=function(c){c=b(a.grid.headers[c].el);c=[c.position().left+c.outerWidth()];a.p.direction==="rtl"&&(c[0]=a.p.width-c[0]);c[0]=c[0]-a.grid.bDiv.scrollLeft;c.push(b(a.grid.hDiv).position().top);c.push(b(a.grid.bDiv).offset().top-b(a.grid.hDiv).offset().top+
b(a.grid.bDiv).height());return c},na=function(c){var d,e=a.grid.headers,f=b.jgrid.getCellIndex(c);for(d=0;d<e.length;d++)if(c===e[d].el){f=d;break}return f};this.p.id=this.id;-1===b.inArray(a.p.multikey,["shiftKey","altKey","ctrlKey"])&&(a.p.multikey=!1);a.p.keyIndex=!1;a.p.keyName=!1;for(f=0;f<a.p.colModel.length;f++)a.p.colModel[f]=b.extend(!0,{},a.p.cmTemplate,a.p.colModel[f].template||{},a.p.colModel[f]),!1===a.p.keyIndex&&!0===a.p.colModel[f].key&&(a.p.keyIndex=f);a.p.sortorder=a.p.sortorder.toLowerCase();
b.jgrid.cell_width=b.jgrid.cellWidth();!0===a.p.grouping&&(a.p.scroll=!1,a.p.rownumbers=!1,a.p.treeGrid=!1,a.p.gridview=!0);if(!0===this.p.treeGrid){try{b(this).jqGrid("setTreeGrid")}catch(wa){}"local"!==a.p.datatype&&(a.p.localReader={id:"_id_"})}if(this.p.subGrid)try{b(a).jqGrid("setSubGrid")}catch(xa){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:b.jgrid.cell_width?a.p.multiselectWidth+
a.p.cellLayout:a.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:a.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0}));a.p.xmlReader=b.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},
a.p.xmlReader);a.p.jsonReader=b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},a.p.jsonReader);a.p.localReader=b.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},a.p.localReader);a.p.scroll&&(a.p.pgbuttons=!1,a.p.pginput=!1,a.p.rowList=[]);a.p.data.length&&
P();var x="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",oa,D,fa,ca,ga,w,o,X,pa=X="",da=[],qa=[];D=[];if(!0===a.p.shrinkToFit&&!0===a.p.forceFit)for(f=a.p.colModel.length-1;0<=f;f--)if(!a.p.colModel[f].hidden){a.p.colModel[f].resizable=!1;break}"horizontal"===a.p.viewsortcols[1]&&(X=" ui-i-asc",pa=" ui-i-desc");oa=k?"class='ui-th-div-ie'":"";X="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+X+" ui-state-disabled ui-icon ui-icon-triangle-1-n ui-sort-"+
g+"'></span>"+("<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+pa+" ui-state-disabled ui-icon ui-icon-triangle-1-s ui-sort-"+g+"'></span></span>");if(a.p.multiSort){da=a.p.sortname.split(",");for(f=0;f<da.length;f++)D=b.trim(da[f]).split(" "),da[f]=b.trim(D[0]),qa[f]=D[1]?b.trim(D[1]):a.p.sortorder||"asc"}for(f=0;f<this.p.colNames.length;f++)D=a.p.headertitles?' title="'+b.jgrid.stripHtml(a.p.colNames[f])+'"':"",x+="<th id='"+a.p.id+"_"+a.p.colModel[f].name+"' role='columnheader' class='ui-state-default ui-th-column ui-th-"+
g+"'"+D+">",D=a.p.colModel[f].index||a.p.colModel[f].name,x+="<div id='jqgh_"+a.p.id+"_"+a.p.colModel[f].name+"' "+oa+">"+a.p.colNames[f],a.p.colModel[f].width=a.p.colModel[f].width?parseInt(a.p.colModel[f].width,10):150,"boolean"!==typeof a.p.colModel[f].title&&(a.p.colModel[f].title=!0),a.p.colModel[f].lso="",D===a.p.sortname&&(a.p.lastsort=f),a.p.multiSort&&(D=b.inArray(D,da),-1!==D&&(a.p.colModel[f].lso=qa[D])),x+=X+"</div></th>";X=null;b(this).append(x+"</tr></thead>");b("thead tr:first th",
this).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});if(this.p.multiselect){var ha=[],Y;b("#cb_"+b.jgrid.jqID(a.p.id),this).bind("click",function(){a.p.selarrrow=[];var c=a.p.frozenColumns===true?a.p.id+"_frozen":"";if(this.checked){b(a.rows).each(function(d){if(d>0&&!b(this).hasClass("ui-subgrid")&&!b(this).hasClass("jqgroup")&&!b(this).hasClass("ui-state-disabled")){b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id))[a.p.useProp?"prop":
"attr"]("checked",true);b(this).addClass("ui-state-highlight").attr("aria-selected","true");a.p.selarrrow.push(this.id);a.p.selrow=this.id;if(c){b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id),a.grid.fbDiv)[a.p.useProp?"prop":"attr"]("checked",true);b("#"+b.jgrid.jqID(this.id),a.grid.fbDiv).addClass("ui-state-highlight")}}});Y=true;ha=[]}else{b(a.rows).each(function(d){if(d>0&&!b(this).hasClass("ui-subgrid")&&!b(this).hasClass("ui-state-disabled")){b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id))[a.p.useProp?
"prop":"attr"]("checked",false);b(this).removeClass("ui-state-highlight").attr("aria-selected","false");ha.push(this.id);if(c){b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(this.id),a.grid.fbDiv)[a.p.useProp?"prop":"attr"]("checked",false);b("#"+b.jgrid.jqID(this.id),a.grid.fbDiv).removeClass("ui-state-highlight")}}});a.p.selrow=null;Y=false}b(a).triggerHandler("jqGridSelectAll",[Y?a.p.selarrrow:ha,Y]);b.isFunction(a.p.onSelectAll)&&a.p.onSelectAll.call(a,Y?a.p.selarrrow:ha,Y)})}!0===a.p.autowidth&&
(x=b(m).innerWidth(),a.p.width=0<x?x:"nw");(function(){var d=0,e=b.jgrid.cell_width?0:n(a.p.cellLayout,0),f=0,g,h=n(a.p.scrollOffset,0),j,k=false,m,l=0,o;b.each(a.p.colModel,function(){if(this.hidden===void 0)this.hidden=false;if(a.p.grouping&&a.p.autowidth){var c=b.inArray(this.name,a.p.groupingView.groupField);if(c>=0&&a.p.groupingView.groupColumnShow.length>c)this.hidden=!a.p.groupingView.groupColumnShow[c]}this.widthOrg=j=n(this.width,0);if(this.hidden===false){d=d+(j+e);this.fixed?l=l+(j+e):
f++}});if(isNaN(a.p.width))a.p.width=d+(a.p.shrinkToFit===false&&!isNaN(a.p.height)?h:0);c.width=a.p.width;a.p.tblwidth=d;if(a.p.shrinkToFit===false&&a.p.forceFit===true)a.p.forceFit=false;if(a.p.shrinkToFit===true&&f>0){m=c.width-e*f-l;if(!isNaN(a.p.height)){m=m-h;k=true}d=0;b.each(a.p.colModel,function(b){if(this.hidden===false&&!this.fixed){this.width=j=Math.round(m*this.width/(a.p.tblwidth-e*f-l));d=d+j;g=b}});o=0;k?c.width-l-(d+e*f)!==h&&(o=c.width-l-(d+e*f)-h):!k&&Math.abs(c.width-l-(d+e*f))!==
1&&(o=c.width-l-(d+e*f));a.p.colModel[g].width=a.p.colModel[g].width+o;a.p.tblwidth=d+o+e*f+l;if(a.p.tblwidth>a.p.width){a.p.colModel[g].width=a.p.colModel[g].width-(a.p.tblwidth-parseInt(a.p.width,10));a.p.tblwidth=a.p.width}}})();b(m).css("width",c.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+a.p.id+"'>&#160;</div>");b(j).css("width",c.width+"px");var x=b("thead:first",a).get(0),N="";a.p.footerrow&&(N+="<table role='grid' style='width:"+a.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow footrow-"+
g+"'>");var j=b("tr:first",x),aa="<tr class='jqgfirstrow' role='row' style='height:auto'>";a.p.disableClick=!1;b("th",j).each(function(d){fa=a.p.colModel[d].width;if(a.p.colModel[d].resizable===void 0)a.p.colModel[d].resizable=true;if(a.p.colModel[d].resizable){ca=document.createElement("span");b(ca).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+g).css("cursor","col-resize");b(this).addClass(a.p.resizeclass)}else ca="";b(this).css("width",fa+"px").prepend(ca);ca=null;var e="";if(a.p.colModel[d].hidden){b(this).css("display",
"none");e="display:none;"}aa=aa+("<td role='gridcell' style='height:0px;width:"+fa+"px;"+e+"'></td>");c.headers[d]={width:fa,el:this};ga=a.p.colModel[d].sortable;if(typeof ga!=="boolean")ga=a.p.colModel[d].sortable=true;e=a.p.colModel[d].name;e==="cb"||e==="subgrid"||e==="rn"||a.p.viewsortcols[2]&&b(">div",this).addClass("ui-jqgrid-sortable");if(ga)if(a.p.multiSort)if(a.p.viewsortcols[0]){b("div span.s-ico",this).show();a.p.colModel[d].lso&&b("div span.ui-icon-"+a.p.colModel[d].lso,this).removeClass("ui-state-disabled")}else{if(a.p.colModel[d].lso){b("div span.s-ico",
this).show();b("div span.ui-icon-"+a.p.colModel[d].lso,this).removeClass("ui-state-disabled")}}else if(a.p.viewsortcols[0]){b("div span.s-ico",this).show();d===a.p.lastsort&&b("div span.ui-icon-"+a.p.sortorder,this).removeClass("ui-state-disabled")}else if(d===a.p.lastsort){b("div span.s-ico",this).show();b("div span.ui-icon-"+a.p.sortorder,this).removeClass("ui-state-disabled")}a.p.footerrow&&(N=N+("<td role='gridcell' "+l(d,0,"",null,"",false)+">&#160;</td>"))}).mousedown(function(d){if(b(d.target).closest("th>span.ui-jqgrid-resize").length===
1){var e=na(this);if(a.p.forceFit===true){var f=a.p,g=e,h;for(h=e+1;h<a.p.colModel.length;h++)if(a.p.colModel[h].hidden!==true){g=h;break}f.nv=g-e}c.dragStart(e,d,ta(e));return false}}).click(function(c){if(a.p.disableClick)return a.p.disableClick=false;var d="th>div.ui-jqgrid-sortable",e,f;a.p.viewsortcols[2]||(d="th>div>span>span.ui-grid-ico-sort");c=b(c.target).closest(d);if(c.length===1){var g;if(a.p.frozenColumns){var h=b(this)[0].id.substring(a.p.id.length+1);b(a.p.colModel).each(function(a){if(this.name===
h){g=a;return false}})}else g=na(this);if(!a.p.viewsortcols[2]){e=true;f=c.attr("sort")}g!=null&&ma(b("div",this)[0].id,g,e,f,this);return false}});if(a.p.sortable&&b.fn.sortable)try{b(a).jqGrid("sortableColumns",j)}catch(ya){}a.p.footerrow&&(N+="</tr></tbody></table>");aa+="</tr>";this.appendChild(document.createElement("tbody"));b(this).addClass("ui-jqgrid-btable").append(aa);var aa=null,j=b("<table class='ui-jqgrid-htable' style='width:"+a.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+
"' cellspacing='0' cellpadding='0' border='0'></table>").append(x),G=a.p.caption&&!0===a.p.hiddengrid?!0:!1;f=b("<div class='ui-jqgrid-hbox"+("rtl"===g?"-rtl":"")+"'></div>");x=null;c.hDiv=document.createElement("div");b(c.hDiv).css({width:c.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(f);b(f).append(j);j=null;G&&b(c.hDiv).hide();a.p.pager&&("string"===typeof a.p.pager?"#"!==a.p.pager.substr(0,1)&&(a.p.pager="#"+a.p.pager):a.p.pager="#"+b(a.p.pager).attr("id"),b(a.p.pager).css({width:c.width+
"px"}).addClass("ui-state-default ui-jqgrid-pager ui-corner-bottom").appendTo(m),G&&b(a.p.pager).hide(),la(a.p.pager,""));!1===a.p.cellEdit&&!0===a.p.hoverrows&&b(a).bind("mouseover",function(a){o=b(a.target).closest("tr.jqgrow");b(o).attr("class")!=="ui-subgrid"&&b(o).addClass("ui-state-hover")}).bind("mouseout",function(a){o=b(a.target).closest("tr.jqgrow");b(o).removeClass("ui-state-hover")});var z,K,ia;b(a).before(c.hDiv).click(function(c){w=c.target;o=b(w,a.rows).closest("tr.jqgrow");if(b(o).length===
0||o[0].className.indexOf("ui-state-disabled")>-1||(b(w,a).closest("table.ui-jqgrid-btable").attr("id")||"").replace("_frozen","")!==a.id)return this;var d=b(w).hasClass("cbox"),e=b(a).triggerHandler("jqGridBeforeSelectRow",[o[0].id,c]);(e=e===false||e==="stop"?false:true)&&b.isFunction(a.p.beforeSelectRow)&&(e=a.p.beforeSelectRow.call(a,o[0].id,c));if(!(w.tagName==="A"||(w.tagName==="INPUT"||w.tagName==="TEXTAREA"||w.tagName==="OPTION"||w.tagName==="SELECT")&&!d)&&e===true){z=o[0].id;K=b.jgrid.getCellIndex(w);
ia=b(w).closest("td,th").html();b(a).triggerHandler("jqGridCellSelect",[z,K,ia,c]);b.isFunction(a.p.onCellSelect)&&a.p.onCellSelect.call(a,z,K,ia,c);if(a.p.cellEdit===true)if(a.p.multiselect&&d)b(a).jqGrid("setSelection",z,true,c);else{z=o[0].rowIndex;try{b(a).jqGrid("editCell",z,K,true)}catch(f){}}else if(a.p.multikey)if(c[a.p.multikey])b(a).jqGrid("setSelection",z,true,c);else{if(a.p.multiselect&&d){d=b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+z).is(":checked");b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+z)[a.p.useProp?
"prop":"attr"]("checked",d)}}else{if(a.p.multiselect&&a.p.multiboxonly&&!d){var g=a.p.frozenColumns?a.p.id+"_frozen":"";b(a.p.selarrrow).each(function(c,d){var e=b(a).jqGrid("getGridRowById",d);b(e).removeClass("ui-state-highlight");b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(d))[a.p.useProp?"prop":"attr"]("checked",false);if(g){b("#"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(g)).removeClass("ui-state-highlight");b("#jqg_"+b.jgrid.jqID(a.p.id)+"_"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(g))[a.p.useProp?"prop":
"attr"]("checked",false)}});a.p.selarrrow=[]}b(a).jqGrid("setSelection",z,true,c)}}}).bind("reloadGrid",function(c,d){if(a.p.treeGrid===true)a.p.datatype=a.p.treedatatype;d&&d.current&&a.grid.selectionPreserver(a);if(a.p.datatype==="local"){b(a).jqGrid("resetSelection");a.p.data.length&&P()}else if(!a.p.treeGrid){a.p.selrow=null;if(a.p.multiselect){a.p.selarrrow=[];ea(false)}a.p.savedRow=[]}a.p.scroll&&W.call(a,true,false);if(d&&d.page){var e=d.page;if(e>a.p.lastpage)e=a.p.lastpage;e<1&&(e=1);a.p.page=
e;a.grid.bDiv.scrollTop=a.grid.prevRowHeight?(e-1)*a.grid.prevRowHeight*a.p.rowNum:0}if(a.grid.prevRowHeight&&a.p.scroll){delete a.p.lastpage;a.grid.populateVisible()}else a.grid.populate();a.p._inlinenav===true&&b(a).jqGrid("showAddEditButtons");return false}).dblclick(function(c){w=c.target;o=b(w,a.rows).closest("tr.jqgrow");if(b(o).length!==0){z=o[0].rowIndex;K=b.jgrid.getCellIndex(w);b(a).triggerHandler("jqGridDblClickRow",[b(o).attr("id"),z,K,c]);b.isFunction(a.p.ondblClickRow)&&a.p.ondblClickRow.call(a,
b(o).attr("id"),z,K,c)}}).bind("contextmenu",function(c){w=c.target;o=b(w,a.rows).closest("tr.jqgrow");if(b(o).length!==0){a.p.multiselect||b(a).jqGrid("setSelection",o[0].id,true,c);z=o[0].rowIndex;K=b.jgrid.getCellIndex(w);b(a).triggerHandler("jqGridRightClickRow",[b(o).attr("id"),z,K,c]);b.isFunction(a.p.onRightClickRow)&&a.p.onRightClickRow.call(a,b(o).attr("id"),z,K,c)}});c.bDiv=document.createElement("div");k&&"auto"===(""+a.p.height).toLowerCase()&&(a.p.height="100%");b(c.bDiv).append(b('<div style="position:relative;'+
(k&&8>b.jgrid.msiever()?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:a.p.height+(isNaN(a.p.height)?"":"px"),width:c.width+"px"}).scroll(c.scrollGrid);b("table:first",c.bDiv).css({width:a.p.tblwidth+"px"});b.support.tbody||2===b("tbody",this).length&&b("tbody:gt(0)",this).remove();a.p.multikey&&(b.jgrid.msie?b(c.bDiv).bind("selectstart",function(){return false}):b(c.bDiv).bind("mousedown",function(){return false}));G&&b(c.bDiv).hide();c.cDiv=
document.createElement("div");var ja=!0===a.p.hidegrid?b("<a role='link' class='ui-jqgrid-titlebar-close HeaderButton' />").hover(function(){ja.addClass("ui-state-hover")},function(){ja.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>").css("rtl"===g?"left":"right","0px"):"";b(c.cDiv).append(ja).append("<span class='ui-jqgrid-title"+("rtl"===g?"-rtl":"")+"'>"+a.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-top ui-helper-clearfix");
b(c.cDiv).insertBefore(c.hDiv);a.p.toolbar[0]&&(c.uDiv=document.createElement("div"),"top"===a.p.toolbar[1]?b(c.uDiv).insertBefore(c.hDiv):"bottom"===a.p.toolbar[1]&&b(c.uDiv).insertAfter(c.hDiv),"both"===a.p.toolbar[1]?(c.ubDiv=document.createElement("div"),b(c.uDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id).insertBefore(c.hDiv),b(c.ubDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id).insertAfter(c.hDiv),G&&b(c.ubDiv).hide()):b(c.uDiv).width(c.width).addClass("ui-userdata ui-state-default").attr("id",
"t_"+this.id),G&&b(c.uDiv).hide());a.p.toppager&&(a.p.toppager=b.jgrid.jqID(a.p.id)+"_toppager",c.topDiv=b("<div id='"+a.p.toppager+"'></div>")[0],a.p.toppager="#"+a.p.toppager,b(c.topDiv).addClass("ui-state-default ui-jqgrid-toppager").width(c.width).insertBefore(c.hDiv),la(a.p.toppager,"_t"));a.p.footerrow&&(c.sDiv=b("<div class='ui-jqgrid-sdiv'></div>")[0],f=b("<div class='ui-jqgrid-hbox"+("rtl"===g?"-rtl":"")+"'></div>"),b(c.sDiv).append(f).width(c.width).insertAfter(c.hDiv),b(f).append(N),c.footers=
b(".ui-jqgrid-ftable",c.sDiv)[0].rows[0].cells,a.p.rownumbers&&(c.footers[0].className="ui-state-default jqgrid-rownum"),G&&b(c.sDiv).hide());f=null;if(a.p.caption){var ua=a.p.datatype;!0===a.p.hidegrid&&(b(".ui-jqgrid-titlebar-close",c.cDiv).click(function(d){var e=b.isFunction(a.p.onHeaderClick),f=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",g,h=this;if(a.p.toolbar[0]===true){a.p.toolbar[1]==="both"&&(f=f+(", #"+b(c.ubDiv).attr("id")));f=f+(", #"+b(c.uDiv).attr("id"))}g=
b(f,"#gview_"+b.jgrid.jqID(a.p.id)).length;a.p.gridstate==="visible"?b(f,"#gbox_"+b.jgrid.jqID(a.p.id)).slideUp("fast",function(){g--;if(g===0){b("span",h).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");a.p.gridstate="hidden";b("#gbox_"+b.jgrid.jqID(a.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(a.p.id)).hide();b(a).triggerHandler("jqGridHeaderClick",[a.p.gridstate,d]);e&&(G||a.p.onHeaderClick.call(a,a.p.gridstate,d))}}):a.p.gridstate===
"hidden"&&b(f,"#gbox_"+b.jgrid.jqID(a.p.id)).slideDown("fast",function(){g--;if(g===0){b("span",h).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(G){a.p.datatype=ua;M();G=false}a.p.gridstate="visible";b("#gbox_"+b.jgrid.jqID(a.p.id)).hasClass("ui-resizable")&&b(".ui-resizable-handle","#gbox_"+b.jgrid.jqID(a.p.id)).show();b(a).triggerHandler("jqGridHeaderClick",[a.p.gridstate,d]);e&&(G||a.p.onHeaderClick.call(a,a.p.gridstate,d))}});return false}),G&&(a.p.datatype=
"local",b(".ui-jqgrid-titlebar-close",c.cDiv).trigger("click")))}else b(c.cDiv).hide();b(c.hDiv).after(c.bDiv).mousemove(function(a){if(c.resizing){c.dragMove(a);return false}});b(".ui-jqgrid-labels",c.hDiv).bind("selectstart",function(){return false});b(document).bind("mouseup.jqGrid"+a.p.id,function(){if(c.resizing){c.dragEnd();return false}return true});a.formatCol=l;a.sortData=ma;a.updatepager=function(c,d){var e,f,g,h,i,j,k,m="",l=a.p.pager?"_"+b.jgrid.jqID(a.p.pager.substr(1)):"",o=a.p.toppager?
"_"+a.p.toppager.substr(1):"";g=parseInt(a.p.page,10)-1;g<0&&(g=0);g=g*parseInt(a.p.rowNum,10);i=g+a.p.reccount;if(a.p.scroll){e=b("tbody:first > tr:gt(0)",a.grid.bDiv);g=i-e.length;a.p.reccount=e.length;if(e=e.outerHeight()||a.grid.prevRowHeight){f=g*e;k=parseInt(a.p.records,10)*e;b(">div:first",a.grid.bDiv).css({height:k}).children("div:first").css({height:f,display:f?"":"none"});if(a.grid.bDiv.scrollTop==0&&a.p.page>1)a.grid.bDiv.scrollTop=a.p.rowNum*(a.p.page-1)*e}a.grid.bDiv.scrollLeft=a.grid.hDiv.scrollLeft}m=
a.p.pager||"";if(m=m+(a.p.toppager?m?","+a.p.toppager:a.p.toppager:"")){k=b.jgrid.formatter.integer||{};e=n(a.p.page);f=n(a.p.lastpage);b(".selbox",m)[this.p.useProp?"prop":"attr"]("disabled",false);if(a.p.pginput===true){b(".ui-pg-input",m).val(a.p.page);h=a.p.toppager?"#sp_1"+l+",#sp_1"+o:"#sp_1"+l;b(h).html(b.fmatter?b.fmatter.util.NumberFormat(a.p.lastpage,k):a.p.lastpage)}if(a.p.viewrecords)if(a.p.reccount===0)b(".ui-paging-info",m).html(a.p.emptyrecords);else{h=g+1;j=a.p.records;if(b.fmatter){h=
b.fmatter.util.NumberFormat(h,k);i=b.fmatter.util.NumberFormat(i,k);j=b.fmatter.util.NumberFormat(j,k)}b(".ui-paging-info",m).html(b.jgrid.format(a.p.recordtext,h,i,j))}if(a.p.pgbuttons===true){e<=0&&(e=f=0);if(e===1||e===0){b("#first"+l+", #prev"+l).addClass("ui-state-disabled").removeClass("ui-state-hover");a.p.toppager&&b("#first_t"+o+", #prev_t"+o).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{b("#first"+l+", #prev"+l).removeClass("ui-state-disabled");a.p.toppager&&b("#first_t"+
o+", #prev_t"+o).removeClass("ui-state-disabled")}if(e===f||e===0){b("#next"+l+", #last"+l).addClass("ui-state-disabled").removeClass("ui-state-hover");a.p.toppager&&b("#next_t"+o+", #last_t"+o).addClass("ui-state-disabled").removeClass("ui-state-hover")}else{b("#next"+l+", #last"+l).removeClass("ui-state-disabled");a.p.toppager&&b("#next_t"+o+", #last_t"+o).removeClass("ui-state-disabled")}}}c===true&&a.p.rownumbers===true&&b(">td.jqgrid-rownum",a.rows).each(function(a){b(this).html(g+1+a)});d&&
a.p.jqgdnd&&b(a).jqGrid("gridDnD","updateDnD");b(a).triggerHandler("jqGridGridComplete");b.isFunction(a.p.gridComplete)&&a.p.gridComplete.call(a);b(a).triggerHandler("jqGridAfterGridComplete")};a.refreshIndex=P;a.setHeadCheckBox=ea;a.constructTr=Z;a.formatter=function(a,b,c,d,e){return u(a,b,c,d,e)};b.extend(c,{populate:M,emptyRows:W,beginReq:S,endReq:Q});this.grid=c;a.addXmlData=function(b){H(b,a.grid.bDiv)};a.addJSONData=function(b){U(b,a.grid.bDiv)};this.grid.cols=this.rows[0].cells;b(a).triggerHandler("jqGridInitGrid");
b.isFunction(a.p.onInitGrid)&&a.p.onInitGrid.call(a);M();a.p.hiddengrid=!1}}}})};b.jgrid.extend({getGridParam:function(b){var g=this[0];return!g||!g.grid?void 0:!b?g.p:void 0!==g.p[b]?g.p[b]:null},setGridParam:function(d){return this.each(function(){this.grid&&"object"===typeof d&&b.extend(!0,this.p,d)})},getGridRowById:function(d){var g;this.each(function(){try{g=this.rows.namedItem(d)}catch(c){g=b(this.grid.bDiv).find("#"+b.jgrid.jqID(d))}});return g},getDataIDs:function(){var d=[],g=0,c,e=0;this.each(function(){if((c=
this.rows.length)&&0<c)for(;g<c;)b(this.rows[g]).hasClass("jqgrow")&&(d[e]=this.rows[g].id,e++),g++});return d},setSelection:function(d,g,c){return this.each(function(){var e,a,i,f,h,j;if(void 0!==d&&(g=!1===g?!1:!0,(a=b(this).jqGrid("getGridRowById",d))&&a.className&&!(-1<a.className.indexOf("ui-state-disabled"))))if(!0===this.p.scrollrows&&(i=b(this).jqGrid("getGridRowById",d).rowIndex,0<=i&&(e=b(this.grid.bDiv)[0].clientHeight,f=b(this.grid.bDiv)[0].scrollTop,h=b(this.rows[i]).position().top,i=
this.rows[i].clientHeight,h+i>=e+f?b(this.grid.bDiv)[0].scrollTop=h-(e+f)+i+f:h<e+f&&h<f&&(b(this.grid.bDiv)[0].scrollTop=h))),!0===this.p.frozenColumns&&(j=this.p.id+"_frozen"),this.p.multiselect){if(this.setHeadCheckBox(!1),this.p.selrow=a.id,f=b.inArray(this.p.selrow,this.p.selarrrow),-1===f?("ui-subgrid"!==a.className&&b(a).addClass("ui-state-highlight").attr("aria-selected","true"),e=!0,this.p.selarrrow.push(this.p.selrow)):("ui-subgrid"!==a.className&&b(a).removeClass("ui-state-highlight").attr("aria-selected",
"false"),e=!1,this.p.selarrrow.splice(f,1),h=this.p.selarrrow[0],this.p.selrow=void 0===h?null:h),b("#jqg_"+b.jgrid.jqID(this.p.id)+"_"+b.jgrid.jqID(a.id))[this.p.useProp?"prop":"attr"]("checked",e),j&&(-1===f?b("#"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(j)).addClass("ui-state-highlight"):b("#"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(j)).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(this.p.id)+"_"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(j))[this.p.useProp?"prop":"attr"]("checked",e)),g)b(this).triggerHandler("jqGridSelectRow",
[a.id,e,c]),this.p.onSelectRow&&this.p.onSelectRow.call(this,a.id,e,c)}else if("ui-subgrid"!==a.className&&(this.p.selrow!==a.id?(b(b(this).jqGrid("getGridRowById",this.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"}),b(a).addClass("ui-state-highlight").attr({"aria-selected":"true",tabindex:"0"}),j&&(b("#"+b.jgrid.jqID(this.p.selrow),"#"+b.jgrid.jqID(j)).removeClass("ui-state-highlight"),b("#"+b.jgrid.jqID(d),"#"+b.jgrid.jqID(j)).addClass("ui-state-highlight")),
e=!0):e=!1,this.p.selrow=a.id,g))b(this).triggerHandler("jqGridSelectRow",[a.id,e,c]),this.p.onSelectRow&&this.p.onSelectRow.call(this,a.id,e,c)})},resetSelection:function(d){return this.each(function(){var g=this,c,e;!0===g.p.frozenColumns&&(e=g.p.id+"_frozen");if(void 0!==d){c=d===g.p.selrow?g.p.selrow:d;b("#"+b.jgrid.jqID(g.p.id)+" tbody:first tr#"+b.jgrid.jqID(c)).removeClass("ui-state-highlight").attr("aria-selected","false");e&&b("#"+b.jgrid.jqID(c),"#"+b.jgrid.jqID(e)).removeClass("ui-state-highlight");
if(g.p.multiselect){b("#jqg_"+b.jgrid.jqID(g.p.id)+"_"+b.jgrid.jqID(c),"#"+b.jgrid.jqID(g.p.id))[g.p.useProp?"prop":"attr"]("checked",!1);if(e)b("#jqg_"+b.jgrid.jqID(g.p.id)+"_"+b.jgrid.jqID(c),"#"+b.jgrid.jqID(e))[g.p.useProp?"prop":"attr"]("checked",!1);g.setHeadCheckBox(!1)}c=null}else g.p.multiselect?(b(g.p.selarrrow).each(function(a,c){b(b(g).jqGrid("getGridRowById",c)).removeClass("ui-state-highlight").attr("aria-selected","false");b("#jqg_"+b.jgrid.jqID(g.p.id)+"_"+b.jgrid.jqID(c))[g.p.useProp?
"prop":"attr"]("checked",!1);e&&(b("#"+b.jgrid.jqID(c),"#"+b.jgrid.jqID(e)).removeClass("ui-state-highlight"),b("#jqg_"+b.jgrid.jqID(g.p.id)+"_"+b.jgrid.jqID(c),"#"+b.jgrid.jqID(e))[g.p.useProp?"prop":"attr"]("checked",!1))}),g.setHeadCheckBox(!1),g.p.selarrrow=[]):g.p.selrow&&(b("#"+b.jgrid.jqID(g.p.id)+" tbody:first tr#"+b.jgrid.jqID(g.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false"),e&&b("#"+b.jgrid.jqID(g.p.selrow),"#"+b.jgrid.jqID(e)).removeClass("ui-state-highlight"),
g.p.selrow=null);!0===g.p.cellEdit&&0<=parseInt(g.p.iCol,10)&&0<=parseInt(g.p.iRow,10)&&(b("td:eq("+g.p.iCol+")",g.rows[g.p.iRow]).removeClass("edit-cell ui-state-highlight"),b(g.rows[g.p.iRow]).removeClass("selected-row ui-state-hover"));g.p.savedRow=[]})},getRowData:function(d){var g={},c,e=!1,a,i=0;this.each(function(){var f=this,h,j;if(void 0===d)e=!0,c=[],a=f.rows.length;else{j=b(f).jqGrid("getGridRowById",d);if(!j)return g;a=2}for(;i<a;)e&&(j=f.rows[i]),b(j).hasClass("jqgrow")&&(b('td[role="gridcell"]',
j).each(function(a){h=f.p.colModel[a].name;if("cb"!==h&&"subgrid"!==h&&"rn"!==h)if(!0===f.p.treeGrid&&h===f.p.ExpandColumn)g[h]=b.jgrid.htmlDecode(b("span:first",this).html());else try{g[h]=b.unformat.call(f,this,{rowId:j.id,colModel:f.p.colModel[a]},a)}catch(c){g[h]=b.jgrid.htmlDecode(b(this).html())}}),e&&(c.push(g),g={})),i++});return c||g},delRowData:function(d){var g=!1,c,e;this.each(function(){c=b(this).jqGrid("getGridRowById",d);if(!c)return!1;b(c).remove();this.p.records--;this.p.reccount--;
this.updatepager(!0,!1);g=!0;this.p.multiselect&&(e=b.inArray(d,this.p.selarrrow),-1!==e&&this.p.selarrrow.splice(e,1));this.p.selrow=this.p.multiselect&&0<this.p.selarrrow.length?this.p.selarrrow[this.p.selarrrow.length-1]:null;if("local"===this.p.datatype){var a=this.p._index[b.jgrid.stripPref(this.p.idPrefix,d)];void 0!==a&&(this.p.data.splice(a,1),this.refreshIndex())}if(!0===this.p.altRows&&g){var i=this.p.altclass;b(this.rows).each(function(a){a%2===1?b(this).addClass(i):b(this).removeClass(i)})}});
return g},setRowData:function(d,g,c){var e,a=!0,i;this.each(function(){if(!this.grid)return!1;var f=this,h,j,k=typeof c,m={};j=b(this).jqGrid("getGridRowById",d);if(!j)return!1;if(g)try{if(b(this.p.colModel).each(function(a){e=this.name;var c=b.jgrid.getAccessor(g,e);void 0!==c&&(m[e]=this.formatter&&"string"===typeof this.formatter&&"date"===this.formatter?b.unformat.date.call(f,c,this):c,h=f.formatter(d,c,a,g,"edit"),i=this.title?{title:b.jgrid.stripHtml(h)}:{},!0===f.p.treeGrid&&e===f.p.ExpandColumn?
b("td[role='gridcell']:eq("+a+") > span:first",j).html(h).attr(i):b("td[role='gridcell']:eq("+a+")",j).html(h).attr(i))}),"local"===f.p.datatype){var n=b.jgrid.stripPref(f.p.idPrefix,d),l=f.p._index[n],r;if(f.p.treeGrid)for(r in f.p.treeReader)f.p.treeReader.hasOwnProperty(r)&&delete m[f.p.treeReader[r]];void 0!==l&&(f.p.data[l]=b.extend(!0,f.p.data[l],m));m=null}}catch(u){a=!1}a&&("string"===k?b(j).addClass(c):"object"===k&&b(j).css(c),b(f).triggerHandler("jqGridAfterGridComplete"))});return a},
addRowData:function(d,g,c,e){c||(c="last");var a=!1,i,f,h,j,k,m,n,l,r="",u,E,T,L,ba,V;g&&(b.isArray(g)?(u=!0,c="last",E=d):(g=[g],u=!1),this.each(function(){var W=g.length;k=this.p.rownumbers===true?1:0;h=this.p.multiselect===true?1:0;j=this.p.subGrid===true?1:0;if(!u)if(d!==void 0)d=""+d;else{d=b.jgrid.randId();if(this.p.keyIndex!==false){E=this.p.colModel[this.p.keyIndex+h+j+k].name;g[0][E]!==void 0&&(d=g[0][E])}}T=this.p.altclass;for(var P=0,Z="",H={},U=b.isFunction(this.p.afterInsertRow)?true:
false;P<W;){L=g[P];f=[];if(u){try{d=L[E];d===void 0&&(d=b.jgrid.randId())}catch(ka){d=b.jgrid.randId()}Z=this.p.altRows===true?(this.rows.length-1)%2===0?T:"":""}V=d;d=this.p.idPrefix+d;if(k){r=this.formatCol(0,1,"",null,d,true);f[f.length]='<td role="gridcell" class="ui-state-default jqgrid-rownum" '+r+">0</td>"}if(h){l='<input role="checkbox" type="checkbox" id="jqg_'+this.p.id+"_"+d+'" class="cbox"/>';r=this.formatCol(k,1,"",null,d,true);f[f.length]='<td role="gridcell" '+r+">"+l+"</td>"}j&&(f[f.length]=
b(this).jqGrid("addSubGridCell",h+k,1));for(n=h+j+k;n<this.p.colModel.length;n++){ba=this.p.colModel[n];i=ba.name;H[i]=L[i];l=this.formatter(d,b.jgrid.getAccessor(L,i),n,L);r=this.formatCol(n,1,l,L,d,H);f[f.length]='<td role="gridcell" '+r+">"+l+"</td>"}f.unshift(this.constructTr(d,false,Z,H,L,false));f[f.length]="</tr>";if(this.rows.length===0)b("table:first",this.grid.bDiv).append(f.join(""));else switch(c){case "last":b(this.rows[this.rows.length-1]).after(f.join(""));m=this.rows.length-1;break;
case "first":b(this.rows[0]).after(f.join(""));m=1;break;case "after":if(m=b(this).jqGrid("getGridRowById",e)){b(this.rows[m.rowIndex+1]).hasClass("ui-subgrid")?b(this.rows[m.rowIndex+1]).after(f):b(m).after(f.join(""));m=m.rowIndex+1}break;case "before":if(m=b(this).jqGrid("getGridRowById",e)){b(m).before(f.join(""));m=m.rowIndex-1}}this.p.subGrid===true&&b(this).jqGrid("addSubGrid",h+k,m);this.p.records++;this.p.reccount++;b(this).triggerHandler("jqGridAfterInsertRow",[d,L,L]);U&&this.p.afterInsertRow.call(this,
d,L,L);P++;if(this.p.datatype==="local"){H[this.p.localReader.id]=V;this.p._index[V]=this.p.data.length;this.p.data.push(H);H={}}}this.p.altRows===true&&!u&&(c==="last"?(this.rows.length-1)%2===1&&b(this.rows[this.rows.length-1]).addClass(T):b(this.rows).each(function(a){a%2===1?b(this).addClass(T):b(this).removeClass(T)}));this.updatepager(true,true);a=true}));return a},footerData:function(d,g,c){function e(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var a,i=!1,f={},h;void 0===d&&
(d="get");"boolean"!==typeof c&&(c=!0);d=d.toLowerCase();this.each(function(){var j=this,k;if(!j.grid||!j.p.footerrow||"set"===d&&e(g))return!1;i=!0;b(this.p.colModel).each(function(e){a=this.name;"set"===d?void 0!==g[a]&&(k=c?j.formatter("",g[a],e,g,"edit"):g[a],h=this.title?{title:b.jgrid.stripHtml(k)}:{},b("tr.footrow td:eq("+e+")",j.grid.sDiv).html(k).attr(h),i=!0):"get"===d&&(f[a]=b("tr.footrow td:eq("+e+")",j.grid.sDiv).html())})});return"get"===d?f:i},showHideCol:function(d,g){return this.each(function(){var c=
this,e=!1,a=b.jgrid.cell_width?0:c.p.cellLayout,i;if(c.grid){"string"===typeof d&&(d=[d]);g="none"!==g?"":"none";var f=""===g?!0:!1,h=c.p.groupHeader&&("object"===typeof c.p.groupHeader||b.isFunction(c.p.groupHeader));h&&b(c).jqGrid("destroyGroupHeader",!1);b(this.p.colModel).each(function(h){if(-1!==b.inArray(this.name,d)&&this.hidden===f){if(!0===c.p.frozenColumns&&!0===this.frozen)return!0;b("tr[role=rowheader]",c.grid.hDiv).each(function(){b(this.cells[h]).css("display",g)});b(c.rows).each(function(){b(this).hasClass("jqgroup")||
b(this.cells[h]).css("display",g)});c.p.footerrow&&b("tr.footrow td:eq("+h+")",c.grid.sDiv).css("display",g);i=parseInt(this.width,10);c.p.tblwidth="none"===g?c.p.tblwidth-(i+a):c.p.tblwidth+(i+a);this.hidden=!f;e=!0;b(c).triggerHandler("jqGridShowHideCol",[f,this.name,h])}});!0===e&&(!0===c.p.shrinkToFit&&!isNaN(c.p.height)&&(c.p.tblwidth+=parseInt(c.p.scrollOffset,10)),b(c).jqGrid("setGridWidth",!0===c.p.shrinkToFit?c.p.tblwidth:c.p.width));h&&b(c).jqGrid("setGroupHeaders",c.p.groupHeader)}})},
hideCol:function(d){return this.each(function(){b(this).jqGrid("showHideCol",d,"none")})},showCol:function(d){return this.each(function(){b(this).jqGrid("showHideCol",d,"")})},remapColumns:function(d,g,c){function e(a){var c;c=a.length?b.makeArray(a):b.extend({},a);b.each(d,function(b){a[b]=c[this]})}function a(a,c){b(">tr"+(c||""),a).each(function(){var a=this,c=b.makeArray(a.cells);b.each(d,function(){var b=c[this];b&&a.appendChild(b)})})}var i=this.get(0);e(i.p.colModel);e(i.p.colNames);e(i.grid.headers);
a(b("thead:first",i.grid.hDiv),c&&":not(.ui-jqgrid-labels)");g&&a(b("#"+b.jgrid.jqID(i.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");i.p.footerrow&&a(b("tbody:first",i.grid.sDiv));i.p.remapColumns&&(i.p.remapColumns.length?e(i.p.remapColumns):i.p.remapColumns=b.makeArray(d));i.p.lastsort=b.inArray(i.p.lastsort,d);i.p.treeGrid&&(i.p.expColInd=b.inArray(i.p.expColInd,d));b(i).triggerHandler("jqGridRemapColumns",[d,g,c])},setGridWidth:function(d,g){return this.each(function(){if(this.grid){var c=
this,e,a=0,i=b.jgrid.cell_width?0:c.p.cellLayout,f,h=0,j=!1,k=c.p.scrollOffset,m,n=0,l;"boolean"!==typeof g&&(g=c.p.shrinkToFit);if(!isNaN(d)){d=parseInt(d,10);c.grid.width=c.p.width=d;b("#gbox_"+b.jgrid.jqID(c.p.id)).css("width",d+"px");b("#gview_"+b.jgrid.jqID(c.p.id)).css("width",d+"px");b(c.grid.bDiv).css("width",d+"px");b(c.grid.hDiv).css("width",d+"px");c.p.pager&&b(c.p.pager).css("width",d+"px");c.p.toppager&&b(c.p.toppager).css("width",d+"px");!0===c.p.toolbar[0]&&(b(c.grid.uDiv).css("width",
d+"px"),"both"===c.p.toolbar[1]&&b(c.grid.ubDiv).css("width",d+"px"));c.p.footerrow&&b(c.grid.sDiv).css("width",d+"px");!1===g&&!0===c.p.forceFit&&(c.p.forceFit=!1);if(!0===g){b.each(c.p.colModel,function(){if(this.hidden===false){e=this.widthOrg;a=a+(e+i);this.fixed?n=n+(e+i):h++}});if(0===h)return;c.p.tblwidth=a;m=d-i*h-n;if(!isNaN(c.p.height)&&(b(c.grid.bDiv)[0].clientHeight<b(c.grid.bDiv)[0].scrollHeight||1===c.rows.length))j=!0,m-=k;var a=0,r=0<c.grid.cols.length;b.each(c.p.colModel,function(b){if(this.hidden===
false&&!this.fixed){e=this.widthOrg;e=Math.round(m*e/(c.p.tblwidth-i*h-n));if(!(e<0)){this.width=e;a=a+e;c.grid.headers[b].width=e;c.grid.headers[b].el.style.width=e+"px";if(c.p.footerrow)c.grid.footers[b].style.width=e+"px";if(r)c.grid.cols[b].style.width=e+"px";f=b}}});if(!f)return;l=0;j?d-n-(a+i*h)!==k&&(l=d-n-(a+i*h)-k):1!==Math.abs(d-n-(a+i*h))&&(l=d-n-(a+i*h));c.p.colModel[f].width+=l;c.p.tblwidth=a+l+i*h+n;c.p.tblwidth>d?(j=c.p.tblwidth-parseInt(d,10),c.p.tblwidth=d,e=c.p.colModel[f].width-=
j):e=c.p.colModel[f].width;c.grid.headers[f].width=e;c.grid.headers[f].el.style.width=e+"px";r&&(c.grid.cols[f].style.width=e+"px");c.p.footerrow&&(c.grid.footers[f].style.width=e+"px")}c.p.tblwidth&&(b("table:first",c.grid.bDiv).css("width",c.p.tblwidth+"px"),b("table:first",c.grid.hDiv).css("width",c.p.tblwidth+"px"),c.grid.hDiv.scrollLeft=c.grid.bDiv.scrollLeft,c.p.footerrow&&b("table:first",c.grid.sDiv).css("width",c.p.tblwidth+"px"))}}})},setGridHeight:function(d){return this.each(function(){if(this.grid){var g=
b(this.grid.bDiv);g.css({height:d+(isNaN(d)?"":"px")});!0===this.p.frozenColumns&&b("#"+b.jgrid.jqID(this.p.id)+"_frozen").parent().height(g.height()-16);this.p.height=d;this.p.scroll&&this.grid.populateVisible()}})},setCaption:function(d){return this.each(function(){this.p.caption=d;b("span.ui-jqgrid-title, span.ui-jqgrid-title-rtl",this.grid.cDiv).html(d);b(this.grid.cDiv).show()})},setLabel:function(d,g,c,e){return this.each(function(){var a=-1;if(this.grid&&void 0!==d&&(b(this.p.colModel).each(function(b){if(this.name===
d)return a=b,!1}),0<=a)){var i=b("tr.ui-jqgrid-labels th:eq("+a+")",this.grid.hDiv);if(g){var f=b(".s-ico",i);b("[id^=jqgh_]",i).empty().html(g).append(f);this.p.colNames[a]=g}c&&("string"===typeof c?b(i).addClass(c):b(i).css(c));"object"===typeof e&&b(i).attr(e)}})},setCell:function(d,g,c,e,a,i){return this.each(function(){var f=-1,h,j;if(this.grid&&(isNaN(g)?b(this.p.colModel).each(function(a){if(this.name===g)return f=a,!1}):f=parseInt(g,10),0<=f&&(h=b(this).jqGrid("getGridRowById",d)))){var k=
b("td:eq("+f+")",h);if(""!==c||!0===i)h=this.formatter(d,c,f,h,"edit"),j=this.p.colModel[f].title?{title:b.jgrid.stripHtml(h)}:{},this.p.treeGrid&&0<b(".tree-wrap",b(k)).length?b("span",b(k)).html(h).attr(j):b(k).html(h).attr(j),"local"===this.p.datatype&&(h=this.p.colModel[f],c=h.formatter&&"string"===typeof h.formatter&&"date"===h.formatter?b.unformat.date.call(this,c,h):c,j=this.p._index[b.jgrid.stripPref(this.p.idPrefix,d)],void 0!==j&&(this.p.data[j][h.name]=c));"string"===typeof e?b(k).addClass(e):
e&&b(k).css(e);"object"===typeof a&&b(k).attr(a)}})},getCell:function(d,g){var c=!1;this.each(function(){var e=-1;if(this.grid&&(isNaN(g)?b(this.p.colModel).each(function(a){if(this.name===g)return e=a,!1}):e=parseInt(g,10),0<=e)){var a=b(this).jqGrid("getGridRowById",d);if(a)try{c=b.unformat.call(this,b("td:eq("+e+")",a),{rowId:a.id,colModel:this.p.colModel[e]},e)}catch(i){c=b.jgrid.htmlDecode(b("td:eq("+e+")",a).html())}}});return c},getCol:function(d,g,c){var e=[],a,i=0,f,h,j,g="boolean"!==typeof g?
!1:g;void 0===c&&(c=!1);this.each(function(){var k=-1;if(this.grid&&(isNaN(d)?b(this.p.colModel).each(function(a){if(this.name===d)return k=a,!1}):k=parseInt(d,10),0<=k)){var m=this.rows.length,n=0,l=0;if(m&&0<m){for(;n<m;){if(b(this.rows[n]).hasClass("jqgrow")){try{a=b.unformat.call(this,b(this.rows[n].cells[k]),{rowId:this.rows[n].id,colModel:this.p.colModel[k]},k)}catch(r){a=b.jgrid.htmlDecode(this.rows[n].cells[k].innerHTML)}c?(j=parseFloat(a),isNaN(j)||(i+=j,void 0===h&&(h=f=j),f=Math.min(f,
j),h=Math.max(h,j),l++)):g?e.push({id:this.rows[n].id,value:a}):e.push(a)}n++}if(c)switch(c.toLowerCase()){case "sum":e=i;break;case "avg":e=i/l;break;case "count":e=m-1;break;case "min":e=f;break;case "max":e=h}}}});return e},clearGridData:function(d){return this.each(function(){if(this.grid){"boolean"!==typeof d&&(d=!1);if(this.p.deepempty)b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:gt(0)").remove();else{var g=b("#"+b.jgrid.jqID(this.p.id)+" tbody:first tr:first")[0];b("#"+b.jgrid.jqID(this.p.id)+
" tbody:first").empty().append(g)}this.p.footerrow&&d&&b(".ui-jqgrid-ftable td",this.grid.sDiv).html("&#160;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page=1;this.p.lastpage=0;this.p.reccount=0;this.p.data=[];this.p._index={};this.updatepager(!0,!1)}})},getInd:function(d,g){var c=!1,e;this.each(function(){(e=b(this).jqGrid("getGridRowById",d))&&(c=!0===g?e:e.rowIndex)});return c},bindKeys:function(d){var g=b.extend({onEnter:null,onSpace:null,onLeftKey:null,
onRightKey:null,scrollingRows:!0},d||{});return this.each(function(){var c=this;b("body").is("[role]")||b("body").attr("role","application");c.p.scrollrows=g.scrollingRows;b(c).keydown(function(d){var a=b(c).find("tr[tabindex=0]")[0],i,f,h,j=c.p.treeReader.expanded_field;if(a)if(h=c.p._index[b.jgrid.stripPref(c.p.idPrefix,a.id)],37===d.keyCode||38===d.keyCode||39===d.keyCode||40===d.keyCode){if(38===d.keyCode){f=a.previousSibling;i="";if(f)if(b(f).is(":hidden"))for(;f;){if(f=f.previousSibling,!b(f).is(":hidden")&&
b(f).hasClass("jqgrow")){i=f.id;break}}else i=f.id;b(c).jqGrid("setSelection",i,!0,d);d.preventDefault()}if(40===d.keyCode){f=a.nextSibling;i="";if(f)if(b(f).is(":hidden"))for(;f;){if(f=f.nextSibling,!b(f).is(":hidden")&&b(f).hasClass("jqgrow")){i=f.id;break}}else i=f.id;b(c).jqGrid("setSelection",i,!0,d);d.preventDefault()}37===d.keyCode&&(c.p.treeGrid&&c.p.data[h][j]&&b(a).find("div.treeclick").trigger("click"),b(c).triggerHandler("jqGridKeyLeft",[c.p.selrow]),b.isFunction(g.onLeftKey)&&g.onLeftKey.call(c,
c.p.selrow));39===d.keyCode&&(c.p.treeGrid&&!c.p.data[h][j]&&b(a).find("div.treeclick").trigger("click"),b(c).triggerHandler("jqGridKeyRight",[c.p.selrow]),b.isFunction(g.onRightKey)&&g.onRightKey.call(c,c.p.selrow))}else 13===d.keyCode?(b(c).triggerHandler("jqGridKeyEnter",[c.p.selrow]),b.isFunction(g.onEnter)&&g.onEnter.call(c,c.p.selrow)):32===d.keyCode&&(b(c).triggerHandler("jqGridKeySpace",[c.p.selrow]),b.isFunction(g.onSpace)&&g.onSpace.call(c,c.p.selrow))})})},unbindKeys:function(){return this.each(function(){b(this).unbind("keydown")})},
getLocalRow:function(d){var g=!1,c;this.each(function(){void 0!==d&&(c=this.p._index[b.jgrid.stripPref(this.p.idPrefix,d)],0<=c&&(g=this.p.data[c]))});return g}})})(jQuery);
(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(a){return"boolean"===typeof a},isObject:function(c){return c&&("object"===typeof c||a.isFunction(c))||!1},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a&&isFinite(a)},isValue:function(a){return this.isObject(a)||this.isString(a)||this.isNumber(a)||this.isBoolean(a)},isEmpty:function(c){if(!this.isString(c)&&this.isValue(c))return!1;if(!this.isValue(c))return!0;c=a.trim(c).replace(/\&nbsp\;/ig,
"").replace(/\&#160\;/ig,"");return""===c}});a.fn.fmatter=function(c,b,d,e,f){var g=b,d=a.extend({},a.jgrid.formatter,d);try{g=a.fn.fmatter[c].call(this,b,d,e,f)}catch(h){}return g};a.fmatter.util={NumberFormat:function(c,b){a.fmatter.isNumber(c)||(c*=1);if(a.fmatter.isNumber(c)){var d=0>c,e=""+c,f=b.decimalSeparator||".",g;if(a.fmatter.isNumber(b.decimalPlaces)){var h=b.decimalPlaces,e=Math.pow(10,h),e=""+Math.round(c*e)/e;g=e.lastIndexOf(".");if(0<h){0>g?(e+=f,g=e.length-1):"."!==f&&(e=e.replace(".",
f));for(;e.length-1-g<h;)e+="0"}}if(b.thousandsSeparator){h=b.thousandsSeparator;g=e.lastIndexOf(f);g=-1<g?g:e.length;var f=e.substring(g),j=-1,i;for(i=g;0<i;i--){j++;if(0===j%3&&i!==g&&(!d||1<i))f=h+f;f=e.charAt(i-1)+f}e=f}e=b.prefix?b.prefix+e:e;return e=b.suffix?e+b.suffix:e}return c}};a.fn.fmatter.defaultFormat=function(c,b){return a.fmatter.isValue(c)&&""!==c?c:b.defaultValue||"&#160;"};a.fn.fmatter.email=function(c,b){return!a.fmatter.isEmpty(c)?'<a href="mailto:'+c+'">'+c+"</a>":a.fn.fmatter.defaultFormat(c,
b)};a.fn.fmatter.checkbox=function(c,b){var d=a.extend({},b.checkbox),e;void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));e=!0===d.disabled?'disabled="disabled"':"";if(a.fmatter.isEmpty(c)||void 0===c)c=a.fn.fmatter.defaultFormat(c,d);c=(""+c+"").toLowerCase();return'<input type="checkbox" '+(0>c.search(/(false|f|0|no|n|off|undefined)/i)?" checked='checked' ":"")+' value="'+c+'" offval="no" '+e+"/>"};a.fn.fmatter.link=function(c,b){var d={target:b.target},
e="";void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));d.target&&(e="target="+d.target);return!a.fmatter.isEmpty(c)?"<a "+e+' href="'+c+'">'+c+"</a>":a.fn.fmatter.defaultFormat(c,b)};a.fn.fmatter.showlink=function(c,b){var d={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},e="";void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));d.target&&(e=
"target="+d.target);d=d.baseLinkUrl+d.showAction+"?"+d.idName+"="+b.rowId+d.addParam;return a.fmatter.isString(c)||a.fmatter.isNumber(c)?"<a "+e+' href="'+d+'">'+c+"</a>":a.fn.fmatter.defaultFormat(c,b)};a.fn.fmatter.integer=function(c,b){var d=a.extend({},b.integer);void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.number=function(c,b){var d=a.extend({},b.number);
void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.currency=function(c,b){var d=a.extend({},b.currency);void 0!==b.colModel&&void 0!==b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return a.fmatter.isEmpty(c)?d.defaultValue:a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.date=function(c,b,d,e){d=a.extend({},b.date);void 0!==b.colModel&&void 0!==
b.colModel.formatoptions&&(d=a.extend({},d,b.colModel.formatoptions));return!d.reformatAfterEdit&&"edit"===e?a.fn.fmatter.defaultFormat(c,b):!a.fmatter.isEmpty(c)?a.jgrid.parseDate(d.srcformat,c,d.newformat,d):a.fn.fmatter.defaultFormat(c,b)};a.fn.fmatter.select=function(c,b){var c=""+c,d=!1,e=[],f,g;void 0!==b.colModel.formatoptions?(d=b.colModel.formatoptions.value,f=void 0===b.colModel.formatoptions.separator?":":b.colModel.formatoptions.separator,g=void 0===b.colModel.formatoptions.delimiter?
";":b.colModel.formatoptions.delimiter):void 0!==b.colModel.editoptions&&(d=b.colModel.editoptions.value,f=void 0===b.colModel.editoptions.separator?":":b.colModel.editoptions.separator,g=void 0===b.colModel.editoptions.delimiter?";":b.colModel.editoptions.delimiter);if(d){var h=!0===b.colModel.editoptions.multiple?!0:!1,j=[];h&&(j=c.split(","),j=a.map(j,function(b){return a.trim(b)}));if(a.fmatter.isString(d)){var i=d.split(g),k=0,l;for(l=0;l<i.length;l++)if(g=i[l].split(f),2<g.length&&(g[1]=a.map(g,
function(a,b){if(b>0)return a}).join(f)),h)-1<a.inArray(g[0],j)&&(e[k]=g[1],k++);else if(a.trim(g[0])===a.trim(c)){e[0]=g[1];break}}else a.fmatter.isObject(d)&&(h?e=a.map(j,function(a){return d[a]}):e[0]=d[c]||"")}c=e.join(", ");return""===c?a.fn.fmatter.defaultFormat(c,b):c};a.fn.fmatter.rowactions=function(c){var b=a(this).closest("tr.jqgrow"),d=b.attr("id"),e=a(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),e=a("#"+e),f=e[0],g=f.p,h=g.colModel[a.jgrid.getCellIndex(this)],
j=h.frozen?a("tr#"+d+" td:eq("+a.jgrid.getCellIndex(this)+") > div",e):a(this).parent(),i={keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null,restoreAfterError:!0,mtype:"POST",delOptions:{},editOptions:{}},k=function(b){a.isFunction(i.afterRestore)&&i.afterRestore.call(f,b);j.find("div.ui-inline-edit,div.ui-inline-del").show();j.find("div.ui-inline-save,div.ui-inline-cancel").hide()};void 0!==h.formatoptions&&(i=a.extend(i,h.formatoptions));void 0!==
g.editOptions&&(i.editOptions=g.editOptions);void 0!==g.delOptions&&(i.delOptions=g.delOptions);b.hasClass("jqgrid-new-row")&&(i.extraparam[g.prmNames.oper]=g.prmNames.addoper);b={keys:i.keys,oneditfunc:i.onEdit,successfunc:i.onSuccess,url:i.url,extraparam:i.extraparam,aftersavefunc:function(b,c){a.isFunction(i.afterSave)&&i.afterSave.call(f,b,c);j.find("div.ui-inline-edit,div.ui-inline-del").show();j.find("div.ui-inline-save,div.ui-inline-cancel").hide()},errorfunc:i.onError,afterrestorefunc:k,restoreAfterError:i.restoreAfterError,
mtype:i.mtype};switch(c){case "edit":e.jqGrid("editRow",d,b);j.find("div.ui-inline-edit,div.ui-inline-del").hide();j.find("div.ui-inline-save,div.ui-inline-cancel").show();e.triggerHandler("jqGridAfterGridComplete");break;case "save":e.jqGrid("saveRow",d,b)&&(j.find("div.ui-inline-edit,div.ui-inline-del").show(),j.find("div.ui-inline-save,div.ui-inline-cancel").hide(),e.triggerHandler("jqGridAfterGridComplete"));break;case "cancel":e.jqGrid("restoreRow",d,k);j.find("div.ui-inline-edit,div.ui-inline-del").show();
j.find("div.ui-inline-save,div.ui-inline-cancel").hide();e.triggerHandler("jqGridAfterGridComplete");break;case "del":e.jqGrid("delGridRow",d,i.delOptions);break;case "formedit":e.jqGrid("setSelection",d),e.jqGrid("editGridRow",d,i.editOptions)}};a.fn.fmatter.actions=function(c,b){var d={keys:!1,editbutton:!0,delbutton:!0,editformbutton:!1},e=b.rowId,f="";void 0!==b.colModel.formatoptions&&(d=a.extend(d,b.colModel.formatoptions));if(void 0===e||a.fmatter.isEmpty(e))return"";d.editformbutton?f+="<div title='"+
a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+("id='jEditButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-pencil'></span></div>":d.editbutton&&(f+="<div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+("id='jEditButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ")+
"><span class='ui-icon ui-icon-pencil'></span></div>");d.delbutton&&(f+="<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+("id='jDeleteButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-trash'></span></div>");f+="<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+
("id='jSaveButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+"><span class='ui-icon ui-icon-disk'></span></div>";f+="<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel' "+("id='jCancelButton_"+e+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ")+
"><span class='ui-icon ui-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+f+"</div>"};a.unformat=function(c,b,d,e){var f,g=b.colModel.formatter,h=b.colModel.formatoptions||{},j=/([\.\*\_\'\(\)\{\}\+\?\\])/g,i=b.colModel.unformat||a.fn.fmatter[g]&&a.fn.fmatter[g].unformat;if(void 0!==i&&a.isFunction(i))f=i.call(this,a(c).text(),b,c);else if(void 0!==g&&a.fmatter.isString(g))switch(f=a.jgrid.formatter||{},g){case "integer":h=a.extend({},f.integer,h);b=h.thousandsSeparator.replace(j,
"\\$1");f=a(c).text().replace(RegExp(b,"g"),"");break;case "number":h=a.extend({},f.number,h);b=h.thousandsSeparator.replace(j,"\\$1");f=a(c).text().replace(RegExp(b,"g"),"").replace(h.decimalSeparator,".");break;case "currency":h=a.extend({},f.currency,h);b=h.thousandsSeparator.replace(j,"\\$1");b=RegExp(b,"g");f=a(c).text();h.prefix&&h.prefix.length&&(f=f.substr(h.prefix.length));h.suffix&&h.suffix.length&&(f=f.substr(0,f.length-h.suffix.length));f=f.replace(b,"").replace(h.decimalSeparator,".");
break;case "checkbox":h=b.colModel.editoptions?b.colModel.editoptions.value.split(":"):["Yes","No"];f=a("input",c).is(":checked")?h[0]:h[1];break;case "select":f=a.unformat.select(c,b,d,e);break;case "actions":return"";default:f=a(c).text()}return void 0!==f?f:!0===e?a(c).text():a.jgrid.htmlDecode(a(c).html())};a.unformat.select=function(c,b,d,e){d=[];c=a(c).text();if(!0===e)return c;var e=a.extend({},void 0!==b.colModel.formatoptions?b.colModel.formatoptions:b.colModel.editoptions),b=void 0===e.separator?
":":e.separator,f=void 0===e.delimiter?";":e.delimiter;if(e.value){var g=e.value,e=!0===e.multiple?!0:!1,h=[];e&&(h=c.split(","),h=a.map(h,function(b){return a.trim(b)}));if(a.fmatter.isString(g)){var j=g.split(f),i=0,k;for(k=0;k<j.length;k++)if(f=j[k].split(b),2<f.length&&(f[1]=a.map(f,function(a,b){if(b>0)return a}).join(b)),e)-1<a.inArray(f[1],h)&&(d[i]=f[0],i++);else if(a.trim(f[1])===a.trim(c)){d[0]=f[0];break}}else if(a.fmatter.isObject(g)||a.isArray(g))e||(h[0]=c),d=a.map(h,function(b){var c;
a.each(g,function(a,d){if(d===b){c=a;return false}});if(c!==void 0)return c});return d.join(", ")}return c||""};a.unformat.date=function(c,b){var d=a.jgrid.formatter.date||{};void 0!==b.formatoptions&&(d=a.extend({},d,b.formatoptions));return!a.fmatter.isEmpty(c)?a.jgrid.parseDate(d.newformat,c,d.srcformat,d):a.fn.fmatter.defaultFormat(c,b)}})(jQuery);
(function(a){a.jgrid.extend({getColProp:function(a){var c={},e=this[0];if(!e.grid)return!1;var e=e.p.colModel,d;for(d=0;d<e.length;d++)if(e[d].name===a){c=e[d];break}return c},setColProp:function(b,c){return this.each(function(){if(this.grid&&c){var e=this.p.colModel,d;for(d=0;d<e.length;d++)if(e[d].name===b){a.extend(!0,this.p.colModel[d],c);break}}})},sortGrid:function(a,c,e){return this.each(function(){var d=-1,i,h=!1;if(this.grid){a||(a=this.p.sortname);for(i=0;i<this.p.colModel.length;i++)if(this.p.colModel[i].index===
a||this.p.colModel[i].name===a){d=i;!0===this.p.frozenColumns&&!0===this.p.colModel[i].frozen&&(h=this.grid.fhDiv.find("#"+this.p.id+"_"+a));break}-1!==d&&(i=this.p.colModel[d].sortable,"boolean"!==typeof i&&(i=!0),"boolean"!==typeof c&&(c=!1),i&&this.sortData("jqgh_"+this.p.id+"_"+a,d,c,e,h))}})},clearBeforeUnload:function(){return this.each(function(){var b=this.grid;b.emptyRows.call(this,!0,!0);a(document).unbind("mouseup.jqGrid"+this.p.id);a(b.hDiv).unbind("mousemove");a(this).unbind();b.dragEnd=
null;b.dragMove=null;b.dragStart=null;b.emptyRows=null;b.populate=null;b.populateVisible=null;b.scrollGrid=null;b.selectionPreserver=null;b.bDiv=null;b.cDiv=null;b.hDiv=null;b.cols=null;var c,e=b.headers.length;for(c=0;c<e;c++)b.headers[c].el=null;this.addJSONData=this.addXmlData=this.formatter=this.constructTr=this.setHeadCheckBox=this.refreshIndex=this.updatepager=this.sortData=this.formatCol=null})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&a(this.p.pager).remove();
try{a(this).jqGrid("clearBeforeUnload"),a("#gbox_"+a.jgrid.jqID(this.id)).remove()}catch(b){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var b=a(this).attr("id"),c=a(this).attr("class");this.p.pager&&a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");var e=document.createElement("table");a(e).attr({id:b});e.className=c;b=a.jgrid.jqID(this.id);a(e).removeClass("ui-jqgrid-btable");1===a(this.p.pager).parents("#gbox_"+b).length?(a(e).insertBefore("#gbox_"+
b).show(),a(this.p.pager).insertBefore("#gbox_"+b)):a(e).insertBefore("#gbox_"+b).show();a(this).jqGrid("clearBeforeUnload");a("#gbox_"+b).remove()}})},setGridState:function(b){return this.each(function(){this.grid&&("hidden"===b?(a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+a.jgrid.jqID(this.p.id)).slideUp("fast"),this.p.pager&&a(this.p.pager).slideUp("fast"),this.p.toppager&&a(this.p.toppager).slideUp("fast"),!0===this.p.toolbar[0]&&("both"===this.p.toolbar[1]&&a(this.grid.ubDiv).slideUp("fast"),
a(this.grid.uDiv).slideUp("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+a.jgrid.jqID(this.p.id)).slideUp("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s"),this.p.gridstate="hidden"):"visible"===b&&(a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+a.jgrid.jqID(this.p.id)).slideDown("fast"),this.p.pager&&a(this.p.pager).slideDown("fast"),this.p.toppager&&a(this.p.toppager).slideDown("fast"),!0===this.p.toolbar[0]&&
("both"===this.p.toolbar[1]&&a(this.grid.ubDiv).slideDown("fast"),a(this.grid.uDiv).slideDown("fast")),this.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+a.jgrid.jqID(this.p.id)).slideDown("fast"),a(".ui-jqgrid-titlebar-close span",this.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n"),this.p.gridstate="visible"))})},filterToolbar:function(b){b=a.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",
stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,operandTitle:"Click to select search operation.",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#"}},a.jgrid.search,b||{});return this.each(function(){var c=this;if(!this.ftoolbar){var e=function(){var e={},g=0,f,o,i={},m;a.each(c.p.colModel,function(){var j=a("#gs_"+a.jgrid.jqID(this.name),!0===this.frozen&&!0===c.p.frozenColumns?c.grid.fhDiv:c.grid.hDiv);
o=this.index||this.name;m=b.searchOperators?j.parent().prev().children("a").attr("soper")||b.defaultSearch:this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"===this.stype?"eq":b.defaultSearch;if((f="custom"===this.stype&&a.isFunction(this.searchoptions.custom_value)&&0<j.length&&"SPAN"===j[0].nodeName.toUpperCase()?this.searchoptions.custom_value.call(c,j.children(".customelement:first"),"get"):j.val())||"nu"===m||"nn"===m)e[o]=f,i[o]=m,g++;else try{delete c.p.postData[o]}catch(h){}});
var h=0<g?!0:!1;if(!0===b.stringResult||"local"===c.p.datatype){var j='{"groupOp":"'+b.groupOp+'","rules":[',d=0;a.each(e,function(a,b){0<d&&(j+=",");j+='{"field":"'+a+'",';j+='"op":"'+i[a]+'",';j+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';d++});j+="]}";a.extend(c.p.postData,{filters:j});a.each(["searchField","searchString","searchOper"],function(a,b){c.p.postData.hasOwnProperty(b)&&delete c.p.postData[b]})}else a.extend(c.p.postData,e);var n;c.p.searchurl&&(n=c.p.url,a(c).jqGrid("setGridParam",
{url:c.p.searchurl}));var r="stop"===a(c).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!r&&a.isFunction(b.beforeSearch)&&(r=b.beforeSearch.call(c));r||a(c).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]);n&&a(c).jqGrid("setGridParam",{url:n});a(c).triggerHandler("jqGridToolbarAfterSearch");a.isFunction(b.afterSearch)&&b.afterSearch.call(c)},d=function(k,g,f){a("#sopt_menu").remove();var g=parseInt(g,10),f=parseInt(f,10)+18,g='<ul id="sopt_menu" class="ui-search-menu" role="menu" tabindex="0" style="font-size:'+
(a(".ui-jqgrid-view").css("font-size")||"11px")+";left:"+g+"px;top:"+f+'px;">',f=a(k).attr("soper"),i,h=[],m,d=0,j=a(k).attr("colname");for(i=c.p.colModel.length;d<i&&c.p.colModel[d].name!==j;)d++;d=c.p.colModel[d];j=a.extend({},d.searchoptions);j.sopt||(j.sopt=[],j.sopt[0]="select"===d.stype?"eq":b.defaultSearch);a.each(b.odata,function(){h.push(this.oper)});for(d=0;d<j.sopt.length;d++)m=a.inArray(j.sopt[d],h),-1!==m&&(i=f===b.odata[m].oper?"ui-state-highlight":"",g+='<li class="ui-menu-item '+i+
'" role="presentation"><a class="ui-corner-all g-menu-item" tabindex="0" role="menuitem" value="'+b.odata[m].oper+'" oper="'+b.operands[b.odata[m].oper]+'"><table cellspacing="0" cellpadding="0" border="0"><tr><td width="25px">'+b.operands[b.odata[m].oper]+"</td><td>"+b.odata[m].text+"</td></tr></table></a></li>");a("body").append(g+"</ul>");a("#sopt_menu").addClass("ui-menu ui-widget ui-widget-content ui-corner-all");a("#sopt_menu > li > a").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).click(function(){var g=
a(this).attr("value"),f=a(this).attr("oper");a(c).triggerHandler("jqGridToolbarSelectOper",[g,f,k]);a("#sopt_menu").hide();a(k).text(f).attr("soper",g);if(b.autosearch===true){f=a(k).parent().next().children()[0];(a(f).val()||g==="nu"||g==="nn")&&e()}})},i=a("<tr class='ui-search-toolbar' role='rowheader'></tr>"),h;a.each(c.p.colModel,function(k){var g=this,f,d;d="";var t="=",m,p=a("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+c.p.direction+"'></th>"),j=a("<div style='position:relative;height:100%;padding-right:0.3em;padding-left:0.3em;'></div>"),
l=a("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper'></td><td class='ui-search-input'></td><td class='ui-search-clear'></td></tr></table>");!0===this.hidden&&a(p).css("display","none");this.search=!1===this.search?!1:!0;void 0===this.stype&&(this.stype="text");f=a.extend({},this.searchoptions||{});if(this.search){if(b.searchOperators){d=f.sopt?f.sopt[0]:"select"===g.stype?"eq":b.defaultSearch;for(m=0;m<b.odata.length;m++)if(b.odata[m].oper===d){t=b.operands[d]||"";break}d=
"<a title='"+(null!=f.searchtitle?f.searchtitle:b.operandTitle)+"' style='padding-right: 0.5em;' soper='"+d+"' class='soptclass' colname='"+this.name+"'>"+t+"</a>"}a("td:eq(0)",l).attr("colindex",k).append(d);void 0===f.clearSearch&&(f.clearSearch=!0);f.clearSearch&&a("td:eq(2)",l).append("<a title='Clear Search Value' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>x</a>");switch(this.stype){case "select":if(d=this.surl||f.dataUrl)a(j).append(l),a.ajax(a.extend({url:d,
dataType:"html",success:function(d){if(f.buildSelect!==void 0)(d=f.buildSelect(d))&&a("td:eq(1)",l).append(d);else a("td:eq(1)",l).append(d);f.defaultValue!==void 0&&a("select",j).val(f.defaultValue);a("select",j).attr({name:g.index||g.name,id:"gs_"+g.name});f.attr&&a("select",j).attr(f.attr);a("select",j).css({width:"100%"});a.jgrid.bindEv.call(c,a("select",j)[0],f);b.autosearch===true&&a("select",j).change(function(){e();return false});d=null}},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));else{var n,
r,q;g.searchoptions?(n=void 0===g.searchoptions.value?"":g.searchoptions.value,r=void 0===g.searchoptions.separator?":":g.searchoptions.separator,q=void 0===g.searchoptions.delimiter?";":g.searchoptions.delimiter):g.editoptions&&(n=void 0===g.editoptions.value?"":g.editoptions.value,r=void 0===g.editoptions.separator?":":g.editoptions.separator,q=void 0===g.editoptions.delimiter?";":g.editoptions.delimiter);if(n){k=document.createElement("select");k.style.width="100%";a(k).attr({name:g.index||g.name,
id:"gs_"+g.name});var s;if("string"===typeof n){d=n.split(q);for(s=0;s<d.length;s++)n=d[s].split(r),q=document.createElement("option"),q.value=n[0],q.innerHTML=n[1],k.appendChild(q)}else if("object"===typeof n)for(s in n)n.hasOwnProperty(s)&&(q=document.createElement("option"),q.value=s,q.innerHTML=n[s],k.appendChild(q));void 0!==f.defaultValue&&a(k).val(f.defaultValue);f.attr&&a(k).attr(f.attr);a(j).append(l);a.jgrid.bindEv.call(c,k,f);a("td:eq(1)",l).append(k);!0===b.autosearch&&a(k).change(function(){e();
return false})}}break;case "text":r=void 0!==f.defaultValue?f.defaultValue:"";a("td:eq(1)",l).append("<input type='text' style='width:100%;padding:0px;' name='"+(g.index||g.name)+"' id='gs_"+g.name+"' value='"+r+"'/>");a(j).append(l);f.attr&&a("input",j).attr(f.attr);a.jgrid.bindEv.call(c,a("input",j)[0],f);!0===b.autosearch&&(b.searchOnEnter?a("input",j).keypress(function(a){if((a.charCode||a.keyCode||0)===13){e();return false}return this}):a("input",j).keydown(function(a){switch(a.which){case 13:return false;
case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:h&&clearTimeout(h);h=setTimeout(function(){e()},500)}}));break;case "custom":a("td:eq(1)",l).append("<span style='width:95%;padding:0px;' name='"+(g.index||g.name)+"' id='gs_"+g.name+"'/>");a(j).append(l);try{if(a.isFunction(f.custom_element)){var v=f.custom_element.call(c,void 0!==f.defaultValue?f.defaultValue:"",f);if(v)v=a(v).addClass("customelement"),a(j).find(">span").append(v);else throw"e2";}else throw"e1";}catch(u){"e1"===
u&&a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"===u?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,"string"===typeof u?u:u.message,a.jgrid.edit.bClose)}}}a(p).append(j);a(i).append(p);b.searchOperators||a("td:eq(0)",l).hide()});a("table thead",c.grid.hDiv).append(i);b.searchOperators&&(a(".soptclass",i).click(function(b){var c=
a(this).offset();d(this,c.left,c.top);b.stopPropagation()}),a("body").on("click",function(b){"soptclass"!==b.target.className&&a("#sopt_menu").hide()}));a(".clearsearchclass",i).click(function(){var d=a(this).parents("tr:first"),g=parseInt(a("td.ui-search-oper",d).attr("colindex"),10),f=a.extend({},c.p.colModel[g].searchoptions||{}),f=f.defaultValue?f.defaultValue:"";c.p.colModel[g].stype==="select"?f?a("td.ui-search-input select",d).val(f):a("td.ui-search-input select",d)[0].selectedIndex=0:a("td.ui-search-input input",
d).val(f);b.autosearch===true&&e()});this.ftoolbar=!0;this.triggerToolbar=e;this.clearToolbar=function(d){var g={},f=0,e,d=typeof d!=="boolean"?true:d;a.each(c.p.colModel,function(){var b,d=a("#gs_"+a.jgrid.jqID(this.name),this.frozen===true&&c.p.frozenColumns===true?c.grid.fhDiv:c.grid.hDiv);if(this.searchoptions&&this.searchoptions.defaultValue!==void 0)b=this.searchoptions.defaultValue;e=this.index||this.name;switch(this.stype){case "select":d.find("option").each(function(c){if(c===0)this.selected=
true;if(a(this).val()===b){this.selected=true;return false}});if(b!==void 0){g[e]=b;f++}else try{delete c.p.postData[e]}catch(h){}break;case "text":d.val(b);if(b!==void 0){g[e]=b;f++}else try{delete c.p.postData[e]}catch(i){}break;case "custom":a.isFunction(this.searchoptions.custom_value)&&d.length>0&&d[0].nodeName.toUpperCase()==="SPAN"&&this.searchoptions.custom_value.call(c,d.children(".customelement:first"),"set",b)}});var i=f>0?true:false;if(b.stringResult===true||c.p.datatype==="local"){var h=
'{"groupOp":"'+b.groupOp+'","rules":[',p=0;a.each(g,function(a,b){p>0&&(h=h+",");h=h+('{"field":"'+a+'",');h=h+'"op":"eq",';h=h+('"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}');p++});h=h+"]}";a.extend(c.p.postData,{filters:h});a.each(["searchField","searchString","searchOper"],function(a,b){c.p.postData.hasOwnProperty(b)&&delete c.p.postData[b]})}else a.extend(c.p.postData,g);var j;if(c.p.searchurl){j=c.p.url;a(c).jqGrid("setGridParam",{url:c.p.searchurl})}var l=a(c).triggerHandler("jqGridToolbarBeforeClear")===
"stop"?true:false;!l&&a.isFunction(b.beforeClear)&&(l=b.beforeClear.call(c));l||d&&a(c).jqGrid("setGridParam",{search:i}).trigger("reloadGrid",[{page:1}]);j&&a(c).jqGrid("setGridParam",{url:j});a(c).triggerHandler("jqGridToolbarAfterClear");a.isFunction(b.afterClear)&&b.afterClear()};this.toggleToolbar=function(){var b=a("tr.ui-search-toolbar",c.grid.hDiv),d=c.p.frozenColumns===true?a("tr.ui-search-toolbar",c.grid.fhDiv):false;if(b.css("display")==="none"){b.show();d&&d.show()}else{b.hide();d&&d.hide()}}}})},
destroyFilterToolbar:function(){return this.each(function(){this.ftoolbar&&(this.toggleToolbar=this.clearToolbar=this.triggerToolbar=null,this.ftoolbar=!1,a(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},destroyGroupHeader:function(b){void 0===b&&(b=!0);return this.each(function(){var c,e,d,i,h,k;e=this.grid;var g=a("table.ui-jqgrid-htable thead",e.hDiv),f=this.p.colModel;if(e){a(this).unbind(".setGroupHeaders");c=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels");i=
e.headers;e=0;for(d=i.length;e<d;e++){h=f[e].hidden?"none":"";h=a(i[e].el).width(i[e].width).css("display",h);try{h.removeAttr("rowSpan")}catch(o){h.attr("rowSpan",1)}c.append(h);k=h.children("span.ui-jqgrid-resize");0<k.length&&(k[0].style.height="");h.children("div")[0].style.top=""}a(g).children("tr.ui-jqgrid-labels").remove();a(g).prepend(c);!0===b&&a(this).jqGrid("setGridParam",{groupHeader:null})}})},setGroupHeaders:function(b){b=a.extend({useColSpanStyle:!1,groupHeaders:[]},b||{});return this.each(function(){this.p.groupHeader=
b;var c,e,d=0,i,h,k,g,f,o=this.p.colModel,t=o.length,m=this.grid.headers,p=a("table.ui-jqgrid-htable",this.grid.hDiv),j=p.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header");i=p.children("thead");var l=p.find(".jqg-first-row-header");void 0===l[0]?l=a("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):l.empty();var n,r=function(a,b){var c=b.length,d;for(d=0;d<c;d++)if(b[d].startColumnName===a)return d;return-1};a(this).prepend(i);
i=a("<tr>",{role:"rowheader"}).addClass("ui-jqgrid-labels jqg-third-row-header");for(c=0;c<t;c++)if(k=m[c].el,g=a(k),e=o[c],h={height:"0px",width:m[c].width+"px",display:e.hidden?"none":""},a("<th>",{role:"gridcell"}).css(h).addClass("ui-first-th-"+this.p.direction).appendTo(l),k.style.width="",h=r(e.name,b.groupHeaders),0<=h){h=b.groupHeaders[h];d=h.numberOfColumns;f=h.titleText;for(h=e=0;h<d&&c+h<t;h++)o[c+h].hidden||e++;h=a("<th>").attr({role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+
this.p.direction).css({height:"22px","border-top":"0px none"}).html(f);0<e&&h.attr("colspan",""+e);this.p.headertitles&&h.attr("title",h.text());0===e&&h.hide();g.before(h);i.append(k);d-=1}else 0===d?b.useColSpanStyle?g.attr("rowspan","2"):(a("<th>",{role:"columnheader"}).addClass("ui-state-default ui-th-column-header ui-th-"+this.p.direction).css({display:e.hidden?"none":"","border-top":"0px none"}).insertBefore(g),i.append(k)):(i.append(k),d--);o=a(this).children("thead");o.prepend(l);i.insertAfter(j);
p.append(o);b.useColSpanStyle&&(p.find("span.ui-jqgrid-resize").each(function(){var b=a(this).parent();b.is(":visible")&&(this.style.cssText="height: "+b.height()+"px !important; cursor: col-resize;")}),p.find("div.ui-jqgrid-sortable").each(function(){var b=a(this),c=b.parent();c.is(":visible")&&c.is(":has(span.ui-jqgrid-resize)")&&b.css("top",(c.height()-b.outerHeight())/2+"px")}));n=o.find("tr.jqg-first-row-header");a(this).bind("jqGridResizeStop.setGroupHeaders",function(a,b,c){n.find("th").eq(c).width(b)})})},
setFrozenColumns:function(){return this.each(function(){if(this.grid){var b=this,c=b.p.colModel,e=0,d=c.length,i=-1,h=!1;if(!(!0===b.p.subGrid||!0===b.p.treeGrid||!0===b.p.cellEdit||b.p.sortable||b.p.scroll||b.p.grouping)){b.p.rownumbers&&e++;for(b.p.multiselect&&e++;e<d;){if(!0===c[e].frozen)h=!0,i=e;else break;e++}if(0<=i&&h){c=b.p.caption?a(b.grid.cDiv).outerHeight():0;e=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).height();b.p.toppager&&(c+=a(b.grid.topDiv).outerHeight());!0===b.p.toolbar[0]&&
"bottom"!==b.p.toolbar[1]&&(c+=a(b.grid.uDiv).outerHeight());b.grid.fhDiv=a('<div style="position:absolute;left:0px;top:'+c+"px;height:"+e+'px;" class="frozen-div ui-state-default ui-jqgrid-hdiv"></div>');b.grid.fbDiv=a('<div style="position:absolute;left:0px;top:'+(parseInt(c,10)+parseInt(e,10)+1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"></div>');a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fhDiv);c=a(".ui-jqgrid-htable","#gview_"+a.jgrid.jqID(b.p.id)).clone(!0);if(b.p.groupHeader){a("tr.jqg-first-row-header, tr.jqg-third-row-header",
c).each(function(){a("th:gt("+i+")",this).remove()});var k=-1,g=-1,f,o;a("tr.jqg-second-row-header th",c).each(function(){f=parseInt(a(this).attr("colspan"),10);if(o=parseInt(a(this).attr("rowspan"),10))k++,g++;f&&(k+=f,g++);if(k===i)return!1});k!==i&&(g=i);a("tr.jqg-second-row-header",c).each(function(){a("th:gt("+g+")",this).remove()})}else a("tr",c).each(function(){a("th:gt("+i+")",this).remove()});a(c).width(1);a(b.grid.fhDiv).append(c).mousemove(function(a){if(b.grid.resizing)return b.grid.dragMove(a),
!1});a(b).bind("jqGridResizeStop.setFrozenColumns",function(c,d,e){c=a(".ui-jqgrid-htable",b.grid.fhDiv);a("th:eq("+e+")",c).width(d);c=a(".ui-jqgrid-btable",b.grid.fbDiv);a("tr:first td:eq("+e+")",c).width(d)});a(b).bind("jqGridSortCol.setFrozenColumns",function(c,d,e){c=a("tr.ui-jqgrid-labels:last th:eq("+b.p.lastsort+")",b.grid.fhDiv);d=a("tr.ui-jqgrid-labels:last th:eq("+e+")",b.grid.fhDiv);a("span.ui-grid-ico-sort",c).addClass("ui-state-disabled");a(c).attr("aria-selected","false");a("span.ui-icon-"+
b.p.sortorder,d).removeClass("ui-state-disabled");a(d).attr("aria-selected","true");!b.p.viewsortcols[0]&&b.p.lastsort!==e&&(a("span.s-ico",c).hide(),a("span.s-ico",d).show())});a("#gview_"+a.jgrid.jqID(b.p.id)).append(b.grid.fbDiv);a(b.grid.bDiv).scroll(function(){a(b.grid.fbDiv).scrollTop(a(this).scrollTop())});!0===b.p.hoverrows&&a("#"+a.jgrid.jqID(b.p.id)).unbind("mouseover").unbind("mouseout");a(b).bind("jqGridAfterGridComplete.setFrozenColumns",function(){a("#"+a.jgrid.jqID(b.p.id)+"_frozen").remove();
a(b.grid.fbDiv).height(a(b.grid.bDiv).height()-16);var c=a("#"+a.jgrid.jqID(b.p.id)).clone(!0);a("tr[role=row]",c).each(function(){a("td[role=gridcell]:gt("+i+")",this).remove()});a(c).width(1).attr("id",b.p.id+"_frozen");a(b.grid.fbDiv).append(c);!0===b.p.hoverrows&&(a("tr.jqgrow",c).hover(function(){a(this).addClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+
a.jgrid.jqID(b.p.id)).removeClass("ui-state-hover")}),a("tr.jqgrow","#"+a.jgrid.jqID(b.p.id)).hover(function(){a(this).addClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)+"_frozen").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover");a("#"+a.jgrid.jqID(this.id),"#"+a.jgrid.jqID(b.p.id)+"_frozen").removeClass("ui-state-hover")}));c=null});b.grid.hDiv.loading||a(b).triggerHandler("jqGridAfterGridComplete");b.p.frozenColumns=!0}}}})},destroyFrozenColumns:function(){return this.each(function(){if(this.grid&&
!0===this.p.frozenColumns){a(this.grid.fhDiv).remove();a(this.grid.fbDiv).remove();this.grid.fhDiv=null;this.grid.fbDiv=null;a(this).unbind(".setFrozenColumns");if(!0===this.p.hoverrows){var b;a("#"+a.jgrid.jqID(this.p.id)).bind("mouseover",function(c){b=a(c.target).closest("tr.jqgrow");"ui-subgrid"!==a(b).attr("class")&&a(b).addClass("ui-state-hover")}).bind("mouseout",function(c){b=a(c.target).closest("tr.jqgrow");a(b).removeClass("ui-state-hover")})}this.p.frozenColumns=!1}})}})})(jQuery);
(function(a){a.extend(a.jgrid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},hideModal:function(d,b){b=a.extend({jqm:!0,gb:""},b||{});if(b.onClose){var c=b.gb&&"string"===typeof b.gb&&"#gbox_"===b.gb.substr(0,6)?b.onClose.call(a("#"+b.gb.substr(6))[0],d):b.onClose(d);if("boolean"===typeof c&&!c)return}if(a.fn.jqm&&!0===b.jqm)a(d).attr("aria-hidden","true").jqmHide();else{if(""!==b.gb)try{a(".jqgrid-overlay:first",b.gb).hide()}catch(g){}a(d).hide().attr("aria-hidden",
"true")}},findPos:function(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent)}return[b,c]},createModal:function(d,b,c,g,e,h,f){var c=a.extend(!0,{},a.jgrid.jqModal||{},c),i=document.createElement("div"),j,k=this,f=a.extend({},f||{});j="rtl"===a(c.gbox).attr("dir")?!0:!1;i.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";i.id=d.themodal;var l=document.createElement("div");l.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";
l.id=d.modalhead;a(l).append("<span class='ui-jqdialog-title'>"+c.caption+"</span>");var n=a("<a class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){n.addClass("ui-state-hover")},function(){n.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");a(l).append(n);j?(i.dir="rtl",a(".ui-jqdialog-title",l).css("float","right"),a(".ui-jqdialog-titlebar-close",l).css("left","0.3em")):(i.dir="ltr",a(".ui-jqdialog-title",l).css("float","left"),a(".ui-jqdialog-titlebar-close",
l).css("right","0.3em"));var m=document.createElement("div");a(m).addClass("ui-jqdialog-content ui-widget-content").attr("id",d.modalcontent);a(m).append(b);i.appendChild(m);a(i).prepend(l);!0===h?a("body").append(i):"string"===typeof h?a(h).append(i):a(i).insertBefore(g);a(i).css(f);void 0===c.jqModal&&(c.jqModal=!0);b={};if(a.fn.jqm&&!0===c.jqModal)0===c.left&&0===c.top&&c.overlay&&(f=[],f=a.jgrid.findPos(e),c.left=f[0]+4,c.top=f[1]+4),b.top=c.top+"px",b.left=c.left;else if(0!==c.left||0!==c.top)b.left=
c.left,b.top=c.top+"px";a("a.ui-jqdialog-titlebar-close",l).click(function(){var b=a("#"+a.jgrid.jqID(d.themodal)).data("onClose")||c.onClose,e=a("#"+a.jgrid.jqID(d.themodal)).data("gbox")||c.gbox;k.hideModal("#"+a.jgrid.jqID(d.themodal),{gb:e,jqm:c.jqModal,onClose:b});return false});if(0===c.width||!c.width)c.width=300;if(0===c.height||!c.height)c.height=200;c.zIndex||(g=a(g).parents("*[role=dialog]").filter(":first").css("z-index"),c.zIndex=g?parseInt(g,10)+2:950);g=0;j&&b.left&&!h&&(g=a(c.gbox).width()-
(!isNaN(c.width)?parseInt(c.width,10):0)-8,b.left=parseInt(b.left,10)+parseInt(g,10));b.left&&(b.left+="px");a(i).css(a.extend({width:isNaN(c.width)?"auto":c.width+"px",height:isNaN(c.height)?"auto":c.height+"px",zIndex:c.zIndex,overflow:"hidden"},b)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":d.modalhead,"aria-hidden":"true"});void 0===c.drag&&(c.drag=!0);void 0===c.resize&&(c.resize=!0);if(c.drag)if(a(l).css("cursor","move"),a.fn.jqDrag)a(i).jqDrag(l);else try{a(i).draggable({handle:a("#"+
a.jgrid.jqID(l.id))})}catch(o){}if(c.resize)if(a.fn.jqResize)a(i).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se'></div>"),a("#"+a.jgrid.jqID(d.themodal)).jqResize(".jqResize",d.scrollelm?"#"+a.jgrid.jqID(d.scrollelm):!1);else try{a(i).resizable({handles:"se, sw",alsoResize:d.scrollelm?"#"+a.jgrid.jqID(d.scrollelm):!1})}catch(p){}!0===c.closeOnEscape&&a(i).keydown(function(b){if(b.which==27){b=a("#"+a.jgrid.jqID(d.themodal)).data("onClose")||
c.onClose;k.hideModal("#"+a.jgrid.jqID(d.themodal),{gb:c.gbox,jqm:c.jqModal,onClose:b})}})},viewModal:function(d,b){b=a.extend({toTop:!0,overlay:10,modal:!1,overlayClass:"ui-widget-overlay",onShow:a.jgrid.showModal,onHide:a.jgrid.closeModal,gbox:"",jqm:!0,jqM:!0},b||{});if(a.fn.jqm&&!0===b.jqm)b.jqM?a(d).attr("aria-hidden","false").jqm(b).jqmShow():a(d).attr("aria-hidden","false").jqmShow();else{""!==b.gbox&&(a(".jqgrid-overlay:first",b.gbox).show(),a(d).data("gbox",b.gbox));a(d).show().attr("aria-hidden",
"false");try{a(":input:visible",d)[0].focus()}catch(c){}}},info_dialog:function(d,b,c,g){var e={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1E3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]};a.extend(!0,e,a.jgrid.jqModal||{},{caption:"<b>"+d+"</b>"},g||{});var h=e.jqModal,f=this;a.fn.jqm&&!h&&(h=!1);d="";if(0<e.buttons.length)for(g=0;g<e.buttons.length;g++)void 0===e.buttons[g].id&&(e.buttons[g].id="info_button_"+g),d+=
"<a id='"+e.buttons[g].id+"' class='fm-button ui-state-default ui-corner-all'>"+e.buttons[g].text+"</a>";g=isNaN(e.dataheight)?e.dataheight:e.dataheight+"px";b="<div id='info_id'>"+("<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+g+";"+("text-align:"+e.align+";")+"'>"+b+"</div>");b+=c?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+
c+"</a>"+d+"</div>":""!==d?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+e.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+d+"</div>":"";b+="</div>";try{"false"===a("#info_dialog").attr("aria-hidden")&&a.jgrid.hideModal("#info_dialog",{jqm:h}),a("#info_dialog").remove()}catch(i){}a.jgrid.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},b,e,"","",!0);d&&a.each(e.buttons,
function(b){a("#"+a.jgrid.jqID(this.id),"#info_id").bind("click",function(){e.buttons[b].onClick.call(a("#info_dialog"));return!1})});a("#closedialog","#info_id").click(function(){f.hideModal("#info_dialog",{jqm:h,onClose:a("#info_dialog").data("onClose")||e.onClose,gb:a("#info_dialog").data("gbox")||e.gbox});return!1});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a.isFunction(e.beforeOpen)&&e.beforeOpen();a.jgrid.viewModal("#info_dialog",
{onHide:function(a){a.w.hide().remove();a.o&&a.o.remove()},modal:e.modal,jqm:h});a.isFunction(e.afterOpen)&&e.afterOpen();try{a("#info_dialog").focus()}catch(j){}},bindEv:function(d,b){a.isFunction(b.dataInit)&&b.dataInit.call(this,d,b);b.dataEvents&&a.each(b.dataEvents,function(){void 0!==this.data?a(d).bind(this.type,this.data,this.fn):a(d).bind(this.type,this.fn)})},createEl:function(d,b,c,g,e){function h(b,d,c){var e="dataInit,dataEvents,dataUrl,buildSelect,sopt,searchhidden,defaultValue,attr,custom_element,custom_value".split(",");
void 0!==c&&a.isArray(c)&&a.merge(e,c);a.each(d,function(d,c){-1===a.inArray(d,e)&&a(b).attr(d,c)});d.hasOwnProperty("id")||a(b).attr("id",a.jgrid.randId())}var f="",i=this;switch(d){case "textarea":f=document.createElement("textarea");g?b.cols||a(f).css({width:"98%"}):b.cols||(b.cols=20);b.rows||(b.rows=2);if("&nbsp;"===c||"&#160;"===c||1===c.length&&160===c.charCodeAt(0))c="";f.value=c;h(f,b);a(f).attr({role:"textbox",multiline:"true"});break;case "checkbox":f=document.createElement("input");f.type=
"checkbox";b.value?(d=b.value.split(":"),c===d[0]&&(f.checked=!0,f.defaultChecked=!0),f.value=d[0],a(f).attr("offval",d[1])):(d=(c+"").toLowerCase(),0>d.search(/(false|f|0|no|n|off|undefined)/i)&&""!==d?(f.checked=!0,f.defaultChecked=!0,f.value=c):f.value="on",a(f).attr("offval","off"));h(f,b,["value"]);a(f).attr("role","checkbox");break;case "select":f=document.createElement("select");f.setAttribute("role","select");g=[];!0===b.multiple?(d=!0,f.multiple="multiple",a(f).attr("aria-multiselectable",
"true")):d=!1;if(void 0!==b.dataUrl){var d=b.name?(""+b.id).substring(0,(""+b.id).length-(""+b.name).length-1):""+b.id,j=b.postData||e.postData;i.p&&i.p.idPrefix&&(d=a.jgrid.stripPref(i.p.idPrefix,d));a.ajax(a.extend({url:a.isFunction(b.dataUrl)?b.dataUrl.call(i,d,c,""+b.name):b.dataUrl,type:"GET",dataType:"html",data:a.isFunction(j)?j.call(i,d,c,""+b.name):j,context:{elem:f,options:b,vl:c},success:function(b){var d=[],c=this.elem,e=this.vl,f=a.extend({},this.options),g=f.multiple===true,b=a.isFunction(f.buildSelect)?
f.buildSelect.call(i,b):b;typeof b==="string"&&(b=a(a.trim(b)).html());if(b){a(c).append(b);h(c,f,j?["postData"]:void 0);if(f.size===void 0)f.size=g?3:1;if(g){d=e.split(",");d=a.map(d,function(b){return a.trim(b)})}else d[0]=a.trim(e);setTimeout(function(){a("option",c).each(function(b){if(b===0&&c.multiple)this.selected=false;a(this).attr("role","option");if(a.inArray(a.trim(a(this).text()),d)>-1||a.inArray(a.trim(a(this).val()),d)>-1)this.selected="selected"})},0)}}},e||{}))}else if(b.value){var k;
void 0===b.size&&(b.size=d?3:1);d&&(g=c.split(","),g=a.map(g,function(b){return a.trim(b)}));"function"===typeof b.value&&(b.value=b.value());var l,n,m=void 0===b.separator?":":b.separator,e=void 0===b.delimiter?";":b.delimiter;if("string"===typeof b.value){l=b.value.split(e);for(k=0;k<l.length;k++){n=l[k].split(m);2<n.length&&(n[1]=a.map(n,function(a,b){if(b>0)return a}).join(m));e=document.createElement("option");e.setAttribute("role","option");e.value=n[0];e.innerHTML=n[1];f.appendChild(e);if(!d&&
(a.trim(n[0])===a.trim(c)||a.trim(n[1])===a.trim(c)))e.selected="selected";if(d&&(-1<a.inArray(a.trim(n[1]),g)||-1<a.inArray(a.trim(n[0]),g)))e.selected="selected"}}else if("object"===typeof b.value)for(k in m=b.value,m)if(m.hasOwnProperty(k)){e=document.createElement("option");e.setAttribute("role","option");e.value=k;e.innerHTML=m[k];f.appendChild(e);if(!d&&(a.trim(k)===a.trim(c)||a.trim(m[k])===a.trim(c)))e.selected="selected";if(d&&(-1<a.inArray(a.trim(m[k]),g)||-1<a.inArray(a.trim(k),g)))e.selected=
"selected"}h(f,b,["value"])}break;case "text":case "password":case "button":k="button"===d?"button":"textbox";f=document.createElement("input");f.type=d;f.value=c;h(f,b);"button"!==d&&(g?b.size||a(f).css({width:"98%"}):b.size||(b.size=20));a(f).attr("role",k);break;case "image":case "file":f=document.createElement("input");f.type=d;h(f,b);break;case "custom":f=document.createElement("span");try{if(a.isFunction(b.custom_element))if(m=b.custom_element.call(i,c,b))m=a(m).addClass("customelement").attr({id:b.id,
name:b.name}),a(f).empty().append(m);else throw"e2";else throw"e1";}catch(o){"e1"===o&&a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"===o?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,"string"===typeof o?o:o.message,a.jgrid.edit.bClose)}}return f},checkDate:function(a,b){var c={},g,a=a.toLowerCase();g=-1!==a.indexOf("/")?
"/":-1!==a.indexOf("-")?"-":-1!==a.indexOf(".")?".":"/";a=a.split(g);b=b.split(g);if(3!==b.length)return!1;g=-1;var e,h=-1,f=-1,i;for(i=0;i<a.length;i++)e=isNaN(b[i])?0:parseInt(b[i],10),c[a[i]]=e,e=a[i],-1!==e.indexOf("y")&&(g=i),-1!==e.indexOf("m")&&(f=i),-1!==e.indexOf("d")&&(h=i);e="y"===a[g]||"yyyy"===a[g]?4:"yy"===a[g]?2:-1;i=[0,31,29,31,30,31,30,31,31,30,31,30,31];var j;if(-1===g)return!1;j=c[a[g]].toString();2===e&&1===j.length&&(e=1);if(j.length!==e||0===c[a[g]]&&"00"!==b[g]||-1===f)return!1;
j=c[a[f]].toString();if(1>j.length||1>c[a[f]]||12<c[a[f]]||-1===h)return!1;j=c[a[h]].toString();return 1>j.length||1>c[a[h]]||31<c[a[h]]||2===c[a[f]]&&c[a[h]]>(0===c[a[g]]%4&&(0!==c[a[g]]%100||0===c[a[g]]%400)?29:28)||c[a[h]]>i[c[a[f]]]?!1:!0},isEmpty:function(a){return a.match(/^\s+$/)||""===a?!0:!1},checkTime:function(d){var b=/^(\d{1,2}):(\d{2})([apAP][Mm])?$/;if(!a.jgrid.isEmpty(d))if(d=d.match(b)){if(d[3]){if(1>d[1]||12<d[1])return!1}else if(23<d[1])return!1;if(59<d[2])return!1}else return!1;
return!0},checkValues:function(d,b,c,g){var e,h,f;f=this.p.colModel;if(void 0===c)if("string"===typeof b){c=0;for(g=f.length;c<g;c++)if(f[c].name===b){e=f[c].editrules;b=c;null!=f[c].formoptions&&(h=f[c].formoptions.label);break}}else 0<=b&&(e=f[b].editrules);else e=c,h=void 0===g?"_":g;if(e){h||(h=null!=this.p.colNames?this.p.colNames[b]:f[b].label);if(!0===e.required&&a.jgrid.isEmpty(d))return[!1,h+": "+a.jgrid.edit.msg.required,""];c=!1===e.required?!1:!0;if(!0===e.number&&!(!1===c&&a.jgrid.isEmpty(d))&&
isNaN(d))return[!1,h+": "+a.jgrid.edit.msg.number,""];if(void 0!==e.minValue&&!isNaN(e.minValue)&&parseFloat(d)<parseFloat(e.minValue))return[!1,h+": "+a.jgrid.edit.msg.minValue+" "+e.minValue,""];if(void 0!==e.maxValue&&!isNaN(e.maxValue)&&parseFloat(d)>parseFloat(e.maxValue))return[!1,h+": "+a.jgrid.edit.msg.maxValue+" "+e.maxValue,""];if(!0===e.email&&!(!1===c&&a.jgrid.isEmpty(d))&&(g=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,
!g.test(d)))return[!1,h+": "+a.jgrid.edit.msg.email,""];if(!0===e.integer&&!(!1===c&&a.jgrid.isEmpty(d))&&(isNaN(d)||0!==d%1||-1!==d.indexOf(".")))return[!1,h+": "+a.jgrid.edit.msg.integer,""];if(!0===e.date&&!(!1===c&&a.jgrid.isEmpty(d))&&(f[b].formatoptions&&f[b].formatoptions.newformat?(f=f[b].formatoptions.newformat,a.jgrid.formatter.date.masks.hasOwnProperty(f)&&(f=a.jgrid.formatter.date.masks[f])):f=f[b].datefmt||"Y-m-d",!a.jgrid.checkDate(f,d)))return[!1,h+": "+a.jgrid.edit.msg.date+" - "+
f,""];if(!0===e.time&&!(!1===c&&a.jgrid.isEmpty(d))&&!a.jgrid.checkTime(d))return[!1,h+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(!0===e.url&&!(!1===c&&a.jgrid.isEmpty(d))&&(g=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,!g.test(d)))return[!1,h+": "+a.jgrid.edit.msg.url,""];if(!0===e.custom&&!(!1===c&&a.jgrid.isEmpty(d)))return a.isFunction(e.custom_func)?(d=e.custom_func.call(this,d,h,b),a.isArray(d)?d:[!1,a.jgrid.edit.msg.customarray,
""]):[!1,a.jgrid.edit.msg.customfcheck,""]}return[!0,"",""]}})})(jQuery);
(function(a){var b={};a.jgrid.extend({searchGrid:function(b){b=a.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,
errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"}},a.jgrid.search,b||{});return this.each(function(){function c(c){u=a(e).triggerHandler("jqGridFilterBeforeShow",[c]);void 0===
u&&(u=!0);u&&a.isFunction(b.beforeShowSearch)&&(u=b.beforeShowSearch.call(e,c));u&&(a.jgrid.viewModal("#"+a.jgrid.jqID(q.themodal),{gbox:"#gbox_"+a.jgrid.jqID(h),jqm:b.jqModal,modal:b.modal,overlay:b.overlay,toTop:b.toTop}),a(e).triggerHandler("jqGridFilterAfterShow",[c]),a.isFunction(b.afterShowSearch)&&b.afterShowSearch.call(e,c))}var e=this;if(e.grid){var h="fbox_"+e.p.id,u=!0,r=!0,q={themodal:"searchmod"+h,modalhead:"searchhd"+h,modalcontent:"searchcnt"+h,scrollelm:h},o=e.p.postData[b.sFilter];
"string"===typeof o&&(o=a.jgrid.parse(o));!0===b.recreateFilter&&a("#"+a.jgrid.jqID(q.themodal)).remove();if(void 0!==a("#"+a.jgrid.jqID(q.themodal))[0])c(a("#fbox_"+a.jgrid.jqID(+e.p.id)));else{var f=a("<div><div id='"+h+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+a.jgrid.jqID(e.p.id)),i="left",t="";"rtl"===e.p.direction&&(i="right",t=" style='text-align:left'",f.attr("dir","rtl"));var v=a.extend([],e.p.colModel),d="<a id='"+h+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+
b.Find+"</a>",p="<a id='"+h+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+b.Reset+"</a>",g="",m="",l,n=!1,x=-1;b.showQuery&&(g="<a id='"+h+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>");b.columns.length?(v=b.columns,x=0,l=v[0].index||v[0].name):a.each(v,function(a,b){if(!b.label)b.label=e.p.colNames[a];if(!n){var c=
b.search===void 0?true:b.search,d=b.hidden===true;if(b.searchoptions&&b.searchoptions.searchhidden===true&&c||c&&!d){n=true;l=b.index||b.name;x=a}}});if(!o&&l||!1===b.multipleSearch){var A="eq";0<=x&&v[x].searchoptions&&v[x].searchoptions.sopt?A=v[x].searchoptions.sopt[0]:b.sopt&&b.sopt.length&&(A=b.sopt[0]);o={groupOp:"AND",rules:[{field:l,op:A,data:""}]}}n=!1;b.tmplNames&&b.tmplNames.length&&(n=!0,m=b.tmplLabel,m+="<select class='ui-template'>",m+="<option value='default'>Default</option>",a.each(b.tmplNames,
function(a,b){m=m+("<option value='"+a+"'>"+b+"</option>")}),m+="</select>");i="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+h+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+i+"'>"+p+m+"</td><td class='EditButton' "+t+">"+g+d+"</td></tr></tbody></table>";h=a.jgrid.jqID(h);a("#"+h).jqFilter({columns:v,filter:b.loadDefaults?o:null,showQuery:b.showQuery,errorcheck:b.errorcheck,sopt:b.sopt,
groupButton:b.multipleGroup,ruleButtons:b.multipleSearch,afterRedraw:b.afterRedraw,ops:b.odata,operands:b.operands,ajaxSelectOptions:e.p.ajaxSelectOptions,groupOps:b.groupOps,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString());a.isFunction(b.afterChange)&&b.afterChange.call(e,a("#"+h),b)},direction:e.p.direction,id:e.p.id});f.append(i);n&&b.tmplFilters&&b.tmplFilters.length&&a(".ui-template",f).bind("change",function(){var c=a(this).val();c==="default"?a("#"+h).jqFilter("addFilter",
o):a("#"+h).jqFilter("addFilter",b.tmplFilters[parseInt(c,10)]);return false});!0===b.multipleGroup&&(b.multipleSearch=!0);a(e).triggerHandler("jqGridFilterInitialize",[a("#"+h)]);a.isFunction(b.onInitializeSearch)&&b.onInitializeSearch.call(e,a("#"+h));b.gbox="#gbox_"+h;b.layer?a.jgrid.createModal(q,f,b,"#gview_"+a.jgrid.jqID(e.p.id),a("#gbox_"+a.jgrid.jqID(e.p.id))[0],"#"+a.jgrid.jqID(b.layer),{position:"relative"}):a.jgrid.createModal(q,f,b,"#gview_"+a.jgrid.jqID(e.p.id),a("#gbox_"+a.jgrid.jqID(e.p.id))[0]);
(b.searchOnEnter||b.closeOnEscape)&&a("#"+a.jgrid.jqID(q.themodal)).keydown(function(c){var d=a(c.target);if(b.searchOnEnter&&c.which===13&&!d.hasClass("add-group")&&!d.hasClass("add-rule")&&!d.hasClass("delete-group")&&!d.hasClass("delete-rule")&&(!d.hasClass("fm-button")||!d.is("[id$=_query]"))){a("#"+h+"_search").focus().click();return false}if(b.closeOnEscape&&c.which===27){a("#"+a.jgrid.jqID(q.modalhead)).find(".ui-jqdialog-titlebar-close").focus().click();return false}});g&&a("#"+h+"_query").bind("click",
function(){a(".queryresult",f).toggle();return false});void 0===b.stringResult&&(b.stringResult=b.multipleSearch);a("#"+h+"_search").bind("click",function(){var c=a("#"+h),d={},k,g=c.jqFilter("filterData");if(b.errorcheck){c[0].hideError();b.showQuery||c.jqFilter("toSQLString");if(c[0].p.error){c[0].showError();return false}}if(b.stringResult){try{k=xmlJsonClass.toJson(g,"","",false)}catch(f){try{k=JSON.stringify(g)}catch(i){}}if(typeof k==="string"){d[b.sFilter]=k;a.each([b.sField,b.sValue,b.sOper],
function(){d[this]=""})}}else if(b.multipleSearch){d[b.sFilter]=g;a.each([b.sField,b.sValue,b.sOper],function(){d[this]=""})}else{d[b.sField]=g.rules[0].field;d[b.sValue]=g.rules[0].data;d[b.sOper]=g.rules[0].op;d[b.sFilter]=""}e.p.search=true;a.extend(e.p.postData,d);r=a(e).triggerHandler("jqGridFilterSearch");r===void 0&&(r=true);r&&a.isFunction(b.onSearch)&&(r=b.onSearch.call(e,e.p.filters));r!==false&&a(e).trigger("reloadGrid",[{page:1}]);b.closeAfterSearch&&a.jgrid.hideModal("#"+a.jgrid.jqID(q.themodal),
{gb:"#gbox_"+a.jgrid.jqID(e.p.id),jqm:b.jqModal,onClose:b.onClose});return false});a("#"+h+"_reset").bind("click",function(){var c={},d=a("#"+h);e.p.search=false;b.multipleSearch===false?c[b.sField]=c[b.sValue]=c[b.sOper]="":c[b.sFilter]="";d[0].resetFilter();n&&a(".ui-template",f).val("default");a.extend(e.p.postData,c);r=a(e).triggerHandler("jqGridFilterReset");r===void 0&&(r=true);r&&a.isFunction(b.onReset)&&(r=b.onReset.call(e));r!==false&&a(e).trigger("reloadGrid",[{page:1}]);b.closeAfterReset&&
a.jgrid.hideModal("#"+a.jgrid.jqID(q.themodal),{gb:"#gbox_"+a.jgrid.jqID(e.p.id),jqm:b.jqModal,onClose:b.onClose});return false});c(a("#"+h));a(".fm-button:not(.ui-state-disabled)",f).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(s,c){c=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,
reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,
overlayClass:"ui-widget-overlay"},a.jgrid.edit,c||{});b[a(this)[0].p.id]=c;return this.each(function(){function e(){a(l+" > tbody > tr > td > .FormElement").each(function(){var c=a(".customelement",this);if(c.length){var b=a(c[0]).attr("name");a.each(d.p.colModel,function(){if(this.name===b&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{if(j[b]=this.editoptions.custom_value.call(d,a("#"+a.jgrid.jqID(b),l),"get"),void 0===j[b])throw"e1";}catch(c){"e1"===c?a.jgrid.info_dialog(a.jgrid.errors.errcap,
"function 'custom_value' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,c.message,a.jgrid.edit.bClose)}return!0}})}else{switch(a(this).get(0).type){case "checkbox":a(this).is(":checked")?j[this.name]=a(this).val():(c=a(this).attr("offval"),j[this.name]=c);break;case "select-one":j[this.name]=a("option:selected",this).val();break;case "select-multiple":j[this.name]=a(this).val();j[this.name]=j[this.name]?j[this.name].join(","):"";a("option:selected",this).each(function(c,
b){a(b).text()});break;case "password":case "text":case "textarea":case "button":j[this.name]=a(this).val()}d.p.autoencode&&(j[this.name]=a.jgrid.htmlEncode(j[this.name]))}});return!0}function h(c,e,k,f){var i,j,l,n=0,h,m,o,t=[],z=!1,s="",p;for(p=1;p<=f;p++)s+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==c&&(z=a(e).jqGrid("getInd",c));a(e.p.colModel).each(function(p){i=this.name;m=(j=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":
"";if("cb"!==i&&"subgrid"!==i&&!0===this.editable&&"rn"!==i){if(!1===z)h="";else if(i===e.p.ExpandColumn&&!0===e.p.treeGrid)h=a("td[role='gridcell']:eq("+p+")",e.rows[z]).text();else{try{h=a.unformat.call(e,a("td[role='gridcell']:eq("+p+")",e.rows[z]),{rowId:c,colModel:this},p)}catch(u){h=this.edittype&&"textarea"===this.edittype?a("td[role='gridcell']:eq("+p+")",e.rows[z]).text():a("td[role='gridcell']:eq("+p+")",e.rows[z]).html()}if(!h||"&nbsp;"===h||"&#160;"===h||1===h.length&&160===h.charCodeAt(0))h=
""}var r=a.extend({},this.editoptions||{},{id:i,name:i}),q=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),x=parseInt(q.rowpos,10)||n+1,w=parseInt(2*(parseInt(q.colpos,10)||1),10);"_empty"===c&&r.defaultValue&&(h=a.isFunction(r.defaultValue)?r.defaultValue.call(d):r.defaultValue);this.edittype||(this.edittype="text");d.p.autoencode&&(h=a.jgrid.htmlDecode(h));o=a.jgrid.createEl.call(d,this.edittype,r,h,!1,a.extend({},a.jgrid.ajaxOptions,e.p.ajaxSelectOptions||
{}));if(b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate)b[d.p.id]._savedData[i]=h;a(o).addClass("FormElement");-1<a.inArray(this.edittype,["text","textarea","password","select"])&&a(o).addClass("ui-widget-content ui-corner-all");l=a(k).find("tr[rowpos="+x+"]");if(q.rowabove){var y=a("<tr><td class='contentinfo' colspan='"+2*f+"'>"+q.rowcontent+"</td></tr>");a(k).append(y);y[0].rp=x}0===l.length&&(l=a("<tr "+m+" rowpos='"+x+"'></tr>").addClass("FormData").attr("id","tr_"+i),a(l).append(s),a(k).append(l),
l[0].rp=x);a("td:eq("+(w-2)+")",l[0]).html(void 0===q.label?e.p.colNames[p]:q.label);a("td:eq("+(w-1)+")",l[0]).append(q.elmprefix).append(o).append(q.elmsuffix);"custom"===this.edittype&&a.isFunction(r.custom_value)&&r.custom_value.call(d,a("#"+i,"#"+g),"set",h);a.jgrid.bindEv.call(d,o,r);t[n]=p;n++}});if(0<n&&(p=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*f-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+e.p.id+"_id' value='"+
c+"'/></td></tr>"),p[0].rp=n+999,a(k).append(p),b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate))b[d.p.id]._savedData[e.p.id+"_id"]=c;return t}function u(c,e,g){var k,i=0,f,j,h,n,o;if(b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate)b[d.p.id]._savedData={},b[d.p.id]._savedData[e.p.id+"_id"]=c;var m=e.p.colModel;if("_empty"===c)a(m).each(function(){k=this.name;h=a.extend({},this.editoptions||{});if((j=a("#"+a.jgrid.jqID(k),"#"+g))&&j.length&&null!==j[0])if(n="","custom"===this.edittype&&a.isFunction(h.custom_value)?
h.custom_value.call(d,a("#"+k,"#"+g),"set",n):h.defaultValue?(n=a.isFunction(h.defaultValue)?h.defaultValue.call(d):h.defaultValue,"checkbox"===j[0].type?(o=n.toLowerCase(),0>o.search(/(false|f|0|no|n|off|undefined)/i)&&""!==o?(j[0].checked=!0,j[0].defaultChecked=!0,j[0].value=n):(j[0].checked=!1,j[0].defaultChecked=!1)):j.val(n)):"checkbox"===j[0].type?(j[0].checked=!1,j[0].defaultChecked=!1,n=a(j).attr("offval")):j[0].type&&"select"===j[0].type.substr(0,6)?j[0].selectedIndex=0:j.val(n),!0===b[d.p.id].checkOnSubmit||
b[d.p.id].checkOnUpdate)b[d.p.id]._savedData[k]=n}),a("#id_g","#"+g).val(c);else{var p=a(e).jqGrid("getInd",c,!0);p&&(a('td[role="gridcell"]',p).each(function(j){k=m[j].name;if("cb"!==k&&"subgrid"!==k&&"rn"!==k&&!0===m[j].editable){if(k===e.p.ExpandColumn&&!0===e.p.treeGrid)f=a(this).text();else try{f=a.unformat.call(e,a(this),{rowId:c,colModel:m[j]},j)}catch(h){f="textarea"===m[j].edittype?a(this).text():a(this).html()}d.p.autoencode&&(f=a.jgrid.htmlDecode(f));if(!0===b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate)b[d.p.id]._savedData[k]=
f;k=a.jgrid.jqID(k);switch(m[j].edittype){case "password":case "text":case "button":case "image":case "textarea":if("&nbsp;"===f||"&#160;"===f||1===f.length&&160===f.charCodeAt(0))f="";a("#"+k,"#"+g).val(f);break;case "select":var n=f.split(","),n=a.map(n,function(c){return a.trim(c)});a("#"+k+" option","#"+g).each(function(){this.selected=!m[j].editoptions.multiple&&(a.trim(f)===a.trim(a(this).text())||n[0]===a.trim(a(this).text())||n[0]===a.trim(a(this).val()))?!0:m[j].editoptions.multiple?-1<a.inArray(a.trim(a(this).text()),
n)||-1<a.inArray(a.trim(a(this).val()),n)?!0:!1:!1});break;case "checkbox":f=""+f;if(m[j].editoptions&&m[j].editoptions.value)if(m[j].editoptions.value.split(":")[0]===f)a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]({checked:!0,defaultChecked:!0});else a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]({checked:!1,defaultChecked:!1});else f=f.toLowerCase(),0>f.search(/(false|f|0|no|n|off|undefined)/i)&&""!==f?(a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]("checked",!0),a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]("defaultChecked",
!0)):(a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]("checked",!1),a("#"+k,"#"+g)[d.p.useProp?"prop":"attr"]("defaultChecked",!1));break;case "custom":try{if(m[j].editoptions&&a.isFunction(m[j].editoptions.custom_value))m[j].editoptions.custom_value.call(d,a("#"+k,"#"+g),"set",f);else throw"e1";}catch(l){"e1"===l?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,l.message,a.jgrid.edit.bClose)}}i++}}),
0<i&&a("#id_g",l).val(c))}}function r(){a.each(d.p.colModel,function(a,c){c.editoptions&&!0===c.editoptions.NullIfEmpty&&j.hasOwnProperty(c.name)&&""===j[c.name]&&(j[c.name]="null")})}function q(){var e,k=[!0,"",""],f={},i=d.p.prmNames,h,m,o,z,s,q=a(d).triggerHandler("jqGridAddEditBeforeCheckValues",[a("#"+g),w]);q&&"object"===typeof q&&(j=q);a.isFunction(b[d.p.id].beforeCheckValues)&&(q=b[d.p.id].beforeCheckValues.call(d,j,a("#"+g),w))&&"object"===typeof q&&(j=q);for(o in j)if(j.hasOwnProperty(o)&&
(k=a.jgrid.checkValues.call(d,j[o],o),!1===k[0]))break;r();k[0]&&(f=a(d).triggerHandler("jqGridAddEditClickSubmit",[b[d.p.id],j,w]),void 0===f&&a.isFunction(b[d.p.id].onclickSubmit)&&(f=b[d.p.id].onclickSubmit.call(d,b[d.p.id],j,w)||{}),k=a(d).triggerHandler("jqGridAddEditBeforeSubmit",[j,a("#"+g),w]),void 0===k&&(k=[!0,"",""]),k[0]&&a.isFunction(b[d.p.id].beforeSubmit)&&(k=b[d.p.id].beforeSubmit.call(d,j,a("#"+g),w)));if(k[0]&&!b[d.p.id].processing){b[d.p.id].processing=!0;a("#sData",l+"_2").addClass("ui-state-active");
m=i.oper;h=i.id;j[m]="_empty"===a.trim(j[d.p.id+"_id"])?i.addoper:i.editoper;j[m]!==i.addoper?j[h]=j[d.p.id+"_id"]:void 0===j[h]&&(j[h]=j[d.p.id+"_id"]);delete j[d.p.id+"_id"];j=a.extend(j,b[d.p.id].editData,f);if(!0===d.p.treeGrid)for(s in j[m]===i.addoper&&(z=a(d).jqGrid("getGridParam","selrow"),j["adjacency"===d.p.treeGridModel?d.p.treeReader.parent_id_field:"parent_id"]=z),d.p.treeReader)d.p.treeReader.hasOwnProperty(s)&&(f=d.p.treeReader[s],j.hasOwnProperty(f)&&!(j[m]===i.addoper&&"parent_id_field"===
s)&&delete j[f]);j[h]=a.jgrid.stripPref(d.p.idPrefix,j[h]);s=a.extend({url:b[d.p.id].url||a(d).jqGrid("getGridParam","editurl"),type:b[d.p.id].mtype,data:a.isFunction(b[d.p.id].serializeEditData)?b[d.p.id].serializeEditData.call(d,j):j,complete:function(f,o){var s;j[h]=d.p.idPrefix+j[h];if(f.status>=300&&f.status!==304){k[0]=false;k[1]=a(d).triggerHandler("jqGridAddEditErrorTextFormat",[f,w]);k[1]=a.isFunction(b[d.p.id].errorTextFormat)?b[d.p.id].errorTextFormat.call(d,f,w):o+" Status: '"+f.statusText+
"'. Error code: "+f.status}else{k=a(d).triggerHandler("jqGridAddEditAfterSubmit",[f,j,w]);k===void 0&&(k=[true,"",""]);k[0]&&a.isFunction(b[d.p.id].afterSubmit)&&(k=b[d.p.id].afterSubmit.call(d,f,j,w))}if(k[0]===false){a("#FormError>td",l).html(k[1]);a("#FormError",l).show()}else{d.p.autoencode&&a.each(j,function(c,b){j[c]=a.jgrid.htmlDecode(b)});if(j[m]===i.addoper){k[2]||(k[2]=a.jgrid.randId());j[h]=k[2];b[d.p.id].reloadAfterSubmit?a(d).trigger("reloadGrid"):d.p.treeGrid===true?a(d).jqGrid("addChildNode",
k[2],z,j):a(d).jqGrid("addRowData",k[2],j,c.addedrow);if(b[d.p.id].closeAfterAdd){d.p.treeGrid!==true&&a(d).jqGrid("setSelection",k[2]);a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose})}else b[d.p.id].clearAfterAdd&&u("_empty",d,g)}else{if(b[d.p.id].reloadAfterSubmit){a(d).trigger("reloadGrid");b[d.p.id].closeAfterEdit||setTimeout(function(){a(d).jqGrid("setSelection",j[h])},1E3)}else d.p.treeGrid===true?a(d).jqGrid("setTreeRow",
j[h],j):a(d).jqGrid("setRowData",j[h],j);b[d.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose})}if(a.isFunction(b[d.p.id].afterComplete)){e=f;setTimeout(function(){a(d).triggerHandler("jqGridAddEditAfterComplete",[e,j,a("#"+g),w]);b[d.p.id].afterComplete.call(d,e,j,a("#"+g),w);e=null},500)}if(b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate){a("#"+g).data("disabled",false);if(b[d.p.id]._savedData[d.p.id+"_id"]!==
"_empty")for(s in b[d.p.id]._savedData)b[d.p.id]._savedData.hasOwnProperty(s)&&j[s]&&(b[d.p.id]._savedData[s]=j[s])}}b[d.p.id].processing=false;a("#sData",l+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+g)[0].focus()}catch(q){}}},a.jgrid.ajaxOptions,b[d.p.id].ajaxEditOptions);!s.url&&!b[d.p.id].useDataProxy&&(a.isFunction(d.p.dataProxy)?b[d.p.id].useDataProxy=!0:(k[0]=!1,k[1]+=" "+a.jgrid.errors.nourl));k[0]&&(b[d.p.id].useDataProxy?(f=d.p.dataProxy.call(d,s,"set_"+d.p.id),void 0===
f&&(f=[!0,""]),!1===f[0]?(k[0]=!1,k[1]=f[1]||"Error deleting the selected row!"):(s.data.oper===i.addoper&&b[d.p.id].closeAfterAdd&&a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose}),s.data.oper===i.editoper&&b[d.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose}))):a.ajax(s))}!1===k[0]&&(a("#FormError>td",l).html(k[1]),a("#FormError",l).show())}
function o(a,c){var b=!1,d;for(d in a)if(a.hasOwnProperty(d)&&a[d]!=c[d]){b=!0;break}return b}function f(){var c=!0;a("#FormError",l).hide();if(b[d.p.id].checkOnUpdate&&(j={},e(),K=o(j,b[d.p.id]._savedData)))a("#"+g).data("disabled",!0),a(".confirm","#"+n.themodal).show(),c=!1;return c}function i(){var c;if("_empty"!==s&&void 0!==d.p.savedRow&&0<d.p.savedRow.length&&a.isFunction(a.fn.jqGrid.restoreRow))for(c=0;c<d.p.savedRow.length;c++)if(d.p.savedRow[c].id==s){a(d).jqGrid("restoreRow",s);break}}
function t(c,b){var d=b[1].length-1;0===c?a("#pData",l+"_2").addClass("ui-state-disabled"):void 0!==b[1][c-1]&&a("#"+a.jgrid.jqID(b[1][c-1])).hasClass("ui-state-disabled")?a("#pData",l+"_2").addClass("ui-state-disabled"):a("#pData",l+"_2").removeClass("ui-state-disabled");c===d?a("#nData",l+"_2").addClass("ui-state-disabled"):void 0!==b[1][c+1]&&a("#"+a.jgrid.jqID(b[1][c+1])).hasClass("ui-state-disabled")?a("#nData",l+"_2").addClass("ui-state-disabled"):a("#nData",l+"_2").removeClass("ui-state-disabled")}
function v(){var c=a(d).jqGrid("getDataIDs"),b=a("#id_g",l).val();return[a.inArray(b,c),c]}var d=this;if(d.grid&&s){var p=d.p.id,g="FrmGrid_"+p,m="TblGrid_"+p,l="#"+a.jgrid.jqID(m),n={themodal:"editmod"+p,modalhead:"edithd"+p,modalcontent:"editcnt"+p,scrollelm:g},x=a.isFunction(b[d.p.id].beforeShowForm)?b[d.p.id].beforeShowForm:!1,A=a.isFunction(b[d.p.id].afterShowForm)?b[d.p.id].afterShowForm:!1,y=a.isFunction(b[d.p.id].beforeInitData)?b[d.p.id].beforeInitData:!1,B=a.isFunction(b[d.p.id].onInitializeForm)?
b[d.p.id].onInitializeForm:!1,k=!0,z=1,F=0,j,K,w,g=a.jgrid.jqID(g);"new"===s?(s="_empty",w="add",c.caption=b[d.p.id].addCaption):(c.caption=b[d.p.id].editCaption,w="edit");!0===c.recreateForm&&void 0!==a("#"+a.jgrid.jqID(n.themodal))[0]&&a("#"+a.jgrid.jqID(n.themodal)).remove();var G=!0;c.checkOnUpdate&&c.jqModal&&!c.modal&&(G=!1);if(void 0!==a("#"+a.jgrid.jqID(n.themodal))[0]){k=a(d).triggerHandler("jqGridAddEditBeforeInitData",[a("#"+a.jgrid.jqID(g)),w]);void 0===k&&(k=!0);k&&y&&(k=y.call(d,a("#"+
g),w));if(!1===k)return;i();a(".ui-jqdialog-title","#"+a.jgrid.jqID(n.modalhead)).html(c.caption);a("#FormError",l).hide();b[d.p.id].topinfo?(a(".topinfo",l).html(b[d.p.id].topinfo),a(".tinfo",l).show()):a(".tinfo",l).hide();b[d.p.id].bottominfo?(a(".bottominfo",l+"_2").html(b[d.p.id].bottominfo),a(".binfo",l+"_2").show()):a(".binfo",l+"_2").hide();u(s,d,g);"_empty"===s||!b[d.p.id].viewPagerButtons?a("#pData, #nData",l+"_2").hide():a("#pData, #nData",l+"_2").show();!0===b[d.p.id].processing&&(b[d.p.id].processing=
!1,a("#sData",l+"_2").removeClass("ui-state-active"));!0===a("#"+g).data("disabled")&&(a(".confirm","#"+a.jgrid.jqID(n.themodal)).hide(),a("#"+g).data("disabled",!1));a(d).triggerHandler("jqGridAddEditBeforeShowForm",[a("#"+g),w]);x&&x.call(d,a("#"+g),w);a("#"+a.jgrid.jqID(n.themodal)).data("onClose",b[d.p.id].onClose);a.jgrid.viewModal("#"+a.jgrid.jqID(n.themodal),{gbox:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,jqM:!1,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass});G||a("."+a.jgrid.jqID(c.overlayClass)).click(function(){if(!f())return false;
a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose});return false});a(d).triggerHandler("jqGridAddEditAfterShowForm",[a("#"+g),w]);A&&A.call(d,a("#"+g),w)}else{var E=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",k=isNaN(c.datawidth)?c.datawidth:c.datawidth+"px",E=a("<form name='FormPost' id='"+g+"' class='FormGrid' onSubmit='return false;' style='width:"+k+";overflow:auto;position:relative;height:"+E+";'></form>").data("disabled",
!1),C=a("<table id='"+m+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),k=a(d).triggerHandler("jqGridAddEditBeforeInitData",[a("#"+g),w]);void 0===k&&(k=!0);k&&y&&(k=y.call(d,a("#"+g),w));if(!1===k)return;i();a(d.p.colModel).each(function(){var a=this.formoptions;z=Math.max(z,a?a.colpos||0:0);F=Math.max(F,a?a.rowpos||0:0)});a(E).append(C);y=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+2*z+"'></td></tr>");y[0].rp=0;a(C).append(y);
y=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*z+"'>"+b[d.p.id].topinfo+"</td></tr>");y[0].rp=0;a(C).append(y);var k=(y="rtl"===d.p.direction?!0:!1)?"nData":"pData",D=y?"pData":"nData";h(s,d,C,z);var k="<a id='"+k+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",D="<a id='"+D+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",H="<a id='sData' class='fm-button ui-state-default ui-corner-all'>"+
c.bSubmit+"</a>",I="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>",m="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+m+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(y?D+k:k+D)+"</td><td class='EditButton'>"+H+I+"</td></tr>"+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+b[d.p.id].bottominfo+"</td></tr>"),m=m+"</tbody></table>";
if(0<F){var J=[];a.each(a(C)[0].rows,function(a,c){J[a]=c});J.sort(function(a,c){return a.rp>c.rp?1:a.rp<c.rp?-1:0});a.each(J,function(c,b){a("tbody",C).append(b)})}c.gbox="#gbox_"+a.jgrid.jqID(p);var L=!1;!0===c.closeOnEscape&&(c.closeOnEscape=!1,L=!0);m=a("<div></div>").append(E).append(m);a.jgrid.createModal(n,m,c,"#gview_"+a.jgrid.jqID(d.p.id),a("#gbox_"+a.jgrid.jqID(d.p.id))[0]);y&&(a("#pData, #nData",l+"_2").css("float","right"),a(".EditButton",l+"_2").css("text-align","left"));b[d.p.id].topinfo&&
a(".tinfo",l).show();b[d.p.id].bottominfo&&a(".binfo",l+"_2").show();m=m=null;a("#"+a.jgrid.jqID(n.themodal)).keydown(function(e){var k=e.target;if(a("#"+g).data("disabled")===true)return false;if(b[d.p.id].savekey[0]===true&&e.which===b[d.p.id].savekey[1]&&k.tagName!=="TEXTAREA"){a("#sData",l+"_2").trigger("click");return false}if(e.which===27){if(!f())return false;L&&a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:c.gbox,jqm:c.jqModal,onClose:b[d.p.id].onClose});return false}if(b[d.p.id].navkeys[0]===
true){if(a("#id_g",l).val()==="_empty")return true;if(e.which===b[d.p.id].navkeys[1]){a("#pData",l+"_2").trigger("click");return false}if(e.which===b[d.p.id].navkeys[2]){a("#nData",l+"_2").trigger("click");return false}}});c.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span","#"+a.jgrid.jqID(n.themodal)).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(n.themodal)).unbind("click").click(function(){if(!f())return false;a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+
a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose});return false}));c.saveicon=a.extend([!0,"left","ui-icon-disk"],c.saveicon);c.closeicon=a.extend([!0,"left","ui-icon-close"],c.closeicon);!0===c.saveicon[0]&&a("#sData",l+"_2").addClass("right"===c.saveicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.saveicon[2]+"'></span>");!0===c.closeicon[0]&&a("#cData",l+"_2").addClass("right"===c.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+
c.closeicon[2]+"'></span>");if(b[d.p.id].checkOnSubmit||b[d.p.id].checkOnUpdate)H="<a id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bYes+"</a>",D="<a id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bNo+"</a>",I="<a id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bExit+"</a>",m=c.zIndex||999,m++,a("<div class='"+c.overlayClass+" jqgrid-overlay confirm' style='z-index:"+m+";display:none;'>&#160;</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+
(m+1)+"'>"+c.saveData+"<br/><br/>"+H+D+I+"</div>").insertAfter("#"+g),a("#sNew","#"+a.jgrid.jqID(n.themodal)).click(function(){q();a("#"+g).data("disabled",false);a(".confirm","#"+a.jgrid.jqID(n.themodal)).hide();return false}),a("#nNew","#"+a.jgrid.jqID(n.themodal)).click(function(){a(".confirm","#"+a.jgrid.jqID(n.themodal)).hide();a("#"+g).data("disabled",false);setTimeout(function(){a(":input:visible","#"+g)[0].focus()},0);return false}),a("#cNew","#"+a.jgrid.jqID(n.themodal)).click(function(){a(".confirm",
"#"+a.jgrid.jqID(n.themodal)).hide();a("#"+g).data("disabled",false);a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose});return false});a(d).triggerHandler("jqGridAddEditInitializeForm",[a("#"+g),w]);B&&B.call(d,a("#"+g),w);"_empty"===s||!b[d.p.id].viewPagerButtons?a("#pData,#nData",l+"_2").hide():a("#pData,#nData",l+"_2").show();a(d).triggerHandler("jqGridAddEditBeforeShowForm",[a("#"+g),w]);x&&x.call(d,a("#"+g),w);a("#"+a.jgrid.jqID(n.themodal)).data("onClose",
b[d.p.id].onClose);a.jgrid.viewModal("#"+a.jgrid.jqID(n.themodal),{gbox:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass});G||a("."+a.jgrid.jqID(c.overlayClass)).click(function(){if(!f())return false;a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose});return false});a(d).triggerHandler("jqGridAddEditAfterShowForm",[a("#"+g),w]);A&&A.call(d,a("#"+g),w);a(".fm-button","#"+a.jgrid.jqID(n.themodal)).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});a("#sData",l+"_2").click(function(){j={};a("#FormError",l).hide();e();if(j[d.p.id+"_id"]==="_empty")q();else if(c.checkOnSubmit===true)if(K=o(j,b[d.p.id]._savedData)){a("#"+g).data("disabled",true);a(".confirm","#"+a.jgrid.jqID(n.themodal)).show()}else q();else q();return false});a("#cData",l+"_2").click(function(){if(!f())return false;a.jgrid.hideModal("#"+a.jgrid.jqID(n.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:c.jqModal,onClose:b[d.p.id].onClose});
return false});a("#nData",l+"_2").click(function(){if(!f())return false;a("#FormError",l).hide();var b=v();b[0]=parseInt(b[0],10);if(b[0]!==-1&&b[1][b[0]+1]){a(d).triggerHandler("jqGridAddEditClickPgButtons",["next",a("#"+g),b[1][b[0]]]);var e;if(a.isFunction(c.onclickPgButtons)){e=c.onclickPgButtons.call(d,"next",a("#"+g),b[1][b[0]]);if(e!==void 0&&e===false)return false}if(a("#"+a.jgrid.jqID(b[1][b[0]+1])).hasClass("ui-state-disabled"))return false;u(b[1][b[0]+1],d,g);a(d).jqGrid("setSelection",
b[1][b[0]+1]);a(d).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",a("#"+g),b[1][b[0]]]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons.call(d,"next",a("#"+g),b[1][b[0]+1]);t(b[0]+1,b)}return false});a("#pData",l+"_2").click(function(){if(!f())return false;a("#FormError",l).hide();var b=v();if(b[0]!==-1&&b[1][b[0]-1]){a(d).triggerHandler("jqGridAddEditClickPgButtons",["prev",a("#"+g),b[1][b[0]]]);var e;if(a.isFunction(c.onclickPgButtons)){e=c.onclickPgButtons.call(d,"prev",a("#"+
g),b[1][b[0]]);if(e!==void 0&&e===false)return false}if(a("#"+a.jgrid.jqID(b[1][b[0]-1])).hasClass("ui-state-disabled"))return false;u(b[1][b[0]-1],d,g);a(d).jqGrid("setSelection",b[1][b[0]-1]);a(d).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",a("#"+g),b[1][b[0]]]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons.call(d,"prev",a("#"+g),b[1][b[0]-1]);t(b[0]-1,b)}return false})}x=v();t(x[0],x)}})},viewGridRow:function(s,c){c=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",
height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1},a.jgrid.view,c||{});b[a(this)[0].p.id]=c;return this.each(function(){function e(){(!0===b[o.p.id].closeOnEscape||!0===b[o.p.id].navkeys[0])&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(p.modalhead)).focus()},0)}function h(b,d,e,f){var g,
i,h,n=0,m,l,o=[],s=!1,p,q="<td class='CaptionTD form-view-label ui-widget-content' width='"+c.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",r="",t=["integer","number","currency"],x=0,u=0,y,v,A;for(p=1;p<=f;p++)r+=1===p?q:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";a(d.p.colModel).each(function(){i=this.editrules&&!0===this.editrules.edithidden?!1:!0===
this.hidden?!0:!1;!i&&"right"===this.align&&(this.formatter&&-1!==a.inArray(this.formatter,t)?x=Math.max(x,parseInt(this.width,10)):u=Math.max(u,parseInt(this.width,10)))});y=0!==x?x:0!==u?u:0;s=a(d).jqGrid("getInd",b);a(d.p.colModel).each(function(b){g=this.name;v=!1;l=(i=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";A="boolean"!==typeof this.viewable?!0:this.viewable;if("cb"!==g&&"subgrid"!==g&&"rn"!==g&&A){m=!1===s?"":g===d.p.ExpandColumn&&
!0===d.p.treeGrid?a("td:eq("+b+")",d.rows[s]).text():a("td:eq("+b+")",d.rows[s]).html();v="right"===this.align&&0!==y?!0:!1;var c=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),k=parseInt(c.rowpos,10)||n+1,p=parseInt(2*(parseInt(c.colpos,10)||1),10);if(c.rowabove){var q=a("<tr><td class='contentinfo' colspan='"+2*f+"'>"+c.rowcontent+"</td></tr>");a(e).append(q);q[0].rp=k}h=a(e).find("tr[rowpos="+k+"]");0===h.length&&(h=a("<tr "+l+" rowpos='"+k+"'></tr>").addClass("FormData").attr("id",
"trv_"+g),a(h).append(r),a(e).append(h),h[0].rp=k);a("td:eq("+(p-2)+")",h[0]).html("<b>"+(void 0===c.label?d.p.colNames[b]:c.label)+"</b>");a("td:eq("+(p-1)+")",h[0]).append("<span>"+m+"</span>").attr("id","v_"+g);v&&a("td:eq("+(p-1)+") span",h[0]).css({"text-align":"right",width:y+"px"});o[n]=b;n++}});0<n&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(2*f-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),
b[0].rp=n+99,a(e).append(b));return o}function u(b,c){var d,e,f=0,g,i;if(i=a(c).jqGrid("getInd",b,!0))a("td",i).each(function(b){d=c.p.colModel[b].name;e=c.p.colModel[b].editrules&&!0===c.p.colModel[b].editrules.edithidden?!1:!0===c.p.colModel[b].hidden?!0:!1;"cb"!==d&&"subgrid"!==d&&"rn"!==d&&(g=d===c.p.ExpandColumn&&!0===c.p.treeGrid?a(this).text():a(this).html(),d=a.jgrid.jqID("v_"+d),a("#"+d+" span","#"+t).html(g),e&&a("#"+d,"#"+t).parents("tr:first").hide(),f++)}),0<f&&a("#id_g","#"+t).val(b)}
function r(b,c){var d=c[1].length-1;0===b?a("#pData","#"+t+"_2").addClass("ui-state-disabled"):void 0!==c[1][b-1]&&a("#"+a.jgrid.jqID(c[1][b-1])).hasClass("ui-state-disabled")?a("#pData",t+"_2").addClass("ui-state-disabled"):a("#pData","#"+t+"_2").removeClass("ui-state-disabled");b===d?a("#nData","#"+t+"_2").addClass("ui-state-disabled"):void 0!==c[1][b+1]&&a("#"+a.jgrid.jqID(c[1][b+1])).hasClass("ui-state-disabled")?a("#nData",t+"_2").addClass("ui-state-disabled"):a("#nData","#"+t+"_2").removeClass("ui-state-disabled")}
function q(){var b=a(o).jqGrid("getDataIDs"),c=a("#id_g","#"+t).val();return[a.inArray(c,b),b]}var o=this;if(o.grid&&s){var f=o.p.id,i="ViewGrid_"+a.jgrid.jqID(f),t="ViewTbl_"+a.jgrid.jqID(f),v="ViewGrid_"+f,d="ViewTbl_"+f,p={themodal:"viewmod"+f,modalhead:"viewhd"+f,modalcontent:"viewcnt"+f,scrollelm:i},g=a.isFunction(b[o.p.id].beforeInitData)?b[o.p.id].beforeInitData:!1,m=!0,l=1,n=0;!0===c.recreateForm&&void 0!==a("#"+a.jgrid.jqID(p.themodal))[0]&&a("#"+a.jgrid.jqID(p.themodal)).remove();if(void 0!==
a("#"+a.jgrid.jqID(p.themodal))[0]){g&&(m=g.call(o,a("#"+i)),void 0===m&&(m=!0));if(!1===m)return;a(".ui-jqdialog-title","#"+a.jgrid.jqID(p.modalhead)).html(c.caption);a("#FormError","#"+t).hide();u(s,o);a.isFunction(b[o.p.id].beforeShowForm)&&b[o.p.id].beforeShowForm.call(o,a("#"+i));a.jgrid.viewModal("#"+a.jgrid.jqID(p.themodal),{gbox:"#gbox_"+a.jgrid.jqID(f),jqm:c.jqModal,jqM:!1,overlay:c.overlay,modal:c.modal});e()}else{var x=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",A=isNaN(c.datawidth)?
c.datawidth:c.datawidth+"px",v=a("<form name='FormPost' id='"+v+"' class='FormGrid' style='width:"+A+";overflow:auto;position:relative;height:"+x+";'></form>"),y=a("<table id='"+d+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");g&&(m=g.call(o,a("#"+i)),void 0===m&&(m=!0));if(!1===m)return;a(o.p.colModel).each(function(){var a=this.formoptions;l=Math.max(l,a?a.colpos||0:0);n=Math.max(n,a?a.rowpos||0:0)});a(v).append(y);h(s,o,y,l);
d="rtl"===o.p.direction?!0:!1;g="<a id='"+(d?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";m="<a id='"+(d?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>";x="<a id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bClose+"</a>";if(0<n){var B=[];a.each(a(y)[0].rows,function(a,b){B[a]=b});B.sort(function(a,b){return a.rp>b.rp?1:a.rp<
b.rp?-1:0});a.each(B,function(b,c){a("tbody",y).append(c)})}c.gbox="#gbox_"+a.jgrid.jqID(f);v=a("<div></div>").append(v).append("<table border='0' class='EditTable' id='"+t+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+c.labelswidth+"'>"+(d?m+g:g+m)+"</td><td class='EditButton'>"+x+"</td></tr></tbody></table>");a.jgrid.createModal(p,v,c,"#gview_"+a.jgrid.jqID(o.p.id),a("#gview_"+a.jgrid.jqID(o.p.id))[0]);d&&(a("#pData, #nData","#"+t+"_2").css("float","right"),a(".EditButton","#"+
t+"_2").css("text-align","left"));c.viewPagerButtons||a("#pData, #nData","#"+t+"_2").hide();v=null;a("#"+p.themodal).keydown(function(d){if(d.which===27){b[o.p.id].closeOnEscape&&a.jgrid.hideModal("#"+a.jgrid.jqID(p.themodal),{gb:c.gbox,jqm:c.jqModal,onClose:c.onClose});return false}if(c.navkeys[0]===true){if(d.which===c.navkeys[1]){a("#pData","#"+t+"_2").trigger("click");return false}if(d.which===c.navkeys[2]){a("#nData","#"+t+"_2").trigger("click");return false}}});c.closeicon=a.extend([!0,"left",
"ui-icon-close"],c.closeicon);!0===c.closeicon[0]&&a("#cData","#"+t+"_2").addClass("right"===c.closeicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+"'></span>");a.isFunction(c.beforeShowForm)&&c.beforeShowForm.call(o,a("#"+i));a.jgrid.viewModal("#"+a.jgrid.jqID(p.themodal),{gbox:"#gbox_"+a.jgrid.jqID(f),jqm:c.jqModal,overlay:c.overlay,modal:c.modal});a(".fm-button:not(.ui-state-disabled)","#"+t+"_2").hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});e();a("#cData","#"+t+"_2").click(function(){a.jgrid.hideModal("#"+a.jgrid.jqID(p.themodal),{gb:"#gbox_"+a.jgrid.jqID(f),jqm:c.jqModal,onClose:c.onClose});return false});a("#nData","#"+t+"_2").click(function(){a("#FormError","#"+t).hide();var b=q();b[0]=parseInt(b[0],10);if(b[0]!==-1&&b[1][b[0]+1]){a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons.call(o,"next",a("#"+i),b[1][b[0]]);u(b[1][b[0]+1],o);a(o).jqGrid("setSelection",b[1][b[0]+1]);a.isFunction(c.afterclickPgButtons)&&
c.afterclickPgButtons.call(o,"next",a("#"+i),b[1][b[0]+1]);r(b[0]+1,b)}e();return false});a("#pData","#"+t+"_2").click(function(){a("#FormError","#"+t).hide();var b=q();if(b[0]!==-1&&b[1][b[0]-1]){a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons.call(o,"prev",a("#"+i),b[1][b[0]]);u(b[1][b[0]-1],o);a(o).jqGrid("setSelection",b[1][b[0]-1]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons.call(o,"prev",a("#"+i),b[1][b[0]-1]);r(b[0]-1,b)}e();return false})}v=q();r(v[0],v)}})},delGridRow:function(s,
c){c=a.extend(!0,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},a.jgrid.del,c||{});b[a(this)[0].p.id]=c;return this.each(function(){var e=this;if(e.grid&&
s){var h=a.isFunction(b[e.p.id].beforeShowForm),u=a.isFunction(b[e.p.id].afterShowForm),r=a.isFunction(b[e.p.id].beforeInitData)?b[e.p.id].beforeInitData:!1,q=e.p.id,o={},f=!0,i="DelTbl_"+a.jgrid.jqID(q),t,v,d,p,g="DelTbl_"+q,m={themodal:"delmod"+q,modalhead:"delhd"+q,modalcontent:"delcnt"+q,scrollelm:i};a.isArray(s)&&(s=s.join());if(void 0!==a("#"+a.jgrid.jqID(m.themodal))[0]){r&&(f=r.call(e,a("#"+i)),void 0===f&&(f=!0));if(!1===f)return;a("#DelData>td","#"+i).text(s);a("#DelError","#"+i).hide();
!0===b[e.p.id].processing&&(b[e.p.id].processing=!1,a("#dData","#"+i).removeClass("ui-state-active"));h&&b[e.p.id].beforeShowForm.call(e,a("#"+i));a.jgrid.viewModal("#"+a.jgrid.jqID(m.themodal),{gbox:"#gbox_"+a.jgrid.jqID(q),jqm:b[e.p.id].jqModal,jqM:!1,overlay:b[e.p.id].overlay,modal:b[e.p.id].modal})}else{var l=isNaN(b[e.p.id].dataheight)?b[e.p.id].dataheight:b[e.p.id].dataheight+"px",n=isNaN(c.datawidth)?c.datawidth:c.datawidth+"px",g="<div id='"+g+"' class='formdata' style='width:"+n+";overflow:auto;position:relative;height:"+
l+";'><table class='DelTable'><tbody><tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>"+("<tr id='DelData' style='display:none'><td >"+s+"</td></tr>"),g=g+('<tr><td class="delmsg" style="white-space:pre;">'+b[e.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>"),g=g+"</tbody></table></div>"+("<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+i+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+
("<a id='dData' class='fm-button ui-state-default ui-corner-all'>"+c.bSubmit+"</a>")+"&#160;"+("<a id='eData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>")+"</td></tr></tbody></table>");c.gbox="#gbox_"+a.jgrid.jqID(q);a.jgrid.createModal(m,g,c,"#gview_"+a.jgrid.jqID(e.p.id),a("#gview_"+a.jgrid.jqID(e.p.id))[0]);r&&(f=r.call(e,a("#"+i)),void 0===f&&(f=!0));if(!1===f)return;a(".fm-button","#"+i+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});
c.delicon=a.extend([!0,"left","ui-icon-scissors"],b[e.p.id].delicon);c.cancelicon=a.extend([!0,"left","ui-icon-cancel"],b[e.p.id].cancelicon);!0===c.delicon[0]&&a("#dData","#"+i+"_2").addClass("right"===c.delicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.delicon[2]+"'></span>");!0===c.cancelicon[0]&&a("#eData","#"+i+"_2").addClass("right"===c.cancelicon[1]?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.cancelicon[2]+"'></span>");
a("#dData","#"+i+"_2").click(function(){var f=[true,""],g,h=a("#DelData>td","#"+i).text();o={};a.isFunction(b[e.p.id].onclickSubmit)&&(o=b[e.p.id].onclickSubmit.call(e,b[e.p.id],h)||{});a.isFunction(b[e.p.id].beforeSubmit)&&(f=b[e.p.id].beforeSubmit.call(e,h));if(f[0]&&!b[e.p.id].processing){b[e.p.id].processing=true;d=e.p.prmNames;t=a.extend({},b[e.p.id].delData,o);p=d.oper;t[p]=d.deloper;v=d.id;h=(""+h).split(",");if(!h.length)return false;for(g in h)h.hasOwnProperty(g)&&(h[g]=a.jgrid.stripPref(e.p.idPrefix,
h[g]));t[v]=h.join();a(this).addClass("ui-state-active");g=a.extend({url:b[e.p.id].url||a(e).jqGrid("getGridParam","editurl"),type:b[e.p.id].mtype,data:a.isFunction(b[e.p.id].serializeDelData)?b[e.p.id].serializeDelData.call(e,t):t,complete:function(d,g){var n;if(d.status>=300&&d.status!==304){f[0]=false;f[1]=a.isFunction(b[e.p.id].errorTextFormat)?b[e.p.id].errorTextFormat.call(e,d):g+" Status: '"+d.statusText+"'. Error code: "+d.status}else a.isFunction(b[e.p.id].afterSubmit)&&(f=b[e.p.id].afterSubmit.call(e,
d,t));if(f[0]===false){a("#DelError>td","#"+i).html(f[1]);a("#DelError","#"+i).show()}else{if(b[e.p.id].reloadAfterSubmit&&e.p.datatype!=="local")a(e).trigger("reloadGrid");else{if(e.p.treeGrid===true)try{a(e).jqGrid("delTreeNode",e.p.idPrefix+h[0])}catch(l){}else for(n=0;n<h.length;n++)a(e).jqGrid("delRowData",e.p.idPrefix+h[n]);e.p.selrow=null;e.p.selarrrow=[]}a.isFunction(b[e.p.id].afterComplete)&&setTimeout(function(){b[e.p.id].afterComplete.call(e,d,h)},500)}b[e.p.id].processing=false;a("#dData",
"#"+i+"_2").removeClass("ui-state-active");f[0]&&a.jgrid.hideModal("#"+a.jgrid.jqID(m.themodal),{gb:"#gbox_"+a.jgrid.jqID(q),jqm:c.jqModal,onClose:b[e.p.id].onClose})}},a.jgrid.ajaxOptions,b[e.p.id].ajaxDelOptions);if(!g.url&&!b[e.p.id].useDataProxy)if(a.isFunction(e.p.dataProxy))b[e.p.id].useDataProxy=true;else{f[0]=false;f[1]=f[1]+(" "+a.jgrid.errors.nourl)}if(f[0])if(b[e.p.id].useDataProxy){g=e.p.dataProxy.call(e,g,"del_"+e.p.id);g===void 0&&(g=[true,""]);if(g[0]===false){f[0]=false;f[1]=g[1]||
"Error deleting the selected row!"}else a.jgrid.hideModal("#"+a.jgrid.jqID(m.themodal),{gb:"#gbox_"+a.jgrid.jqID(q),jqm:c.jqModal,onClose:b[e.p.id].onClose})}else a.ajax(g)}if(f[0]===false){a("#DelError>td","#"+i).html(f[1]);a("#DelError","#"+i).show()}return false});a("#eData","#"+i+"_2").click(function(){a.jgrid.hideModal("#"+a.jgrid.jqID(m.themodal),{gb:"#gbox_"+a.jgrid.jqID(q),jqm:b[e.p.id].jqModal,onClose:b[e.p.id].onClose});return false});h&&b[e.p.id].beforeShowForm.call(e,a("#"+i));a.jgrid.viewModal("#"+
a.jgrid.jqID(m.themodal),{gbox:"#gbox_"+a.jgrid.jqID(q),jqm:b[e.p.id].jqModal,overlay:b[e.p.id].overlay,modal:b[e.p.id].modal})}u&&b[e.p.id].afterShowForm.call(e,a("#"+i));!0===b[e.p.id].closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(m.modalhead)).focus()},0)}})},navGrid:function(b,c,e,h,u,r,q){c=a.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",
refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},a.jgrid.nav,c||{});return this.each(function(){if(!this.nav){var o={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},f=this,i;if(f.grid&&"string"===typeof b){void 0===a("#"+o.themodal)[0]&&(!c.alerttop&&!c.alertleft&&(void 0!==
window.innerWidth?(c.alertleft=window.innerWidth,c.alerttop=window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(c.alertleft=document.documentElement.clientWidth,c.alerttop=document.documentElement.clientHeight):(c.alertleft=1024,c.alerttop=768),c.alertleft=c.alertleft/2-parseInt(c.alertwidth,10)/2,c.alerttop=c.alerttop/2-25),a.jgrid.createModal(o,"<div>"+c.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",
{gbox:"#gbox_"+a.jgrid.jqID(f.p.id),jqModal:!0,drag:!0,resize:!0,caption:c.alertcap,top:c.alerttop,left:c.alertleft,width:c.alertwidth,height:c.alertheight,closeOnEscape:c.closeOnEscape,zIndex:c.alertzIndex},"#gview_"+a.jgrid.jqID(f.p.id),a("#gbox_"+a.jgrid.jqID(f.p.id))[0],!0));var t=1,v,d=function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},p=function(){a(this).removeClass("ui-state-hover")};c.cloneToTop&&f.p.toppager&&(t=2);for(v=0;v<t;v++){var g=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),
m,l;0===v?(m=b,l=f.p.id,m===f.p.toppager&&(l+="_top",t=1)):(m=f.p.toppager,l=f.p.id+"_top");"rtl"===f.p.direction&&a(g).attr("dir","rtl").css("float","right");c.add&&(h=h||{},i=a("<td class='ui-pg-button ui-corner-all'></td>"),a(i).append("<div class='ui-pg-div'><span class='ui-icon "+c.addicon+"'></span>"+c.addtext+"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.addtitle||"",id:h.id||"add_"+l}).click(function(){a(this).hasClass("ui-state-disabled")||(a.isFunction(c.addfunc)?c.addfunc.call(f):
a(f).jqGrid("editGridRow","new",h));return false}).hover(d,p),i=null);c.edit&&(i=a("<td class='ui-pg-button ui-corner-all'></td>"),e=e||{},a(i).append("<div class='ui-pg-div'><span class='ui-icon "+c.editicon+"'></span>"+c.edittext+"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.edittitle||"",id:e.id||"edit_"+l}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=f.p.selrow;if(b)a.isFunction(c.editfunc)?c.editfunc.call(f,b):a(f).jqGrid("editGridRow",b,e);else{a.jgrid.viewModal("#"+
o.themodal,{gbox:"#gbox_"+a.jgrid.jqID(f.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(d,p),i=null);c.view&&(i=a("<td class='ui-pg-button ui-corner-all'></td>"),q=q||{},a(i).append("<div class='ui-pg-div'><span class='ui-icon "+c.viewicon+"'></span>"+c.viewtext+"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.viewtitle||"",id:q.id||"view_"+l}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=f.p.selrow;if(b)a.isFunction(c.viewfunc)?c.viewfunc.call(f,b):a(f).jqGrid("viewGridRow",
b,q);else{a.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+a.jgrid.jqID(f.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(d,p),i=null);c.del&&(i=a("<td class='ui-pg-button ui-corner-all'></td>"),u=u||{},a(i).append("<div class='ui-pg-div'><span class='ui-icon "+c.delicon+"'></span>"+c.deltext+"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.deltitle||"",id:u.id||"del_"+l}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b;if(f.p.multiselect){b=f.p.selarrrow;b.length===
0&&(b=null)}else b=f.p.selrow;if(b)a.isFunction(c.delfunc)?c.delfunc.call(f,b):a(f).jqGrid("delGridRow",b,u);else{a.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+a.jgrid.jqID(f.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(d,p),i=null);(c.add||c.edit||c.del||c.view)&&a("tr",g).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");c.search&&(i=a("<td class='ui-pg-button ui-corner-all'></td>"),r=r||{},a(i).append("<div class='ui-pg-div'><span class='ui-icon "+
c.searchicon+"'></span>"+c.searchtext+"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.searchtitle||"",id:r.id||"search_"+l}).click(function(){a(this).hasClass("ui-state-disabled")||(a.isFunction(c.searchfunc)?c.searchfunc.call(f,r):a(f).jqGrid("searchGrid",r));return false}).hover(d,p),r.showOnLoad&&!0===r.showOnLoad&&a(i,g).click(),i=null);c.refresh&&(i=a("<td class='ui-pg-button ui-corner-all'></td>"),a(i).append("<div class='ui-pg-div'><span class='ui-icon "+c.refreshicon+"'></span>"+c.refreshtext+
"</div>"),a("tr",g).append(i),a(i,g).attr({title:c.refreshtitle||"",id:"refresh_"+l}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(c.beforeRefresh)&&c.beforeRefresh.call(f);f.p.search=false;try{var b=f.p.id;f.p.postData.filters="";try{a("#fbox_"+a.jgrid.jqID(b)).jqFilter("resetFilter")}catch(d){}a.isFunction(f.clearToolbar)&&f.clearToolbar.call(f,false)}catch(e){}switch(c.refreshstate){case "firstpage":a(f).trigger("reloadGrid",[{page:1}]);break;case "current":a(f).trigger("reloadGrid",
[{current:true}])}a.isFunction(c.afterRefresh)&&c.afterRefresh.call(f)}return false}).hover(d,p),i=null);i=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+i+";visibility:hidden;' ></div>");i=a(g).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(m+"_"+c.position,m).append(g);f.p._nvtd&&(i>f.p._nvtd[0]&&(a(m+"_"+c.position,m).width(i),f.p._nvtd[0]=i),f.p._nvtd[1]=i);g=i=i=null;this.nav=!0}}}})},
navButtonAdd:function(b,c){c=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},c||{});return this.each(function(){if(this.grid){"string"===typeof b&&0!==b.indexOf("#")&&(b="#"+a.jgrid.jqID(b));var e=a(".navtable",b)[0],h=this;if(e&&!(c.id&&void 0!==a("#"+a.jgrid.jqID(c.id),e)[0])){var u=a("<td></td>");"NONE"===c.buttonicon.toString().toUpperCase()?a(u).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+c.caption+
"</div>"):a(u).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+c.buttonicon+"'></span>"+c.caption+"</div>");c.id&&a(u).attr("id",c.id);"first"===c.position?0===e.rows[0].cells.length?a("tr",e).append(u):a("tr td:eq(0)",e).before(u):a("tr",e).append(u);a(u,e).attr("title",c.title||"").click(function(b){a(this).hasClass("ui-state-disabled")||a.isFunction(c.onClickButton)&&c.onClickButton.call(h,b);return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(b,c){c=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},c||{});return this.each(function(){if(this.grid){"string"===typeof b&&0!==b.indexOf("#")&&(b="#"+a.jgrid.jqID(b));var e=a(".navtable",b)[0];if(e){var h="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</td>";"first"===c.position?0===e.rows[0].cells.length?
a("tr",e).append(h):a("tr td:eq(0)",e).before(h):a("tr",e).append(h)}}})},GridToForm:function(b,c){return this.each(function(){var e=this,h;if(e.grid){var u=a(e).jqGrid("getRowData",b);if(u)for(h in u)u.hasOwnProperty(h)&&(a("[name="+a.jgrid.jqID(h)+"]",c).is("input:radio")||a("[name="+a.jgrid.jqID(h)+"]",c).is("input:checkbox")?a("[name="+a.jgrid.jqID(h)+"]",c).each(function(){if(a(this).val()==u[h])a(this)[e.p.useProp?"prop":"attr"]("checked",!0);else a(this)[e.p.useProp?"prop":"attr"]("checked",
!1)}):a("[name="+a.jgrid.jqID(h)+"]",c).val(u[h]))}})},FormToGrid:function(b,c,e,h){return this.each(function(){if(this.grid){e||(e="set");h||(h="first");var u=a(c).serializeArray(),r={};a.each(u,function(a,b){r[b.name]=b.value});"add"===e?a(this).jqGrid("addRowData",b,r,h):"set"===e&&a(this).jqGrid("setRowData",b,r)}})}})})(jQuery);
(function(a){a.fn.jqFilter=function(d){if("string"===typeof d){var l=a.fn.jqFilter[d];if(!l)throw"jqFilter - No such method: "+d;var v=a.makeArray(arguments).slice(1);return l.apply(this,v)}var n=a.extend(!0,{filter:null,columns:[],onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:"eq,ne,lt,le,gt,ge,nu,nn,in,ni".split(","),stropts:"eq,ne,bw,bn,ew,en,cn,nc,nu,nn,in,ni".split(","),strarr:["text","string","blob"],groupOps:[{op:"AND",
text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,direction:"ltr"},a.jgrid.filter,d||{});return this.each(function(){if(!this.filter){this.p=n;if(null===this.p.filter||void 0===this.p.filter)this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]};var d,l=this.p.columns.length,f,t=/msie/i.test(navigator.userAgent)&&!window.opera;this.p.initFilter=a.extend(!0,{},this.p.filter);if(l){for(d=0;d<l;d++)if(f=this.p.columns[d],f.stype?f.inputtype=f.stype:f.inputtype||(f.inputtype="text"),
f.sorttype?f.searchtype=f.sorttype:f.searchtype||(f.searchtype="string"),void 0===f.hidden&&(f.hidden=!1),f.label||(f.label=f.name),f.index&&(f.name=f.index),f.hasOwnProperty("searchoptions")||(f.searchoptions={}),!f.hasOwnProperty("searchrules"))f.searchrules={};this.p.showQuery&&a(this).append("<table class='queryresult ui-widget ui-widget-content' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'></td></tr></tbody></table>");var u=function(){return a("#"+
a.jgrid.jqID(n.id))[0]||null},r=function(g,j){var b=[!0,""],c=u();if(a.isFunction(j.searchrules))b=j.searchrules.call(c,g,j);else if(a.jgrid&&a.jgrid.checkValues)try{b=a.jgrid.checkValues.call(c,g,-1,j.searchrules,j.label)}catch(k){}b&&b.length&&!1===b[0]&&(n.error=!b[0],n.errmsg=b[1])};this.onchange=function(){this.p.error=!1;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){a("table.group:first",this).remove();var g=this.createTableForGroup(n.filter,
null);a(this).append(g);a.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)};this.createTableForGroup=function(g,j){var b=this,c,k=a("<table class='group ui-widget ui-widget-content' style='border:0px none;'><tbody></tbody></table>"),e="left";"rtl"===this.p.direction&&(e="right",k.attr("dir","rtl"));null===j&&k.append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='"+e+"'></th></tr>");var h=a("<tr></tr>");k.append(h);e=a("<th colspan='5' align='"+
e+"'></th>");h.append(e);if(!0===this.p.ruleButtons){var d=a("<select class='opsel'></select>");e.append(d);var h="",i;for(c=0;c<n.groupOps.length;c++)i=g.groupOp===b.p.groupOps[c].op?" selected='selected'":"",h+="<option value='"+b.p.groupOps[c].op+"'"+i+">"+b.p.groupOps[c].text+"</option>";d.append(h).bind("change",function(){g.groupOp=a(d).val();b.onchange()})}h="<span></span>";this.p.groupButton&&(h=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>"),h.bind("click",
function(){if(g.groups===void 0)g.groups=[];g.groups.push({groupOp:n.groupOps[0].op,rules:[],groups:[]});b.reDraw();b.onchange();return false}));e.append(h);if(!0===this.p.ruleButtons){var h=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),f;h.bind("click",function(){if(g.rules===void 0)g.rules=[];for(c=0;c<b.p.columns.length;c++){var e=b.p.columns[c].search===void 0?true:b.p.columns[c].search,j=b.p.columns[c].hidden===true;if(b.p.columns[c].searchoptions.searchhidden===
true&&e||e&&!j){f=b.p.columns[c];break}}e=f.searchoptions.sopt?f.searchoptions.sopt:b.p.sopt?b.p.sopt:a.inArray(f.searchtype,b.p.strarr)!==-1?b.p.stropts:b.p.numopts;g.rules.push({field:f.name,op:e[0],data:""});b.reDraw();return false});e.append(h)}null!==j&&(h=a("<input type='button' value='-' title='Delete group' class='delete-group'/>"),e.append(h),h.bind("click",function(){for(c=0;c<j.groups.length;c++)if(j.groups[c]===g){j.groups.splice(c,1);break}b.reDraw();b.onchange();return false}));if(void 0!==
g.groups)for(c=0;c<g.groups.length;c++)e=a("<tr></tr>"),k.append(e),h=a("<td class='first'></td>"),e.append(h),h=a("<td colspan='4'></td>"),h.append(this.createTableForGroup(g.groups[c],g)),e.append(h);void 0===g.groupOp&&(g.groupOp=b.p.groupOps[0].op);if(void 0!==g.rules)for(c=0;c<g.rules.length;c++)k.append(this.createTableRowForRule(g.rules[c],g));return k};this.createTableRowForRule=function(g,j){var b=this,c=u(),k=a("<tr></tr>"),e,h,f,i,d="",p;k.append("<td class='first'></td>");var m=a("<td class='columns'></td>");
k.append(m);var l=a("<select></select>"),o,q=[];m.append(l);l.bind("change",function(){g.field=a(l).val();f=a(this).parents("tr:first");for(e=0;e<b.p.columns.length;e++)if(b.p.columns[e].name===g.field){i=b.p.columns[e];break}if(i){i.searchoptions.id=a.jgrid.randId();t&&"text"===i.inputtype&&!i.searchoptions.size&&(i.searchoptions.size=10);var d=a.jgrid.createEl.call(c,i.inputtype,i.searchoptions,"",!0,b.p.ajaxSelectOptions||{},!0);a(d).addClass("input-elm");h=i.searchoptions.sopt?i.searchoptions.sopt:
b.p.sopt?b.p.sopt:-1!==a.inArray(i.searchtype,b.p.strarr)?b.p.stropts:b.p.numopts;var j="",k=0;q=[];a.each(b.p.ops,function(){q.push(this.oper)});for(e=0;e<h.length;e++)o=a.inArray(h[e],q),-1!==o&&(0===k&&(g.op=b.p.ops[o].oper),j+="<option value='"+b.p.ops[o].oper+"'>"+b.p.ops[o].text+"</option>",k++);a(".selectopts",f).empty().append(j);a(".selectopts",f)[0].selectedIndex=0;a.jgrid.msie&&9>a.jgrid.msiever()&&(j=parseInt(a("select.selectopts",f)[0].offsetWidth,10)+1,a(".selectopts",f).width(j),a(".selectopts",
f).css("width","auto"));a(".data",f).empty().append(d);a.jgrid.bindEv.call(c,d,i.searchoptions);a(".input-elm",f).bind("change",function(e){var d=a(this).hasClass("ui-autocomplete-input")?200:0;setTimeout(function(){var d=e.target;g.data=d.nodeName.toUpperCase()==="SPAN"&&i.searchoptions&&a.isFunction(i.searchoptions.custom_value)?i.searchoptions.custom_value.call(c,a(d).children(".customelement:first"),"get"):d.value;b.onchange()},d)});setTimeout(function(){g.data=a(d).val();b.onchange()},0)}});
for(e=m=0;e<b.p.columns.length;e++){p=void 0===b.p.columns[e].search?!0:b.p.columns[e].search;var r=!0===b.p.columns[e].hidden;if(!0===b.p.columns[e].searchoptions.searchhidden&&p||p&&!r)p="",g.field===b.p.columns[e].name&&(p=" selected='selected'",m=e),d+="<option value='"+b.p.columns[e].name+"'"+p+">"+b.p.columns[e].label+"</option>"}l.append(d);d=a("<td class='operators'></td>");k.append(d);i=n.columns[m];i.searchoptions.id=a.jgrid.randId();t&&"text"===i.inputtype&&!i.searchoptions.size&&(i.searchoptions.size=
10);m=a.jgrid.createEl.call(c,i.inputtype,i.searchoptions,g.data,!0,b.p.ajaxSelectOptions||{},!0);if("nu"===g.op||"nn"===g.op)a(m).attr("readonly","true"),a(m).attr("disabled","true");var s=a("<select class='selectopts'></select>");d.append(s);s.bind("change",function(){g.op=a(s).val();f=a(this).parents("tr:first");var c=a(".input-elm",f)[0];if(g.op==="nu"||g.op==="nn"){g.data="";if(c.tagName.toUpperCase()!=="SELECT")c.value="";c.setAttribute("readonly","true");c.setAttribute("disabled","true")}else{if(c.tagName.toUpperCase()===
"SELECT")g.data=c.value;c.removeAttribute("readonly");c.removeAttribute("disabled")}b.onchange()});h=i.searchoptions.sopt?i.searchoptions.sopt:b.p.sopt?b.p.sopt:-1!==a.inArray(i.searchtype,b.p.strarr)?b.p.stropts:b.p.numopts;d="";a.each(b.p.ops,function(){q.push(this.oper)});for(e=0;e<h.length;e++)o=a.inArray(h[e],q),-1!==o&&(p=g.op===b.p.ops[o].oper?" selected='selected'":"",d+="<option value='"+b.p.ops[o].oper+"'"+p+">"+b.p.ops[o].text+"</option>");s.append(d);d=a("<td class='data'></td>");k.append(d);
d.append(m);a.jgrid.bindEv.call(c,m,i.searchoptions);a(m).addClass("input-elm").bind("change",function(){g.data=i.inputtype==="custom"?i.searchoptions.custom_value.call(c,a(this).children(".customelement:first"),"get"):a(this).val();b.onchange()});d=a("<td></td>");k.append(d);!0===this.p.ruleButtons&&(m=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>"),d.append(m),m.bind("click",function(){for(e=0;e<j.rules.length;e++)if(j.rules[e]===g){j.rules.splice(e,1);break}b.reDraw();
b.onchange();return false}));return k};this.getStringForGroup=function(a){var d="(",b;if(void 0!==a.groups)for(b=0;b<a.groups.length;b++){1<d.length&&(d+=" "+a.groupOp+" ");try{d+=this.getStringForGroup(a.groups[b])}catch(c){alert(c)}}if(void 0!==a.rules)try{for(b=0;b<a.rules.length;b++)1<d.length&&(d+=" "+a.groupOp+" "),d+=this.getStringForRule(a.rules[b])}catch(f){alert(f)}d+=")";return"()"===d?"":d};this.getStringForRule=function(d){var f="",b="",c,k;for(c=0;c<this.p.ops.length;c++)if(this.p.ops[c].oper===
d.op){f=this.p.operands.hasOwnProperty(d.op)?this.p.operands[d.op]:"";b=this.p.ops[c].oper;break}for(c=0;c<this.p.columns.length;c++)if(this.p.columns[c].name===d.field){k=this.p.columns[c];break}if(void 0===k)return"";c=d.data;if("bw"===b||"bn"===b)c+="%";if("ew"===b||"en"===b)c="%"+c;if("cn"===b||"nc"===b)c="%"+c+"%";if("in"===b||"ni"===b)c=" ("+c+")";n.errorcheck&&r(d.data,k);return-1!==a.inArray(k.searchtype,["int","integer","float","number","currency"])||"nn"===b||"nu"===b?d.field+" "+f+" "+
c:d.field+" "+f+' "'+c+'"'};this.resetFilter=function(){this.p.filter=a.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(n.filter)};this.toString=function(){function a(b){var c="(",f;if(void 0!==b.groups)for(f=0;f<b.groups.length;f++)1<
c.length&&(c="OR"===b.groupOp?c+" || ":c+" && "),c+=a(b.groups[f]);if(void 0!==b.rules)for(f=0;f<b.rules.length;f++){1<c.length&&(c="OR"===b.groupOp?c+" || ":c+" && ");var e=b.rules[f];if(d.p.errorcheck){for(var h=void 0,l=void 0,h=0;h<d.p.columns.length;h++)if(d.p.columns[h].name===e.field){l=d.p.columns[h];break}l&&r(e.data,l)}c+=e.op+"(item."+e.field+",'"+e.data+"')"}c+=")";return"()"===c?"":c}var d=this;return a(this.p.filter)};this.reDraw();if(this.p.showQuery)this.onchange();this.filter=!0}}})};
a.extend(a.fn.jqFilter,{toSQLString:function(){var a="";this.each(function(){a=this.toUserFriendlyString()});return a},filterData:function(){var a;this.each(function(){a=this.p.filter});return a},getParameter:function(a){return void 0!==a&&this.p.hasOwnProperty(a)?this.p[a]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(d){"string"===typeof d&&(d=a.jgrid.parse(d));this.each(function(){this.p.filter=d;this.reDraw();this.onchange()})}})})(jQuery);
(function(a){a.jgrid.inlineEdit=a.jgrid.inlineEdit||{};a.jgrid.extend({editRow:function(c,b,e,n,h,j,p,g,f){var k={},d=a.makeArray(arguments).slice(1);if("object"===a.type(d[0]))k=d[0];else if(void 0!==b&&(k.keys=b),a.isFunction(e)&&(k.oneditfunc=e),a.isFunction(n)&&(k.successfunc=n),void 0!==h&&(k.url=h),void 0!==j&&(k.extraparam=j),a.isFunction(p)&&(k.aftersavefunc=p),a.isFunction(g)&&(k.errorfunc=g),a.isFunction(f))k.afterrestorefunc=f;k=a.extend(!0,{keys:!1,oneditfunc:null,successfunc:null,url:null,
extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST"},a.jgrid.inlineEdit,k);return this.each(function(){var d=this,f,b,e=0,g=null,h={},j,m,n;if(d.grid&&(j=a(d).jqGrid("getInd",c,!0),!1!==j&&(n=a.isFunction(k.beforeEditRow)?k.beforeEditRow.call(d,k,c):void 0,void 0===n&&(n=!0),n&&"0"===(a(j).attr("editable")||"0")&&!a(j).hasClass("not-editable-row"))))m=d.p.colModel,a('td[role="gridcell"]',j).each(function(l){f=m[l].name;var j=!0===d.p.treeGrid&&f===
d.p.ExpandColumn;if(j)b=a("span:first",this).html();else try{b=a.unformat.call(d,this,{rowId:c,colModel:m[l]},l)}catch(k){b=m[l].edittype&&"textarea"===m[l].edittype?a(this).text():a(this).html()}if("cb"!==f&&"subgrid"!==f&&"rn"!==f&&(d.p.autoencode&&(b=a.jgrid.htmlDecode(b)),h[f]=b,!0===m[l].editable)){null===g&&(g=l);j?a("span:first",this).html(""):a(this).html("");var n=a.extend({},m[l].editoptions||{},{id:c+"_"+f,name:f});m[l].edittype||(m[l].edittype="text");if("&nbsp;"===b||"&#160;"===b||1===
b.length&&160===b.charCodeAt(0))b="";var u=a.jgrid.createEl.call(d,m[l].edittype,n,b,!0,a.extend({},a.jgrid.ajaxOptions,d.p.ajaxSelectOptions||{}));a(u).addClass("editable");j?a("span:first",this).append(u):a(this).append(u);a.jgrid.bindEv.call(d,u,n);"select"===m[l].edittype&&void 0!==m[l].editoptions&&!0===m[l].editoptions.multiple&&void 0===m[l].editoptions.dataUrl&&a.jgrid.msie&&a(u).width(a(u).width());e++}}),0<e&&(h.id=c,d.p.savedRow.push(h),a(j).attr("editable","1"),a("td:eq("+g+") input",
j).focus(),!0===k.keys&&a(j).bind("keydown",function(f){if(27===f.keyCode){a(d).jqGrid("restoreRow",c,k.afterrestorefunc);if(d.p._inlinenav)try{a(d).jqGrid("showAddEditButtons")}catch(b){}return!1}if(13===f.keyCode){if("TEXTAREA"===f.target.tagName)return!0;if(a(d).jqGrid("saveRow",c,k)&&d.p._inlinenav)try{a(d).jqGrid("showAddEditButtons")}catch(e){}return!1}}),a(d).triggerHandler("jqGridInlineEditRow",[c,k]),a.isFunction(k.oneditfunc)&&k.oneditfunc.call(d,c))})},saveRow:function(c,b,e,n,h,j,p){var g=
a.makeArray(arguments).slice(1),f={};if("object"===a.type(g[0]))f=g[0];else if(a.isFunction(b)&&(f.successfunc=b),void 0!==e&&(f.url=e),void 0!==n&&(f.extraparam=n),a.isFunction(h)&&(f.aftersavefunc=h),a.isFunction(j)&&(f.errorfunc=j),a.isFunction(p))f.afterrestorefunc=p;var f=a.extend(!0,{successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST"},a.jgrid.inlineEdit,f),k=!1,d=this[0],o,i={},v={},r={},s,w,q;if(!d.grid)return k;
q=a(d).jqGrid("getInd",c,!0);if(!1===q)return k;g=a.isFunction(f.beforeSaveRow)?f.beforeSaveRow.call(d,f,c):void 0;void 0===g&&(g=!0);if(g){g=a(q).attr("editable");f.url=f.url||d.p.editurl;if("1"===g){var m;a('td[role="gridcell"]',q).each(function(c){m=d.p.colModel[c];o=m.name;if("cb"!==o&&"subgrid"!==o&&!0===m.editable&&"rn"!==o&&!a(this).hasClass("not-editable-cell")){switch(m.edittype){case "checkbox":var b=["Yes","No"];m.editoptions&&(b=m.editoptions.value.split(":"));i[o]=a("input",this).is(":checked")?
b[0]:b[1];break;case "text":case "password":case "textarea":case "button":i[o]=a("input, textarea",this).val();break;case "select":if(m.editoptions.multiple){var b=a("select",this),e=[];i[o]=a(b).val();i[o]=i[o]?i[o].join(","):"";a("select option:selected",this).each(function(d,c){e[d]=a(c).text()});v[o]=e.join(",")}else i[o]=a("select option:selected",this).val(),v[o]=a("select option:selected",this).text();m.formatter&&"select"===m.formatter&&(v={});break;case "custom":try{if(m.editoptions&&a.isFunction(m.editoptions.custom_value)){if(i[o]=
m.editoptions.custom_value.call(d,a(".customelement",this),"get"),void 0===i[o])throw"e2";}else throw"e1";}catch(g){"e1"===g&&a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose),"e2"===g?a.jgrid.info_dialog(a.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose):a.jgrid.info_dialog(a.jgrid.errors.errcap,g.message,a.jgrid.edit.bClose)}}w=a.jgrid.checkValues.call(d,i[o],c);if(!1===w[0])return!1;d.p.autoencode&&
(i[o]=a.jgrid.htmlEncode(i[o]));"clientArray"!==f.url&&m.editoptions&&!0===m.editoptions.NullIfEmpty&&""===i[o]&&(r[o]="null")}});if(!1===w[0]){try{var t=a(d).jqGrid("getGridRowById",c),l=a.jgrid.findPos(t);a.jgrid.info_dialog(a.jgrid.errors.errcap,w[1],a.jgrid.edit.bClose,{left:l[0],top:l[1]+a(t).outerHeight()})}catch(x){alert(w[1])}return k}g=d.p.prmNames;t=c;l=!1===d.p.keyIndex?g.id:d.p.colModel[d.p.keyIndex+(!0===d.p.rownumbers?1:0)+(!0===d.p.multiselect?1:0)+(!0===d.p.subGrid?1:0)].name;if(i){i[g.oper]=
g.editoper;if(void 0===i[l]||""===i[l])i[l]=c;else if(q.id!==d.p.idPrefix+i[l]&&(g=a.jgrid.stripPref(d.p.idPrefix,c),void 0!==d.p._index[g]&&(d.p._index[i[l]]=d.p._index[g],delete d.p._index[g]),c=d.p.idPrefix+i[l],a(q).attr("id",c),d.p.selrow===t&&(d.p.selrow=c),a.isArray(d.p.selarrrow)&&(g=a.inArray(t,d.p.selarrrow),0<=g&&(d.p.selarrrow[g]=c)),d.p.multiselect))g="jqg_"+d.p.id+"_"+c,a("input.cbox",q).attr("id",g).attr("name",g);void 0===d.p.inlineData&&(d.p.inlineData={});i=a.extend({},i,d.p.inlineData,
f.extraparam)}if("clientArray"===f.url){i=a.extend({},i,v);d.p.autoencode&&a.each(i,function(d,c){i[d]=a.jgrid.htmlDecode(c)});g=a(d).jqGrid("setRowData",c,i);a(q).attr("editable","0");for(l=0;l<d.p.savedRow.length;l++)if(""+d.p.savedRow[l].id===""+t){s=l;break}0<=s&&d.p.savedRow.splice(s,1);a(d).triggerHandler("jqGridInlineAfterSaveRow",[c,g,i,f]);a.isFunction(f.aftersavefunc)&&f.aftersavefunc.call(d,c,g,f);k=!0;a(q).removeClass("jqgrid-new-row").unbind("keydown")}else a("#lui_"+a.jgrid.jqID(d.p.id)).show(),
r=a.extend({},i,r),r[l]=a.jgrid.stripPref(d.p.idPrefix,r[l]),a.ajax(a.extend({url:f.url,data:a.isFunction(d.p.serializeRowData)?d.p.serializeRowData.call(d,r):r,type:f.mtype,async:!1,complete:function(b,e){a("#lui_"+a.jgrid.jqID(d.p.id)).hide();if("success"===e){var g=!0,h;h=a(d).triggerHandler("jqGridInlineSuccessSaveRow",[b,c,f]);a.isArray(h)||(h=[!0,i]);h[0]&&a.isFunction(f.successfunc)&&(h=f.successfunc.call(d,b));a.isArray(h)?(g=h[0],i=h[1]||i):g=h;if(!0===g){d.p.autoencode&&a.each(i,function(d,
c){i[d]=a.jgrid.htmlDecode(c)});i=a.extend({},i,v);a(d).jqGrid("setRowData",c,i);a(q).attr("editable","0");for(g=0;g<d.p.savedRow.length;g++)if(""+d.p.savedRow[g].id===""+c){s=g;break}0<=s&&d.p.savedRow.splice(s,1);a(d).triggerHandler("jqGridInlineAfterSaveRow",[c,b,i,f]);a.isFunction(f.aftersavefunc)&&f.aftersavefunc.call(d,c,b);k=!0;a(q).removeClass("jqgrid-new-row").unbind("keydown")}else a(d).triggerHandler("jqGridInlineErrorSaveRow",[c,b,e,null,f]),a.isFunction(f.errorfunc)&&f.errorfunc.call(d,
c,b,e,null),!0===f.restoreAfterError&&a(d).jqGrid("restoreRow",c,f.afterrestorefunc)}},error:function(b,e,g){a("#lui_"+a.jgrid.jqID(d.p.id)).hide();a(d).triggerHandler("jqGridInlineErrorSaveRow",[c,b,e,g,f]);if(a.isFunction(f.errorfunc))f.errorfunc.call(d,c,b,e,g);else{b=b.responseText||b.statusText;try{a.jgrid.info_dialog(a.jgrid.errors.errcap,'<div class="ui-state-error">'+b+"</div>",a.jgrid.edit.bClose,{buttonalign:"right"})}catch(h){alert(b)}}!0===f.restoreAfterError&&a(d).jqGrid("restoreRow",
c,f.afterrestorefunc)}},a.jgrid.ajaxOptions,d.p.ajaxRowOptions||{}))}return k}},restoreRow:function(c,b){var e=a.makeArray(arguments).slice(1),n={};"object"===a.type(e[0])?n=e[0]:a.isFunction(b)&&(n.afterrestorefunc=b);n=a.extend(!0,{},a.jgrid.inlineEdit,n);return this.each(function(){var b=this,e,p,g={},f;if(b.grid){p=a(b).jqGrid("getInd",c,true);if(p!==false){f=a.isFunction(n.beforeCancelRow)?n.beforeCancelRow.call(b,cancelPrm,sr):void 0;f===void 0&&(f=true);if(f){for(f=0;f<b.p.savedRow.length;f++)if(""+
b.p.savedRow[f].id===""+c){e=f;break}if(e>=0){if(a.isFunction(a.fn.datepicker))try{a("input.hasDatepicker","#"+a.jgrid.jqID(p.id)).datepicker("hide")}catch(k){}a.each(b.p.colModel,function(){this.editable===true&&b.p.savedRow[e].hasOwnProperty(this.name)&&(g[this.name]=b.p.savedRow[e][this.name])});a(b).jqGrid("setRowData",c,g);a(p).attr("editable","0").unbind("keydown");b.p.savedRow.splice(e,1);a("#"+a.jgrid.jqID(c),"#"+a.jgrid.jqID(b.p.id)).hasClass("jqgrid-new-row")&&setTimeout(function(){a(b).jqGrid("delRowData",
c);a(b).jqGrid("showAddEditButtons")},0)}a(b).triggerHandler("jqGridInlineAfterRestoreRow",[c]);a.isFunction(n.afterrestorefunc)&&n.afterrestorefunc.call(b,c)}}}})},addRow:function(c){c=a.extend(!0,{rowID:null,initdata:{},position:"first",useDefValues:!0,useFormatter:!1,addRowParams:{extraparam:{}}},c||{});return this.each(function(){if(this.grid){var b=this,e=a.isFunction(c.beforeAddRow)?c.beforeAddRow.call(b,c.addRowParams):void 0;void 0===e&&(e=!0);e&&(c.rowID=a.isFunction(c.rowID)?c.rowID.call(b,
c):null!=c.rowID?c.rowID:a.jgrid.randId(),!0===c.useDefValues&&a(b.p.colModel).each(function(){if(this.editoptions&&this.editoptions.defaultValue){var e=this.editoptions.defaultValue,e=a.isFunction(e)?e.call(b):e;c.initdata[this.name]=e}}),a(b).jqGrid("addRowData",c.rowID,c.initdata,c.position),c.rowID=b.p.idPrefix+c.rowID,a("#"+a.jgrid.jqID(c.rowID),"#"+a.jgrid.jqID(b.p.id)).addClass("jqgrid-new-row"),c.useFormatter?a("#"+a.jgrid.jqID(c.rowID)+" .ui-inline-edit","#"+a.jgrid.jqID(b.p.id)).click():
(e=b.p.prmNames,c.addRowParams.extraparam[e.oper]=e.addoper,a(b).jqGrid("editRow",c.rowID,c.addRowParams),a(b).jqGrid("setSelection",c.rowID)))}})},inlineNav:function(c,b){b=a.extend(!0,{edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",save:!0,saveicon:"ui-icon-disk",cancel:!0,cancelicon:"ui-icon-cancel",addParams:{addRowParams:{extraparam:{}}},editParams:{},restoreAfterSelect:!0},a.jgrid.nav,b||{});return this.each(function(){if(this.grid){var e=this,n,h=a.jgrid.jqID(e.p.id);e.p._inlinenav=
!0;if(!0===b.addParams.useFormatter){var j=e.p.colModel,p;for(p=0;p<j.length;p++)if(j[p].formatter&&"actions"===j[p].formatter){j[p].formatoptions&&(j=a.extend({keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null},j[p].formatoptions),b.addParams.addRowParams={keys:j.keys,oneditfunc:j.onEdit,successfunc:j.onSuccess,url:j.url,extraparam:j.extraparam,aftersavefunc:j.afterSave,errorfunc:j.onError,afterrestorefunc:j.afterRestore});break}}b.add&&a(e).jqGrid("navButtonAdd",
c,{caption:b.addtext,title:b.addtitle,buttonicon:b.addicon,id:e.p.id+"_iladd",onClickButton:function(){a(e).jqGrid("addRow",b.addParams);b.addParams.useFormatter||(a("#"+h+"_ilsave").removeClass("ui-state-disabled"),a("#"+h+"_ilcancel").removeClass("ui-state-disabled"),a("#"+h+"_iladd").addClass("ui-state-disabled"),a("#"+h+"_iledit").addClass("ui-state-disabled"))}});b.edit&&a(e).jqGrid("navButtonAdd",c,{caption:b.edittext,title:b.edittitle,buttonicon:b.editicon,id:e.p.id+"_iledit",onClickButton:function(){var c=
a(e).jqGrid("getGridParam","selrow");c?(a(e).jqGrid("editRow",c,b.editParams),a("#"+h+"_ilsave").removeClass("ui-state-disabled"),a("#"+h+"_ilcancel").removeClass("ui-state-disabled"),a("#"+h+"_iladd").addClass("ui-state-disabled"),a("#"+h+"_iledit").addClass("ui-state-disabled")):(a.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+h,jqm:!0}),a("#jqg_alrt").focus())}});b.save&&(a(e).jqGrid("navButtonAdd",c,{caption:b.savetext||"",title:b.savetitle||"Save row",buttonicon:b.saveicon,id:e.p.id+"_ilsave",onClickButton:function(){var c=
e.p.savedRow[0].id;if(c){var f=e.p.prmNames,k=f.oper,d={};a("#"+a.jgrid.jqID(c),"#"+h).hasClass("jqgrid-new-row")?(b.addParams.addRowParams.extraparam[k]=f.addoper,d=b.addParams.addRowParams):(b.editParams.extraparam||(b.editParams.extraparam={}),b.editParams.extraparam[k]=f.editoper,d=b.editParams);a(e).jqGrid("saveRow",c,d)&&a(e).jqGrid("showAddEditButtons")}else a.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+h,jqm:!0}),a("#jqg_alrt").focus()}}),a("#"+h+"_ilsave").addClass("ui-state-disabled"));b.cancel&&
(a(e).jqGrid("navButtonAdd",c,{caption:b.canceltext||"",title:b.canceltitle||"Cancel row editing",buttonicon:b.cancelicon,id:e.p.id+"_ilcancel",onClickButton:function(){var c=e.p.savedRow[0].id,f={};if(c){f=a("#"+a.jgrid.jqID(c),"#"+h).hasClass("jqgrid-new-row")?b.addParams.addRowParams:b.editParams;a(e).jqGrid("restoreRow",c,f);a(e).jqGrid("showAddEditButtons")}else{a.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+h,jqm:true});a("#jqg_alrt").focus()}}}),a("#"+h+"_ilcancel").addClass("ui-state-disabled"));
!0===b.restoreAfterSelect&&(n=a.isFunction(e.p.beforeSelectRow)?e.p.beforeSelectRow:!1,e.p.beforeSelectRow=function(c,f){var h=true;if(e.p.savedRow.length>0&&e.p._inlinenav===true&&c!==e.p.selrow&&e.p.selrow!==null){e.p.selrow===b.addParams.rowID?a(e).jqGrid("delRowData",e.p.selrow):a(e).jqGrid("restoreRow",e.p.selrow,b.editParams);a(e).jqGrid("showAddEditButtons")}n&&(h=n.call(e,c,f));return h})}})},showAddEditButtons:function(){return this.each(function(){if(this.grid){var c=a.jgrid.jqID(this.p.id);
a("#"+c+"_ilsave").addClass("ui-state-disabled");a("#"+c+"_ilcancel").addClass("ui-state-disabled");a("#"+c+"_iladd").removeClass("ui-state-disabled");a("#"+c+"_iledit").removeClass("ui-state-disabled")}})}})})(jQuery);
(function(b){b.jgrid.extend({editCell:function(d,f,a){return this.each(function(){var c=this,g,e,h,i;if(c.grid&&!0===c.p.cellEdit){f=parseInt(f,10);c.p.selrow=c.rows[d].id;c.p.knv||b(c).jqGrid("GridNav");if(0<c.p.savedRow.length){if(!0===a&&d==c.p.iRow&&f==c.p.iCol)return;b(c).jqGrid("saveCell",c.p.savedRow[0].id,c.p.savedRow[0].ic)}else window.setTimeout(function(){b("#"+b.jgrid.jqID(c.p.knv)).attr("tabindex","-1").focus()},0);i=c.p.colModel[f];g=i.name;if(!("subgrid"===g||"cb"===g||"rn"===g)){h=
b("td:eq("+f+")",c.rows[d]);if(!0===i.editable&&!0===a&&!h.hasClass("not-editable-cell")){0<=parseInt(c.p.iCol,10)&&0<=parseInt(c.p.iRow,10)&&(b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight"),b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover"));b(h).addClass("edit-cell ui-state-highlight");b(c.rows[d]).addClass("selected-row ui-state-hover");try{e=b.unformat.call(c,h,{rowId:c.rows[d].id,colModel:i},f)}catch(k){e=i.edittype&&"textarea"===i.edittype?b(h).text():
b(h).html()}c.p.autoencode&&(e=b.jgrid.htmlDecode(e));i.edittype||(i.edittype="text");c.p.savedRow.push({id:d,ic:f,name:g,v:e});if("&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0))e="";if(b.isFunction(c.p.formatCell)){var j=c.p.formatCell.call(c,c.rows[d].id,g,e,d,f);void 0!==j&&(e=j)}b(c).triggerHandler("jqGridBeforeEditCell",[c.rows[d].id,g,e,d,f]);b.isFunction(c.p.beforeEditCell)&&c.p.beforeEditCell.call(c,c.rows[d].id,g,e,d,f);var j=b.extend({},i.editoptions||{},{id:d+"_"+g,name:g}),
n=b.jgrid.createEl.call(c,i.edittype,j,e,!0,b.extend({},b.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{}));b(h).html("").append(n).attr("tabindex","0");b.jgrid.bindEv.call(c,n,j);window.setTimeout(function(){b(n).focus()},0);b("input, select, textarea",h).bind("keydown",function(a){a.keyCode===27&&(b("input.hasDatepicker",h).length>0?b(".ui-datepicker").is(":hidden")?b(c).jqGrid("restoreCell",d,f):b("input.hasDatepicker",h).datepicker("hide"):b(c).jqGrid("restoreCell",d,f));if(a.keyCode===13){b(c).jqGrid("saveCell",
d,f);return false}if(a.keyCode===9){if(c.grid.hDiv.loading)return false;a.shiftKey?b(c).jqGrid("prevCell",d,f):b(c).jqGrid("nextCell",d,f)}a.stopPropagation()});b(c).triggerHandler("jqGridAfterEditCell",[c.rows[d].id,g,e,d,f]);b.isFunction(c.p.afterEditCell)&&c.p.afterEditCell.call(c,c.rows[d].id,g,e,d,f)}else 0<=parseInt(c.p.iCol,10)&&0<=parseInt(c.p.iRow,10)&&(b("td:eq("+c.p.iCol+")",c.rows[c.p.iRow]).removeClass("edit-cell ui-state-highlight"),b(c.rows[c.p.iRow]).removeClass("selected-row ui-state-hover")),
h.addClass("edit-cell ui-state-highlight"),b(c.rows[d]).addClass("selected-row ui-state-hover"),e=h.html().replace(/\&#160\;/ig,""),b(c).triggerHandler("jqGridSelectCell",[c.rows[d].id,g,e,d,f]),b.isFunction(c.p.onSelectCell)&&c.p.onSelectCell.call(c,c.rows[d].id,g,e,d,f);c.p.iCol=f;c.p.iRow=d}}})},saveCell:function(d,f){return this.each(function(){var a=this,c;if(a.grid&&!0===a.p.cellEdit){c=1<=a.p.savedRow.length?0:null;if(null!==c){var g=b("td:eq("+f+")",a.rows[d]),e,h,i=a.p.colModel[f],k=i.name,
j=b.jgrid.jqID(k);switch(i.edittype){case "select":if(i.editoptions.multiple){var j=b("#"+d+"_"+j,a.rows[d]),n=[];(e=b(j).val())?e.join(","):e="";b("option:selected",j).each(function(a,c){n[a]=b(c).text()});h=n.join(",")}else e=b("#"+d+"_"+j+" option:selected",a.rows[d]).val(),h=b("#"+d+"_"+j+" option:selected",a.rows[d]).text();i.formatter&&(h=e);break;case "checkbox":var l=["Yes","No"];i.editoptions&&(l=i.editoptions.value.split(":"));h=e=b("#"+d+"_"+j,a.rows[d]).is(":checked")?l[0]:l[1];break;
case "password":case "text":case "textarea":case "button":h=e=b("#"+d+"_"+j,a.rows[d]).val();break;case "custom":try{if(i.editoptions&&b.isFunction(i.editoptions.custom_value)){e=i.editoptions.custom_value.call(a,b(".customelement",g),"get");if(void 0===e)throw"e2";h=e}else throw"e1";}catch(o){"e1"===o&&b.jgrid.info_dialog(b.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,b.jgrid.edit.bClose),"e2"===o?b.jgrid.info_dialog(b.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,
b.jgrid.edit.bClose):b.jgrid.info_dialog(b.jgrid.errors.errcap,o.message,b.jgrid.edit.bClose)}}if(h!==a.p.savedRow[c].v){if(c=b(a).triggerHandler("jqGridBeforeSaveCell",[a.rows[d].id,k,e,d,f]))h=e=c;if(b.isFunction(a.p.beforeSaveCell)&&(c=a.p.beforeSaveCell.call(a,a.rows[d].id,k,e,d,f)))h=e=c;var p=b.jgrid.checkValues.call(a,e,f);if(!0===p[0]){c=b(a).triggerHandler("jqGridBeforeSubmitCell",[a.rows[d].id,k,e,d,f])||{};b.isFunction(a.p.beforeSubmitCell)&&((c=a.p.beforeSubmitCell.call(a,a.rows[d].id,
k,e,d,f))||(c={}));0<b("input.hasDatepicker",g).length&&b("input.hasDatepicker",g).datepicker("hide");if("remote"===a.p.cellsubmit)if(a.p.cellurl){var m={};a.p.autoencode&&(e=b.jgrid.htmlEncode(e));m[k]=e;l=a.p.prmNames;i=l.id;j=l.oper;m[i]=b.jgrid.stripPref(a.p.idPrefix,a.rows[d].id);m[j]=l.editoper;m=b.extend(c,m);b("#lui_"+b.jgrid.jqID(a.p.id)).show();a.grid.hDiv.loading=!0;b.ajax(b.extend({url:a.p.cellurl,data:b.isFunction(a.p.serializeCellData)?a.p.serializeCellData.call(a,m):m,type:"POST",complete:function(c,
i){b("#lui_"+a.p.id).hide();a.grid.hDiv.loading=false;if(i==="success"){var j=b(a).triggerHandler("jqGridAfterSubmitCell",[a,c,m.id,k,e,d,f])||[true,""];j[0]===true&&b.isFunction(a.p.afterSubmitCell)&&(j=a.p.afterSubmitCell.call(a,c,m.id,k,e,d,f));if(j[0]===true){b(g).empty();b(a).jqGrid("setCell",a.rows[d].id,f,h,false,false,true);b(g).addClass("dirty-cell");b(a.rows[d]).addClass("edited");b(a).triggerHandler("jqGridAfterSaveCell",[a.rows[d].id,k,e,d,f]);b.isFunction(a.p.afterSaveCell)&&a.p.afterSaveCell.call(a,
a.rows[d].id,k,e,d,f);a.p.savedRow.splice(0,1)}else{b.jgrid.info_dialog(b.jgrid.errors.errcap,j[1],b.jgrid.edit.bClose);b(a).jqGrid("restoreCell",d,f)}}},error:function(c,e,h){b("#lui_"+b.jgrid.jqID(a.p.id)).hide();a.grid.hDiv.loading=false;b(a).triggerHandler("jqGridErrorCell",[c,e,h]);b.isFunction(a.p.errorCell)?a.p.errorCell.call(a,c,e,h):b.jgrid.info_dialog(b.jgrid.errors.errcap,c.status+" : "+c.statusText+"<br/>"+e,b.jgrid.edit.bClose);b(a).jqGrid("restoreCell",d,f)}},b.jgrid.ajaxOptions,a.p.ajaxCellOptions||
{}))}else try{b.jgrid.info_dialog(b.jgrid.errors.errcap,b.jgrid.errors.nourl,b.jgrid.edit.bClose),b(a).jqGrid("restoreCell",d,f)}catch(q){}"clientArray"===a.p.cellsubmit&&(b(g).empty(),b(a).jqGrid("setCell",a.rows[d].id,f,h,!1,!1,!0),b(g).addClass("dirty-cell"),b(a.rows[d]).addClass("edited"),b(a).triggerHandler("jqGridAfterSaveCell",[a.rows[d].id,k,e,d,f]),b.isFunction(a.p.afterSaveCell)&&a.p.afterSaveCell.call(a,a.rows[d].id,k,e,d,f),a.p.savedRow.splice(0,1))}else try{window.setTimeout(function(){b.jgrid.info_dialog(b.jgrid.errors.errcap,
e+" "+p[1],b.jgrid.edit.bClose)},100),b(a).jqGrid("restoreCell",d,f)}catch(r){}}else b(a).jqGrid("restoreCell",d,f)}window.setTimeout(function(){b("#"+b.jgrid.jqID(a.p.knv)).attr("tabindex","-1").focus()},0)}})},restoreCell:function(d,f){return this.each(function(){var a=this,c;if(a.grid&&!0===a.p.cellEdit){c=1<=a.p.savedRow.length?0:null;if(null!==c){var g=b("td:eq("+f+")",a.rows[d]);if(b.isFunction(b.fn.datepicker))try{b("input.hasDatepicker",g).datepicker("hide")}catch(e){}b(g).empty().attr("tabindex",
"-1");b(a).jqGrid("setCell",a.rows[d].id,f,a.p.savedRow[c].v,!1,!1,!0);b(a).triggerHandler("jqGridAfterRestoreCell",[a.rows[d].id,a.p.savedRow[c].v,d,f]);b.isFunction(a.p.afterRestoreCell)&&a.p.afterRestoreCell.call(a,a.rows[d].id,a.p.savedRow[c].v,d,f);a.p.savedRow.splice(0,1)}window.setTimeout(function(){b("#"+a.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(d,f){return this.each(function(){var a=!1,c;if(this.grid&&!0===this.p.cellEdit){for(c=f+1;c<this.p.colModel.length;c++)if(!0===
this.p.colModel[c].editable){a=c;break}!1!==a?b(this).jqGrid("editCell",d,a,!0):0<this.p.savedRow.length&&b(this).jqGrid("saveCell",d,f)}})},prevCell:function(d,f){return this.each(function(){var a=!1,c;if(this.grid&&!0===this.p.cellEdit){for(c=f-1;0<=c;c--)if(!0===this.p.colModel[c].editable){a=c;break}!1!==a?b(this).jqGrid("editCell",d,a,!0):0<this.p.savedRow.length&&b(this).jqGrid("saveCell",d,f)}})},GridNav:function(){return this.each(function(){function d(c,d,e){if("v"===e.substr(0,1)){var f=
b(a.grid.bDiv)[0].clientHeight,g=b(a.grid.bDiv)[0].scrollTop,l=a.rows[c].offsetTop+a.rows[c].clientHeight,o=a.rows[c].offsetTop;"vd"===e&&l>=f&&(b(a.grid.bDiv)[0].scrollTop=b(a.grid.bDiv)[0].scrollTop+a.rows[c].clientHeight);"vu"===e&&o<g&&(b(a.grid.bDiv)[0].scrollTop=b(a.grid.bDiv)[0].scrollTop-a.rows[c].clientHeight)}"h"===e&&(e=b(a.grid.bDiv)[0].clientWidth,f=b(a.grid.bDiv)[0].scrollLeft,g=a.rows[c].cells[d].offsetLeft,a.rows[c].cells[d].offsetLeft+a.rows[c].cells[d].clientWidth>=e+parseInt(f,
10)?b(a.grid.bDiv)[0].scrollLeft=b(a.grid.bDiv)[0].scrollLeft+a.rows[c].cells[d].clientWidth:g<f&&(b(a.grid.bDiv)[0].scrollLeft=b(a.grid.bDiv)[0].scrollLeft-a.rows[c].cells[d].clientWidth))}function f(b,c){var d,e;if("lft"===c){d=b+1;for(e=b;0<=e;e--)if(!0!==a.p.colModel[e].hidden){d=e;break}}if("rgt"===c){d=b-1;for(e=b;e<a.p.colModel.length;e++)if(!0!==a.p.colModel[e].hidden){d=e;break}}return d}var a=this;if(a.grid&&!0===a.p.cellEdit){a.p.knv=a.p.id+"_kn";var c=b("<div style='position:fixed;top:0px;width:1px;height:1px;' tabindex='0'><div tabindex='-1' style='width:1px;height:1px;' id='"+
a.p.knv+"'></div></div>"),g,e;b(c).insertBefore(a.grid.cDiv);b("#"+a.p.knv).focus().keydown(function(c){e=c.keyCode;"rtl"===a.p.direction&&(37===e?e=39:39===e&&(e=37));switch(e){case 38:0<a.p.iRow-1&&(d(a.p.iRow-1,a.p.iCol,"vu"),b(a).jqGrid("editCell",a.p.iRow-1,a.p.iCol,!1));break;case 40:a.p.iRow+1<=a.rows.length-1&&(d(a.p.iRow+1,a.p.iCol,"vd"),b(a).jqGrid("editCell",a.p.iRow+1,a.p.iCol,!1));break;case 37:0<=a.p.iCol-1&&(g=f(a.p.iCol-1,"lft"),d(a.p.iRow,g,"h"),b(a).jqGrid("editCell",a.p.iRow,g,
!1));break;case 39:a.p.iCol+1<=a.p.colModel.length-1&&(g=f(a.p.iCol+1,"rgt"),d(a.p.iRow,g,"h"),b(a).jqGrid("editCell",a.p.iRow,g,!1));break;case 13:0<=parseInt(a.p.iCol,10)&&0<=parseInt(a.p.iRow,10)&&b(a).jqGrid("editCell",a.p.iRow,a.p.iCol,!0);break;default:return!0}return!1})}})},getChangedCells:function(d){var f=[];d||(d="all");this.each(function(){var a=this,c;a.grid&&!0===a.p.cellEdit&&b(a.rows).each(function(g){var e={};b(this).hasClass("edited")&&(b("td",this).each(function(f){c=a.p.colModel[f].name;
if("cb"!==c&&"subgrid"!==c)if("dirty"===d){if(b(this).hasClass("dirty-cell"))try{e[c]=b.unformat.call(a,this,{rowId:a.rows[g].id,colModel:a.p.colModel[f]},f)}catch(i){e[c]=b.jgrid.htmlDecode(b(this).html())}}else try{e[c]=b.unformat.call(a,this,{rowId:a.rows[g].id,colModel:a.p.colModel[f]},f)}catch(k){e[c]=b.jgrid.htmlDecode(b(this).html())}}),e.id=this.id,f.push(e))})});return f}})})(jQuery);
(function(c){c.fn.jqm=function(a){var i={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:d,ajaxText:"",target:d,modal:d,toTop:d,onShow:d,onHide:d,onLoad:d};return this.each(function(){if(this._jqm)return j[this._jqm].c=c.extend({},j[this._jqm].c,a);l++;this._jqm=l;j[l]={c:c.extend(i,c.jqm.params,a),a:d,w:c(this).addClass("jqmID"+l),s:l};i.trigger&&c(this).jqmAddTrigger(i.trigger)})};c.fn.jqmAddClose=function(a){return o(this,a,"jqmHide")};c.fn.jqmAddTrigger=
function(a){return o(this,a,"jqmShow")};c.fn.jqmShow=function(a){return this.each(function(){c.jqm.open(this._jqm,a)})};c.fn.jqmHide=function(a){return this.each(function(){c.jqm.close(this._jqm,a)})};c.jqm={hash:{},open:function(a,i){var b=j[a],e=b.c,h="."+e.closeClass,f=parseInt(b.w.css("z-index")),f=0<f?f:3E3,g=c("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":f-1,opacity:e.overlay/100});if(b.a)return d;b.t=i;b.a=!0;b.w.css("z-index",f);e.modal?(k[0]||setTimeout(function(){p("bind")},
1),k.push(a)):0<e.overlay?e.closeoverlay&&b.w.jqmAddClose(g):g=d;b.o=g?g.addClass(e.overlayClass).prependTo("body"):d;e.ajax?(f=e.target||b.w,g=e.ajax,f="string"==typeof f?c(f,b.w):c(f),g="@"==g.substr(0,1)?c(i).attr(g.substring(1)):g,f.html(e.ajaxText).load(g,function(){e.onLoad&&e.onLoad.call(this,b);h&&b.w.jqmAddClose(c(h,b.w));m(b)})):h&&b.w.jqmAddClose(c(h,b.w));e.toTop&&b.o&&b.w.before('<span id="jqmP'+b.w[0]._jqm+'"></span>').insertAfter(b.o);e.onShow?e.onShow(b):b.w.show();m(b);return d},
close:function(a){a=j[a];if(!a.a)return d;a.a=d;k[0]&&(k.pop(),k[0]||p("unbind"));a.c.toTop&&a.o&&c("#jqmP"+a.w[0]._jqm).after(a.w).remove();if(a.c.onHide)a.c.onHide(a);else a.w.hide(),a.o&&a.o.remove();return d},params:{}};var l=0,j=c.jqm.hash,k=[],d=!1,m=function(a){try{c(":input:visible",a.w)[0].focus()}catch(d){}},p=function(a){c(document)[a]("keypress",n)[a]("keydown",n)[a]("mousedown",n)},n=function(a){var d=j[k[k.length-1]],b=!c(a.target).parents(".jqmID"+d.s)[0];b&&(c(".jqmID"+d.s).each(function(){var d=
c(this),h=d.offset();if(h.top<=a.pageY&&a.pageY<=h.top+d.height()&&h.left<=a.pageX&&a.pageX<=h.left+d.width())return b=!1}),m(d));return!b},o=function(a,i,b){return a.each(function(){var a=this._jqm;c(i).each(function(){this[b]||(this[b]=[],c(this).click(function(){for(var a in{jqmShow:1,jqmHide:1})for(var b in this[a])if(j[this[a][b]])j[this[a][b]].w[a](this);return d}));this[b].push(a)})})}})(jQuery);
(function(b){b.fn.jqDrag=function(a){return h(this,a,"d")};b.fn.jqResize=function(a,b){return h(this,a,"r",b)};b.jqDnR={dnr:{},e:0,drag:function(a){"d"==d.k?e.css({left:d.X+a.pageX-d.pX,top:d.Y+a.pageY-d.pY}):(e.css({width:Math.max(a.pageX-d.pX+d.W,0),height:Math.max(a.pageY-d.pY+d.H,0)}),f&&g.css({width:Math.max(a.pageX-f.pX+f.W,0),height:Math.max(a.pageY-f.pY+f.H,0)}));return!1},stop:function(){b(document).unbind("mousemove",c.drag).unbind("mouseup",c.stop)}};var c=b.jqDnR,d=c.dnr,e=c.e,g,f,h=function(a,
c,h,l){return a.each(function(){c=c?b(c,a):a;c.bind("mousedown",{e:a,k:h},function(a){var c=a.data,i={};e=c.e;g=l?b(l):!1;if("relative"!=e.css("position"))try{e.position(i)}catch(h){}d={X:i.left||j("left")||0,Y:i.top||j("top")||0,W:j("width")||e[0].scrollWidth||0,H:j("height")||e[0].scrollHeight||0,pX:a.pageX,pY:a.pageY,k:c.k};f=g&&"d"!=c.k?{X:i.left||k("left")||0,Y:i.top||k("top")||0,W:g[0].offsetWidth||k("width")||0,H:g[0].offsetHeight||k("height")||0,pX:a.pageX,pY:a.pageY,k:c.k}:!1;if(b("input.hasDatepicker",
e[0])[0])try{b("input.hasDatepicker",e[0]).datepicker("hide")}catch(m){}b(document).mousemove(b.jqDnR.drag).mouseup(b.jqDnR.stop);return!1})})},j=function(a){return parseInt(e.css(a),10)||!1},k=function(a){return parseInt(g.css(a),10)||!1}})(jQuery);
(function(b){b.jgrid.extend({setSubGrid:function(){return this.each(function(){var d,c;this.p.subGridOptions=b.extend({plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,selectOnCollapse:!1,reloadOnExpand:!0},this.p.subGridOptions||{});this.p.colNames.unshift("");this.p.colModel.unshift({name:"subgrid",width:b.jgrid.cell_width?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,
search:!1,fixed:!0});d=this.p.subGridModel;if(d[0]){d[0].align=b.extend([],d[0].align||[]);for(c=0;c<d[0].name.length;c++)d[0].align[c]=d[0].align[c]||"left"}})},addSubGridCell:function(b,c){var a="",m,l;this.each(function(){a=this.formatCol(b,c);l=this.p.id;m=this.p.subGridOptions.plusicon});return'<td role="gridcell" aria-describedby="'+l+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+a+"><a style='cursor:pointer;'><span class='ui-icon "+m+"'></span></a></td>"},addSubGrid:function(d,c){return this.each(function(){var a=
this;if(a.grid){var m=function(c,d,h){d=b("<td align='"+a.p.subGridModel[0].align[h]+"'></td>").html(d);b(c).append(d)},l=function(c,d){var h,f,e,g=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),i=b("<tr></tr>");for(f=0;f<a.p.subGridModel[0].name.length;f++)h=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+a.p.direction+"'></th>"),b(h).html(a.p.subGridModel[0].name[f]),b(h).width(a.p.subGridModel[0].width[f]),b(i).append(h);b(g).append(i);c&&(e=a.p.xmlReader.subgrid,
b(e.root+" "+e.row,c).each(function(){i=b("<tr class='ui-widget-content ui-subtblcell'></tr>");if(!0===e.repeatitems)b(e.cell,this).each(function(a){m(i,b(this).text()||"&#160;",a)});else{var c=a.p.subGridModel[0].mapping||a.p.subGridModel[0].name;if(c)for(f=0;f<c.length;f++)m(i,b(c[f],this).text()||"&#160;",f)}b(g).append(i)}));h=b("table:first",a.grid.bDiv).attr("id")+"_";b("#"+b.jgrid.jqID(h+d)).append(g);a.grid.hDiv.loading=!1;b("#load_"+b.jgrid.jqID(a.p.id)).hide();return!1},o=function(c,d){var h,
f,e,g,i,k=b("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),j=b("<tr></tr>");for(f=0;f<a.p.subGridModel[0].name.length;f++)h=b("<th class='ui-state-default ui-th-subgrid ui-th-column ui-th-"+a.p.direction+"'></th>"),b(h).html(a.p.subGridModel[0].name[f]),b(h).width(a.p.subGridModel[0].width[f]),b(j).append(h);b(k).append(j);if(c&&(g=a.p.jsonReader.subgrid,h=b.jgrid.getAccessor(c,g.root),void 0!==h))for(f=0;f<h.length;f++){e=h[f];j=b("<tr class='ui-widget-content ui-subtblcell'></tr>");
if(!0===g.repeatitems){g.cell&&(e=e[g.cell]);for(i=0;i<e.length;i++)m(j,e[i]||"&#160;",i)}else{var l=a.p.subGridModel[0].mapping||a.p.subGridModel[0].name;if(l.length)for(i=0;i<l.length;i++)m(j,e[l[i]]||"&#160;",i)}b(k).append(j)}f=b("table:first",a.grid.bDiv).attr("id")+"_";b("#"+b.jgrid.jqID(f+d)).append(k);a.grid.hDiv.loading=!1;b("#load_"+b.jgrid.jqID(a.p.id)).hide();return!1},s=function(c){var e,d,f,g;e=b(c).attr("id");d={nd_:(new Date).getTime()};d[a.p.prmNames.subgridid]=e;if(!a.p.subGridModel[0])return!1;
if(a.p.subGridModel[0].params)for(g=0;g<a.p.subGridModel[0].params.length;g++)for(f=0;f<a.p.colModel.length;f++)a.p.colModel[f].name===a.p.subGridModel[0].params[g]&&(d[a.p.colModel[f].name]=b("td:eq("+f+")",c).text().replace(/\&#160\;/ig,""));if(!a.grid.hDiv.loading)switch(a.grid.hDiv.loading=!0,b("#load_"+b.jgrid.jqID(a.p.id)).show(),a.p.subgridtype||(a.p.subgridtype=a.p.datatype),b.isFunction(a.p.subgridtype)?a.p.subgridtype.call(a,d):a.p.subgridtype=a.p.subgridtype.toLowerCase(),a.p.subgridtype){case "xml":case "json":b.ajax(b.extend({type:a.p.mtype,
url:a.p.subGridUrl,dataType:a.p.subgridtype,data:b.isFunction(a.p.serializeSubGridData)?a.p.serializeSubGridData.call(a,d):d,complete:function(c){a.p.subgridtype==="xml"?l(c.responseXML,e):o(b.jgrid.parse(c.responseText),e)}},b.jgrid.ajaxOptions,a.p.ajaxSubgridOptions||{}))}return!1},e,k,p,q=0,g,j;b.each(a.p.colModel,function(){(!0===this.hidden||"rn"===this.name||"cb"===this.name)&&q++});var r=a.rows.length,n=1;void 0!==c&&0<c&&(n=c,r=c+1);for(;n<r;)b(a.rows[n]).hasClass("jqgrow")&&b(a.rows[n].cells[d]).bind("click",
function(){var c=b(this).parent("tr")[0];j=c.nextSibling;if(b(this).hasClass("sgcollapsed")){k=a.p.id;e=c.id;if(a.p.subGridOptions.reloadOnExpand===true||a.p.subGridOptions.reloadOnExpand===false&&!b(j).hasClass("ui-subgrid")){p=d>=1?"<td colspan='"+d+"'>&#160;</td>":"";g=b(a).triggerHandler("jqGridSubGridBeforeExpand",[k+"_"+e,e]);(g=g===false||g==="stop"?false:true)&&b.isFunction(a.p.subGridBeforeExpand)&&(g=a.p.subGridBeforeExpand.call(a,k+"_"+e,e));if(g===false)return false;b(c).after("<tr role='row' class='ui-subgrid'>"+
p+"<td class='ui-widget-content subgrid-cell'><span class='ui-icon "+a.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(a.p.colNames.length-1-q,10)+"' class='ui-widget-content subgrid-data'><div id="+k+"_"+e+" class='tablediv'></div></td></tr>");b(a).triggerHandler("jqGridSubGridRowExpanded",[k+"_"+e,e]);b.isFunction(a.p.subGridRowExpanded)?a.p.subGridRowExpanded.call(a,k+"_"+e,e):s(c)}else b(j).show();b(this).html("<a style='cursor:pointer;'><span class='ui-icon "+a.p.subGridOptions.minusicon+
"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");a.p.subGridOptions.selectOnExpand&&b(a).jqGrid("setSelection",e)}else if(b(this).hasClass("sgexpanded")){g=b(a).triggerHandler("jqGridSubGridRowColapsed",[k+"_"+e,e]);g=g===false||g==="stop"?false:true;e=c.id;g&&b.isFunction(a.p.subGridRowColapsed)&&(g=a.p.subGridRowColapsed.call(a,k+"_"+e,e));if(g===false)return false;a.p.subGridOptions.reloadOnExpand===true?b(j).remove(".ui-subgrid"):b(j).hasClass("ui-subgrid")&&b(j).hide();b(this).html("<a style='cursor:pointer;'><span class='ui-icon "+
a.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed");a.p.subGridOptions.selectOnCollapse&&b(a).jqGrid("setSelection",e)}return false}),n++;!0===a.p.subGridOptions.expandOnLoad&&b(a.rows).filter(".jqgrow").each(function(a,c){b(c.cells[0]).click()});a.subGridXml=function(a,b){l(a,b)};a.subGridJson=function(a,b){o(a,b)}}})},expandSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=b(this).jqGrid("getInd",d,!0);c&&
(c=b("td.sgcollapsed",c)[0])&&b(c).trigger("click")}})},collapseSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=b(this).jqGrid("getInd",d,!0);c&&(c=b("td.sgexpanded",c)[0])&&b(c).trigger("click")}})},toggleSubGridRow:function(d){return this.each(function(){if((this.grid||d)&&!0===this.p.subGrid){var c=b(this).jqGrid("getInd",d,!0);if(c){var a=b("td.sgcollapsed",c)[0];a?b(a).trigger("click"):(a=b("td.sgexpanded",c)[0])&&b(a).trigger("click")}}})}})})(jQuery);
(function(e){e.extend(e.jgrid,{template:function(b){var g=e.makeArray(arguments).slice(1),f,a=g.length;null==b&&(b="");return b.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(b,h){if(!isNaN(parseInt(h,10)))return g[parseInt(h,10)];for(f=0;f<a;f++)if(e.isArray(g[f]))for(var c=g[f],l=c.length;l--;)if(h===c[l].nm)return c[l].v})}});e.jgrid.extend({groupingSetup:function(){return this.each(function(){var b,g,f=this.p.colModel,a=this.p.groupingView;if(null!==a&&("object"===typeof a||
e.isFunction(a)))if(a.groupField.length){void 0===a.visibiltyOnNextGrouping&&(a.visibiltyOnNextGrouping=[]);a.lastvalues=[];a.groups=[];a.counters=[];for(b=0;b<a.groupField.length;b++)a.groupOrder[b]||(a.groupOrder[b]="asc"),a.groupText[b]||(a.groupText[b]="{0}"),"boolean"!==typeof a.groupColumnShow[b]&&(a.groupColumnShow[b]=!0),"boolean"!==typeof a.groupSummary[b]&&(a.groupSummary[b]=!1),!0===a.groupColumnShow[b]?(a.visibiltyOnNextGrouping[b]=!0,e(this).jqGrid("showCol",a.groupField[b])):(a.visibiltyOnNextGrouping[b]=
e("#"+e.jgrid.jqID(this.p.id+"_"+a.groupField[b])).is(":visible"),e(this).jqGrid("hideCol",a.groupField[b]));a.summary=[];b=0;for(g=f.length;b<g;b++)f[b].summaryType&&(f[b].summaryDivider?a.summary.push({nm:f[b].name,st:f[b].summaryType,v:"",sd:f[b].summaryDivider,vd:"",sr:f[b].summaryRound,srt:f[b].summaryRoundType||"round"}):a.summary.push({nm:f[b].name,st:f[b].summaryType,v:"",sr:f[b].summaryRound,srt:f[b].summaryRoundType||"round"}))}else this.p.grouping=!1;else this.p.grouping=!1})},groupingPrepare:function(b,
g,f,a){this.each(function(){var d=this.p.groupingView,h=this,c,l=d.groupField.length,m,i,k,q=0;for(c=0;c<l;c++)m=d.groupField[c],k=d.displayField[c],i=f[m],k=null==k?null:f[k],null==k&&(k=i),void 0!==i&&(0===a?(d.groups.push({idx:c,dataIndex:m,value:i,displayValue:k,startRow:a,cnt:1,summary:[]}),d.lastvalues[c]=i,d.counters[c]={cnt:1,pos:d.groups.length-1,summary:e.extend(!0,[],d.summary)}):"object"!==typeof i&&(e.isArray(d.isInTheSameGroup)&&e.isFunction(d.isInTheSameGroup[c])?!d.isInTheSameGroup[c].call(h,
d.lastvalues[c],i,c,d):d.lastvalues[c]!==i)?(d.groups.push({idx:c,dataIndex:m,value:i,displayValue:k,startRow:a,cnt:1,summary:[]}),d.lastvalues[c]=i,q=1,d.counters[c]={cnt:1,pos:d.groups.length-1,summary:e.extend(!0,[],d.summary)}):1===q?(d.groups.push({idx:c,dataIndex:m,value:i,displayValue:k,startRow:a,cnt:1,summary:[]}),d.lastvalues[c]=i,d.counters[c]={cnt:1,pos:d.groups.length-1,summary:e.extend(!0,[],d.summary)}):(d.counters[c].cnt+=1,d.groups[d.counters[c].pos].cnt=d.counters[c].cnt),e.each(d.counters[c].summary,
function(){if(e.isFunction(this.st))this.v=this.st.call(h,this.v,this.nm,f);else{this.v=e(h).jqGrid("groupingCalculations.handler",this.st,this.v,this.nm,this.sr,this.srt,f);if(this.st.toLowerCase()==="avg"&&this.sd)this.vd=e(h).jqGrid("groupingCalculations.handler",this.st,this.vd,this.sd,this.sr,this.srt,f)}}),d.groups[d.counters[c].pos].summary=d.counters[c].summary);g.push(b)});return g},groupingToggle:function(b){this.each(function(){var g=this.p.groupingView,f=b.split("_"),a=parseInt(f[f.length-
2],10);f.splice(f.length-2,2);var d=f.join("_"),f=g.minusicon,h=g.plusicon,c=e("#"+e.jgrid.jqID(b)),c=c.length?c[0].nextSibling:null,l=e("#"+e.jgrid.jqID(b)+" span.tree-wrap-"+this.p.direction),m=function(a){a=e.map(a.split(" "),function(a){if(a.substring(0,d.length+1)===d+"_")return parseInt(a.substring(d.length+1),10)});return 0<a.length?a[0]:void 0},i,k=!1;if(l.hasClass(f)){if(g.showSummaryOnHide){if(c)for(;c&&!(e(c).hasClass("jqfoot")&&parseInt(e(c).attr("jqfootlevel"),10)<=a);)e(c).hide(),c=
c.nextSibling}else if(c)for(;c;){g=m(c.className);if(void 0!==g&&g<=a)break;e(c).hide();c=c.nextSibling}l.removeClass(f).addClass(h);k=!0}else{if(c)for(i=void 0;c;){g=m(c.className);void 0===i&&(i=void 0===g);if(void 0!==g){if(g<=a)break;g===a+1&&e(c).show().find(">td>span.tree-wrap-"+this.p.direction).removeClass(f).addClass(h)}else i&&e(c).show();c=c.nextSibling}l.removeClass(h).addClass(f)}e(this).triggerHandler("jqGridGroupingClickGroup",[b,k]);e.isFunction(this.p.onClickGroup)&&this.p.onClickGroup.call(this,
b,k)});return!1},groupingRender:function(b,g){return this.each(function(){function f(a,b,d){var c=!1;if(0===b)c=d[a];else{var f=d[a].idx;if(0===f)c=d[a];else for(;0<=a;a--)if(d[a].idx===f-b){c=d[a];break}}return c}var a=this,d=a.p.groupingView,h="",c="",l,m,i=d.groupCollapse?d.plusicon:d.minusicon,k,q=[],w=d.groupField.length,i=i+(" tree-wrap-"+a.p.direction);e.each(a.p.colModel,function(a,b){var c;for(c=0;c<w;c++)if(d.groupField[c]===b.name){q[c]=a;break}});var t=0,x=e.makeArray(d.groupSummary);
x.reverse();e.each(d.groups,function(s,j){t++;m=a.p.id+"ghead_"+j.idx;l=m+"_"+s;c="<span style='cursor:pointer;' class='ui-icon "+i+"' onclick=\"jQuery('#"+e.jgrid.jqID(a.p.id)+"').jqGrid('groupingToggle','"+l+"');return false;\"></span>";try{e.isArray(d.formatDisplayField)&&e.isFunction(d.formatDisplayField[j.idx])?(j.displayValue=d.formatDisplayField[j.idx].call(a,j.displayValue,j.value,a.p.colModel[q[j.idx]],j.idx,d),k=j.displayValue):k=a.formatter(l,j.displayValue,q[j.idx],j.value)}catch(C){k=
j.displayValue}h+='<tr id="'+l+'"'+(d.groupCollapse&&0<j.idx?' style="display:none;" ':" ")+'role="row" class= "ui-widget-content jqgroup ui-row-'+a.p.direction+" "+m+'"><td style="padding-left:'+12*j.idx+'px;" colspan="'+g+'">'+c+e.jgrid.template(d.groupText[j.idx],k,j.cnt,j.summary)+"</td></tr>";if(w-1===j.idx){var o=d.groups[s+1],p,n,B=void 0!==o?d.groups[s+1].startRow:b.length;for(n=j.startRow;n<B;n++)h+=b[n].join("");var r;if(void 0!==o){for(r=0;r<d.groupField.length&&o.dataIndex!==d.groupField[r];r++);
t=d.groupField.length-r}for(o=0;o<t;o++)if(x[o]){n="";d.groupCollapse&&!d.showSummaryOnHide&&(n=' style="display:none;"');h+="<tr"+n+' jqfootlevel="'+(j.idx-o)+'" role="row" class="ui-widget-content jqfoot ui-row-'+a.p.direction+'">';n=f(s,o,d.groups);var u=a.p.colModel,v,y=n.cnt;for(p=0;p<g;p++){var z="<td "+a.formatCol(p,1,"")+">&#160;</td>",A="{0}";e.each(n.summary,function(){if(this.nm===u[p].name){u[p].summaryTpl&&(A=u[p].summaryTpl);"string"===typeof this.st&&"avg"===this.st.toLowerCase()&&
(this.sd&&this.vd?this.v/=this.vd:this.v&&0<y&&(this.v/=y));try{v=a.formatter("",this.v,p,this)}catch(b){v=this.v}z="<td "+a.formatCol(p,1,"")+">"+e.jgrid.format(A,v)+"</td>";return!1}});h+=z}h+="</tr>"}t=r}});e("#"+e.jgrid.jqID(a.p.id)+" tbody:first").append(h);h=null})},groupingGroupBy:function(b,g){return this.each(function(){"string"===typeof b&&(b=[b]);var f=this.p.groupingView;this.p.grouping=!0;void 0===f.visibiltyOnNextGrouping&&(f.visibiltyOnNextGrouping=[]);var a;for(a=0;a<f.groupField.length;a++)!f.groupColumnShow[a]&&
f.visibiltyOnNextGrouping[a]&&e(this).jqGrid("showCol",f.groupField[a]);for(a=0;a<b.length;a++)f.visibiltyOnNextGrouping[a]=e("#"+e.jgrid.jqID(this.p.id)+"_"+e.jgrid.jqID(b[a])).is(":visible");this.p.groupingView=e.extend(this.p.groupingView,g||{});f.groupField=b;e(this).trigger("reloadGrid")})},groupingRemove:function(b){return this.each(function(){void 0===b&&(b=!0);this.p.grouping=!1;if(!0===b){var g=this.p.groupingView,f;for(f=0;f<g.groupField.length;f++)!g.groupColumnShow[f]&&g.visibiltyOnNextGrouping[f]&&
e(this).jqGrid("showCol",g.groupField);e("tr.jqgroup, tr.jqfoot","#"+e.jgrid.jqID(this.p.id)+" tbody:first").remove();e("tr.jqgrow:hidden","#"+e.jgrid.jqID(this.p.id)+" tbody:first").show()}else e(this).trigger("reloadGrid")})},groupingCalculations:{handler:function(b,e,f,a,d,h){var c={sum:function(){return parseFloat(e||0)+parseFloat(h[f]||0)},min:function(){return""===e?parseFloat(h[f]||0):Math.min(parseFloat(e),parseFloat(h[f]||0))},max:function(){return""===e?parseFloat(h[f]||0):Math.max(parseFloat(e),
parseFloat(h[f]||0))},count:function(){""===e&&(e=0);return h.hasOwnProperty(f)?e+1:0},avg:function(){return c.sum()}};if(!c[b])throw"jqGrid Grouping No such method: "+b;b=c[b]();null!=a&&("fixed"===d?b=b.toFixed(a):(a=Math.pow(10,a),b=Math.round(b*a)/a));return b}}})})(jQuery);
(function(d){d.jgrid.extend({setTreeNode:function(b,c){return this.each(function(){var a=this;if(a.grid&&a.p.treeGrid)for(var h=a.p.expColInd,e=a.p.treeReader.expanded_field,i=a.p.treeReader.leaf_field,g=a.p.treeReader.level_field,f=a.p.treeReader.icon_field,l=a.p.treeReader.loaded,k,m,n,j;b<c;)j=d.jgrid.stripPref(a.p.idPrefix,a.rows[b].id),j=a.p.data[a.p._index[j]],"nested"===a.p.treeGridModel&&!j[i]&&(k=parseInt(j[a.p.treeReader.left_field],10),m=parseInt(j[a.p.treeReader.right_field],10),j[i]=
m===k+1?"true":"false",a.rows[b].cells[a.p._treeleafpos].innerHTML=j[i]),k=parseInt(j[g],10),0===a.p.tree_root_level?(n=k+1,m=k):(n=k,m=k-1),n="<div class='tree-wrap tree-wrap-"+a.p.direction+"' style='width:"+18*n+"px;'>",n+="<div style='"+("rtl"===a.p.direction?"right:":"left:")+18*m+"px;' class='ui-icon ",void 0!==j[l]&&(j[l]="true"===j[l]||!0===j[l]?!0:!1),"true"===j[i]||!0===j[i]?(n+=(void 0!==j[f]&&""!==j[f]?j[f]:a.p.treeIcons.leaf)+" tree-leaf treeclick",j[i]=!0,m="leaf"):(j[i]=!1,m=""),j[e]=
("true"===j[e]||!0===j[e]?!0:!1)&&(j[l]||void 0===j[l]),n=!1===j[e]?n+(!0===j[i]?"'":a.p.treeIcons.plus+" tree-plus treeclick'"):n+(!0===j[i]?"'":a.p.treeIcons.minus+" tree-minus treeclick'"),n+="></div></div>",d(a.rows[b].cells[h]).wrapInner("<span class='cell-wrapper"+m+"'></span>").prepend(n),k!==parseInt(a.p.tree_root_level,10)&&((j=(j=d(a).jqGrid("getNodeParent",j))&&j.hasOwnProperty(e)?j[e]:!0)||d(a.rows[b]).css("display","none")),d(a.rows[b].cells[h]).find("div.treeclick").bind("click",function(b){b=
d.jgrid.stripPref(a.p.idPrefix,d(b.target||b.srcElement,a.rows).closest("tr.jqgrow")[0].id);b=a.p._index[b];if(!a.p.data[b][i])if(a.p.data[b][e]){d(a).jqGrid("collapseRow",a.p.data[b]);d(a).jqGrid("collapseNode",a.p.data[b])}else{d(a).jqGrid("expandRow",a.p.data[b]);d(a).jqGrid("expandNode",a.p.data[b])}return false}),!0===a.p.ExpandColClick&&d(a.rows[b].cells[h]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(b){var b=d.jgrid.stripPref(a.p.idPrefix,d(b.target||b.srcElement,
a.rows).closest("tr.jqgrow")[0].id),c=a.p._index[b];if(!a.p.data[c][i])if(a.p.data[c][e]){d(a).jqGrid("collapseRow",a.p.data[c]);d(a).jqGrid("collapseNode",a.p.data[c])}else{d(a).jqGrid("expandRow",a.p.data[c]);d(a).jqGrid("expandNode",a.p.data[c])}d(a).jqGrid("setSelection",b);return false}),b++})},setTreeGrid:function(){return this.each(function(){var b=this,c=0,a=!1,h,e,i,g=[];if(b.p.treeGrid){b.p.treedatatype||d.extend(b.p,{treedatatype:b.p.datatype});b.p.subGrid=!1;b.p.altRows=!1;b.p.pgbuttons=
!1;b.p.pginput=!1;b.p.gridview=!0;null===b.p.rowTotal&&(b.p.rowNum=1E4);b.p.multiselect=!1;b.p.rowList=[];b.p.expColInd=0;b.p.treeIcons=d.extend({plus:"ui-icon-triangle-1-"+("rtl"===b.p.direction?"w":"e"),minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},b.p.treeIcons||{});"nested"===b.p.treeGridModel?b.p.treeReader=d.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.p.treeReader):"adjacency"===b.p.treeGridModel&&
(b.p.treeReader=d.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.p.treeReader));for(e in b.p.colModel)if(b.p.colModel.hasOwnProperty(e))for(i in h=b.p.colModel[e].name,h===b.p.ExpandColumn&&!a&&(a=!0,b.p.expColInd=c),c++,b.p.treeReader)b.p.treeReader.hasOwnProperty(i)&&b.p.treeReader[i]===h&&g.push(h);d.each(b.p.treeReader,function(a,e){if(e&&d.inArray(e,g)===-1){if(a==="leaf_field")b.p._treeleafpos=c;c++;b.p.colNames.push(e);
b.p.colModel.push({name:e,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})}})},expandRow:function(b){this.each(function(){var c=this;if(c.grid&&c.p.treeGrid){var a=d(c).jqGrid("getNodeChildren",b),h=c.p.treeReader.expanded_field;d(a).each(function(){var a=c.p.idPrefix+d.jgrid.getAccessor(this,c.p.localReader.id);d(d(c).jqGrid("getGridRowById",a)).css("display","");this[h]&&d(c).jqGrid("expandRow",this)})}})},collapseRow:function(b){this.each(function(){var c=
this;if(c.grid&&c.p.treeGrid){var a=d(c).jqGrid("getNodeChildren",b),h=c.p.treeReader.expanded_field;d(a).each(function(){var a=c.p.idPrefix+d.jgrid.getAccessor(this,c.p.localReader.id);d(d(c).jqGrid("getGridRowById",a)).css("display","none");this[h]&&d(c).jqGrid("collapseRow",this)})}})},getRootNodes:function(){var b=[];this.each(function(){var c=this;if(c.grid&&c.p.treeGrid)switch(c.p.treeGridModel){case "nested":var a=c.p.treeReader.level_field;d(c.p.data).each(function(){parseInt(this[a],10)===
parseInt(c.p.tree_root_level,10)&&b.push(this)});break;case "adjacency":var h=c.p.treeReader.parent_id_field;d(c.p.data).each(function(){(null===this[h]||"null"===(""+this[h]).toLowerCase())&&b.push(this)})}});return b},getNodeDepth:function(b){var c=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":c=parseInt(b[this.p.treeReader.level_field],10)-parseInt(this.p.tree_root_level,10);break;case "adjacency":c=d(this).jqGrid("getNodeAncestors",b).length}});
return c},getNodeParent:function(b){var c=null;this.each(function(){var a=this;if(a.grid&&a.p.treeGrid)switch(a.p.treeGridModel){case "nested":var h=a.p.treeReader.left_field,e=a.p.treeReader.right_field,i=a.p.treeReader.level_field,g=parseInt(b[h],10),f=parseInt(b[e],10),l=parseInt(b[i],10);d(this.p.data).each(function(){if(parseInt(this[i],10)===l-1&&parseInt(this[h],10)<g&&parseInt(this[e],10)>f)return c=this,!1});break;case "adjacency":var k=a.p.treeReader.parent_id_field,m=a.p.localReader.id;
d(this.p.data).each(function(){if(this[m]===d.jgrid.stripPref(a.p.idPrefix,b[k]))return c=this,!1})}});return c},getNodeChildren:function(b){var c=[];this.each(function(){var a=this;if(a.grid&&a.p.treeGrid)switch(a.p.treeGridModel){case "nested":var h=a.p.treeReader.left_field,e=a.p.treeReader.right_field,i=a.p.treeReader.level_field,g=parseInt(b[h],10),f=parseInt(b[e],10),l=parseInt(b[i],10);d(this.p.data).each(function(){parseInt(this[i],10)===l+1&&parseInt(this[h],10)>g&&parseInt(this[e],10)<f&&
c.push(this)});break;case "adjacency":var k=a.p.treeReader.parent_id_field,m=a.p.localReader.id;d(this.p.data).each(function(){this[k]==d.jgrid.stripPref(a.p.idPrefix,b[m])&&c.push(this)})}});return c},getFullTreeNode:function(b){var c=[];this.each(function(){var a=this,h;if(a.grid&&a.p.treeGrid)switch(a.p.treeGridModel){case "nested":var e=a.p.treeReader.left_field,i=a.p.treeReader.right_field,g=a.p.treeReader.level_field,f=parseInt(b[e],10),l=parseInt(b[i],10),k=parseInt(b[g],10);d(this.p.data).each(function(){parseInt(this[g],
10)>=k&&parseInt(this[e],10)>=f&&parseInt(this[e],10)<=l&&c.push(this)});break;case "adjacency":if(b){c.push(b);var m=a.p.treeReader.parent_id_field,n=a.p.localReader.id;d(this.p.data).each(function(b){h=c.length;for(b=0;b<h;b++)if(d.jgrid.stripPref(a.p.idPrefix,c[b][n])===this[m]){c.push(this);break}})}}});return c},getNodeAncestors:function(b){var c=[];this.each(function(){if(this.grid&&this.p.treeGrid)for(var a=d(this).jqGrid("getNodeParent",b);a;)c.push(a),a=d(this).jqGrid("getNodeParent",a)});
return c},isVisibleNode:function(b){var c=!0;this.each(function(){if(this.grid&&this.p.treeGrid){var a=d(this).jqGrid("getNodeAncestors",b),h=this.p.treeReader.expanded_field;d(a).each(function(){c=c&&this[h];if(!c)return!1})}});return c},isNodeLoaded:function(b){var c;this.each(function(){if(this.grid&&this.p.treeGrid){var a=this.p.treeReader.leaf_field,h=this.p.treeReader.loaded;c=void 0!==b?void 0!==b[h]?b[h]:b[a]||0<d(this).jqGrid("getNodeChildren",b).length?!0:!1:!1}});return c},expandNode:function(b){return this.each(function(){if(this.grid&&
this.p.treeGrid){var c=this.p.treeReader.expanded_field,a=this.p.treeReader.parent_id_field,h=this.p.treeReader.loaded,e=this.p.treeReader.level_field,i=this.p.treeReader.left_field,g=this.p.treeReader.right_field;if(!b[c]){var f=d.jgrid.getAccessor(b,this.p.localReader.id),l=d("#"+this.p.idPrefix+d.jgrid.jqID(f),this.grid.bDiv)[0],k=this.p._index[f];d(this).jqGrid("isNodeLoaded",this.p.data[k])?(b[c]=!0,d("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+
" tree-minus")):this.grid.hDiv.loading||(b[c]=!0,d("div.treeclick",l).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=l.rowIndex,this.p.datatype=this.p.treedatatype,"nested"===this.p.treeGridModel?d(this).jqGrid("setGridParam",{postData:{nodeid:f,n_left:b[i],n_right:b[g],n_level:b[e]}}):d(this).jqGrid("setGridParam",{postData:{nodeid:f,parentid:b[a],n_level:b[e]}}),d(this).trigger("reloadGrid"),b[h]=!0,"nested"===this.p.treeGridModel?
d(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):d(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}))}}})},collapseNode:function(b){return this.each(function(){if(this.grid&&this.p.treeGrid){var c=this.p.treeReader.expanded_field;b[c]&&(b[c]=!1,c=d.jgrid.getAccessor(b,this.p.localReader.id),c=d("#"+this.p.idPrefix+d.jgrid.jqID(c),this.grid.bDiv)[0],d("div.treeclick",c).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+
" tree-plus"))}})},SortTree:function(b,c,a,h){return this.each(function(){if(this.grid&&this.p.treeGrid){var e,i,g,f=[],l=this,k;e=d(this).jqGrid("getRootNodes");e=d.jgrid.from(e);e.orderBy(b,c,a,h);k=e.select();e=0;for(i=k.length;e<i;e++)g=k[e],f.push(g),d(this).jqGrid("collectChildrenSortTree",f,g,b,c,a,h);d.each(f,function(a){var b=d.jgrid.getAccessor(this,l.p.localReader.id);d("#"+d.jgrid.jqID(l.p.id)+" tbody tr:eq("+a+")").after(d("tr#"+d.jgrid.jqID(b),l.grid.bDiv))});f=k=e=null}})},collectChildrenSortTree:function(b,
c,a,h,e,i){return this.each(function(){if(this.grid&&this.p.treeGrid){var g,f,l,k;g=d(this).jqGrid("getNodeChildren",c);g=d.jgrid.from(g);g.orderBy(a,h,e,i);k=g.select();g=0;for(f=k.length;g<f;g++)l=k[g],b.push(l),d(this).jqGrid("collectChildrenSortTree",b,l,a,h,e,i)}})},setTreeRow:function(b,c){var a=!1;this.each(function(){this.grid&&this.p.treeGrid&&(a=d(this).jqGrid("setRowData",b,c))});return a},delTreeNode:function(b){return this.each(function(){var c=this.p.localReader.id,a,h=this.p.treeReader.left_field,
e=this.p.treeReader.right_field,i,g,f;if(this.grid&&this.p.treeGrid&&(a=this.p._index[b],void 0!==a)){i=parseInt(this.p.data[a][e],10);g=i-parseInt(this.p.data[a][h],10)+1;var l=d(this).jqGrid("getFullTreeNode",this.p.data[a]);if(0<l.length)for(a=0;a<l.length;a++)d(this).jqGrid("delRowData",l[a][c]);if("nested"===this.p.treeGridModel){c=d.jgrid.from(this.p.data).greater(h,i,{stype:"integer"}).select();if(c.length)for(f in c)c.hasOwnProperty(f)&&(c[f][h]=parseInt(c[f][h],10)-g);c=d.jgrid.from(this.p.data).greater(e,
i,{stype:"integer"}).select();if(c.length)for(f in c)c.hasOwnProperty(f)&&(c[f][e]=parseInt(c[f][e],10)-g)}}})},addChildNode:function(b,c,a,h){var e=this[0];if(a){var i=e.p.treeReader.expanded_field,g=e.p.treeReader.leaf_field,f=e.p.treeReader.level_field,l=e.p.treeReader.parent_id_field,k=e.p.treeReader.left_field,m=e.p.treeReader.right_field,n=e.p.treeReader.loaded,j,r,q,t,p;j=0;var s=c,u;void 0===h&&(h=!1);if(void 0===b||null===b){p=e.p.data.length-1;if(0<=p)for(;0<=p;)j=Math.max(j,parseInt(e.p.data[p][e.p.localReader.id],
10)),p--;b=j+1}var v=d(e).jqGrid("getInd",c);u=!1;if(void 0===c||null===c||""===c)s=c=null,j="last",t=e.p.tree_root_level,p=e.p.data.length+1;else if(j="after",r=e.p._index[c],q=e.p.data[r],c=q[e.p.localReader.id],t=parseInt(q[f],10)+1,p=d(e).jqGrid("getFullTreeNode",q),p.length?(s=p=p[p.length-1][e.p.localReader.id],p=d(e).jqGrid("getInd",s)+1):p=d(e).jqGrid("getInd",c)+1,q[g])u=!0,q[i]=!0,d(e.rows[v]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.p.treeIcons.leaf+
" tree-leaf").addClass(e.p.treeIcons.minus+" tree-minus"),e.p.data[r][g]=!1,q[n]=!0;r=p+1;void 0===a[i]&&(a[i]=!1);void 0===a[n]&&(a[n]=!1);a[f]=t;void 0===a[g]&&(a[g]=!0);"adjacency"===e.p.treeGridModel&&(a[l]=c);if("nested"===e.p.treeGridModel){var o;if(null!==c){g=parseInt(q[m],10);f=d.jgrid.from(e.p.data);f=f.greaterOrEquals(m,g,{stype:"integer"});f=f.select();if(f.length)for(o in f)f.hasOwnProperty(o)&&(f[o][k]=f[o][k]>g?parseInt(f[o][k],10)+2:f[o][k],f[o][m]=f[o][m]>=g?parseInt(f[o][m],10)+
2:f[o][m]);a[k]=g;a[m]=g+1}else{g=parseInt(d(e).jqGrid("getCol",m,!1,"max"),10);f=d.jgrid.from(e.p.data).greater(k,g,{stype:"integer"}).select();if(f.length)for(o in f)f.hasOwnProperty(o)&&(f[o][k]=parseInt(f[o][k],10)+2);f=d.jgrid.from(e.p.data).greater(m,g,{stype:"integer"}).select();if(f.length)for(o in f)f.hasOwnProperty(o)&&(f[o][m]=parseInt(f[o][m],10)+2);a[k]=g+1;a[m]=g+2}}if(null===c||d(e).jqGrid("isNodeLoaded",q)||u)d(e).jqGrid("addRowData",b,a,j,s),d(e).jqGrid("setTreeNode",p,r);q&&!q[i]&&
h&&d(e.rows[v]).find("div.treeclick").click()}}})})(jQuery);
(function(c){c.jgrid.extend({jqGridImport:function(a){a=c.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},a||{});return this.each(function(){var d=this,f=function(a,b){var e=c(b.xmlGrid.config,a)[0],h=c(b.xmlGrid.data,a)[0],f,g;if(xmlJsonClass.xml2json&&c.jgrid.parse){e=xmlJsonClass.xml2json(e," ");e=c.jgrid.parse(e);for(g in e)e.hasOwnProperty(g)&&(f=e[g]);h?(h=e.grid.datatype,
e.grid.datatype="xmlstring",e.grid.datastr=a,c(d).jqGrid(f).jqGrid("setGridParam",{datatype:h})):c(d).jqGrid(f)}else alert("xml2json or parse are not present")},b=function(a,b){if(a&&"string"===typeof a){var e=!1;c.jgrid.useJSON&&(c.jgrid.useJSON=!1,e=!0);var f=c.jgrid.parse(a);e&&(c.jgrid.useJSON=!0);e=f[b.jsonGrid.config];if(f=f[b.jsonGrid.data]){var g=e.datatype;e.datatype="jsonstring";e.datastr=f;c(d).jqGrid(e).jqGrid("setGridParam",{datatype:g})}else c(d).jqGrid(e)}};switch(a.imptype){case "xml":c.ajax(c.extend({url:a.impurl,
type:a.mtype,data:a.impData,dataType:"xml",complete:function(b,g){"success"===g&&(f(b.responseXML,a),c(d).triggerHandler("jqGridImportComplete",[b,a]),c.isFunction(a.importComplete)&&a.importComplete(b))}},a.ajaxOptions));break;case "xmlstring":if(a.impstring&&"string"===typeof a.impstring){var g=c.parseXML(a.impstring);g&&(f(g,a),c(d).triggerHandler("jqGridImportComplete",[g,a]),c.isFunction(a.importComplete)&&a.importComplete(g),a.impstring=null);g=null}break;case "json":c.ajax(c.extend({url:a.impurl,
type:a.mtype,data:a.impData,dataType:"json",complete:function(f){try{b(f.responseText,a),c(d).triggerHandler("jqGridImportComplete",[f,a]),c.isFunction(a.importComplete)&&a.importComplete(f)}catch(g){}}},a.ajaxOptions));break;case "jsonstring":a.impstring&&"string"===typeof a.impstring&&(b(a.impstring,a),c(d).triggerHandler("jqGridImportComplete",[a.impstring,a]),c.isFunction(a.importComplete)&&a.importComplete(a.impstring),a.impstring=null)}})},jqGridExport:function(a){var a=c.extend({exptype:"xmlstring",
root:"grid",ident:"\t"},a||{}),d=null;this.each(function(){if(this.grid){var f,b=c.extend(!0,{},c(this).jqGrid("getGridParam"));b.rownumbers&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.multiselect&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.subGrid&&(b.colNames.splice(0,1),b.colModel.splice(0,1));b.knv=null;if(b.treeGrid)for(f in b.treeReader)b.treeReader.hasOwnProperty(f)&&(b.colNames.splice(b.colNames.length-1),b.colModel.splice(b.colModel.length-1));switch(a.exptype){case "xmlstring":d=
"<"+a.root+">"+xmlJsonClass.json2xml(b,a.ident)+"</"+a.root+">";break;case "jsonstring":d="{"+xmlJsonClass.toJson(b,a.root,a.ident,!1)+"}",void 0!==b.postData.filters&&(d=d.replace(/filters":"/,'filters":'),d=d.replace(/}]}"/,"}]}"))}}});return d},excelExport:function(a){a=c.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},a||{});return this.each(function(){if(this.grid){var d;"remote"===a.exptype&&(d=c.extend({},this.p.postData),d[a.oper]=a.tag,d=jQuery.param(d),d=-1!==
a.url.indexOf("?")?a.url+"&"+d:a.url+"?"+d,window.location=d)}})}})})(jQuery);
var xmlJsonClass={xml2json:function(a,b){9===a.nodeType&&(a=a.documentElement);var g=this.toJson(this.toObj(this.removeWhite(a)),a.nodeName,"\t");return"{\n"+b+(b?g.replace(/\t/g,b):g.replace(/\t|\n/g,""))+"\n}"},json2xml:function(a,b){var g=function(a,b,e){var d="",f,i;if(a instanceof Array)if(0===a.length)d+=e+"<"+b+">__EMPTY_ARRAY_</"+b+">\n";else{f=0;for(i=a.length;f<i;f+=1)var l=e+g(a[f],b,e+"\t")+"\n",d=d+l}else if("object"===typeof a){f=!1;d+=e+"<"+b;for(i in a)a.hasOwnProperty(i)&&("@"===
i.charAt(0)?d+=" "+i.substr(1)+'="'+a[i].toString()+'"':f=!0);d+=f?">":"/>";if(f){for(i in a)a.hasOwnProperty(i)&&("#text"===i?d+=a[i]:"#cdata"===i?d+="<![CDATA["+a[i]+"]]\>":"@"!==i.charAt(0)&&(d+=g(a[i],i,e+"\t")));d+=("\n"===d.charAt(d.length-1)?e:"")+"</"+b+">"}}else"function"===typeof a?d+=e+"<"+b+"><![CDATA["+a+"]]\></"+b+">":(void 0===a&&(a=""),d='""'===a.toString()||0===a.toString().length?d+(e+"<"+b+">__EMPTY_STRING_</"+b+">"):d+(e+"<"+b+">"+a.toString()+"</"+b+">"));return d},f="",e;for(e in a)a.hasOwnProperty(e)&&
(f+=g(a[e],e,""));return b?f.replace(/\t/g,b):f.replace(/\t|\n/g,"")},toObj:function(a){var b={},g=/function/i;if(1===a.nodeType){if(a.attributes.length){var f;for(f=0;f<a.attributes.length;f+=1)b["@"+a.attributes[f].nodeName]=(a.attributes[f].nodeValue||"").toString()}if(a.firstChild){var e=f=0,h=!1,c;for(c=a.firstChild;c;c=c.nextSibling)1===c.nodeType?h=!0:3===c.nodeType&&c.nodeValue.match(/[^ \f\n\r\t\v]/)?f+=1:4===c.nodeType&&(e+=1);if(h)if(2>f&&2>e){this.removeWhite(a);for(c=a.firstChild;c;c=
c.nextSibling)3===c.nodeType?b["#text"]=this.escape(c.nodeValue):4===c.nodeType?g.test(c.nodeValue)?b[c.nodeName]=[b[c.nodeName],c.nodeValue]:b["#cdata"]=this.escape(c.nodeValue):b[c.nodeName]?b[c.nodeName]instanceof Array?b[c.nodeName][b[c.nodeName].length]=this.toObj(c):b[c.nodeName]=[b[c.nodeName],this.toObj(c)]:b[c.nodeName]=this.toObj(c)}else a.attributes.length?b["#text"]=this.escape(this.innerXml(a)):b=this.escape(this.innerXml(a));else if(f)a.attributes.length?b["#text"]=this.escape(this.innerXml(a)):
(b=this.escape(this.innerXml(a)),"__EMPTY_ARRAY_"===b?b="[]":"__EMPTY_STRING_"===b&&(b=""));else if(e)if(1<e)b=this.escape(this.innerXml(a));else for(c=a.firstChild;c;c=c.nextSibling)if(g.test(a.firstChild.nodeValue)){b=a.firstChild.nodeValue;break}else b["#cdata"]=this.escape(c.nodeValue)}!a.attributes.length&&!a.firstChild&&(b=null)}else 9===a.nodeType?b=this.toObj(a.documentElement):alert("unhandled node type: "+a.nodeType);return b},toJson:function(a,b,g,f){void 0===f&&(f=!0);var e=b?'"'+b+'"':
"",h="\t",c="\n";f||(c=h="");if("[]"===a)e+=b?":[]":"[]";else if(a instanceof Array){var j,d,k=[];d=0;for(j=a.length;d<j;d+=1)k[d]=this.toJson(a[d],"",g+h,f);e+=(b?":[":"[")+(1<k.length?c+g+h+k.join(","+c+g+h)+c+g:k.join(""))+"]"}else if(null===a)e+=(b&&":")+"null";else if("object"===typeof a){j=[];for(d in a)a.hasOwnProperty(d)&&(j[j.length]=this.toJson(a[d],d,g+h,f));e+=(b?":{":"{")+(1<j.length?c+g+h+j.join(","+c+g+h)+c+g:j.join(""))+"}"}else e="string"===typeof a?e+((b&&":")+'"'+a.replace(/\\/g,
"\\\\").replace(/\"/g,'\\"')+'"'):e+((b&&":")+a.toString());return e},innerXml:function(a){var b="";if("innerHTML"in a)b=a.innerHTML;else for(var g=function(a){var b="",h;if(1===a.nodeType){b+="<"+a.nodeName;for(h=0;h<a.attributes.length;h+=1)b+=" "+a.attributes[h].nodeName+'="'+(a.attributes[h].nodeValue||"").toString()+'"';if(a.firstChild){b+=">";for(h=a.firstChild;h;h=h.nextSibling)b+=g(h);b+="</"+a.nodeName+">"}else b+="/>"}else 3===a.nodeType?b+=a.nodeValue:4===a.nodeType&&(b+="<![CDATA["+a.nodeValue+
"]]\>");return b},a=a.firstChild;a;a=a.nextSibling)b+=g(a);return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();var b;for(b=a.firstChild;b;)if(3===b.nodeType)if(b.nodeValue.match(/[^ \f\n\r\t\v]/))b=b.nextSibling;else{var g=b.nextSibling;a.removeChild(b);b=g}else 1===b.nodeType&&this.removeWhite(b),b=b.nextSibling;return a}};
function tableToGrid(j,k){jQuery(j).each(function(){if(!this.grid){jQuery(this).width("99%");var b=jQuery(this).width(),c=jQuery("tr td:first-child input[type=checkbox]:first",jQuery(this)),a=jQuery("tr td:first-child input[type=radio]:first",jQuery(this)),c=0<c.length,a=!c&&0<a.length,i=c||a,d=[],e=[];jQuery("th",jQuery(this)).each(function(){0===d.length&&i?(d.push({name:"__selection__",index:"__selection__",width:0,hidden:!0}),e.push("__selection__")):(d.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),
index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150}),e.push(jQuery(this).html()))});var f=[],g=[],h=[];jQuery("tbody > tr",jQuery(this)).each(function(){var b={},a=0;jQuery("td",jQuery(this)).each(function(){if(0===a&&i){var c=jQuery("input",jQuery(this)),e=c.attr("value");g.push(e||f.length);c.is(":checked")&&h.push(e);b[d[a].name]=c.attr("value")}else b[d[a].name]=jQuery(this).html();a++});0<a&&f.push(b)});
jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:b,colNames:e,colModel:d,multiselect:c},k||{}));for(b=0;b<f.length;b++)a=null,0<g.length&&(a=g[b])&&a.replace&&(a=encodeURIComponent(a).replace(/[.\-%]/g,"_")),null===a&&(a=b+1),jQuery(this).jqGrid("addRowData",a,f[b]);for(b=0;b<h.length;b++)jQuery(this).jqGrid("setSelection",h[b])}})};
(function(b){b.jgrid.msie&&8===b.jgrid.msiever()&&(b.expr[":"].hidden=function(b){return 0===b.offsetWidth||0===b.offsetHeight||"none"===b.style.display});b.jgrid._multiselect=!1;if(b.ui&&b.ui.multiselect){if(b.ui.multiselect.prototype._setSelected){var o=b.ui.multiselect.prototype._setSelected;b.ui.multiselect.prototype._setSelected=function(a,d){var c=o.call(this,a,d);if(d&&this.selectedList){var e=this.element;this.selectedList.find("li").each(function(){b(this).data("optionLink")&&b(this).data("optionLink").remove().appendTo(e)})}return c}}b.ui.multiselect.prototype.destroy&&
(b.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();b.Widget===void 0?b.widget.prototype.destroy.apply(this,arguments):b.Widget.prototype.destroy.apply(this,arguments)});b.jgrid._multiselect=!0}b.jgrid.extend({sortableColumns:function(a){return this.each(function(){function d(){c.p.disableClick=true}var c=this,e=b.jgrid.jqID(c.p.id),e={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+e+"_cb,#jqgh_"+e+"_rn,#jqgh_"+e+"_subgrid),:hidden)",
placeholder:{element:function(a){return b(document.createElement(a[0].nodeName)).addClass(a[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(b,a){a.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10));a.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}},update:function(a,
e){var d=b(e.item).parent(),d=b(">th",d),f={},g=c.p.id+"_";b.each(c.p.colModel,function(b){f[this.name]=b});var j=[];d.each(function(){var a=b(">div",this).get(0).id.replace(/^jqgh_/,"").replace(g,"");f.hasOwnProperty(a)&&j.push(f[a])});b(c).jqGrid("remapColumns",j,true,true);b.isFunction(c.p.sortable.update)&&c.p.sortable.update(j);setTimeout(function(){c.p.disableClick=false},50)}};if(c.p.sortable.options)b.extend(e,c.p.sortable.options);else if(b.isFunction(c.p.sortable))c.p.sortable={update:c.p.sortable};
if(e.start){var g=e.start;e.start=function(b,a){d();g.call(this,b,a)}}else e.start=d;if(c.p.sortable.exclude)e.items=e.items+(":not("+c.p.sortable.exclude+")");a.sortable(e).data("sortable").floating=true})},columnChooser:function(a){function d(a,c){a&&(typeof a==="string"?b.fn[a]&&b.fn[a].apply(c,b.makeArray(arguments).slice(2)):b.isFunction(a)&&a.apply(c,b.makeArray(arguments).slice(2)))}var c=this;if(!b("#colchooser_"+b.jgrid.jqID(c[0].p.id)).length){var e=b('<div id="colchooser_'+c[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),
g=b("select",e),a=b.extend({width:420,height:240,classname:null,done:function(b){b&&c.jqGrid("remapColumns",b,true)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470},dlog_opts:function(a){var c={};c[a.bSubmit]=function(){a.apply_perm();a.cleanup(false)};c[a.bCancel]=function(){a.cleanup(true)};return b.extend(true,{buttons:c,close:function(){a.cleanup(true)},modal:a.modal||false,resizable:a.resizable||true,width:a.width+20},a.dialog_opts||{})},apply_perm:function(){b("option",g).each(function(){this.selected?
c.jqGrid("showCol",i[this.value].name):c.jqGrid("hideCol",i[this.value].name)});var e=[];b("option:selected",g).each(function(){e.push(parseInt(this.value,10))});b.each(e,function(){delete m[i[parseInt(this,10)].name]});b.each(m,function(){var b=parseInt(this,10);var a=e,c=b;if(c>=0){var d=a.slice(),i=d.splice(c,Math.max(a.length-c,c));if(c>a.length)c=a.length;d[c]=b;e=d.concat(i)}else e=void 0});a.done&&a.done.call(c,e)},cleanup:function(b){d(a.dlog,e,"destroy");d(a.msel,g,"destroy");e.remove();
b&&a.done&&a.done.call(c)},msel_opts:{}},b.jgrid.col,a||{});if(b.ui&&b.ui.multiselect&&a.msel==="multiselect"){if(!b.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}a.msel_opts=b.extend(b.ui.multiselect.defaults,a.msel_opts)}a.caption&&e.attr("title",a.caption);if(a.classname){e.addClass(a.classname);g.addClass(a.classname)}if(a.width){b(">div",e).css({width:a.width,margin:"0 auto"});g.css("width",a.width)}if(a.height){b(">div",
e).css("height",a.height);g.css("height",a.height-10)}var i=c.jqGrid("getGridParam","colModel"),q=c.jqGrid("getGridParam","colNames"),m={},f=[];g.empty();b.each(i,function(a){m[this.name]=a;this.hidedlg?this.hidden||f.push(a):g.append("<option value='"+a+"' "+(this.hidden?"":"selected='selected'")+">"+b.jgrid.stripHtml(q[a])+"</option>")});var n=b.isFunction(a.dlog_opts)?a.dlog_opts.call(c,a):a.dlog_opts;d(a.dlog,e,n);n=b.isFunction(a.msel_opts)?a.msel_opts.call(c,a):a.msel_opts;d(a.msel,g,n)}},sortableRows:function(a){return this.each(function(){var d=
this;if(d.grid&&!d.p.treeGrid&&b.fn.sortable){a=b.extend({cursor:"move",axis:"y",items:".jqgrow"},a||{});if(a.start&&b.isFunction(a.start)){a._start_=a.start;delete a.start}else a._start_=false;if(a.update&&b.isFunction(a.update)){a._update_=a.update;delete a.update}else a._update_=false;a.start=function(c,e){b(e.item).css("border-width","0px");b("td",e.item).each(function(b){this.style.width=d.grid.cols[b].style.width});if(d.p.subGrid){var g=b(e.item).attr("id");try{b(d).jqGrid("collapseSubGridRow",
g)}catch(i){}}a._start_&&a._start_.apply(this,[c,e])};a.update=function(c,e){b(e.item).css("border-width","");d.p.rownumbers===true&&b("td.jqgrid-rownum",d.rows).each(function(a){b(this).html(a+1+(parseInt(d.p.page,10)-1)*parseInt(d.p.rowNum,10))});a._update_&&a._update_.apply(this,[c,e])};b("tbody:first",d).sortable(a);b("tbody:first",d).disableSelection()}})},gridDnD:function(a){return this.each(function(){function d(){var a=b.data(c,"dnd");b("tr.jqgrow:not(.ui-draggable)",c).draggable(b.isFunction(a.drag)?
a.drag.call(b(c),a):a.drag)}var c=this,e,g;if(c.grid&&!c.p.treeGrid&&b.fn.draggable&&b.fn.droppable){b("#jqgrid_dnd")[0]===void 0&&b("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");if(typeof a==="string"&&a==="updateDnD"&&c.p.jqgdnd===true)d();else{a=b.extend({drag:function(a){return b.extend({start:function(e,d){var f;if(c.p.subGrid){f=b(d.helper).attr("id");try{b(c).jqGrid("collapseSubGridRow",f)}catch(g){}}for(f=0;f<b.data(c,"dnd").connectWith.length;f++)b(b.data(c,"dnd").connectWith[f]).jqGrid("getGridParam",
"reccount")===0&&b(b.data(c,"dnd").connectWith[f]).jqGrid("addRowData","jqg_empty_row",{});d.helper.addClass("ui-state-highlight");b("td",d.helper).each(function(b){this.style.width=c.grid.headers[b].width+"px"});a.onstart&&b.isFunction(a.onstart)&&a.onstart.call(b(c),e,d)},stop:function(e,d){var f;if(d.helper.dropped&&!a.dragcopy){f=b(d.helper).attr("id");f===void 0&&(f=b(this).attr("id"));b(c).jqGrid("delRowData",f)}for(f=0;f<b.data(c,"dnd").connectWith.length;f++)b(b.data(c,"dnd").connectWith[f]).jqGrid("delRowData",
"jqg_empty_row");a.onstop&&b.isFunction(a.onstop)&&a.onstop.call(b(c),e,d)}},a.drag_opts||{})},drop:function(a){return b.extend({accept:function(a){if(!b(a).hasClass("jqgrow"))return a;a=b(a).closest("table.ui-jqgrid-btable");if(a.length>0&&b.data(a[0],"dnd")!==void 0){a=b.data(a[0],"dnd").connectWith;return b.inArray("#"+b.jgrid.jqID(this.id),a)!==-1?true:false}return false},drop:function(e,d){if(b(d.draggable).hasClass("jqgrow")){var f=b(d.draggable).attr("id"),f=d.draggable.parent().parent().jqGrid("getRowData",
f);if(!a.dropbyname){var g=0,j={},h,l,p=b("#"+b.jgrid.jqID(this.id)).jqGrid("getGridParam","colModel");try{for(l in f)if(f.hasOwnProperty(l)){h=p[g].name;h==="cb"||h==="rn"||h==="subgrid"||f.hasOwnProperty(l)&&p[g]&&(j[h]=f[l]);g++}f=j}catch(o){}}d.helper.dropped=true;if(a.beforedrop&&b.isFunction(a.beforedrop)){h=a.beforedrop.call(this,e,d,f,b("#"+b.jgrid.jqID(c.p.id)),b(this));h!==void 0&&h!==null&&typeof h==="object"&&(f=h)}if(d.helper.dropped){var k;if(a.autoid)if(b.isFunction(a.autoid))k=a.autoid.call(this,
f);else{k=Math.ceil(Math.random()*1E3);k=a.autoidprefix+k}b("#"+b.jgrid.jqID(this.id)).jqGrid("addRowData",k,f,a.droppos)}a.ondrop&&b.isFunction(a.ondrop)&&a.ondrop.call(this,e,d,f)}}},a.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},a||
{});if(a.connectWith){a.connectWith=a.connectWith.split(",");a.connectWith=b.map(a.connectWith,function(a){return b.trim(a)});b.data(c,"dnd",a);c.p.reccount!==0&&!c.p.jqgdnd&&d();c.p.jqgdnd=true;for(e=0;e<a.connectWith.length;e++){g=a.connectWith[e];b(g).droppable(b.isFunction(a.drop)?a.drop.call(b(c),a):a.drop)}}}}})},gridResize:function(a){return this.each(function(){var d=this,c=b.jgrid.jqID(d.p.id);if(d.grid&&b.fn.resizable){a=b.extend({},a||{});if(a.alsoResize){a._alsoResize_=a.alsoResize;delete a.alsoResize}else a._alsoResize_=
false;if(a.stop&&b.isFunction(a.stop)){a._stop_=a.stop;delete a.stop}else a._stop_=false;a.stop=function(e,g){b(d).jqGrid("setGridParam",{height:b("#gview_"+c+" .ui-jqgrid-bdiv").height()});b(d).jqGrid("setGridWidth",g.size.width,a.shrinkToFit);a._stop_&&a._stop_.call(d,e,g)};a.alsoResize=a._alsoResize_?eval("("+("{'#gview_"+c+" .ui-jqgrid-bdiv':true,'"+a._alsoResize_+"':true}")+")"):b(".ui-jqgrid-bdiv","#gview_"+c);delete a._alsoResize_;b("#gbox_"+c).resizable(a)}})}})})(jQuery);
/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(d){d.jqplot.BarRenderer=function(){d.jqplot.LineRenderer.call(this)};d.jqplot.BarRenderer.prototype=new d.jqplot.LineRenderer();d.jqplot.BarRenderer.prototype.constructor=d.jqplot.BarRenderer;d.jqplot.BarRenderer.prototype.init=function(o,q){this.barPadding=8;this.barMargin=10;this.barDirection="vertical";this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=false;this.groups=1;this.varyBarColor=false;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.transposedData=true;this.renderer.animation={show:false,direction:"down",speed:3000,_supported:true};this._type="bar";if(o.highlightMouseDown&&o.highlightMouseOver==null){o.highlightMouseOver=false}d.extend(true,this,o);d.extend(true,this.renderer,o);this.fill=true;if(this.barDirection==="horizontal"&&this.rendererOptions.animation&&this.rendererOptions.animation.direction==null){this.renderer.animation.direction="left"}if(this.waterfall){this.fillToZero=false;this.disableStack=true}if(this.barDirection=="vertical"){this._primaryAxis="_xaxis";this._stackAxis="y";this.fillAxis="y"}else{this._primaryAxis="_yaxis";this._stackAxis="x";this.fillAxis="x"}this._highlightedPoint=null;this._plotSeriesInfo=null;this._dataColors=[];this._barPoints=[];var p={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill};this.renderer.shapeRenderer.init(p);var n={lineJoin:"miter",lineCap:"round",fill:true,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill};this.renderer.shadowRenderer.init(n);q.postInitHooks.addOnce(h);q.postDrawHooks.addOnce(j);q.eventListenerHooks.addOnce("jqplotMouseMove",b);q.eventListenerHooks.addOnce("jqplotMouseDown",a);q.eventListenerHooks.addOnce("jqplotMouseUp",l);q.eventListenerHooks.addOnce("jqplotClick",e);q.eventListenerHooks.addOnce("jqplotRightClick",m)};function g(t,p,o,w){if(this.rendererOptions.barDirection=="horizontal"){this._stackAxis="x";this._primaryAxis="_yaxis"}if(this.rendererOptions.waterfall==true){this._data=d.extend(true,[],this.data);var s=0;var u=(!this.rendererOptions.barDirection||this.rendererOptions.barDirection==="vertical"||this.transposedData===false)?1:0;for(var q=0;q<this.data.length;q++){s+=this.data[q][u];if(q>0){this.data[q][u]+=this.data[q-1][u]}}this.data[this.data.length]=(u==1)?[this.data.length+1,s]:[s,this.data.length+1];this._data[this._data.length]=(u==1)?[this._data.length+1,s]:[s,this._data.length+1]}if(this.rendererOptions.groups>1){this.breakOnNull=true;var n=this.data.length;var v=parseInt(n/this.rendererOptions.groups,10);var r=0;for(var q=v;q<n;q+=v){this.data.splice(q+r,0,[null,null]);this._plotData.splice(q+r,0,[null,null]);this._stackData.splice(q+r,0,[null,null]);r++}for(q=0;q<this.data.length;q++){if(this._primaryAxis=="_xaxis"){this.data[q][0]=q+1;this._plotData[q][0]=q+1;this._stackData[q][0]=q+1}else{this.data[q][1]=q+1;this._plotData[q][1]=q+1;this._stackData[q][1]=q+1}}}}d.jqplot.preSeriesInitHooks.push(g);d.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){var r=0;var t=0;var q=this[this._primaryAxis];var p,o,u;for(var n=0;n<q._series.length;n++){o=q._series[n];if(o===this){u=n}if(o.renderer.constructor==d.jqplot.BarRenderer){r+=o.data.length;t+=1}}return[r,t,u]};d.jqplot.BarRenderer.prototype.setBarWidth=function(){var q;var n=0;var o=0;var t=this[this._primaryAxis];var x,r,v;var w=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);n=w[0];o=w[1];var u=t.numberTicks;var p=(u-1)/2;if(t.name=="xaxis"||t.name=="x2axis"){if(this._stack){this.barWidth=(t._offsets.max-t._offsets.min)/n*o-this.barMargin}else{this.barWidth=((t._offsets.max-t._offsets.min)/p-this.barPadding*(o-1)-this.barMargin*2)/o}}else{if(this._stack){this.barWidth=(t._offsets.min-t._offsets.max)/n*o-this.barMargin}else{this.barWidth=((t._offsets.min-t._offsets.max)/p-this.barPadding*(o-1)-this.barMargin*2)/o}}return[n,o]};function f(o){var q=[];for(var s=0;s<o.length;s++){var r=d.jqplot.getColorComponents(o[s]);var n=[r[0],r[1],r[2]];var t=n[0]+n[1]+n[2];for(var p=0;p<3;p++){n[p]=(t>570)?n[p]*0.8:n[p]+0.3*(255-n[p]);n[p]=parseInt(n[p],10)}q.push("rgb("+n[0]+","+n[1]+","+n[2]+")")}return q}function i(v,u,s,t,o){var q=v,w=v-1,n,p,r=(o==="x")?0:1;if(q>0){p=t.series[w]._plotData[u][r];if((s*p)<0){n=i(w,u,s,t,o)}else{n=t.series[w].gridData[u][r]}}else{n=(r===0)?t.series[q]._xaxis.series_u2p(0):t.series[q]._yaxis.series_u2p(0)}return n}d.jqplot.BarRenderer.prototype.draw=function(E,L,q,G){var I;var A=d.extend({},q);var w=(A.shadow!=undefined)?A.shadow:this.shadow;var O=(A.showLine!=undefined)?A.showLine:this.showLine;var F=(A.fill!=undefined)?A.fill:this.fill;var p=this.xaxis;var J=this.yaxis;var y=this._xaxis.series_u2p;var K=this._yaxis.series_u2p;var D,C;this._dataColors=[];this._barPoints=[];if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var N=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);var x=N[0];var v=N[1];var s=N[2];var H=[];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(v/2-0.5)+s)*(this.barWidth+this.barPadding)}if(O){var u=new d.jqplot.ColorGenerator(this.negativeSeriesColors);var B=new d.jqplot.ColorGenerator(this.seriesColors);var M=u.get(this.index);if(!this.useNegativeColors){M=A.fillStyle}var t=A.fillStyle;var r;var P;var o;if(this.barDirection=="vertical"){for(var I=0;I<L.length;I++){if(!this._stack&&this.data[I][1]==null){continue}H=[];r=L[I][0]+this._barNudge;if(this._stack&&this._prevGridData.length){o=i(this.index,I,this._plotData[I][1],G,"y")}else{if(this.fillToZero){o=this._yaxis.series_u2p(0)}else{if(this.waterfall&&I>0&&I<this.gridData.length-1){o=this.gridData[I-1][1]}else{if(this.waterfall&&I==0&&I<this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){o=this._yaxis.series_u2p(0)}else{if(this._yaxis.min>0){o=E.canvas.height}else{o=0}}}else{if(this.waterfall&&I==this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){o=this._yaxis.series_u2p(0)}else{if(this._yaxis.min>0){o=E.canvas.height}else{o=0}}}else{o=E.canvas.height}}}}}if((this.fillToZero&&this._plotData[I][1]<0)||(this.waterfall&&this._data[I][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){A.fillStyle=u.next()}else{A.fillStyle=B.next()}}else{A.fillStyle=M}}else{if(this.varyBarColor&&!this._stack){A.fillStyle=B.next()}else{A.fillStyle=t}}if(!this.fillToZero||this._plotData[I][1]>=0){H.push([r-this.barWidth/2,o]);H.push([r-this.barWidth/2,L[I][1]]);H.push([r+this.barWidth/2,L[I][1]]);H.push([r+this.barWidth/2,o])}else{H.push([r-this.barWidth/2,L[I][1]]);H.push([r-this.barWidth/2,o]);H.push([r+this.barWidth/2,o]);H.push([r+this.barWidth/2,L[I][1]])}this._barPoints.push(H);if(w&&!this._stack){var z=d.extend(true,{},A);delete z.fillStyle;this.renderer.shadowRenderer.draw(E,H,z)}var n=A.fillStyle||this.color;this._dataColors.push(n);this.renderer.shapeRenderer.draw(E,H,A)}}else{if(this.barDirection=="horizontal"){for(var I=0;I<L.length;I++){if(!this._stack&&this.data[I][0]==null){continue}H=[];r=L[I][1]-this._barNudge;P;if(this._stack&&this._prevGridData.length){P=i(this.index,I,this._plotData[I][0],G,"x")}else{if(this.fillToZero){P=this._xaxis.series_u2p(0)}else{if(this.waterfall&&I>0&&I<this.gridData.length-1){P=this.gridData[I-1][0]}else{if(this.waterfall&&I==0&&I<this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){P=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){P=0}else{P=0}}}else{if(this.waterfall&&I==this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){P=this._xaxis.series_u2p(0)}else{if(this._xaxis.min>0){P=0}else{P=E.canvas.width}}}else{P=0}}}}}if((this.fillToZero&&this._plotData[I][1]<0)||(this.waterfall&&this._data[I][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){A.fillStyle=u.next()}else{A.fillStyle=B.next()}}}else{if(this.varyBarColor&&!this._stack){A.fillStyle=B.next()}else{A.fillStyle=t}}if(!this.fillToZero||this._plotData[I][0]>=0){H.push([P,r+this.barWidth/2]);H.push([P,r-this.barWidth/2]);H.push([L[I][0],r-this.barWidth/2]);H.push([L[I][0],r+this.barWidth/2])}else{H.push([L[I][0],r+this.barWidth/2]);H.push([L[I][0],r-this.barWidth/2]);H.push([P,r-this.barWidth/2]);H.push([P,r+this.barWidth/2])}this._barPoints.push(H);if(w&&!this._stack){var z=d.extend(true,{},A);delete z.fillStyle;this.renderer.shadowRenderer.draw(E,H,z)}var n=A.fillStyle||this.color;this._dataColors.push(n);this.renderer.shapeRenderer.draw(E,H,A)}}}}if(this.highlightColors.length==0){this.highlightColors=d.jqplot.computeHighlightColors(this._dataColors)}else{if(typeof(this.highlightColors)=="string"){var N=this.highlightColors;this.highlightColors=[];for(var I=0;I<this._dataColors.length;I++){this.highlightColors.push(N)}}}};d.jqplot.BarRenderer.prototype.drawShadow=function(z,G,p,B){var D;var w=(p!=undefined)?p:{};var t=(w.shadow!=undefined)?w.shadow:this.shadow;var I=(w.showLine!=undefined)?w.showLine:this.showLine;var A=(w.fill!=undefined)?w.fill:this.fill;var o=this.xaxis;var E=this.yaxis;var v=this._xaxis.series_u2p;var F=this._yaxis.series_u2p;var y,C,x,u,s,r;if(this._stack&&this.shadow){if(this.barWidth==null){this.renderer.setBarWidth.call(this)}var H=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);u=H[0];s=H[1];r=H[2];if(this._stack){this._barNudge=0}else{this._barNudge=(-Math.abs(s/2-0.5)+r)*(this.barWidth+this.barPadding)}if(I){if(this.barDirection=="vertical"){for(var D=0;D<G.length;D++){if(this.data[D][1]==null){continue}C=[];var q=G[D][0]+this._barNudge;var n;if(this._stack&&this._prevGridData.length){n=i(this.index,D,this._plotData[D][1],B,"y")}else{if(this.fillToZero){n=this._yaxis.series_u2p(0)}else{n=z.canvas.height}}C.push([q-this.barWidth/2,n]);C.push([q-this.barWidth/2,G[D][1]]);C.push([q+this.barWidth/2,G[D][1]]);C.push([q+this.barWidth/2,n]);this.renderer.shadowRenderer.draw(z,C,w)}}else{if(this.barDirection=="horizontal"){for(var D=0;D<G.length;D++){if(this.data[D][0]==null){continue}C=[];var q=G[D][1]-this._barNudge;var J;if(this._stack&&this._prevGridData.length){J=i(this.index,D,this._plotData[D][0],B,"x")}else{if(this.fillToZero){J=this._xaxis.series_u2p(0)}else{J=0}}C.push([J,q+this.barWidth/2]);C.push([G[D][0],q+this.barWidth/2]);C.push([G[D][0],q-this.barWidth/2]);C.push([J,q-this.barWidth/2]);this.renderer.shadowRenderer.draw(z,C,w)}}}}}};function h(q,p,n){for(var o=0;o<this.series.length;o++){if(this.series[o].renderer.constructor==d.jqplot.BarRenderer){if(this.series[o].highlightMouseOver){this.series[o].highlightMouseDown=false}}}}function j(){if(this.plugins.barRenderer&&this.plugins.barRenderer.highlightCanvas){this.plugins.barRenderer.highlightCanvas.resetCanvas();this.plugins.barRenderer.highlightCanvas=null}this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new d.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-barRenderer-highlight-canvas",this._plotDimensions,this));this.plugins.barRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(n){k(n.data.plot)})}function c(u,t,q,p){var o=u.series[t];var n=u.plugins.barRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);o._highlightedPoint=q;u.plugins.barRenderer.highlightedSeriesIndex=t;var r={fillStyle:o.highlightColors[q]};o.renderer.shapeRenderer.draw(n._ctx,p,r);n=null}function k(p){var n=p.plugins.barRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);for(var o=0;o<p.series.length;o++){p.series[o]._highlightedPoint=null}p.plugins.barRenderer.highlightedSeriesIndex=null;p.target.trigger("jqplotDataUnhighlight");n=null}function b(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var o=jQuery.Event("jqplotDataMouseOver");o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p);if(s.series[p[0]].highlightMouseOver&&!(p[0]==s.plugins.barRenderer.highlightedSeriesIndex&&p[1]==s.series[p[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=r.which;n.pageX=r.pageX;n.pageY=r.pageY;s.target.trigger(n,p);c(s,t.seriesIndex,t.pointIndex,t.points)}}else{if(t==null){k(s)}}}function a(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];if(r.series[o[0]].highlightMouseDown&&!(o[0]==r.plugins.barRenderer.highlightedSeriesIndex&&o[1]==r.series[o[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o);c(r,s.seriesIndex,s.pointIndex,s.points)}}else{if(s==null){k(r)}}}function l(p,o,s,r,q){var n=q.plugins.barRenderer.highlightedSeriesIndex;if(n!=null&&q.series[n].highlightMouseDown){k(q)}}function e(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];var n=jQuery.Event("jqplotDataClick");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o)}}function m(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var n=s.plugins.barRenderer.highlightedSeriesIndex;if(n!=null&&s.series[n].highlightMouseDown){k(s)}var o=jQuery.Event("jqplotDataRightClick");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p)}}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){a.jqplot.CanvasAxisLabelRenderer=function(b){this.angle=0;this.axis;this.show=true;this.showLabel=true;this.label="";this.fontFamily='"Trebuchet MS", Arial, Helvetica, sans-serif';this.fontSize="11pt";this.fontWeight="normal";this.fontStretch=1;this.textColor="#666666";this.enableFontSupport=true;this.pt2px=null;this._elem;this._ctx;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null};a.extend(true,this,b);if(b.angle==null&&this.axis!="xaxis"&&this.axis!="x2axis"){this.angle=-90}var c={fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily};if(this.pt2px){c.pt2px=this.pt2px}if(this.enableFontSupport){if(a.jqplot.support_canvas_text()){this._textRenderer=new a.jqplot.CanvasFontRenderer(c)}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}};a.jqplot.CanvasAxisLabelRenderer.prototype.init=function(b){a.extend(true,this,b);this._textRenderer.init({fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily})};a.jqplot.CanvasAxisLabelRenderer.prototype.getWidth=function(d){if(this._elem){return this._elem.outerWidth(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.sin(f.angle)*e)+Math.abs(Math.cos(f.angle)*c);return b}};a.jqplot.CanvasAxisLabelRenderer.prototype.getHeight=function(d){if(this._elem){return this._elem.outerHeight(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.cos(f.angle)*e)+Math.abs(Math.sin(f.angle)*c);return b}};a.jqplot.CanvasAxisLabelRenderer.prototype.getAngleRad=function(){var b=this.angle*Math.PI/180;return b};a.jqplot.CanvasAxisLabelRenderer.prototype.draw=function(c,f){if(this._elem){if(a.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce();this._elem=null}var e=f.canvasManager.getCanvas();this._textRenderer.setText(this.label,c);var b=this.getWidth(c);var d=this.getHeight(c);e.width=b;e.height=d;e.style.width=b;e.style.height=d;e=f.canvasManager.initCanvas(e);this._elem=a(e);this._elem.css({position:"absolute"});this._elem.addClass("jqplot-"+this.axis+"-label");e=null;return this._elem};a.jqplot.CanvasAxisLabelRenderer.prototype.pack=function(){this._textRenderer.draw(this._elem.get(0).getContext("2d"),this.label)}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){a.jqplot.CanvasAxisTickRenderer=function(b){this.mark="outside";this.showMark=true;this.showGridline=true;this.isMinorTick=false;this.angle=0;this.markSize=4;this.show=true;this.showLabel=true;this.labelPosition="auto";this.label="";this.value=null;this._styles={};this.formatter=a.jqplot.DefaultTickFormatter;this.formatString="";this.prefix="";this.fontFamily='"Trebuchet MS", Arial, Helvetica, sans-serif';this.fontSize="10pt";this.fontWeight="normal";this.fontStretch=1;this.textColor="#666666";this.enableFontSupport=true;this.pt2px=null;this._elem;this._ctx;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null};a.extend(true,this,b);var c={fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily};if(this.pt2px){c.pt2px=this.pt2px}if(this.enableFontSupport){if(a.jqplot.support_canvas_text()){this._textRenderer=new a.jqplot.CanvasFontRenderer(c)}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}}else{this._textRenderer=new a.jqplot.CanvasTextRenderer(c)}};a.jqplot.CanvasAxisTickRenderer.prototype.init=function(b){a.extend(true,this,b);this._textRenderer.init({fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily})};a.jqplot.CanvasAxisTickRenderer.prototype.getWidth=function(d){if(this._elem){return this._elem.outerWidth(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.sin(f.angle)*e)+Math.abs(Math.cos(f.angle)*c);return b}};a.jqplot.CanvasAxisTickRenderer.prototype.getHeight=function(d){if(this._elem){return this._elem.outerHeight(true)}else{var f=this._textRenderer;var c=f.getWidth(d);var e=f.getHeight(d);var b=Math.abs(Math.cos(f.angle)*e)+Math.abs(Math.sin(f.angle)*c);return b}};a.jqplot.CanvasAxisTickRenderer.prototype.getAngleRad=function(){var b=this.angle*Math.PI/180;return b};a.jqplot.CanvasAxisTickRenderer.prototype.setTick=function(b,d,c){this.value=b;if(c){this.isMinorTick=true}return this};a.jqplot.CanvasAxisTickRenderer.prototype.draw=function(c,f){if(!this.label){this.label=this.prefix+this.formatter(this.formatString,this.value)}if(this._elem){if(a.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){window.G_vmlCanvasManager.uninitElement(this._elem.get(0))}this._elem.emptyForce();this._elem=null}var e=f.canvasManager.getCanvas();this._textRenderer.setText(this.label,c);var b=this.getWidth(c);var d=this.getHeight(c);e.width=b;e.height=d;e.style.width=b;e.style.height=d;e.style.textAlign="left";e.style.position="absolute";e=f.canvasManager.initCanvas(e);this._elem=a(e);this._elem.css(this._styles);this._elem.addClass("jqplot-"+this.axis+"-tick");e=null;return this._elem};a.jqplot.CanvasAxisTickRenderer.prototype.pack=function(){this._textRenderer.draw(this._elem.get(0).getContext("2d"),this.label)}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){a.jqplot.CanvasTextRenderer=function(b){this.fontStyle="normal";this.fontVariant="normal";this.fontWeight="normal";this.fontSize="10px";this.fontFamily="sans-serif";this.fontStretch=1;this.fillStyle="#666666";this.angle=0;this.textAlign="start";this.textBaseline="alphabetic";this.text;this.width;this.height;this.pt2px=1.28;a.extend(true,this,b);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);this.setHeight()};a.jqplot.CanvasTextRenderer.prototype.init=function(b){a.extend(true,this,b);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);this.setHeight()};a.jqplot.CanvasTextRenderer.prototype.normalizeFontSize=function(b){b=String(b);var c=parseFloat(b);if(b.indexOf("px")>-1){return c/this.pt2px}else{if(b.indexOf("pt")>-1){return c}else{if(b.indexOf("em")>-1){return c*12}else{if(b.indexOf("%")>-1){return c*12/100}else{return c/this.pt2px}}}}};a.jqplot.CanvasTextRenderer.prototype.fontWeight2Float=function(b){if(Number(b)){return b/400}else{switch(b){case"normal":return 1;break;case"bold":return 1.75;break;case"bolder":return 2.25;break;case"lighter":return 0.75;break;default:return 1;break}}};a.jqplot.CanvasTextRenderer.prototype.getText=function(){return this.text};a.jqplot.CanvasTextRenderer.prototype.setText=function(c,b){this.text=c;this.setWidth(b);return this};a.jqplot.CanvasTextRenderer.prototype.getWidth=function(b){return this.width};a.jqplot.CanvasTextRenderer.prototype.setWidth=function(c,b){if(!b){this.width=this.measure(c,this.text)}else{this.width=b}return this};a.jqplot.CanvasTextRenderer.prototype.getHeight=function(b){return this.height};a.jqplot.CanvasTextRenderer.prototype.setHeight=function(b){if(!b){this.height=this.normalizedFontSize*this.pt2px}else{this.height=b}return this};a.jqplot.CanvasTextRenderer.prototype.letter=function(b){return this.letters[b]};a.jqplot.CanvasTextRenderer.prototype.ascent=function(){return this.normalizedFontSize};a.jqplot.CanvasTextRenderer.prototype.descent=function(){return 7*this.normalizedFontSize/25};a.jqplot.CanvasTextRenderer.prototype.measure=function(d,g){var f=0;var b=g.length;for(var e=0;e<b;e++){var h=this.letter(g.charAt(e));if(h){f+=h.width*this.normalizedFontSize/25*this.fontStretch}}return f};a.jqplot.CanvasTextRenderer.prototype.draw=function(s,n){var r=0;var o=this.height*0.72;var p=0;var l=n.length;var k=this.normalizedFontSize/25;s.save();var h,f;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){h=0;f=-Math.sin(this.angle)*this.width}else{if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){h=Math.sin(this.angle)*this.height;f=0}else{if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){h=-Math.cos(this.angle)*this.width;f=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height}else{if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){h=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;f=-Math.cos(this.angle)*this.height}}}}s.strokeStyle=this.fillStyle;s.fillStyle=this.fillStyle;s.translate(h,f);s.rotate(this.angle);s.lineCap="round";var t=(this.normalizedFontSize>30)?2:2+(30-this.normalizedFontSize)/20;s.lineWidth=t*k*this.fontWeight2Float(this.fontWeight);for(var g=0;g<l;g++){var m=this.letter(n.charAt(g));if(!m){continue}s.beginPath();var e=1;var b=0;for(var d=0;d<m.points.length;d++){var q=m.points[d];if(q[0]==-1&&q[1]==-1){e=1;continue}if(e){s.moveTo(r+q[0]*k*this.fontStretch,o-q[1]*k);e=false}else{s.lineTo(r+q[0]*k*this.fontStretch,o-q[1]*k)}}s.stroke();r+=m.width*k*this.fontStretch}s.restore();return p};a.jqplot.CanvasTextRenderer.prototype.letters={" ":{width:16,points:[]},"!":{width:10,points:[[5,21],[5,7],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],[-1,-1],[12,21],[12,14]]},"#":{width:21,points:[[11,25],[4,-7],[-1,-1],[17,25],[10,-7],[-1,-1],[4,12],[18,12],[-1,-1],[3,6],[17,6]]},"$":{width:20,points:[[8,25],[8,-4],[-1,-1],[12,25],[12,-4],[-1,-1],[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},"%":{width:24,points:[[21,21],[3,0],[-1,-1],[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],[10,20],[13,19],[16,19],[19,20],[21,21],[-1,-1],[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},"&":{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},"'":{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},"(":{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},")":{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},"*":{width:16,points:[[8,21],[8,9],[-1,-1],[3,18],[13,12],[-1,-1],[13,18],[3,12]]},"+":{width:26,points:[[13,18],[13,0],[-1,-1],[4,9],[22,9]]},",":{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"-":{width:18,points:[[6,9],[12,9]]},".":{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},"/":{width:22,points:[[20,25],[2,-7]]},"0":{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},"1":{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},"2":{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},"3":{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},"4":{width:20,points:[[13,21],[3,7],[18,7],[-1,-1],[13,21],[13,0]]},"5":{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},"6":{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},"7":{width:20,points:[[17,21],[7,0],[-1,-1],[3,21],[17,21]]},"8":{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},"9":{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},":":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},";":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"<":{width:24,points:[[20,18],[4,9],[20,0]]},"=":{width:26,points:[[4,12],[22,12],[-1,-1],[4,6],[22,6]]},">":{width:24,points:[[4,18],[20,9],[4,0]]},"?":{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],[-1,-1],[9,2],[8,1],[9,0],[10,1],[9,2]]},"@":{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],[-1,-1],[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],[-1,-1],[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],[-1,-1],[19,16],[18,8],[18,6],[19,5]]},A:{width:18,points:[[9,21],[1,0],[-1,-1],[9,21],[17,0],[-1,-1],[4,7],[14,7]]},B:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[-1,-1],[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},C:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},D:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},E:{width:19,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11],[-1,-1],[4,0],[17,0]]},F:{width:18,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11]]},G:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],[-1,-1],[13,8],[18,8]]},H:{width:22,points:[[4,21],[4,0],[-1,-1],[18,21],[18,0],[-1,-1],[4,11],[18,11]]},I:{width:8,points:[[4,21],[4,0]]},J:{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},K:{width:21,points:[[4,21],[4,0],[-1,-1],[18,21],[4,7],[-1,-1],[9,12],[18,0]]},L:{width:17,points:[[4,21],[4,0],[-1,-1],[4,0],[16,0]]},M:{width:24,points:[[4,21],[4,0],[-1,-1],[4,21],[12,0],[-1,-1],[20,21],[12,0],[-1,-1],[20,21],[20,0]]},N:{width:22,points:[[4,21],[4,0],[-1,-1],[4,21],[18,0],[-1,-1],[18,21],[18,0]]},O:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},P:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},Q:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],[-1,-1],[12,4],[18,-2]]},R:{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],[-1,-1],[11,11],[18,0]]},S:{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},T:{width:16,points:[[8,21],[8,0],[-1,-1],[1,21],[15,21]]},U:{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},V:{width:18,points:[[1,21],[9,0],[-1,-1],[17,21],[9,0]]},W:{width:24,points:[[2,21],[7,0],[-1,-1],[12,21],[7,0],[-1,-1],[12,21],[17,0],[-1,-1],[22,21],[17,0]]},X:{width:20,points:[[3,21],[17,0],[-1,-1],[17,21],[3,0]]},Y:{width:18,points:[[1,21],[9,11],[9,0],[-1,-1],[17,21],[9,11]]},Z:{width:20,points:[[17,21],[3,0],[-1,-1],[3,21],[17,21],[-1,-1],[3,0],[17,0]]},"[":{width:14,points:[[4,25],[4,-7],[-1,-1],[5,25],[5,-7],[-1,-1],[4,25],[11,25],[-1,-1],[4,-7],[11,-7]]},"\\":{width:14,points:[[0,21],[14,-3]]},"]":{width:14,points:[[9,25],[9,-7],[-1,-1],[10,25],[10,-7],[-1,-1],[3,25],[10,25],[-1,-1],[3,-7],[10,-7]]},"^":{width:16,points:[[6,15],[8,18],[10,15],[-1,-1],[3,12],[8,17],[13,12],[-1,-1],[8,17],[8,0]]},_:{width:16,points:[[0,-2],[16,-2]]},"`":{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},a:{width:19,points:[[15,14],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},b:{width:19,points:[[4,21],[4,0],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},c:{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},d:{width:19,points:[[15,21],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},e:{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},f:{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],[-1,-1],[2,14],[9,14]]},g:{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},h:{width:19,points:[[4,21],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},i:{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],[-1,-1],[4,14],[4,0]]},j:{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],[-1,-1],[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},k:{width:17,points:[[4,21],[4,0],[-1,-1],[14,14],[4,4],[-1,-1],[8,8],[15,0]]},l:{width:8,points:[[4,21],[4,0]]},m:{width:30,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],[-1,-1],[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},n:{width:19,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},o:{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},p:{width:19,points:[[4,14],[4,-7],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},q:{width:19,points:[[15,14],[15,-7],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},r:{width:13,points:[[4,14],[4,0],[-1,-1],[4,8],[5,11],[7,13],[9,14],[12,14]]},s:{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},t:{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],[-1,-1],[2,14],[9,14]]},u:{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],[-1,-1],[15,14],[15,0]]},v:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0]]},w:{width:22,points:[[3,14],[7,0],[-1,-1],[11,14],[7,0],[-1,-1],[11,14],[15,0],[-1,-1],[19,14],[15,0]]},x:{width:17,points:[[3,14],[14,0],[-1,-1],[14,14],[3,0]]},y:{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},z:{width:17,points:[[14,14],[3,0],[-1,-1],[3,14],[14,14],[-1,-1],[3,0],[14,0]]},"{":{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],[-1,-1],[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],[-1,-1],[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},"|":{width:8,points:[[4,25],[4,-7]]},"}":{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],[-1,-1],[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],[-1,-1],[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},"~":{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],[-1,-1],[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]}};a.jqplot.CanvasFontRenderer=function(b){b=b||{};if(!b.pt2px){b.pt2px=1.5}a.jqplot.CanvasTextRenderer.call(this,b)};a.jqplot.CanvasFontRenderer.prototype=new a.jqplot.CanvasTextRenderer({});a.jqplot.CanvasFontRenderer.prototype.constructor=a.jqplot.CanvasFontRenderer;a.jqplot.CanvasFontRenderer.prototype.measure=function(c,e){var d=this.fontSize+" "+this.fontFamily;c.save();c.font=d;var b=c.measureText(e).width;c.restore();return b};a.jqplot.CanvasFontRenderer.prototype.draw=function(e,g){var c=0;var h=this.height*0.72;e.save();var d,b;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){d=0;b=-Math.sin(this.angle)*this.width}else{if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){d=Math.sin(this.angle)*this.height;b=0}else{if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){d=-Math.cos(this.angle)*this.width;b=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height}else{if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){d=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;b=-Math.cos(this.angle)*this.height}}}}e.strokeStyle=this.fillStyle;e.fillStyle=this.fillStyle;var f=this.fontSize+" "+this.fontFamily;e.font=f;e.translate(d,b);e.rotate(this.angle);e.fillText(g,c,h);e.restore()}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(d){var f=0;d.jqplot.CanvasOverlay=function(o){var l=o||{};this.options={show:d.jqplot.config.enablePlugins,deferDraw:false};this.objects=[];this.objectNames=[];this.canvas=null;this.markerRenderer=new d.jqplot.MarkerRenderer({style:"line"});this.markerRenderer.init();this.highlightObjectIndex=null;if(l.objects){var q=l.objects,p;for(var m=0;m<q.length;m++){p=q[m];for(var r in p){switch(r){case"line":this.addLine(p[r]);break;case"horizontalLine":this.addHorizontalLine(p[r]);break;case"dashedHorizontalLine":this.addDashedHorizontalLine(p[r]);break;case"verticalLine":this.addVerticalLine(p[r]);break;case"dashedVerticalLine":this.addDashedVerticalLine(p[r]);break;default:break}}}}d.extend(true,this.options,l)};d.jqplot.CanvasOverlay.postPlotInit=function(o,n,m){var l=m||{};this.plugins.canvasOverlay=new d.jqplot.CanvasOverlay(l.canvasOverlay)};function h(){this.uid=null;this.type=null;this.gridStart=null;this.gridStop=null;this.tooltipWidthFactor=0;this.options={name:null,show:true,lineWidth:2,lineCap:"round",color:"#666666",shadow:true,shadowAngle:45,shadowOffset:1,shadowDepth:3,shadowAlpha:"0.07",xaxis:"xaxis",yaxis:"yaxis",showTooltip:false,showTooltipPrecision:0.6,tooltipLocation:"nw",fadeTooltip:true,tooltipFadeSpeed:"fast",tooltipOffset:4,tooltipFormatString:"%d, %d"}}function b(l){h.call(this);this.type="line";var m={start:[],stop:[]};d.extend(true,this.options,m,l);if(this.options.showTooltipPrecision<0.01){this.options.showTooltipPrecision=0.01}}b.prototype=new h();b.prototype.constructor=b;function e(l){h.call(this);this.type="horizontalLine";var m={y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null};d.extend(true,this.options,m,l);if(this.options.showTooltipPrecision<0.01){this.options.showTooltipPrecision=0.01}}e.prototype=new h();e.prototype.constructor=e;function i(l){h.call(this);this.type="dashedHorizontalLine";var m={y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null,dashPattern:[8,8]};d.extend(true,this.options,m,l);if(this.options.showTooltipPrecision<0.01){this.options.showTooltipPrecision=0.01}}i.prototype=new h();i.prototype.constructor=i;function c(l){h.call(this);this.type="verticalLine";var m={x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null};d.extend(true,this.options,m,l);if(this.options.showTooltipPrecision<0.01){this.options.showTooltipPrecision=0.01}}c.prototype=new h();c.prototype.constructor=c;function k(l){h.call(this);this.type="dashedVerticalLine";this.start=null;this.stop=null;var m={x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null,dashPattern:[8,8]};d.extend(true,this.options,m,l);if(this.options.showTooltipPrecision<0.01){this.options.showTooltipPrecision=0.01}}k.prototype=new h();k.prototype.constructor=k;d.jqplot.CanvasOverlay.prototype.addLine=function(m){var l=new b(m);l.uid=f++;this.objects.push(l);this.objectNames.push(l.options.name)};d.jqplot.CanvasOverlay.prototype.addHorizontalLine=function(m){var l=new e(m);l.uid=f++;this.objects.push(l);this.objectNames.push(l.options.name)};d.jqplot.CanvasOverlay.prototype.addDashedHorizontalLine=function(m){var l=new i(m);l.uid=f++;this.objects.push(l);this.objectNames.push(l.options.name)};d.jqplot.CanvasOverlay.prototype.addVerticalLine=function(m){var l=new c(m);l.uid=f++;this.objects.push(l);this.objectNames.push(l.options.name)};d.jqplot.CanvasOverlay.prototype.addDashedVerticalLine=function(m){var l=new k(m);l.uid=f++;this.objects.push(l);this.objectNames.push(l.options.name)};d.jqplot.CanvasOverlay.prototype.removeObject=function(l){if(d.type(l)=="number"){this.objects.splice(l,1);this.objectNames.splice(l,1)}else{var m=d.inArray(l,this.objectNames);if(m!=-1){this.objects.splice(m,1);this.objectNames.splice(m,1)}}};d.jqplot.CanvasOverlay.prototype.getObject=function(l){if(d.type(l)=="number"){return this.objects[l]}else{var m=d.inArray(l,this.objectNames);if(m!=-1){return this.objects[m]}}};d.jqplot.CanvasOverlay.prototype.get=d.jqplot.CanvasOverlay.prototype.getObject;d.jqplot.CanvasOverlay.prototype.clear=function(l){this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight())};d.jqplot.CanvasOverlay.prototype.draw=function(I){var w,t=this.objects,D=this.markerRenderer,q,E;if(this.options.show){this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight());for(var F=0;F<t.length;F++){w=t[F];var z=d.extend(true,{},w.options);if(w.options.show){D.shadow=w.options.shadow;w.tooltipWidthFactor=w.options.lineWidth/w.options.showTooltipPrecision;switch(w.type){case"line":D.style="line";z.closePath=false;q=[I.axes[w.options.xaxis].series_u2p(w.options.start[0]),I.axes[w.options.yaxis].series_u2p(w.options.start[1])];E=[I.axes[w.options.xaxis].series_u2p(w.options.stop[0]),I.axes[w.options.yaxis].series_u2p(w.options.stop[1])];w.gridStart=q;w.gridStop=E;D.draw(q,E,this.canvas._ctx,z);break;case"horizontalLine":if(w.options.y!=null){D.style="line";z.closePath=false;var n=I.axes[w.options.xaxis],Q,J,u=I.axes[w.options.yaxis].series_u2p(w.options.y),G=w.options.xminOffset||w.options.xOffset,r=w.options.xmaxOffset||w.options.xOffset;if(w.options.xmin!=null){Q=n.series_u2p(w.options.xmin)}else{if(G!=null){if(d.type(G)=="number"){Q=n.series_u2p(n.min+G)}else{if(d.type(G)=="string"){Q=n.series_u2p(n.min)+parseFloat(G)}}}}if(w.options.xmax!=null){J=n.series_u2p(w.options.xmax)}else{if(r!=null){if(d.type(r)=="number"){J=n.series_u2p(n.max-r)}else{if(d.type(r)=="string"){J=n.series_u2p(n.max)-parseFloat(r)}}}}if(J!=null&&Q!=null){w.gridStart=[Q,u];w.gridStop=[J,u];D.draw([Q,u],[J,u],this.canvas._ctx,z)}}break;case"dashedHorizontalLine":var m=w.options.dashPattern;var C=0;for(var K=0;K<m.length;K++){C+=m[K]}if(w.options.y!=null){D.style="line";z.closePath=false;var n=I.axes[w.options.xaxis],Q,J,u=I.axes[w.options.yaxis].series_u2p(w.options.y),G=w.options.xminOffset||w.options.xOffset,r=w.options.xmaxOffset||w.options.xOffset;if(w.options.xmin!=null){Q=n.series_u2p(w.options.xmin)}else{if(G!=null){if(d.type(G)=="number"){Q=n.series_u2p(n.min+G)}else{if(d.type(G)=="string"){Q=n.series_u2p(n.min)+parseFloat(G)}}}}if(w.options.xmax!=null){J=n.series_u2p(w.options.xmax)}else{if(r!=null){if(d.type(r)=="number"){J=n.series_u2p(n.max-r)}else{if(d.type(r)=="string"){J=n.series_u2p(n.max)-parseFloat(r)}}}}if(J!=null&&Q!=null){w.gridStart=[Q,u];w.gridStop=[J,u];var p=Math.ceil((J-Q)/C);var O=Q,M;for(var K=0;K<p;K++){for(var H=0;H<m.length;H+=2){M=O+m[H];D.draw([O,u],[M,u],this.canvas._ctx,z);O+=m[H];if(H<m.length-1){O+=m[H+1]}}}}}break;case"verticalLine":if(w.options.x!=null){D.style="line";z.closePath=false;var L=I.axes[w.options.yaxis],l,s,v=I.axes[w.options.xaxis].series_u2p(w.options.x),B=w.options.yminOffset||w.options.yOffset,o=w.options.ymaxOffset||w.options.yOffset;if(w.options.ymin!=null){l=L.series_u2p(w.options.ymin)}else{if(B!=null){if(d.type(B)=="number"){l=L.series_u2p(L.min-B)}else{if(d.type(B)=="string"){l=L.series_u2p(L.min)-parseFloat(B)}}}}if(w.options.ymax!=null){s=L.series_u2p(w.options.ymax)}else{if(o!=null){if(d.type(o)=="number"){s=L.series_u2p(L.max+o)}else{if(d.type(o)=="string"){s=L.series_u2p(L.max)+parseFloat(o)}}}}if(s!=null&&l!=null){w.gridStart=[v,l];w.gridStop=[v,s];D.draw([v,l],[v,s],this.canvas._ctx,z)}}break;case"dashedVerticalLine":var m=w.options.dashPattern;var C=0;for(var K=0;K<m.length;K++){C+=m[K]}if(w.options.x!=null){D.style="line";z.closePath=false;var L=I.axes[w.options.yaxis],l,s,v=I.axes[w.options.xaxis].series_u2p(w.options.x),B=w.options.yminOffset||w.options.yOffset,o=w.options.ymaxOffset||w.options.yOffset;if(w.options.ymin!=null){l=L.series_u2p(w.options.ymin)}else{if(B!=null){if(d.type(B)=="number"){l=L.series_u2p(L.min-B)}else{if(d.type(B)=="string"){l=L.series_u2p(L.min)-parseFloat(B)}}}}if(w.options.ymax!=null){s=L.series_u2p(w.options.ymax)}else{if(o!=null){if(d.type(o)=="number"){s=L.series_u2p(L.max+o)}else{if(d.type(o)=="string"){s=L.series_u2p(L.max)+parseFloat(o)}}}}if(s!=null&&l!=null){w.gridStart=[v,l];w.gridStop=[v,s];var p=Math.ceil((l-s)/C);var A=((p*C)-(l-s))/2;var O=l,M,N,P;for(var K=0;K<p;K++){for(var H=0;H<m.length;H+=2){M=O-m[H];if(M<s){M=s}if(O<s){O=s}D.draw([v,O],[v,M],this.canvas._ctx,z);O-=m[H];if(H<m.length-1){O-=m[H+1]}}}}}break;default:break}}}}};d.jqplot.CanvasOverlay.postPlotDraw=function(){var m=this.plugins.canvasOverlay;if(m&&m.highlightCanvas){m.highlightCanvas.resetCanvas();m.highlightCanvas=null}m.canvas=new d.jqplot.GenericCanvas();this.eventCanvas._elem.before(m.canvas.createElement(this._gridPadding,"jqplot-overlayCanvas-canvas",this._plotDimensions,this));m.canvas.setContext();if(!m.deferDraw){m.draw(this)}var l=document.createElement("div");m._tooltipElem=d(l);l=null;m._tooltipElem.addClass("jqplot-canvasOverlay-tooltip");m._tooltipElem.css({position:"absolute",display:"none"});this.eventCanvas._elem.before(m._tooltipElem);this.eventCanvas._elem.bind("mouseleave",{elem:m._tooltipElem},function(n){n.data.elem.hide()});var m=null};function j(q,o,p,n){var s=q.plugins.canvasOverlay;var m=s._tooltipElem;var l=o.options,t,r;m.html(d.jqplot.sprintf(l.tooltipFormatString,n[0],n[1]));switch(l.tooltipLocation){case"nw":t=p[0]+q._gridPadding.left-m.outerWidth(true)-l.tooltipOffset;r=p[1]+q._gridPadding.top-l.tooltipOffset-m.outerHeight(true);break;case"n":t=p[0]+q._gridPadding.left-m.outerWidth(true)/2;r=p[1]+q._gridPadding.top-l.tooltipOffset-m.outerHeight(true);break;case"ne":t=p[0]+q._gridPadding.left+l.tooltipOffset;r=p[1]+q._gridPadding.top-l.tooltipOffset-m.outerHeight(true);break;case"e":t=p[0]+q._gridPadding.left+l.tooltipOffset;r=p[1]+q._gridPadding.top-m.outerHeight(true)/2;break;case"se":t=p[0]+q._gridPadding.left+l.tooltipOffset;r=p[1]+q._gridPadding.top+l.tooltipOffset;break;case"s":t=p[0]+q._gridPadding.left-m.outerWidth(true)/2;r=p[1]+q._gridPadding.top+l.tooltipOffset;break;case"sw":t=p[0]+q._gridPadding.left-m.outerWidth(true)-l.tooltipOffset;r=p[1]+q._gridPadding.top+l.tooltipOffset;break;case"w":t=p[0]+q._gridPadding.left-m.outerWidth(true)-l.tooltipOffset;r=p[1]+q._gridPadding.top-m.outerHeight(true)/2;break;default:t=p[0]+q._gridPadding.left-m.outerWidth(true)-l.tooltipOffset;r=p[1]+q._gridPadding.top-l.tooltipOffset-m.outerHeight(true);break}m.css("left",t);m.css("top",r);if(l.fadeTooltip){m.stop(true,true).fadeIn(l.tooltipFadeSpeed)}else{m.show()}m=null}function g(y,p,r,o){var n=y[0];var m=y[1];var x=Math.round(r[0]);var w=Math.round(r[1]);var t=Math.round(p[0]);var s=Math.round(p[1]);var q=Math.sqrt(Math.pow(x-t,2)+Math.pow(w-s,2));var z=o*q;var v=Math.abs((t-x)*(m-w)-(s-w)*(n-x));var u=(v<z)?true:false;return u}function a(y,v,q,z,w){var x=w.plugins.canvasOverlay;var u=x.objects;var r=u.length;var t,m=false;var p;for(var s=0;s<r;s++){t=u[s];if(t.options.showTooltip){var o=g([v.x,v.y],t.gridStart,t.gridStop,t.tooltipWidthFactor);q=[w.axes[t.options.xaxis].series_p2u(v.x),w.axes[t.options.yaxis].series_p2u(v.y)];if(o&&x.highlightObjectIndex==null){switch(t.type){case"line":j(w,t,[v.x,v.y],q);break;case"horizontalLine":case"dashedHorizontalLine":j(w,t,[v.x,t.gridStart[1]],[q[0],t.options.y]);break;case"verticalLine":case"dashedVerticalLine":j(w,t,[t.gridStart[0],v.y],[t.options.x,q[1]]);break;default:break}x.highlightObjectIndex=s;m=true;break}else{if(o&&x.highlightObjectIndex!==s){p=x._tooltipElem;if(t.fadeTooltip){p.fadeOut(t.tooltipFadeSpeed)}else{p.hide()}switch(t.type){case"line":j(w,t,[v.x,v.y],q);break;case"horizontalLine":case"dashedHorizontalLine":j(w,t,[v.x,t.gridStart[1]],[q[0],t.options.y]);break;case"verticalLine":case"dashedVerticalLine":j(w,t,[t.gridStart[0],v.y],[t.options.x,q[1]]);break;default:break}x.highlightObjectIndex=s;m=true;break}else{if(o){switch(t.type){case"line":j(w,t,[v.x,v.y],q);break;case"horizontalLine":case"dashedHorizontalLine":j(w,t,[v.x,t.gridStart[1]],[q[0],t.options.y]);break;case"verticalLine":case"dashedVerticalLine":j(w,t,[t.gridStart[0],v.y],[t.options.x,q[1]]);break;default:break}m=true;break}}}}}if(!m&&x.highlightObjectIndex!==null){p=x._tooltipElem;t=x.getObject(x.highlightObjectIndex);if(t.fadeTooltip){p.fadeOut(t.tooltipFadeSpeed)}else{p.hide()}x.highlightObjectIndex=null}}d.jqplot.postInitHooks.push(d.jqplot.CanvasOverlay.postPlotInit);d.jqplot.postDrawHooks.push(d.jqplot.CanvasOverlay.postPlotDraw);d.jqplot.eventListenerHooks.push(["jqplotMouseMove",a])})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){a.jqplot.CategoryAxisRenderer=function(b){a.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=false};a.jqplot.CategoryAxisRenderer.prototype=new a.jqplot.LinearAxisRenderer();a.jqplot.CategoryAxisRenderer.prototype.constructor=a.jqplot.CategoryAxisRenderer;a.jqplot.CategoryAxisRenderer.prototype.init=function(e){this.groups=1;this.groupLabels=[];this._groupLabels=[];this._grouped=false;this._barsPerGroup=null;this.reverse=false;a.extend(true,this,{tickOptions:{formatString:"%d"}},e);var b=this._dataBounds;for(var f=0;f<this._series.length;f++){var g=this._series[f];if(g.groups){this.groups=g.groups}var h=g.data;for(var c=0;c<h.length;c++){if(this.name=="xaxis"||this.name=="x2axis"){if(h[c][0]<b.min||b.min==null){b.min=h[c][0]}if(h[c][0]>b.max||b.max==null){b.max=h[c][0]}}else{if(h[c][1]<b.min||b.min==null){b.min=h[c][1]}if(h[c][1]>b.max||b.max==null){b.max=h[c][1]}}}}if(this.groupLabels.length){this.groups=this.groupLabels.length}};a.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var D=this._ticks;var z=this.ticks;var F=this.name;var C=this._dataBounds;var v,A;var q,w;var d,c;var b,x;if(z.length){if(this.groups>1&&!this._grouped){var r=z.length;var p=parseInt(r/this.groups,10);var e=0;for(var x=p;x<r;x+=p){z.splice(x+e,0," ");e++}this._grouped=true}this.min=0.5;this.max=z.length+0.5;var m=this.max-this.min;this.numberTicks=2*z.length+1;for(x=0;x<z.length;x++){b=this.min+2*x*m/(this.numberTicks-1);var h=new this.tickRenderer(this.tickOptions);h.showLabel=false;h.setTick(b,this.name);this._ticks.push(h);var h=new this.tickRenderer(this.tickOptions);h.label=z[x];h.showMark=false;h.showGridline=false;h.setTick(b+0.5,this.name);this._ticks.push(h)}var h=new this.tickRenderer(this.tickOptions);h.showLabel=false;h.setTick(b+1,this.name);this._ticks.push(h)}else{if(F=="xaxis"||F=="x2axis"){v=this._plotDimensions.width}else{v=this._plotDimensions.height}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null}if(this.min!=null&&this.max!=null&&this.tickInterval!=null){if(parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval){this.tickInterval=null}}var y=[];var B=0;var q=0.5;var w,E;var f=false;for(var x=0;x<this._series.length;x++){var k=this._series[x];for(var u=0;u<k.data.length;u++){if(this.name=="xaxis"||this.name=="x2axis"){E=k.data[u][0]}else{E=k.data[u][1]}if(a.inArray(E,y)==-1){f=true;B+=1;y.push(E)}}}if(f&&this.sortMergedLabels){y.sort(function(j,i){return j-i})}this.ticks=y;for(var x=0;x<this._series.length;x++){var k=this._series[x];for(var u=0;u<k.data.length;u++){if(this.name=="xaxis"||this.name=="x2axis"){E=k.data[u][0]}else{E=k.data[u][1]}var n=a.inArray(E,y)+1;if(this.name=="xaxis"||this.name=="x2axis"){k.data[u][0]=n}else{k.data[u][1]=n}}}if(this.groups>1&&!this._grouped){var r=y.length;var p=parseInt(r/this.groups,10);var e=0;for(var x=p;x<r;x+=p+1){y[x]=" "}this._grouped=true}w=B+0.5;if(this.numberTicks==null){this.numberTicks=2*B+1}var m=w-q;this.min=q;this.max=w;var o=0;var g=parseInt(3+v/10,10);var p=parseInt(B/g,10);if(this.tickInterval==null){this.tickInterval=m/(this.numberTicks-1)}for(var x=0;x<this.numberTicks;x++){b=this.min+x*this.tickInterval;var h=new this.tickRenderer(this.tickOptions);if(x/2==parseInt(x/2,10)){h.showLabel=false;h.showMark=true}else{if(p>0&&o<p){h.showLabel=false;o+=1}else{h.showLabel=true;o=0}h.label=h.formatter(h.formatString,y[(x-1)/2]);h.showMark=false;h.showGridline=false}h.setTick(b,this.name);this._ticks.push(h)}}};a.jqplot.CategoryAxisRenderer.prototype.draw=function(b,j){if(this.show){this.renderer.createTicks.call(this);var h=0;var c;if(this._elem){this._elem.emptyForce()}this._elem=this._elem||a('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>');if(this.name=="xaxis"||this.name=="x2axis"){this._elem.width(this._plotDimensions.width)}else{this._elem.height(this._plotDimensions.height)}this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var g=this._label.draw(b,j);g.appendTo(this._elem)}var f=this._ticks;for(var e=0;e<f.length;e++){var d=f[e];if(d.showLabel&&(!d.isMinorTick||this.showMinorTicks)){var g=d.draw(b,j);g.appendTo(this._elem)}}this._groupLabels=[];for(var e=0;e<this.groupLabels.length;e++){var g=a('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');g.html(this.groupLabels[e]);this._groupLabels.push(g);g.appendTo(this._elem)}}return this._elem};a.jqplot.CategoryAxisRenderer.prototype.set=function(){var e=0;var m;var k=0;var f=0;var d=(this._label==null)?false:this._label.show;if(this.show){var n=this._ticks;for(var c=0;c<n.length;c++){var g=n[c];if(g.showLabel&&(!g.isMinorTick||this.showMinorTicks)){if(this.name=="xaxis"||this.name=="x2axis"){m=g._elem.outerHeight(true)}else{m=g._elem.outerWidth(true)}if(m>e){e=m}}}var j=0;for(var c=0;c<this._groupLabels.length;c++){var b=this._groupLabels[c];if(this.name=="xaxis"||this.name=="x2axis"){m=b.outerHeight(true)}else{m=b.outerWidth(true)}if(m>j){j=m}}if(d){k=this._label._elem.outerWidth(true);f=this._label._elem.outerHeight(true)}if(this.name=="xaxis"){e+=j+f;this._elem.css({height:e+"px",left:"0px",bottom:"0px"})}else{if(this.name=="x2axis"){e+=j+f;this._elem.css({height:e+"px",left:"0px",top:"0px"})}else{if(this.name=="yaxis"){e+=j+k;this._elem.css({width:e+"px",left:"0px",top:"0px"});if(d&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",k+"px")}}else{e+=j+k;this._elem.css({width:e+"px",right:"0px",top:"0px"});if(d&&this._label.constructor==a.jqplot.AxisLabelRenderer){this._label._elem.css("width",k+"px")}}}}}};a.jqplot.CategoryAxisRenderer.prototype.pack=function(e,c){var C=this._ticks;var v=this.max;var s=this.min;var n=c.max;var l=c.min;var q=(this._label==null)?false:this._label.show;var x;for(var r in e){this._elem.css(r,e[r])}this._offsets=c;var g=n-l;var k=v-s;if(!this.reverse){this.u2p=function(h){return(h-s)*g/k+l};this.p2u=function(h){return(h-l)*k/g+s};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(h){return(h-s)*g/k};this.series_p2u=function(h){return h*k/g+s}}else{this.series_u2p=function(h){return(h-v)*g/k};this.series_p2u=function(h){return h*k/g+v}}}else{this.u2p=function(h){return l+(v-h)*g/k};this.p2u=function(h){return s+(h-l)*k/g};if(this.name=="xaxis"||this.name=="x2axis"){this.series_u2p=function(h){return(v-h)*g/k};this.series_p2u=function(h){return h*k/g+v}}else{this.series_u2p=function(h){return(s-h)*g/k};this.series_p2u=function(h){return h*k/g+s}}}if(this.show){if(this.name=="xaxis"||this.name=="x2axis"){for(x=0;x<C.length;x++){var o=C[x];if(o.show&&o.showLabel){var b;if(o.constructor==a.jqplot.CanvasAxisTickRenderer&&o.angle){var A=(this.name=="xaxis")?1:-1;switch(o.labelPosition){case"auto":if(A*o.angle<0){b=-o.getWidth()+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2}else{b=-o._textRenderer.height*Math.sin(o._textRenderer.angle)/2}break;case"end":b=-o.getWidth()+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break;case"start":b=-o._textRenderer.height*Math.sin(o._textRenderer.angle)/2;break;case"middle":b=-o.getWidth()/2+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break;default:b=-o.getWidth()/2+o._textRenderer.height*Math.sin(-o._textRenderer.angle)/2;break}}else{b=-o.getWidth()/2}var D=this.u2p(o.value)+b+"px";o._elem.css("left",D);o.pack()}}var z=["bottom",0];if(q){var m=this._label._elem.outerWidth(true);this._label._elem.css("left",l+g/2-m/2+"px");if(this.name=="xaxis"){this._label._elem.css("bottom","0px");z=["bottom",this._label._elem.outerHeight(true)]}else{this._label._elem.css("top","0px");z=["top",this._label._elem.outerHeight(true)]}this._label.pack()}var d=parseInt(this._ticks.length/this.groups,10);for(x=0;x<this._groupLabels.length;x++){var B=0;var f=0;for(var u=x*d;u<=(x+1)*d;u++){if(this._ticks[u]._elem&&this._ticks[u].label!=" "){var o=this._ticks[u]._elem;var r=o.position();B+=r.left+o.outerWidth(true)/2;f++}}B=B/f;this._groupLabels[x].css({left:(B-this._groupLabels[x].outerWidth(true)/2)});this._groupLabels[x].css(z[0],z[1])}}else{for(x=0;x<C.length;x++){var o=C[x];if(o.show&&o.showLabel){var b;if(o.constructor==a.jqplot.CanvasAxisTickRenderer&&o.angle){var A=(this.name=="yaxis")?1:-1;switch(o.labelPosition){case"auto":case"end":if(A*o.angle<0){b=-o._textRenderer.height*Math.cos(-o._textRenderer.angle)/2}else{b=-o.getHeight()+o._textRenderer.height*Math.cos(o._textRenderer.angle)/2}break;case"start":if(o.angle>0){b=-o._textRenderer.height*Math.cos(-o._textRenderer.angle)/2}else{b=-o.getHeight()+o._textRenderer.height*Math.cos(o._textRenderer.angle)/2}break;case"middle":b=-o.getHeight()/2;break;default:b=-o.getHeight()/2;break}}else{b=-o.getHeight()/2}var D=this.u2p(o.value)+b+"px";o._elem.css("top",D);o.pack()}}var z=["left",0];if(q){var y=this._label._elem.outerHeight(true);this._label._elem.css("top",n-g/2-y/2+"px");if(this.name=="yaxis"){this._label._elem.css("left","0px");z=["left",this._label._elem.outerWidth(true)]}else{this._label._elem.css("right","0px");z=["right",this._label._elem.outerWidth(true)]}this._label.pack()}var d=parseInt(this._ticks.length/this.groups,10);for(x=0;x<this._groupLabels.length;x++){var B=0;var f=0;for(var u=x*d;u<=(x+1)*d;u++){if(this._ticks[u]._elem&&this._ticks[u].label!=" "){var o=this._ticks[u]._elem;var r=o.position();B+=r.top+o.outerHeight()/2;f++}}B=B/f;this._groupLabels[x].css({top:B-this._groupLabels[x].outerHeight()/2});this._groupLabels[x].css(z[0],z[1])}}}}})(jQuery);(function($){$.jqplot.Cursor=function(options){this.style='crosshair';this.previousCursor='auto';this.show=$.jqplot.config.enablePlugins;this.showTooltip=true;this.followMouse=false;this.tooltipLocation='se';this.tooltipOffset=6;this.showTooltipGridPosition=false;this.showTooltipUnitPosition=true;this.showTooltipDataPosition=false;this.tooltipFormatString='%.4P, %.4P';this.useAxesFormatters=true;this.tooltipAxisGroups=[];this.zoom=false;this.zoomProxy=false;this.zoomTarget=false;this.looseZoom=true;this.clickReset=false;this.dblClickReset=true;this.showVerticalLine=false;this.showHorizontalLine=false;this.constrainZoomTo='none';this.shapeRenderer=new $.jqplot.ShapeRenderer();this._zoom={start:[],end:[],started:false,zooming:false,isZoomed:false,axes:{start:{},end:{}},gridpos:{},datapos:{}};this._tooltipElem;this.zoomCanvas;this.cursorCanvas;this.intersectionThreshold=2;this.showCursorLegend=false;this.cursorLegendFormatString=$.jqplot.Cursor.cursorLegendFormatString;this._oldHandlers={onselectstart:null,ondrag:null,onmousedown:null};this.constrainOutsideZoom=true;this.showTooltipOutsideZoom=false;this.onGrid=false;$.extend(true,this,options);};$.jqplot.Cursor.cursorLegendFormatString='%s x:%s, y:%s';$.jqplot.Cursor.init=function(target,data,opts){var options=opts||{};this.plugins.cursor=new $.jqplot.Cursor(options.cursor);var c=this.plugins.cursor;if(c.show){$.jqplot.eventListenerHooks.push(['jqplotMouseEnter',handleMouseEnter]);$.jqplot.eventListenerHooks.push(['jqplotMouseLeave',handleMouseLeave]);$.jqplot.eventListenerHooks.push(['jqplotMouseMove',handleMouseMove]);if(c.showCursorLegend){opts.legend=opts.legend||{};opts.legend.renderer=$.jqplot.CursorLegendRenderer;opts.legend.formatString=this.plugins.cursor.cursorLegendFormatString;opts.legend.show=true;}
if(c.zoom){$.jqplot.eventListenerHooks.push(['jqplotMouseDown',handleMouseDown]);if(c.clickReset){$.jqplot.eventListenerHooks.push(['jqplotClick',handleClick]);}
if(c.dblClickReset){$.jqplot.eventListenerHooks.push(['jqplotDblClick',handleDblClick]);}}
this.resetZoom=function(){var axes=this.axes;if(!c.zoomProxy){for(var ax in axes){axes[ax].reset();axes[ax]._ticks=[];if(c._zoom.axes[ax]!==undefined){axes[ax]._autoFormatString=c._zoom.axes[ax].tickFormatString;}}
this.redraw();}
else{var ctx=this.plugins.cursor.zoomCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx=null;}
this.plugins.cursor._zoom.isZoomed=false;this.target.trigger('jqplotResetZoom',[this,this.plugins.cursor]);};if(c.showTooltipDataPosition){c.showTooltipUnitPosition=false;c.showTooltipGridPosition=false;if(options.cursor.tooltipFormatString==undefined){c.tooltipFormatString=$.jqplot.Cursor.cursorLegendFormatString;}}}};$.jqplot.Cursor.postDraw=function(){var c=this.plugins.cursor;if(c.zoomCanvas){c.zoomCanvas.resetCanvas();c.zoomCanvas=null;}
if(c.cursorCanvas){c.cursorCanvas.resetCanvas();c.cursorCanvas=null;}
if(c._tooltipElem){c._tooltipElem.emptyForce();c._tooltipElem=null;}
if(c.zoom){c.zoomCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(c.zoomCanvas.createElement(this._gridPadding,'jqplot-zoom-canvas',this._plotDimensions,this));c.zoomCanvas.setContext();}
var elem=document.createElement('div');c._tooltipElem=$(elem);elem=null;c._tooltipElem.addClass('jqplot-cursor-tooltip');c._tooltipElem.css({position:'absolute',display:'none'});if(c.zoomCanvas){c.zoomCanvas._elem.before(c._tooltipElem);}
else{this.eventCanvas._elem.before(c._tooltipElem);}
if(c.showVerticalLine||c.showHorizontalLine){c.cursorCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(c.cursorCanvas.createElement(this._gridPadding,'jqplot-cursor-canvas',this._plotDimensions,this));c.cursorCanvas.setContext();}
if(c.showTooltipUnitPosition){if(c.tooltipAxisGroups.length===0){var series=this.series;var s;var temp=[];for(var i=0;i<series.length;i++){s=series[i];var ax=s.xaxis+','+s.yaxis;if($.inArray(ax,temp)==-1){temp.push(ax);}}
for(var i=0;i<temp.length;i++){c.tooltipAxisGroups.push(temp[i].split(','));}}}};$.jqplot.Cursor.zoomProxy=function(targetPlot,controllerPlot){var tc=targetPlot.plugins.cursor;var cc=controllerPlot.plugins.cursor;tc.zoomTarget=true;tc.zoom=true;tc.style='auto';tc.dblClickReset=false;cc.zoom=true;cc.zoomProxy=true;controllerPlot.target.bind('jqplotZoom',plotZoom);controllerPlot.target.bind('jqplotResetZoom',plotReset);function plotZoom(ev,gridpos,datapos,plot,cursor){tc.doZoom(gridpos,datapos,targetPlot,cursor);}
function plotReset(ev,plot,cursor){targetPlot.resetZoom();}};$.jqplot.Cursor.prototype.resetZoom=function(plot,cursor){var axes=plot.axes;var cax=cursor._zoom.axes;if(!plot.plugins.cursor.zoomProxy&&cursor._zoom.isZoomed){for(var ax in axes){axes[ax].reset();axes[ax]._ticks=[];axes[ax]._autoFormatString=cax[ax].tickFormatString;}
plot.redraw();cursor._zoom.isZoomed=false;}
else{var ctx=cursor.zoomCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx=null;}
plot.target.trigger('jqplotResetZoom',[plot,cursor]);};$.jqplot.Cursor.resetZoom=function(plot){plot.resetZoom();};$.jqplot.Cursor.prototype.doZoom=function(gridpos,datapos,plot,cursor){var c=cursor;var axes=plot.axes;var zaxes=c._zoom.axes;var start=zaxes.start;var end=zaxes.end;var min,max,dp,span,newmin,newmax,curax,_numberTicks,ret;var ctx=plot.plugins.cursor.zoomCanvas._ctx;if((c.constrainZoomTo=='none'&&Math.abs(gridpos.x-c._zoom.start[0])>6&&Math.abs(gridpos.y-c._zoom.start[1])>6)||(c.constrainZoomTo=='x'&&Math.abs(gridpos.x-c._zoom.start[0])>6)||(c.constrainZoomTo=='y'&&Math.abs(gridpos.y-c._zoom.start[1])>6)){if(!plot.plugins.cursor.zoomProxy){for(var ax in datapos){if(c._zoom.axes[ax]==undefined){c._zoom.axes[ax]={};c._zoom.axes[ax].numberTicks=axes[ax].numberTicks;c._zoom.axes[ax].tickInterval=axes[ax].tickInterval;c._zoom.axes[ax].daTickInterval=axes[ax].daTickInterval;c._zoom.axes[ax].min=axes[ax].min;c._zoom.axes[ax].max=axes[ax].max;c._zoom.axes[ax].tickFormatString=(axes[ax].tickOptions!=null)?axes[ax].tickOptions.formatString:'';}
if((c.constrainZoomTo=='none')||(c.constrainZoomTo=='x'&&ax.charAt(0)=='x')||(c.constrainZoomTo=='y'&&ax.charAt(0)=='y')){dp=datapos[ax];if(dp!=null){if(dp>start[ax]){newmin=start[ax];newmax=dp;}
else{span=start[ax]-dp;newmin=dp;newmax=start[ax];}
curax=axes[ax];_numberTicks=null;if(curax.alignTicks){if(curax.name==='x2axis'&&plot.axes.xaxis.show){_numberTicks=plot.axes.xaxis.numberTicks;}
else if(curax.name.charAt(0)==='y'&&curax.name!=='yaxis'&&curax.name!=='yMidAxis'&&plot.axes.yaxis.show){_numberTicks=plot.axes.yaxis.numberTicks;}}
if(this.looseZoom&&(axes[ax].renderer.constructor===$.jqplot.LinearAxisRenderer||axes[ax].renderer.constructor===$.jqplot.LogAxisRenderer)){ret=$.jqplot.LinearTickGenerator(newmin,newmax,curax._scalefact,_numberTicks);if(axes[ax].tickInset&&ret[0]<axes[ax].min+axes[ax].tickInset*axes[ax].tickInterval){ret[0]+=ret[4];ret[2]-=1;}
if(axes[ax].tickInset&&ret[1]>axes[ax].max-axes[ax].tickInset*axes[ax].tickInterval){ret[1]-=ret[4];ret[2]-=1;}
if(axes[ax].renderer.constructor===$.jqplot.LogAxisRenderer&&ret[0]<axes[ax].min){ret[0]+=ret[4];ret[2]-=1;}
axes[ax].min=ret[0];axes[ax].max=ret[1];axes[ax]._autoFormatString=ret[3];axes[ax].numberTicks=ret[2];axes[ax].tickInterval=ret[4];axes[ax].daTickInterval=[ret[4]/1000,'seconds'];}
else{axes[ax].min=newmin;axes[ax].max=newmax;axes[ax].tickInterval=null;axes[ax].numberTicks=null;axes[ax].daTickInterval=null;}
axes[ax]._ticks=[];}}}
ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);plot.redraw();c._zoom.isZoomed=true;ctx=null;}
plot.target.trigger('jqplotZoom',[gridpos,datapos,plot,cursor]);}};$.jqplot.preInitHooks.push($.jqplot.Cursor.init);$.jqplot.postDrawHooks.push($.jqplot.Cursor.postDraw);function updateTooltip(gridpos,datapos,plot){var c=plot.plugins.cursor;var s='';var addbr=false;if(c.showTooltipGridPosition){s=gridpos.x+', '+gridpos.y;addbr=true;}
if(c.showTooltipUnitPosition){var g;for(var i=0;i<c.tooltipAxisGroups.length;i++){g=c.tooltipAxisGroups[i];if(addbr){s+='<br />';}
if(c.useAxesFormatters){for(var j=0;j<g.length;j++){if(j){s+=', ';}
var af=plot.axes[g[j]]._ticks[0].formatter;var afstr=plot.axes[g[j]]._ticks[0].formatString;s+=af(afstr,datapos[g[j]]);}}
else{s+=$.jqplot.sprintf(c.tooltipFormatString,datapos[g[0]],datapos[g[1]]);}
addbr=true;}}
if(c.showTooltipDataPosition){var series=plot.series;var ret=getIntersectingPoints(plot,gridpos.x,gridpos.y);var addbr=false;for(var i=0;i<series.length;i++){if(series[i].show){var idx=series[i].index;var label=series[i].label.toString();var cellid=$.inArray(idx,ret.indices);var sx=undefined;var sy=undefined;if(cellid!=-1){var data=ret.data[cellid].data;if(c.useAxesFormatters){var xf=series[i]._xaxis._ticks[0].formatter;var yf=series[i]._yaxis._ticks[0].formatter;var xfstr=series[i]._xaxis._ticks[0].formatString;var yfstr=series[i]._yaxis._ticks[0].formatString;sx=xf(xfstr,data[0]);sy=yf(yfstr,data[1]);}
else{sx=data[0];sy=data[1];}
if(addbr){s+='<br />';}
s+=$.jqplot.sprintf(c.tooltipFormatString,label,sx,sy);addbr=true;}}}}
c._tooltipElem.html(s);}
function moveLine(gridpos,plot){var c=plot.plugins.cursor;var ctx=c.cursorCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);if(c.showVerticalLine){c.shapeRenderer.draw(ctx,[[gridpos.x,0],[gridpos.x,ctx.canvas.height]]);}
if(c.showHorizontalLine){c.shapeRenderer.draw(ctx,[[0,gridpos.y],[ctx.canvas.width,gridpos.y]]);}
var ret=getIntersectingPoints(plot,gridpos.x,gridpos.y);if(c.showCursorLegend){var cells=$(plot.targetId+' td.jqplot-cursor-legend-label');for(var i=0;i<cells.length;i++){var idx=$(cells[i]).data('seriesIndex');var series=plot.series[idx];var label=series.label.toString();var cellid=$.inArray(idx,ret.indices);var sx=undefined;var sy=undefined;if(cellid!=-1){var data=ret.data[cellid].data;if(c.useAxesFormatters){var xf=series._xaxis._ticks[0].formatter;var yf=series._yaxis._ticks[0].formatter;var xfstr=series._xaxis._ticks[0].formatString;var yfstr=series._yaxis._ticks[0].formatString;sx=xf(xfstr,data[0]);sy=yf(yfstr,data[1]);}
else{sx=data[0];sy=data[1];}}
if(plot.legend.escapeHtml){$(cells[i]).text($.jqplot.sprintf(c.cursorLegendFormatString,label,sx,sy));}
else{$(cells[i]).html($.jqplot.sprintf(c.cursorLegendFormatString,label,sx,sy));}}}
ctx=null;}
function getIntersectingPoints(plot,x,y){var ret={indices:[],data:[]};var s,i,d0,d,j,r,p;var threshold;var c=plot.plugins.cursor;for(var i=0;i<plot.series.length;i++){s=plot.series[i];r=s.renderer;if(s.show){threshold=c.intersectionThreshold;if(s.showMarker){threshold+=s.markerRenderer.size/2;}
for(var j=0;j<s.gridData.length;j++){p=s.gridData[j];if(c.showVerticalLine){if(Math.abs(x-p[0])<=threshold){ret.indices.push(i);ret.data.push({seriesIndex:i,pointIndex:j,gridData:p,data:s.data[j]});}}}}}
return ret;}
function moveTooltip(gridpos,plot){var c=plot.plugins.cursor;var elem=c._tooltipElem;switch(c.tooltipLocation){case'nw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top-c.tooltipOffset-elem.outerHeight(true);break;case'n':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top-c.tooltipOffset-elem.outerHeight(true);break;case'ne':var x=gridpos.x+plot._gridPadding.left+c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top-c.tooltipOffset-elem.outerHeight(true);break;case'e':var x=gridpos.x+plot._gridPadding.left+c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;case'se':var x=gridpos.x+plot._gridPadding.left+c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top+c.tooltipOffset;break;case's':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top+c.tooltipOffset;break;case'sw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top+c.tooltipOffset;break;case'w':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;default:var x=gridpos.x+plot._gridPadding.left+c.tooltipOffset;var y=gridpos.y+plot._gridPadding.top+c.tooltipOffset;break;}
elem.css('left',x);elem.css('top',y);elem=null;}
function positionTooltip(plot){var grid=plot._gridPadding;var c=plot.plugins.cursor;var elem=c._tooltipElem;switch(c.tooltipLocation){case'nw':var a=grid.left+c.tooltipOffset;var b=grid.top+c.tooltipOffset;elem.css('left',a);elem.css('top',b);break;case'n':var a=(grid.left+(plot._plotDimensions.width-grid.right))/2-elem.outerWidth(true)/2;var b=grid.top+c.tooltipOffset;elem.css('left',a);elem.css('top',b);break;case'ne':var a=grid.right+c.tooltipOffset;var b=grid.top+c.tooltipOffset;elem.css({right:a,top:b});break;case'e':var a=grid.right+c.tooltipOffset;var b=(grid.top+(plot._plotDimensions.height-grid.bottom))/2-elem.outerHeight(true)/2;elem.css({right:a,top:b});break;case'se':var a=grid.right+c.tooltipOffset;var b=grid.bottom+c.tooltipOffset;elem.css({right:a,bottom:b});break;case's':var a=(grid.left+(plot._plotDimensions.width-grid.right))/2-elem.outerWidth(true)/2;var b=grid.bottom+c.tooltipOffset;elem.css({left:a,bottom:b});break;case'sw':var a=grid.left+c.tooltipOffset;var b=grid.bottom+c.tooltipOffset;elem.css({left:a,bottom:b});break;case'w':var a=grid.left+c.tooltipOffset;var b=(grid.top+(plot._plotDimensions.height-grid.bottom))/2-elem.outerHeight(true)/2;elem.css({left:a,top:b});break;default:var a=grid.right-c.tooltipOffset;var b=grid.bottom+c.tooltipOffset;elem.css({right:a,bottom:b});break;}
elem=null;}
function handleClick(ev,gridpos,datapos,neighbor,plot){ev.preventDefault();ev.stopImmediatePropagation();var c=plot.plugins.cursor;if(c.clickReset){c.resetZoom(plot,c);}
var sel=window.getSelection;if(document.selection&&document.selection.empty)
{document.selection.empty();}
else if(sel&&!sel().isCollapsed){sel().collapse();}
return false;}
function handleDblClick(ev,gridpos,datapos,neighbor,plot){ev.preventDefault();ev.stopImmediatePropagation();var c=plot.plugins.cursor;if(c.dblClickReset){c.resetZoom(plot,c);}
var sel=window.getSelection;if(document.selection&&document.selection.empty)
{document.selection.empty();}
else if(sel&&!sel().isCollapsed){sel().collapse();}
return false;}
function handleMouseLeave(ev,gridpos,datapos,neighbor,plot){var c=plot.plugins.cursor;c.onGrid=false;if(c.show){$(ev.target).css('cursor',c.previousCursor);if(c.showTooltip&&!(c._zoom.zooming&&c.showTooltipOutsideZoom&&!c.constrainOutsideZoom)){c._tooltipElem.empty();c._tooltipElem.hide();}
if(c.zoom){c._zoom.gridpos=gridpos;c._zoom.datapos=datapos;}
if(c.showVerticalLine||c.showHorizontalLine){var ctx=c.cursorCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx=null;}
if(c.showCursorLegend){var cells=$(plot.targetId+' td.jqplot-cursor-legend-label');for(var i=0;i<cells.length;i++){var idx=$(cells[i]).data('seriesIndex');var series=plot.series[idx];var label=series.label.toString();if(plot.legend.escapeHtml){$(cells[i]).text($.jqplot.sprintf(c.cursorLegendFormatString,label,undefined,undefined));}
else{$(cells[i]).html($.jqplot.sprintf(c.cursorLegendFormatString,label,undefined,undefined));}}}}}
function handleMouseEnter(ev,gridpos,datapos,neighbor,plot){var c=plot.plugins.cursor;c.onGrid=true;if(c.show){c.previousCursor=ev.target.style.cursor;ev.target.style.cursor=c.style;if(c.showTooltip){updateTooltip(gridpos,datapos,plot);if(c.followMouse){moveTooltip(gridpos,plot);}
else{positionTooltip(plot);}
c._tooltipElem.show();}
if(c.showVerticalLine||c.showHorizontalLine){moveLine(gridpos,plot);}}}
function handleMouseMove(ev,gridpos,datapos,neighbor,plot){var c=plot.plugins.cursor;if(c.show){if(c.showTooltip){updateTooltip(gridpos,datapos,plot);if(c.followMouse){moveTooltip(gridpos,plot);}}
if(c.showVerticalLine||c.showHorizontalLine){moveLine(gridpos,plot);}}}
function getEventPosition(ev){var plot=ev.data.plot;var go=plot.eventCanvas._elem.offset();var gridPos={x:ev.pageX-go.left,y:ev.pageY-go.top};var dataPos={xaxis:null,yaxis:null,x2axis:null,y2axis:null,y3axis:null,y4axis:null,y5axis:null,y6axis:null,y7axis:null,y8axis:null,y9axis:null,yMidAxis:null};var an=['xaxis','yaxis','x2axis','y2axis','y3axis','y4axis','y5axis','y6axis','y7axis','y8axis','y9axis','yMidAxis'];var ax=plot.axes;var n,axis;for(n=11;n>0;n--){axis=an[n-1];if(ax[axis].show){dataPos[axis]=ax[axis].series_p2u(gridPos[axis.charAt(0)]);}}
return{offsets:go,gridPos:gridPos,dataPos:dataPos};}
function handleZoomMove(ev){var plot=ev.data.plot;var c=plot.plugins.cursor;if(c.show&&c.zoom&&c._zoom.started&&!c.zoomTarget){ev.preventDefault();var ctx=c.zoomCanvas._ctx;var positions=getEventPosition(ev);var gridpos=positions.gridPos;var datapos=positions.dataPos;c._zoom.gridpos=gridpos;c._zoom.datapos=datapos;c._zoom.zooming=true;var xpos=gridpos.x;var ypos=gridpos.y;var height=ctx.canvas.height;var width=ctx.canvas.width;if(c.showTooltip&&!c.onGrid&&c.showTooltipOutsideZoom){updateTooltip(gridpos,datapos,plot);if(c.followMouse){moveTooltip(gridpos,plot);}}
if(c.constrainZoomTo=='x'){c._zoom.end=[xpos,height];}
else if(c.constrainZoomTo=='y'){c._zoom.end=[width,ypos];}
else{c._zoom.end=[xpos,ypos];}
var sel=window.getSelection;if(document.selection&&document.selection.empty)
{document.selection.empty();}
else if(sel&&!sel().isCollapsed){sel().collapse();}
drawZoomBox.call(c);ctx=null;}}
function handleMouseDown(ev,gridpos,datapos,neighbor,plot){var c=plot.plugins.cursor;if(plot.plugins.mobile){$(document).one('vmouseup.jqplot_cursor',{plot:plot},handleMouseUp);}else{$(document).one('mouseup.jqplot_cursor',{plot:plot},handleMouseUp);}
var axes=plot.axes;if(document.onselectstart!=undefined){c._oldHandlers.onselectstart=document.onselectstart;document.onselectstart=function(){return false;};}
if(document.ondrag!=undefined){c._oldHandlers.ondrag=document.ondrag;document.ondrag=function(){return false;};}
if(document.onmousedown!=undefined){c._oldHandlers.onmousedown=document.onmousedown;document.onmousedown=function(){return false;};}
if(c.zoom){if(!c.zoomProxy){var ctx=c.zoomCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx=null;}
if(c.constrainZoomTo=='x'){c._zoom.start=[gridpos.x,0];}
else if(c.constrainZoomTo=='y'){c._zoom.start=[0,gridpos.y];}
else{c._zoom.start=[gridpos.x,gridpos.y];}
c._zoom.started=true;for(var ax in datapos){c._zoom.axes.start[ax]=datapos[ax];}
if(plot.plugins.mobile){$(document).bind('vmousemove.jqplotCursor',{plot:plot},handleZoomMove);}else{$(document).bind('mousemove.jqplotCursor',{plot:plot},handleZoomMove);}}}
function handleMouseUp(ev){var plot=ev.data.plot;var c=plot.plugins.cursor;if(c.zoom&&c._zoom.zooming&&!c.zoomTarget){var xpos=c._zoom.gridpos.x;var ypos=c._zoom.gridpos.y;var datapos=c._zoom.datapos;var height=c.zoomCanvas._ctx.canvas.height;var width=c.zoomCanvas._ctx.canvas.width;var axes=plot.axes;if(c.constrainOutsideZoom&&!c.onGrid){if(xpos<0){xpos=0;}
else if(xpos>width){xpos=width;}
if(ypos<0){ypos=0;}
else if(ypos>height){ypos=height;}
for(var axis in datapos){if(datapos[axis]){if(axis.charAt(0)=='x'){datapos[axis]=axes[axis].series_p2u(xpos);}
else{datapos[axis]=axes[axis].series_p2u(ypos);}}}}
if(c.constrainZoomTo=='x'){ypos=height;}
else if(c.constrainZoomTo=='y'){xpos=width;}
c._zoom.end=[xpos,ypos];c._zoom.gridpos={x:xpos,y:ypos};c.doZoom(c._zoom.gridpos,datapos,plot,c);}
c._zoom.started=false;c._zoom.zooming=false;$(document).unbind('mousemove.jqplotCursor',handleZoomMove);if(document.onselectstart!=undefined&&c._oldHandlers.onselectstart!=null){document.onselectstart=c._oldHandlers.onselectstart;c._oldHandlers.onselectstart=null;}
if(document.ondrag!=undefined&&c._oldHandlers.ondrag!=null){document.ondrag=c._oldHandlers.ondrag;c._oldHandlers.ondrag=null;}
if(document.onmousedown!=undefined&&c._oldHandlers.onmousedown!=null){document.onmousedown=c._oldHandlers.onmousedown;c._oldHandlers.onmousedown=null;}}
function drawZoomBox(){var start=this._zoom.start;var end=this._zoom.end;var ctx=this.zoomCanvas._ctx;var l,t,h,w;if(end[0]>start[0]){l=start[0];w=end[0]-start[0];}
else{l=end[0];w=start[0]-end[0];}
if(end[1]>start[1]){t=start[1];h=end[1]-start[1];}
else{t=end[1];h=start[1]-end[1];}
ctx.fillStyle='rgba(0,0,0,0.2)';ctx.strokeStyle='#999999';ctx.lineWidth=1.0;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx.fillRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx.clearRect(l,t,w,h);ctx.strokeRect(l,t,w,h);ctx=null;}
$.jqplot.CursorLegendRenderer=function(options){$.jqplot.TableLegendRenderer.call(this,options);this.formatString='%s';};$.jqplot.CursorLegendRenderer.prototype=new $.jqplot.TableLegendRenderer();$.jqplot.CursorLegendRenderer.prototype.constructor=$.jqplot.CursorLegendRenderer;$.jqplot.CursorLegendRenderer.prototype.draw=function(){if(this._elem){this._elem.emptyForce();this._elem=null;}
if(this.show){var series=this._series,s;var elem=document.createElement('div');this._elem=$(elem);elem=null;this._elem.addClass('jqplot-legend jqplot-cursor-legend');this._elem.css('position','absolute');var pad=false;for(var i=0;i<series.length;i++){s=series[i];if(s.show&&s.showLabel){var lt=$.jqplot.sprintf(this.formatString,s.label.toString());if(lt){var color=s.color;if(s._stack&&!s.fill){color='';}
addrow.call(this,lt,color,pad,i);pad=true;}
for(var j=0;j<$.jqplot.addLegendRowHooks.length;j++){var item=$.jqplot.addLegendRowHooks[j].call(this,s);if(item){addrow.call(this,item.label,item.color,pad);pad=true;}}}}
series=s=null;delete series;delete s;}
function addrow(label,color,pad,idx){var rs=(pad)?this.rowSpacing:'0';var tr=$('<tr class="jqplot-legend jqplot-cursor-legend"></tr>').appendTo(this._elem);tr.data('seriesIndex',idx);$('<td class="jqplot-legend jqplot-cursor-legend-swatch" style="padding-top:'+rs+';">'+'<div style="border:1px solid #cccccc;padding:0.2em;">'+'<div class="jqplot-cursor-legend-swatch" style="background-color:'+color+';"></div>'+'</div></td>').appendTo(tr);var td=$('<td class="jqplot-legend jqplot-cursor-legend-label" style="vertical-align:middle;padding-top:'+rs+';"></td>');td.appendTo(tr);td.data('seriesIndex',idx);if(this.escapeHtml){td.text(label);}
else{td.html(label);}
tr=null;td=null;}
return this._elem;};})(jQuery);(function($){$.jqplot.DateAxisRenderer=function(){$.jqplot.LinearAxisRenderer.call(this);this.date=new $.jsDate();};var second=1000;var minute=60*second;var hour=60*minute;var day=24*hour;var week=7*day;var month=30.4368499*day;var year=365.242199*day;var daysInMonths=[31,28,31,30,31,30,31,30,31,30,31,30];var niceFormatStrings=['%M:%S.%#N','%M:%S.%#N','%M:%S.%#N','%M:%S','%M:%S','%M:%S','%M:%S','%H:%M:%S','%H:%M:%S','%H:%M','%H:%M','%H:%M','%H:%M','%H:%M','%H:%M','%a %H:%M','%a %H:%M','%b %e %H:%M','%b %e %H:%M','%b %e %H:%M','%b %e %H:%M','%v','%v','%v','%v','%v','%v','%v'];var niceIntervals=[0.1*second,0.2*second,0.5*second,second,2*second,5*second,10*second,15*second,30*second,minute,2*minute,5*minute,10*minute,15*minute,30*minute,hour,2*hour,4*hour,6*hour,8*hour,12*hour,day,2*day,3*day,4*day,5*day,week,2*week];var niceMonthlyIntervals=[];function bestDateInterval(min,max,titarget){var badness=Number.MAX_VALUE;var temp,bestTi,bestfmt;for(var i=0,l=niceIntervals.length;i<l;i++){temp=Math.abs(titarget-niceIntervals[i]);if(temp<badness){badness=temp;bestTi=niceIntervals[i];bestfmt=niceFormatStrings[i];}}
return[bestTi,bestfmt];}
$.jqplot.DateAxisRenderer.prototype=new $.jqplot.LinearAxisRenderer();$.jqplot.DateAxisRenderer.prototype.constructor=$.jqplot.DateAxisRenderer;$.jqplot.DateTickFormatter=function(format,val){if(!format){format='%Y/%m/%d';}
return $.jsDate.strftime(val,format);};$.jqplot.DateTickFormatterSpecialPhys=function(format,val){var iDate=$.jsDate.createDate(Math.abs(val));var df=MP_Util.GetDateFormatter();var iDate2=df.format(iDate,mp_formatter.DateTimeFormatter.FULL_DATE_2YEAR);var iDate4=df.format(iDate,mp_formatter.DateTimeFormatter.FULL_DATE_4YEAR);var curDtTm=new Date;curDtTm.setMilliseconds(0);curDtTm.setSeconds(0);if(iDate.getMilliseconds()==0&&iDate.getSeconds()==0&&iDate.getMinutes()==0&&iDate.getHours()==0){var nFormat="<span>"+iDate2+"</span><br/><span>&nbsp;</span>%H:%M";}
else{var nFormat="<span>%H:%M</span>";}
return $.jsDate.strftime(val,nFormat);};$.jqplot.DateTickFormatterSpecial=function(format,val){var curDtTm=new Date();curDtTm.setMilliseconds(0);curDtTm.setSeconds(0);var nFormat="<span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;%H:%M</span><span class='jqplot-elem-hideOnHover nowTime'>%H:%M</span>";return $.jsDate.strftime(val,nFormat);};$.jqplot.DateTickFormatterXSpecial=function(format,val){var iDate=$.jsDate.createDate(Math.abs(val));var curDtTm=new Date();curDtTm.setMilliseconds(0);curDtTm.setSeconds(0);var nFormat=format;if(DAR_HELPERS.createdNow&&iDate.getTime()==curDtTm.getTime()){nFormat="<span class='jqplot-elem-hideOnHover'>&nbsp;</span><span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;%H:%M</span>";}
else if(siDate.getMilliseconds()==0&&iDate.getSeconds()==0&&iDate.getMinutes()==0&&iDate.getHours()==0){nFormat="<span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;</span>%H:%M<br class='jqplot-elem-hideOnHover'/><span class='jqplot-elem-hideOnHover'>%#m/%#d/%y</span>";}
else{nFormat="<span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;</span>%H:%M";}
return $.jsDate.strftime(val,nFormat);};$.jqplot.DateTickFormatterX2Special=function(format,val){var iDate=$.jsDate.createDate(Math.abs(val));var df=MP_Util.GetDateFormatter();var iDate2=df.format(iDate,mp_formatter.DateTimeFormatter.FULL_DATE_2YEAR);var iDate4=df.format(iDate,mp_formatter.DateTimeFormatter.FULL_DATE_4YEAR);var curDtTm=new Date();curDtTm.setMilliseconds(0);curDtTm.setSeconds(0);var nFormat=format;if(DAR_HELPERS.createdNow&&iDate.getTime()==curDtTm.getTime()){nFormat="<span class='jqplot-elem-hideOnHover'>&nbsp;</span><span class='jqplot-elem-showOnHover'>"+iDate4+"&nbsp;%H:%M</span>";}
else if(iDate.getMilliseconds()==0&&iDate.getSeconds()==0&&iDate.getMinutes()==0&&iDate.getHours()==0){nFormat="<span class='jqplot-elem-showOnHover'>"+iDate4+"</span><span class='jqplot-elem-hideOnHover'>"+iDate2+"</span><br class='jqplot-elem-hideOnHover'/><span class='jqplot-elem-showOnHover'>&nbsp;</span>%H:%M";}
else{nFormat="<span class='jqplot-elem-showOnHover'>"+iDate4+"</span>&nbsp;<br class='jqplot-elem-hideOnHover'/>%H:%M";}
return $.jsDate.strftime(val,nFormat);};$.jqplot.DateTickFormatterYSpecial=function(format,val){var iDate=$.jsDate.createDate(Math.abs(val));var curDtTm=new Date();curDtTm.setMilliseconds(0);curDtTm.setSeconds(0);var nFormat=format;if(DAR_HELPERS.createdNow&&iDate.getTime()==curDtTm.getTime()){nFormat="<span class='jqplot-elem-hideOnHover'>&nbsp;</span><span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;%H:%M</span>";}
else if(iDate.getMilliseconds()==0&&iDate.getSeconds()==0&&iDate.getMinutes()==0&&iDate.getHours()==0){nFormat="%#m/%#d/<span class='jqplot-elem-showOnHover'>%Y</span><span class='jqplot-elem-hideOnHover'>%y</span><br class='jqplot-elem-hideOnHover'/><span class='jqplot-elem-showOnHover'>&nbsp;</span>%H:%M";}
else{nFormat="<span class='jqplot-elem-showOnHover'>%#m/%#d/%Y&nbsp;</span>%H:%M";}
return $.jsDate.strftime(val,nFormat);};$.jqplot.DateAxisRenderer.prototype.init=function(options){this.tickOptions.formatter=$.jqplot.DateTickFormatter;this.tickInset=0;this.drawBaseline=true;this.baselineWidth=null;this.baselineColor=null;this.daTickInterval=null;this._daTickInterval=null;$.extend(true,this,options);if(this.specialFormat&&this.specialFormatFlag!=null&&this.specialFormatFlag==3)
{this.tickOptions.formatter=$.jqplot.DateTickFormatterSpecialPhys;}
else if(this.specialFormat&&this.specialFormatFlag!=null&&this.specialFormatFlag==1){this.tickOptions.formatter=$.jqplot.DateTickFormatterSpecial;}
else if(this.specialFormat&&this.name.match("xaxis")!=null){this.tickOptions.formatter=$.jqplot.DateTickFormatterXSpecial;}
else if(this.specialFormat&&this.name.match(/^x/)!=null){this.tickOptions.formatter=$.jqplot.DateTickFormatterX2Special;}
else if(this.specialFormat&&this.name.match(/^y/)!=null){this.tickOptions.formatter=$.jqplot.DateTickFormatterYSpecial;}
else{this.tickOptions.formatter=$.jqplot.DateTickFormatter;}
var db=this._dataBounds,stats,sum,s,d,pd,sd,intv;for(var i=0;i<this._series.length;i++){stats={intervals:[],frequencies:{},sortedIntervals:[],min:null,max:null,mean:null};sum=0;s=this._series[i];d=s.data;pd=s._plotData;sd=s._stackData;intv=0;for(var j=0;j<d.length;j++){if(this.name=='xaxis'||this.name=='x2axis'){d[j][0]=new $.jsDate(d[j][0]).getTime();pd[j][0]=new $.jsDate(d[j][0]).getTime();sd[j][0]=new $.jsDate(d[j][0]).getTime();if((d[j][0]!=null&&d[j][0]<db.min)||db.min==null){db.min=d[j][0];}
if((d[j][0]!=null&&d[j][0]>db.max)||db.max==null){db.max=d[j][0];}
if(j>0){intv=Math.abs(d[j][0]-d[j-1][0]);stats.intervals.push(intv);if(stats.frequencies.hasOwnProperty(intv)){stats.frequencies[intv]+=1;}
else{stats.frequencies[intv]=1;}}
sum+=intv;}
else{d[j][1]=new $.jsDate(d[j][1]).getTime();pd[j][1]=new $.jsDate(d[j][1]).getTime();sd[j][1]=new $.jsDate(d[j][1]).getTime();if((d[j][1]!=null&&d[j][1]<db.min)||db.min==null){db.min=d[j][1];}
if((d[j][1]!=null&&d[j][1]>db.max)||db.max==null){db.max=d[j][1];}
if(j>0){intv=Math.abs(d[j][1]-d[j-1][1]);stats.intervals.push(intv);if(stats.frequencies.hasOwnProperty(intv)){stats.frequencies[intv]+=1;}
else{stats.frequencies[intv]=1;}}}
sum+=intv;}
if(s.renderer.bands){if(s.renderer.bands.hiData.length){var bd=s.renderer.bands.hiData;for(var j=0,l=bd.length;j<l;j++){if(this.name==='xaxis'||this.name==='x2axis'){bd[j][0]=new $.jsDate(bd[j][0]).getTime();if((bd[j][0]!=null&&bd[j][0]>db.max)||db.max==null){db.max=bd[j][0];}}
else{bd[j][1]=new $.jsDate(bd[j][1]).getTime();if((bd[j][1]!=null&&bd[j][1]>db.max)||db.max==null){db.max=bd[j][1];}}}}
if(s.renderer.bands.lowData.length){var bd=s.renderer.bands.lowData;for(var j=0,l=bd.length;j<l;j++){if(this.name==='xaxis'||this.name==='x2axis'){bd[j][0]=new $.jsDate(bd[j][0]).getTime();if((bd[j][0]!=null&&bd[j][0]<db.min)||db.min==null){db.min=bd[j][0];}}
else{bd[j][1]=new $.jsDate(bd[j][1]).getTime();if((bd[j][1]!=null&&bd[j][1]<db.min)||db.min==null){db.min=bd[j][1];}}}}}
var tempf=0,tempn=0;for(var n in stats.frequencies){stats.sortedIntervals.push({interval:n,frequency:stats.frequencies[n]});}
stats.sortedIntervals.sort(function(a,b){return b.frequency-a.frequency;});stats.min=$.jqplot.arrayMin(stats.intervals);stats.max=$.jqplot.arrayMax(stats.intervals);stats.mean=sum/d.length;this._intervalStats.push(stats);stats=sum=s=d=pd=sd=null;}
db=null;};$.jqplot.DateAxisRenderer.prototype.reset=function(){this.min=this._options.min;this.max=this._options.max;this.tickInterval=this._options.tickInterval;this.numberTicks=this._options.numberTicks;this._autoFormatString='';if(this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString){this.tickOptions.formatString='';}
this.daTickInterval=this._daTickInterval;this.useDST=this._useDST;this.specialFormat=this._specialFormat;this.specialFormatFlag=this._specialFormatFlag;};$.jqplot.DateAxisRenderer.prototype.createTicks=function(){var ticks=this._ticks;var userTicks=this.ticks;var name=this.name;var db=this._dataBounds;var midnightExists=false;var dim,interval;var min,max;var pos1,pos2;var tt,i;if(this.specialFormat)
{if(this.specialFormatFlag==null||(this.specialFormatFlag!=1&&this.specialFormatFlag!=3)){var minDtTm=$.jsDate.createDate(this.min);var maxDtTm=$.jsDate.createDate(this.max);DAR_HELPERS.createdNow=true;var tickVals=DAR_HELPERS.DynamicRangeTickCalc(minDtTm.getTime(),maxDtTm.getTime());this.numberTicks=tickVals.length;userTicks=tickVals;midnightExists=false;for(var i=0;i<userTicks.length;i++)
{var tDate=$.jsDate.createDate(userTicks[i]);if(tDate.getMilliseconds()==0&&tDate.getSeconds()==0&&tDate.getMinutes()==0&&tDate.getHours()==0)
midnightExists=true;}
this.min=tickVals[0];this.max=tickVals[tickVals.length-1];this.daTickInterval=[(this.max-this.min)/(this.numberTicks-1)/1000,'seconds'];}
else if(this.specialFormatFlag==3){var threshold=30;var insetMult=1;var tickInterval=this.tickInterval;min=((this.min!=null)?new $.jsDate(this.min).getTime():db.min);max=((this.max!=null)?new $.jsDate(this.max).getTime():db.max);var range=max-min;if(this.tickOptions==null||!this.tickOptions.formatString){this._overrideFormatString=true;}}
else if(this.specialFormatFlag==1){userTicks=[new Date().getTime()];}
if(this.specialFormatFlag==2)
{var tempTicks=[],cDiffOpt=null,cDiff=null;for(var i=0;i<userTicks.length;i++)
{var t1Time=(userTicks[i].constructor==Array)?userTicks[i][0]:userTicks[i];if(i==0)
tempTicks.push(t1Time);else
{var t2Time=(userTicks[i-1].constructor==Array)?userTicks[i-1][0]:userTicks[i-1];cDiff=t1Time-t2Time;var t1Date=$.jsDate.createDate(t1Time),t2Date=$.jsDate.createDate(t2Time);eval(["t1Date.set",DAR_HELPERS.tickDiff[1],"(t1Date.get",DAR_HELPERS.tickDiff[1],"()-DAR_HELPERS.tickDiff[0]);"].join(""));if(t1Date.getTime()==t2Date.getTime())
{tempTicks.push(Math.round(t2Time+(cDiff/2)));tempTicks.push(t1Time);}
else
{if(DAR_HELPERS.tickDiff[0]==1&&DAR_HELPERS.tickDiff[1]=="Date")
t2Date.setHours(t2Date.getHours()+12);else if(DAR_HELPERS.tickDiff[0]==1&&DAR_HELPERS.tickDiff[1]=="Month")
t2Date.setDate(t2Date.getDate()+15);else
eval(["t2Date.set",DAR_HELPERS.tickDiff[1],"(t2Date.get",DAR_HELPERS.tickDiff[1],"()+Math.round(DAR_HELPERS.tickDiff[0]/2));"].join(""));var t2TempTime=t2Date.getTime();if(t2TempTime>=t1Time)
{tempTicks.push(t1Time);}
else
{tempTicks.push(t2TempTime);tempTicks.push(t1Time);}}}}
userTicks=tempTicks;this.numberTicks=userTicks.length;}}
if(userTicks.length){if(this.specialFormatFlag==3){for(i=0;i<userTicks.length;i++){var ut=userTicks[i];var t=new this.tickRenderer(this.tickOptions);if(ut.constructor==Array){t.value=new $.jsDate(ut[0]).getTime();t.label=ut[1];if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
t.setTick(t.value,this.name);this._ticks.push(t);}
else{t.value=new $.jsDate(ut).getTime();if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
t.setTick(t.value,this.name);this._ticks.push(t);}}}
else{for(i=0;i<userTicks.length;i++){var t=new this.tickRenderer(this.tickOptions);t.value=$.jsDate.createDate((userTicks[i].constructor==Array)?userTicks[i][0]:userTicks[i]).getTime();if(t.value>this.max)
continue;t.label=(userTicks[i].constructor==Array)?userTicks[i][1]:null;if(this.specialFormat)
{if(this.specialFormatFlag!=null&&this.specialFormatFlag==2)
{if(i==0||i==(userTicks.length-1))
{t.showLabel=false;t.showGridline=false;t.showMark=false;}
else if((i%2)==0)
{t.showGridline=false;t.showLabel=true;t.showMark=false;}
else
{t.showGridline=true;t.showLabel=false;t.showMark=true;}}
else if(userTicks.length>=2&&i==(userTicks.length-1)&&userTicks[userTicks.length-1]==this.max)
{var t1Date=$.jsDate.createDate((userTicks[i-1].constructor==Array)?userTicks[i-1][0]:userTicks[i-1]);var t2Date=$.jsDate.createDate((userTicks[i].constructor==Array)?userTicks[i][0]:userTicks[i]);eval(["t2Date.set",DAR_HELPERS.tickDiff[1],"(t2Date.get",DAR_HELPERS.tickDiff[1],"()-DAR_HELPERS.tickDiff[0]);"].join(""));if(t1Date.getTime()!=t2Date.getTime())
{t.showLabel=false;t.showGridline=false;t.showMark=false;}}}
if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
t.setTick(t.value,this.name);this._ticks.push(t);}}
this.numberTicks=this._ticks.length;this.min=this._ticks[0].value;this.max=this._ticks[this.numberTicks-1].value;this.daTickInterval=[(this.max-this.min)/(this.numberTicks-1)/1000,'seconds'];}
else if(this.min==null&&this.max==null){var opts=$.extend(true,{},this.tickOptions,{name:this.name,value:null});var nttarget,titarget;if(!this.tickInterval&&!this.numberTicks){var tdim=Math.max(dim,threshold+1);var spacingFactor=100;if(this.tickRenderer===$.jqplot.CanvasAxisTickRenderer&&this.tickOptions.angle){spacingFactor=115-40*Math.abs(Math.sin(this.tickOptions.angle/180*Math.PI));}
nttarget=Math.ceil((tdim-threshold)/spacingFactor+1);titarget=(max-min)/(nttarget-1);}
else if(this.tickInterval){titarget=this.tickInterval;}
else if(this.numberTicks){nttarget=this.numberTicks;titarget=(max-min)/(nttarget-1);}
if(titarget<=19*day){var ret=bestDateInterval(min,max,titarget);var tempti=ret[0];this._autoFormatString=ret[1];min=Math.floor(min/tempti)*tempti;min=new $.jsDate(min);min=min.getTime()+min.getUtcOffset();nttarget=Math.ceil((max-min)/tempti)+1;this.min=min;this.max=min+(nttarget-1)*tempti;if(this.max<max){this.max+=tempti;nttarget+=1;}
this.tickInterval=tempti;this.numberTicks=nttarget;for(var i=0;i<nttarget;i++){opts.value=this.min+i*tempti;t=new this.tickRenderer(opts);if(this._overrideFormatString&&this._autoFormatString!=''){t.formatString=this._autoFormatString;}
if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
this._ticks.push(t);}
insetMult=this.tickInterval;}
else if(titarget<=9*month){this._autoFormatString='%v';var intv=Math.round(titarget/month);if(intv<1){intv=1;}
else if(intv>6){intv=6;}
var mstart=new $.jsDate(min).setDate(1).setHours(0,0,0,0);var tempmend=new $.jsDate(max);var mend=new $.jsDate(max).setDate(1).setHours(0,0,0,0);if(tempmend.getTime()!==mend.getTime()){mend=mend.add(1,'month');}
var nmonths=mend.diff(mstart,'month');nttarget=Math.ceil(nmonths/intv)+1;this.min=mstart.getTime();this.max=mstart.clone().add((nttarget-1)*intv,'month').getTime();this.numberTicks=nttarget;for(var i=0;i<nttarget;i++){if(i===0){opts.value=mstart.getTime();}
else{opts.value=mstart.add(intv,'month').getTime();}
t=new this.tickRenderer(opts);if(this._overrideFormatString&&this._autoFormatString!=''){t.formatString=this._autoFormatString;}
if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
this._ticks.push(t);}
insetMult=intv*month;}
else{this._autoFormatString='%v';var intv=Math.round(titarget/year);if(intv<1){intv=1;}
var mstart=new $.jsDate(min).setMonth(0,1).setHours(0,0,0,0);var mend=new $.jsDate(max).add(1,'year').setMonth(0,1).setHours(0,0,0,0);var nyears=mend.diff(mstart,'year');nttarget=Math.ceil(nyears/intv)+1;this.min=mstart.getTime();this.max=mstart.clone().add((nttarget-1)*intv,'year').getTime();this.numberTicks=nttarget;for(var i=0;i<nttarget;i++){if(i===0){opts.value=mstart.getTime();}
else{opts.value=mstart.add(intv,'year').getTime();}
t=new this.tickRenderer(opts);if(this._overrideFormatString&&this._autoFormatString!=''){t.formatString=this._autoFormatString;}
if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
this._ticks.push(t);}
insetMult=intv*year;}}
else{if(name.match(/^x/)){dim=this._plotDimensions.width;}
else{dim=this._plotDimensions.height;}
if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null;}
if(this.tickInterval!=null)
{if(Number(this.tickInterval)){this.daTickInterval=[Number(this.tickInterval),'seconds'];}
else if(typeof this.tickInterval=="string"){var parts=this.tickInterval.split(' ');if(parts.length==1){this.daTickInterval=[1,parts[0]];}
else if(parts.length==2){this.daTickInterval=[parts[0],parts[1]];}}}
min=((this.min!=null)?$.jsDate.createDate(this.min).getTime():db.min);max=((this.max!=null)?$.jsDate.createDate(this.max).getTime():db.max);if(min==max){var adj=24*60*60*500;min-=adj;max+=adj;}
var range=max-min;var rmin,rmax;rmin=(this.min!=null)?$.jsDate.createDate(this.min).getTime():min-range/2*(this.padMin-1);rmax=(this.max!=null)?$.jsDate.createDate(this.max).getTime():max+range/2*(this.padMax-1);this.min=rmin;this.max=rmax;range=this.max-this.min;if(this.numberTicks==null){if(this.daTickInterval!=null){var max=$.jsDate.createDate(this.max);var nc=new $.jsDate(max).diff(this.min,this.daTickInterval[1],true);this.numberTicks=Math.ceil(nc/this.daTickInterval[0])+1;var min=$.jsDate.createDate(this.min);this.max=new $.jsDate(min).add((this.numberTicks-1)*this.daTickInterval[0],this.daTickInterval[1]).getTime();}
else if(dim>200){this.numberTicks=parseInt(3+(dim-200)/100,10);}
else{this.numberTicks=2;}}
insetMult=range/(this.numberTicks-1)/1000;if(this.daTickInterval==null){this.daTickInterval=[insetMult,'seconds'];}
if(this.specialFormatFlag==3){for(var i=0;i<this.numberTicks;i++){var min=new $.jsDate(this.min);tt=min.add(i*this.daTickInterval[0],this.daTickInterval[1]).getTime();var t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
t.setTick(tt,this.name);this._ticks.push(t);}}
else{for(var i=0;i<this.numberTicks;i++){var min=$.jsDate.createDate(this.min);if(this.useDST){tt=new $.jsDate(min).add(i*this.daTickInterval[0],this.daTickInterval[1]).getTime();}
else{tt=new $.jsDate(min).addNoDST(i*this.daTickInterval[0],this.daTickInterval[1]).getTime();}
var t=new this.tickRenderer(this.tickOptions);if(!this.showTicks){t.showLabel=false;t.showMark=false;}
else if(!this.showTickMarks){t.showMark=false;}
t.setTick(tt,this.name);this._ticks.push(t);}}}
if(this._daTickInterval==null){this._daTickInterval=this.daTickInterval;}};})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(e){e.jqplot.DonutRenderer=function(){e.jqplot.LineRenderer.call(this)};e.jqplot.DonutRenderer.prototype=new e.jqplot.LineRenderer();e.jqplot.DonutRenderer.prototype.constructor=e.jqplot.DonutRenderer;e.jqplot.DonutRenderer.prototype.init=function(p,t){this.diameter=null;this.innerDiameter=null;this.thickness=null;this.padding=20;this.sliceMargin=0;this.ringMargin=null;this.fill=true;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=5;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.dataLabels="percent";this.showDataLabels=false;this.dataLabelFormatString=null;this.dataLabelThreshold=3;this.dataLabelPositionFactor=0.4;this.dataLabelNudge=0;this.startAngle=0;this.tickRenderer=e.jqplot.DonutTickRenderer;this._drawData=true;this._type="donut";if(p.highlightMouseDown&&p.highlightMouseOver==null){p.highlightMouseOver=false}e.extend(true,this,p);if(this.diameter!=null){this.diameter=this.diameter-this.sliceMargin}this._diameter=null;this._innerDiameter=null;this._radius=null;this._innerRadius=null;this._thickness=null;this._previousSeries=[];this._numberSeries=1;this._sliceAngles=[];this._highlightedPoint=null;if(this.highlightColors.length==0){for(var r=0;r<this.seriesColors.length;r++){var q=e.jqplot.getColorComponents(this.seriesColors[r]);var n=[q[0],q[1],q[2]];var s=n[0]+n[1]+n[2];for(var o=0;o<3;o++){n[o]=(s>570)?n[o]*0.8:n[o]+0.3*(255-n[o]);n[o]=parseInt(n[o],10)}this.highlightColors.push("rgb("+n[0]+","+n[1]+","+n[2]+")")}}t.postParseOptionsHooks.addOnce(l);t.postInitHooks.addOnce(g);t.eventListenerHooks.addOnce("jqplotMouseMove",b);t.eventListenerHooks.addOnce("jqplotMouseDown",a);t.eventListenerHooks.addOnce("jqplotMouseUp",j);t.eventListenerHooks.addOnce("jqplotClick",f);t.eventListenerHooks.addOnce("jqplotRightClick",m);t.postDrawHooks.addOnce(h)};e.jqplot.DonutRenderer.prototype.setGridData=function(s){var o=[];var t=[];var n=this.startAngle/180*Math.PI;var r=0;this._drawData=false;for(var q=0;q<this.data.length;q++){if(this.data[q][1]!=0){this._drawData=true}o.push(this.data[q][1]);t.push([this.data[q][0]]);if(q>0){o[q]+=o[q-1]}r+=this.data[q][1]}var p=Math.PI*2/o[o.length-1];for(var q=0;q<o.length;q++){t[q][1]=o[q]*p;t[q][2]=this.data[q][1]/r}this.gridData=t};e.jqplot.DonutRenderer.prototype.makeGridData=function(s,t){var o=[];var u=[];var r=0;var n=this.startAngle/180*Math.PI;this._drawData=false;for(var q=0;q<s.length;q++){if(this.data[q][1]!=0){this._drawData=true}o.push(s[q][1]);u.push([s[q][0]]);if(q>0){o[q]+=o[q-1]}r+=s[q][1]}var p=Math.PI*2/o[o.length-1];for(var q=0;q<o.length;q++){u[q][1]=o[q]*p;u[q][2]=s[q][1]/r}return u};e.jqplot.DonutRenderer.prototype.drawSlice=function(x,u,t,p,s){var n=this._diameter/2;var v=n-this._thickness;var w=this.fill;x.save();x.translate(this._center[0],this._center[1]);if(s){for(var q=0;q<this.shadowDepth;q++){x.save();x.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));o()}}else{o()}function o(){if(t>6.282+this.startAngle){t=6.282+this.startAngle;if(u>t){u=6.281+this.startAngle}}if(u>=t){return}x.beginPath();x.fillStyle=p;x.strokeStyle=p;x.arc(0,0,n,u,t,false);x.lineTo(v*Math.cos(t),v*Math.sin(t));x.arc(0,0,v,t,u,true);x.closePath();if(w){x.fill()}else{x.stroke()}}if(s){for(var q=0;q<this.shadowDepth;q++){x.restore()}}x.restore()};e.jqplot.DonutRenderer.prototype.draw=function(N,V,t,P){var Q;var J=(t!=undefined)?t:{};var q=0;var p=0;var u=1;if(t.legendInfo&&t.legendInfo.placement=="insideGrid"){var I=t.legendInfo;switch(I.location){case"nw":q=I.width+I.xoffset;break;case"w":q=I.width+I.xoffset;break;case"sw":q=I.width+I.xoffset;break;case"ne":q=I.width+I.xoffset;u=-1;break;case"e":q=I.width+I.xoffset;u=-1;break;case"se":q=I.width+I.xoffset;u=-1;break;case"n":p=I.height+I.yoffset;break;case"s":p=I.height+I.yoffset;u=-1;break;default:break}}var B=(J.shadow!=undefined)?J.shadow:this.shadow;var W=(J.showLine!=undefined)?J.showLine:this.showLine;var O=(J.fill!=undefined)?J.fill:this.fill;var s=N.canvas.width;var H=N.canvas.height;var G=s-q-2*this.padding;var R=H-p-2*this.padding;var v=Math.min(G,R);var T=v;var X=(this.ringMargin==null)?this.sliceMargin*2:this.ringMargin;for(var Q=0;Q<this._previousSeries.length;Q++){T-=2*this._previousSeries[Q]._thickness+2*X}this._diameter=this.diameter||T;if(this.innerDiameter!=null){var M=(this._numberSeries>1&&this.index>0)?this._previousSeries[0]._diameter:this._diameter;this._thickness=this.thickness||(M-this.innerDiameter-2*X*this._numberSeries)/this._numberSeries/2}else{this._thickness=this.thickness||v/2/(this._numberSeries+1)*0.85}var K=this._radius=this._diameter/2;this._innerRadius=this._radius-this._thickness;var o=this.startAngle/180*Math.PI;this._center=[(s-u*q)/2+u*q,(H-u*p)/2+u*p];if(this.shadow){var L="rgba(0,0,0,"+this.shadowAlpha+")";for(var Q=0;Q<V.length;Q++){var A=(Q==0)?o:V[Q-1][1]+o;A+=this.sliceMargin/180*Math.PI;this.renderer.drawSlice.call(this,N,A,V[Q][1]+o,L,true)}}for(var Q=0;Q<V.length;Q++){var A=(Q==0)?o:V[Q-1][1]+o;A+=this.sliceMargin/180*Math.PI;var z=V[Q][1]+o;this._sliceAngles.push([A,z]);this.renderer.drawSlice.call(this,N,A,z,this.seriesColors[Q],false);if(this.showDataLabels&&V[Q][2]*100>=this.dataLabelThreshold){var S,U=(A+z)/2,C;if(this.dataLabels=="label"){S=this.dataLabelFormatString||"%s";C=e.jqplot.sprintf(S,V[Q][0])}else{if(this.dataLabels=="value"){S=this.dataLabelFormatString||"%d";C=e.jqplot.sprintf(S,this.data[Q][1])}else{if(this.dataLabels=="percent"){S=this.dataLabelFormatString||"%d%%";C=e.jqplot.sprintf(S,V[Q][2]*100)}else{if(this.dataLabels.constructor==Array){S=this.dataLabelFormatString||"%s";C=e.jqplot.sprintf(S,this.dataLabels[Q])}}}}var n=this._innerRadius+this._thickness*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge;var F=this._center[0]+Math.cos(U)*n+this.canvas._offsets.left;var E=this._center[1]+Math.sin(U)*n+this.canvas._offsets.top;var D=e('<span class="jqplot-donut-series jqplot-data-label" style="position:absolute;">'+C+"</span>").insertBefore(P.eventCanvas._elem);F-=D.width()/2;E-=D.height()/2;F=Math.round(F);E=Math.round(E);D.css({left:F,top:E})}}};e.jqplot.DonutAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this)};e.jqplot.DonutAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer();e.jqplot.DonutAxisRenderer.prototype.constructor=e.jqplot.DonutAxisRenderer;e.jqplot.DonutAxisRenderer.prototype.init=function(n){this.tickRenderer=e.jqplot.DonutTickRenderer;e.extend(true,this,n);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};e.jqplot.DonutLegendRenderer=function(){e.jqplot.TableLegendRenderer.call(this)};e.jqplot.DonutLegendRenderer.prototype=new e.jqplot.TableLegendRenderer();e.jqplot.DonutLegendRenderer.prototype.constructor=e.jqplot.DonutLegendRenderer;e.jqplot.DonutLegendRenderer.prototype.init=function(n){this.numberRows=null;this.numberColumns=null;e.extend(true,this,n)};e.jqplot.DonutLegendRenderer.prototype.draw=function(){var q=this;if(this.show){var y=this._series;var B="position:absolute;";B+=(this.background)?"background:"+this.background+";":"";B+=(this.border)?"border:"+this.border+";":"";B+=(this.fontSize)?"font-size:"+this.fontSize+";":"";B+=(this.fontFamily)?"font-family:"+this.fontFamily+";":"";B+=(this.textColor)?"color:"+this.textColor+";":"";B+=(this.marginTop!=null)?"margin-top:"+this.marginTop+";":"";B+=(this.marginBottom!=null)?"margin-bottom:"+this.marginBottom+";":"";B+=(this.marginLeft!=null)?"margin-left:"+this.marginLeft+";":"";B+=(this.marginRight!=null)?"margin-right:"+this.marginRight+";":"";this._elem=e('<table class="jqplot-table-legend" style="'+B+'"></table>');var F=false,x=false,n,v;var z=y[0];var o=new e.jqplot.ColorGenerator(z.seriesColors);if(z.show){var G=z.data;if(this.numberRows){n=this.numberRows;if(!this.numberColumns){v=Math.ceil(G.length/n)}else{v=this.numberColumns}}else{if(this.numberColumns){v=this.numberColumns;n=Math.ceil(G.length/this.numberColumns)}else{n=G.length;v=1}}var E,D,p,t,r,u,w,C;var A=0;for(E=0;E<n;E++){if(x){p=e('<tr class="jqplot-table-legend"></tr>').prependTo(this._elem)}else{p=e('<tr class="jqplot-table-legend"></tr>').appendTo(this._elem)}for(D=0;D<v;D++){if(A<G.length){u=this.labels[A]||G[A][0].toString();C=o.next();if(!x){if(E>0){F=true}else{F=false}}else{if(E==n-1){F=false}else{F=true}}w=(F)?this.rowSpacing:"0";t=e('<td class="jqplot-table-legend" style="text-align:center;padding-top:'+w+';"><div><div class="jqplot-table-legend-swatch" style="border-color:'+C+';"></div></div></td>');r=e('<td class="jqplot-table-legend" style="padding-top:'+w+';"></td>');if(this.escapeHtml){r.text(u)}else{r.html(u)}if(x){r.prependTo(p);t.prependTo(p)}else{t.appendTo(p);r.appendTo(p)}F=true}A++}}}}return this._elem};function c(r,q,o){o=o||{};o.axesDefaults=o.axesDefaults||{};o.legend=o.legend||{};o.seriesDefaults=o.seriesDefaults||{};var n=false;if(o.seriesDefaults.renderer==e.jqplot.DonutRenderer){n=true}else{if(o.series){for(var p=0;p<o.series.length;p++){if(o.series[p].renderer==e.jqplot.DonutRenderer){n=true}}}}if(n){o.axesDefaults.renderer=e.jqplot.DonutAxisRenderer;o.legend.renderer=e.jqplot.DonutLegendRenderer;o.legend.preDraw=true;o.seriesDefaults.pointLabels={show:false}}}function g(r,q,o){for(var p=1;p<this.series.length;p++){if(!this.series[p]._previousSeries.length){for(var n=0;n<p;n++){if(this.series[p].renderer.constructor==e.jqplot.DonutRenderer&&this.series[n].renderer.constructor==e.jqplot.DonutRenderer){this.series[p]._previousSeries.push(this.series[n])}}}}for(p=0;p<this.series.length;p++){if(this.series[p].renderer.constructor==e.jqplot.DonutRenderer){this.series[p]._numberSeries=this.series.length;if(this.series[p].highlightMouseOver){this.series[p].highlightMouseDown=false}}}}var k=false;function l(n){for(var o=0;o<this.series.length;o++){this.series[o].seriesColors=this.seriesColors;this.series[o].colorGenerator=e.jqplot.colorGenerator}}function d(r,q,p){var o=r.series[q];var n=r.plugins.donutRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);o._highlightedPoint=p;r.plugins.donutRenderer.highlightedSeriesIndex=q;o.renderer.drawSlice.call(o,n._ctx,o._sliceAngles[p][0],o._sliceAngles[p][1],o.highlightColors[p],false)}function i(p){var n=p.plugins.donutRenderer.highlightCanvas;n._ctx.clearRect(0,0,n._ctx.canvas.width,n._ctx.canvas.height);for(var o=0;o<p.series.length;o++){p.series[o]._highlightedPoint=null}p.plugins.donutRenderer.highlightedSeriesIndex=null;p.target.trigger("jqplotDataUnhighlight")}function b(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var o=jQuery.Event("jqplotDataMouseOver");o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p);if(s.series[p[0]].highlightMouseOver&&!(p[0]==s.plugins.donutRenderer.highlightedSeriesIndex&&p[1]==s.series[p[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=r.which;n.pageX=r.pageX;n.pageY=r.pageY;s.target.trigger(n,p);d(s,p[0],p[1])}}else{if(t==null){i(s)}}}function a(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];if(r.series[o[0]].highlightMouseDown&&!(o[0]==r.plugins.donutRenderer.highlightedSeriesIndex&&o[1]==r.series[o[0]]._highlightedPoint)){var n=jQuery.Event("jqplotDataHighlight");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o);d(r,o[0],o[1])}}else{if(s==null){i(r)}}}function j(p,o,s,r,q){var n=q.plugins.donutRenderer.highlightedSeriesIndex;if(n!=null&&q.series[n].highlightMouseDown){i(q)}}function f(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];var n=jQuery.Event("jqplotDataClick");n.which=q.which;n.pageX=q.pageX;n.pageY=q.pageY;r.target.trigger(n,o)}}function m(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var n=s.plugins.donutRenderer.highlightedSeriesIndex;if(n!=null&&s.series[n].highlightMouseDown){i(s)}var o=jQuery.Event("jqplotDataRightClick");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p)}}function h(){if(this.plugins.donutRenderer&&this.plugins.donutRenderer.highlightCanvas){this.plugins.donutRenderer.highlightCanvas.resetCanvas();this.plugins.donutRenderer.highlightCanvas=null}this.plugins.donutRenderer={highlightedSeriesIndex:null};this.plugins.donutRenderer.highlightCanvas=new e.jqplot.GenericCanvas();var o=e(this.targetId+" .jqplot-data-label");if(o.length){e(o[0]).before(this.plugins.donutRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-donutRenderer-highlight-canvas",this._plotDimensions,this))}else{this.eventCanvas._elem.before(this.plugins.donutRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-donutRenderer-highlight-canvas",this._plotDimensions,this))}var n=this.plugins.donutRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(p){i(p.data.plot)})}e.jqplot.preInitHooks.push(c);e.jqplot.DonutTickRenderer=function(){e.jqplot.AxisTickRenderer.call(this)};e.jqplot.DonutTickRenderer.prototype=new e.jqplot.AxisTickRenderer();e.jqplot.DonutTickRenderer.prototype.constructor=e.jqplot.DonutTickRenderer})(jQuery);(function($){$.jqplot.eventListenerHooks.push(['jqplotMouseMove',handleMove]);$.jqplot.Highlighter=function(options){this.show=$.jqplot.config.enablePlugins;this.markerRenderer=new $.jqplot.MarkerRenderer({shadow:false});this.showMarker=true;this.lineWidthAdjust=2.5;this.sizeAdjust=5;this.showTooltip=true;this.tooltipLocation='nw';this.fadeTooltip=true;this.tooltipFadeSpeed="fast";this.tooltipOffset=2;this.tooltipAxes='both';this.tooltipSeparator=', ';this.tooltipContentEditor=null;this.useAxesFormatters=true;this.tooltipFormatString='%.5P';this.formatString=null;this.yvalues=1;this.bringSeriesToFront=false;this._tooltipElem;this.isHighlighting=false;this.currentNeighbor=null;$.extend(true,this,options);};var locations=['nw','n','ne','e','se','s','sw','w'];var locationIndicies={'nw':0,'n':1,'ne':2,'e':3,'se':4,'s':5,'sw':6,'w':7};var oppositeLocations=['se','s','sw','w','nw','n','ne','e'];$.jqplot.Highlighter.init=function(target,data,opts){var options=opts||{};this.plugins.highlighter=new $.jqplot.Highlighter(options.highlighter);};$.jqplot.Highlighter.parseOptions=function(defaults,options){this.showHighlight=true;};$.jqplot.Highlighter.postPlotDraw=function(){if(this.plugins.highlighter&&this.plugins.highlighter.highlightCanvas){this.plugins.highlighter.highlightCanvas.resetCanvas();this.plugins.highlighter.highlightCanvas=null;}
if(this.plugins.highlighter&&this.plugins.highlighter._tooltipElem){this.plugins.highlighter._tooltipElem.emptyForce();this.plugins.highlighter._tooltipElem=null;}
this.plugins.highlighter.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.highlighter.highlightCanvas.createElement(this._gridPadding,'jqplot-highlight-canvas',this._plotDimensions,this));this.plugins.highlighter.highlightCanvas.setContext();var elem=document.createElement('div');this.plugins.highlighter._tooltipElem=$(elem);elem=null;this.plugins.highlighter._tooltipElem.addClass('jqplot-highlighter-tooltip');this.plugins.highlighter._tooltipElem.css({position:'absolute',display:'none'});this.eventCanvas._elem.before(this.plugins.highlighter._tooltipElem);};$.jqplot.preInitHooks.push($.jqplot.Highlighter.init);$.jqplot.preParseSeriesOptionsHooks.push($.jqplot.Highlighter.parseOptions);$.jqplot.postDrawHooks.push($.jqplot.Highlighter.postPlotDraw);function draw(plot,neighbor){var hl=plot.plugins.highlighter;var s=plot.series[neighbor.seriesIndex];var smr=s.markerRenderer;var mr=hl.markerRenderer;mr.style=smr.style;mr.lineWidth=smr.lineWidth+hl.lineWidthAdjust;mr.size=smr.size+hl.sizeAdjust;var rgba=$.jqplot.getColorComponents(smr.color);var newrgb=[rgba[0],rgba[1],rgba[2]];var alpha=(rgba[3]>=0.6)?rgba[3]*0.6:rgba[3]*(2-rgba[3]);mr.color='rgba('+newrgb[0]+','+newrgb[1]+','+newrgb[2]+','+alpha+')';mr.init();mr.draw(s.gridData[neighbor.pointIndex][0],s.gridData[neighbor.pointIndex][1],hl.highlightCanvas._ctx);}
function showTooltip(plot,series,neighbor){var hl=plot.plugins.highlighter;var elem=hl._tooltipElem;var serieshl=series.highlighter||{};var opts=$.extend(true,{},hl,serieshl);if(opts.useAxesFormatters){var xf=series._xaxis._ticks[0].formatter;var yf=series._yaxis._ticks[0].formatter;var xfstr=series._xaxis._ticks[0].formatString;var yfstr=series._yaxis._ticks[0].formatString;var str;var xstr=xf(xfstr,neighbor.data[0]);var ystrs=[];for(var i=1;i<opts.yvalues+1;i++){ystrs.push(yf(yfstr,neighbor.data[i]));}
if(typeof opts.formatString==='string'){switch(opts.tooltipAxes){case'both':case'xy':ystrs.unshift(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case'yx':ystrs.push(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case'x':str=$.jqplot.sprintf.apply($.jqplot.sprintf,[opts.formatString,xstr]);break;case'y':ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;default:ystrs.unshift(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;}}
else{switch(opts.tooltipAxes){case'both':case'xy':str=xstr;for(var i=0;i<ystrs.length;i++){str+=opts.tooltipSeparator+ystrs[i];}
break;case'yx':str='';for(var i=0;i<ystrs.length;i++){str+=ystrs[i]+opts.tooltipSeparator;}
str+=xstr;break;case'x':str=xstr;break;case'y':str=ystrs.join(opts.tooltipSeparator);break;default:str=xstr;for(var i=0;i<ystrs.length;i++){str+=opts.tooltipSeparator+ystrs[i];}
break;}}}
else{var str;if(typeof opts.formatString==='string'){str=$.jqplot.sprintf.apply($.jqplot.sprintf,[opts.formatString].concat(neighbor.data));}
else{if(opts.tooltipAxes=='both'||opts.tooltipAxes=='xy'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0])+opts.tooltipSeparator+$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1]);}
else if(opts.tooltipAxes=='yx'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1])+opts.tooltipSeparator+$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0]);}
else if(opts.tooltipAxes=='x'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0]);}
else if(opts.tooltipAxes=='y'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1]);}}}
if($.isFunction(opts.tooltipContentEditor)){str=opts.tooltipContentEditor(str,neighbor.seriesIndex,neighbor.pointIndex,plot);}
str=str.replace(/%l/,series.label);if(neighbor.data[2]!=undefined&&neighbor.data[2])
str=str.replace(/%1/,neighbor.data[2]);else
str=str.replace(/%1/,"");if(neighbor.data[3]!=undefined&&neighbor.data[3])
str=str.replace(/%2/,neighbor.data[3]);else
str=str.replace(/%2/,"");if(neighbor.data[4]!=undefined&&neighbor.data[4])
str=str.replace(/%3/,neighbor.data[4]);else
str=str.replace(/%3/,"");if(neighbor.data[5]!=undefined&&neighbor.data[5])
str=str.replace(/%4/,neighbor.data[5]);else
str=str.replace(/%4/,"");if(neighbor.data[8]!=undefined&&neighbor.data[8])
str=str.replace(/%5/,neighbor.data[8]);else
str=str.replace(/%5/,"");if(neighbor.data[7]!=undefined&&neighbor.data[7])
str=str.replace(/%6/,neighbor.data[7]);else
str=str.replace(/%6/,"");elem.html(str);var gridpos={x:neighbor.gridData[0],y:neighbor.gridData[1]};var ms=0;var fact=0.707;if(series.markerRenderer.show==true){ms=(series.markerRenderer.size+opts.sizeAdjust)/2;}
var loc=locations;if(series.fillToZero&&series.fill&&neighbor.data[1]<0){loc=oppositeLocations;}
switch(loc[locationIndicies[opts.tooltipLocation]]){case'nw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case'n':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-ms;break;case'ne':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case'e':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;case'se':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+fact*ms;break;case's':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+ms;break;case'sw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+fact*ms;break;case'w':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;default:var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;}
elem.css('left',x);elem.css('top',y);if(opts.fadeTooltip){elem.stop(true,true).fadeIn(opts.tooltipFadeSpeed);}
else{elem.show();}
elem=null;}
function handleMove(ev,gridpos,datapos,neighbor,plot){var hl=plot.plugins.highlighter;var c=plot.plugins.cursor;if(hl.show){if(neighbor==null&&hl.isHighlighting&&HIGHLIGHTER_HELPERS.isHighlighting){var ctx=hl.highlightCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);if(hl.fadeTooltip){hl._tooltipElem.fadeOut(hl.tooltipFadeSpeed);}
else{hl._tooltipElem.hide();}
if(hl.bringSeriesToFront){plot.restorePreviousSeriesOrder();}
hl.isHighlighting=false;HIGHLIGHTER_HELPERS.isHighlighting=false;hl.currentNeighbor=null;ctx=null;}
else if(neighbor!=null&&plot.series[neighbor.seriesIndex].showHighlight&&!hl.isHighlighting&&!HIGHLIGHTER_HELPERS.isHighlighting){hl.isHighlighting=true;HIGHLIGHTER_HELPERS.isHighlighting=true;hl.currentNeighbor=neighbor;if(hl.showMarker){draw(plot,neighbor);}
if(hl.showTooltip&&(!c||!c._zoom.started)){showTooltip(plot,plot.series[neighbor.seriesIndex],neighbor);}
if(hl.bringSeriesToFront){plot.moveSeriesToFront(neighbor.seriesIndex);}}
else if(neighbor!=null&&hl.isHighlighting&&HIGHLIGHTER_HELPERS.isHighlighting&&hl.currentNeighbor!=neighbor){if(plot.series[neighbor.seriesIndex].showHighlight){var ctx=hl.highlightCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);hl.isHighlighting=true;HIGHLIGHTER_HELPERS.isHighlighting=true;hl.currentNeighbor=neighbor;if(hl.showMarker){draw(plot,neighbor);}
if(hl.showTooltip&&(!c||!c._zoom.started)){showTooltip(plot,plot.series[neighbor.seriesIndex],neighbor);}
if(hl.bringSeriesToFront){plot.moveSeriesToFront(neighbor.seriesIndex);}}}}}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function($){$.jqplot.JSON=window.JSON;if(!window.JSON){$.jqplot.JSON={}}function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof $.jqplot.JSON.stringify!=="function"){$.jqplot.JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("$.jqplot.JSON.stringify")}return str("",{"":value})}}if(typeof $.jqplot.JSON.parse!=="function"){$.jqplot.JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("$.jqplot.JSON.parse")}}})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(c){c.jqplot.MeterGaugeRenderer=function(){c.jqplot.LineRenderer.call(this)};c.jqplot.MeterGaugeRenderer.prototype=new c.jqplot.LineRenderer();c.jqplot.MeterGaugeRenderer.prototype.constructor=c.jqplot.MeterGaugeRenderer;c.jqplot.MeterGaugeRenderer.prototype.init=function(e){this.diameter=null;this.padding=null;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=4;this.background="#efefef";this.ringColor="#BBC6D0";this.needleColor="#C3D3E5";this.tickColor="989898";this.ringWidth=null;this.min;this.max;this.ticks=[];this.showTicks=true;this.showTickLabels=true;this.label=null;this.labelHeightAdjust=0;this.labelPosition="inside";this.intervals=[];this.intervalColors=["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc","#c747a3","#cddf54","#FBD178","#26B4E3","#bd70c7"];this.intervalInnerRadius=null;this.intervalOuterRadius=null;this.tickRenderer=c.jqplot.MeterGaugeTickRenderer;this.tickPositions=[1,2,2.5,5,10];this.tickSpacing=30;this.numberMinorTicks=null;this.hubRadius=null;this.tickPadding=null;this.needleThickness=null;this.needlePad=6;this.pegNeedle=true;this._type="meterGauge";c.extend(true,this,e);this.type=null;this.numberTicks=null;this.tickInterval=null;this.span=180;if(this.type=="circular"){this.semiCircular=false}else{if(this.type!="circular"){this.semiCircular=true}else{this.semiCircular=(this.span<=180)?true:false}}this._tickPoints=[];this._labelElem=null;this.startAngle=(90+(360-this.span)/2)*Math.PI/180;this.endAngle=(90-(360-this.span)/2)*Math.PI/180;this.setmin=!!(this.min==null);this.setmax=!!(this.max==null);if(this.intervals.length){if(this.intervals[0].length==null||this.intervals.length==1){for(var f=0;f<this.intervals.length;f++){this.intervals[f]=[this.intervals[f],this.intervals[f],this.intervalColors[f]]}}else{if(this.intervals[0].length==2){for(f=0;f<this.intervals.length;f++){this.intervals[f]=[this.intervals[f][0],this.intervals[f][1],this.intervalColors[f]]}}}}if(this.ticks.length){if(this.ticks[0].length==null||this.ticks[0].length==1){for(var f=0;f<this.ticks.length;f++){this.ticks[f]=[this.ticks[f],this.ticks[f]]}}this.min=(this.min==null)?this.ticks[0][0]:this.min;this.max=(this.max==null)?this.ticks[this.ticks.length-1][0]:this.max;this.setmin=false;this.setmax=false;this.numberTicks=this.ticks.length;this.tickInterval=this.ticks[1][0]-this.ticks[0][0];this.tickFactor=Math.floor(parseFloat((Math.log(this.tickInterval)/Math.log(10)).toFixed(11)));this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor);if(!this.numberMinorTicks){this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor-1)}if(!this.numberMinorTicks){this.numberMinorTicks=1}}else{if(this.intervals.length){this.min=(this.min==null)?0:this.min;this.setmin=false;if(this.max==null){if(this.intervals[this.intervals.length-1][0]>=this.data[0][1]){this.max=this.intervals[this.intervals.length-1][0];this.setmax=false}}else{this.setmax=false}}else{this.min=(this.min==null)?0:this.min;this.setmin=false;if(this.max==null){this.max=this.data[0][1]*1.25;this.setmax=true}else{this.setmax=false}}}};c.jqplot.MeterGaugeRenderer.prototype.setGridData=function(j){var f=[];var k=[];var e=this.startAngle;for(var h=0;h<this.data.length;h++){f.push(this.data[h][1]);k.push([this.data[h][0]]);if(h>0){f[h]+=f[h-1]}}var g=Math.PI*2/f[f.length-1];for(var h=0;h<f.length;h++){k[h][1]=f[h]*g}this.gridData=k};c.jqplot.MeterGaugeRenderer.prototype.makeGridData=function(j,k){var f=[];var l=[];var e=this.startAngle;for(var h=0;h<j.length;h++){f.push(j[h][1]);l.push([j[h][0]]);if(h>0){f[h]+=f[h-1]}}var g=Math.PI*2/f[f.length-1];for(var h=0;h<f.length;h++){l[h][1]=f[h]*g}return l};function b(j,f,g){var e;for(var h=j.length-1;h>=0;h--){e=f/(j[h]*Math.pow(10,g));if(e==4||e==5){return e-1}}return null}c.jqplot.MeterGaugeRenderer.prototype.draw=function(X,aC,ap){var aa;var aM=(ap!=undefined)?ap:{};var ai=0;var ah=0;var at=1;if(ap.legendInfo&&ap.legendInfo.placement=="inside"){var aI=ap.legendInfo;switch(aI.location){case"nw":ai=aI.width+aI.xoffset;break;case"w":ai=aI.width+aI.xoffset;break;case"sw":ai=aI.width+aI.xoffset;break;case"ne":ai=aI.width+aI.xoffset;at=-1;break;case"e":ai=aI.width+aI.xoffset;at=-1;break;case"se":ai=aI.width+aI.xoffset;at=-1;break;case"n":ah=aI.height+aI.yoffset;break;case"s":ah=aI.height+aI.yoffset;at=-1;break;default:break}}if(this.label){this._labelElem=c('<div class="jqplot-meterGauge-label" style="position:absolute;">'+this.label+"</div>");this.canvas._elem.after(this._labelElem)}var m=(aM.shadow!=undefined)?aM.shadow:this.shadow;var N=(aM.showLine!=undefined)?aM.showLine:this.showLine;var I=(aM.fill!=undefined)?aM.fill:this.fill;var K=X.canvas.width;var S=X.canvas.height;if(this.padding==null){this.padding=Math.round(Math.min(K,S)/30)}var Q=K-ai-2*this.padding;var ab=S-ah-2*this.padding;if(this.labelPosition=="bottom"&&this.label){ab-=this._labelElem.outerHeight(true)}var L=Math.min(Q,ab);var ad=L;if(!this.diameter){if(this.semiCircular){if(Q>=2*ab){if(!this.ringWidth){this.ringWidth=2*ab/35}this.needleThickness=this.needleThickness||2+Math.pow(this.ringWidth,0.8);this.innerPad=this.ringWidth/2+this.needleThickness/2+this.needlePad;this.diameter=2*(ab-2*this.innerPad)}else{if(!this.ringWidth){this.ringWidth=Q/35}this.needleThickness=this.needleThickness||2+Math.pow(this.ringWidth,0.8);this.innerPad=this.ringWidth/2+this.needleThickness/2+this.needlePad;this.diameter=Q-2*this.innerPad-this.ringWidth-this.padding}this._center=[(K-at*ai)/2+at*ai,(S+at*ah-this.padding-this.ringWidth-this.innerPad)]}else{if(!this.ringWidth){this.ringWidth=ad/35}this.needleThickness=this.needleThickness||2+Math.pow(this.ringWidth,0.8);this.innerPad=0;this.diameter=ad-this.ringWidth;this._center=[(K-at*ai)/2+at*ai,(S-at*ah)/2+at*ah]}}if(this._labelElem&&this.labelPosition=="bottom"){this._center[1]-=this._labelElem.outerHeight(true)}this._radius=this.diameter/2;this.tickSpacing=6000/this.diameter;if(!this.hubRadius){this.hubRadius=this.diameter/18}this.shadowOffset=0.5+this.ringWidth/9;this.shadowWidth=this.ringWidth*1;this.tickPadding=3+Math.pow(this.diameter/20,0.7);this.tickOuterRadius=this._radius-this.ringWidth/2-this.tickPadding;this.tickLength=(this.showTicks)?this._radius/13:0;if(this.ticks.length==0){var A=this.max,aL=this.min,q=this.setmax,aG=this.setmin,au=(A-aL)*this.tickSpacing/this.span;var aw=Math.floor(parseFloat((Math.log(au)/Math.log(10)).toFixed(11)));var an=(au/Math.pow(10,aw));(an>2&&an<=2.5)?an=2.5:an=Math.ceil(an);var T=this.tickPositions;var aA,ak;for(aa=0;aa<T.length;aa++){if(an==T[aa]||aa&&T[aa-1]<an&&an<T[aa]){au=T[aa]*Math.pow(10,aw);aA=aa}}for(aa=0;aa<T.length;aa++){if(an==T[aa]||aa&&T[aa-1]<an&&an<T[aa]){au=T[aa]*Math.pow(10,aw);ak=Math.ceil((A-aL)/au)}}if(q&&aG){var aP=(aL>0)?aL-aL%au:aL-aL%au-au;if(!this.forceZero){var D=Math.min(aL-aP,0.8*au);var o=Math.floor(D/T[aA]);if(o>1){aP=aP+T[aA]*(o-1);if(parseInt(aP,10)!=aP&&parseInt(aP-T[aA],10)==aP-T[aA]){aP=aP-T[aA]}}}if(aL==aP){aL-=au}else{if(aL-aP>0.23*au){aL=aP}else{aL=aP-au;ak+=1}}ak+=1;var E=aL+(ak-1)*au;if(A>=E){E+=au;ak+=1}if(E-A<0.23*au){E+=au;ak+=1}this.max=A=E;this.min=aL;this.tickInterval=au;this.numberTicks=ak;var O;for(aa=0;aa<ak;aa++){O=parseFloat((aL+aa*au).toFixed(11));this.ticks.push([O,O])}this.max=this.ticks[ak-1][1];this.tickFactor=aw;this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor);if(!this.numberMinorTicks){this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor-1)}}else{if(q){var E=aL+(ak-1)*au;if(A>=E){A=E+au;ak+=1}else{A=E}this.tickInterval=this.tickInterval||au;this.numberTicks=this.numberTicks||ak;var O;for(aa=0;aa<this.numberTicks;aa++){O=parseFloat((aL+aa*this.tickInterval).toFixed(11));this.ticks.push([O,O])}this.max=this.ticks[this.numberTicks-1][1];this.tickFactor=aw;this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor);if(!this.numberMinorTicks){this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor-1)}}}if(!q&&!aG){var P=this.max-this.min;aw=Math.floor(parseFloat((Math.log(P)/Math.log(10)).toFixed(11)))-1;var aN=[5,6,4,7,3,8,9,10,2],V,C,av=0,M;if(P>1){var aJ=String(P);if(aJ.search(/\./)==-1){var aF=aJ.search(/0+$/);av=(aF>0)?aJ.length-aF-1:0}}M=P/Math.pow(10,av);for(aa=0;aa<aN.length;aa++){V=M/(aN[aa]-1);if(V==parseInt(V,10)){this.numberTicks=aN[aa];this.tickInterval=P/(this.numberTicks-1);this.tickFactor=aw+1;break}}var O;for(aa=0;aa<this.numberTicks;aa++){O=parseFloat((this.min+aa*this.tickInterval).toFixed(11));this.ticks.push([O,O])}this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor);if(!this.numberMinorTicks){this.numberMinorTicks=b(this.tickPositions,this.tickInterval,this.tickFactor-1)}if(!this.numberMinorTicks){this.numberMinorTicks=1;var aH=[4,5,3,6,2];for(aa=0;aa<5;aa++){var ao=this.tickInterval/aH[aa];if(ao==parseInt(ao,10)){this.numberMinorTicks=aH[aa]-1;break}}}}}var U=this._radius,aE=this.startAngle,k=this.endAngle,H=Math.PI,e=Math.PI/2;if(this.semiCircular){var z=Math.atan(this.innerPad/U),ac=this.outerStartAngle=aE-z,aB=this.outerEndAngle=k+z,B=this.hubStartAngle=aE-Math.atan(this.innerPad/this.hubRadius*2),af=this.hubEndAngle=k+Math.atan(this.innerPad/this.hubRadius*2);X.save();X.translate(this._center[0],this._center[1]);X.lineJoin="round";X.lineCap="round";X.save();X.beginPath();X.fillStyle=this.background;X.arc(0,0,U,ac,aB,false);X.closePath();X.fill();X.restore();var aj="rgba(0,0,0,"+this.shadowAlpha+")";X.save();for(var aa=0;aa<this.shadowDepth;aa++){X.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));X.beginPath();X.strokeStyle=aj;X.lineWidth=this.shadowWidth;X.arc(0,0,U,ac,aB,false);X.closePath();X.stroke()}X.restore();X.save();var az=parseInt((this.shadowDepth+1)/2,10);for(var aa=0;aa<az;aa++){X.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));X.beginPath();X.fillStyle=aj;X.arc(0,0,this.hubRadius,B,af,false);X.closePath();X.fill()}X.restore();X.save();X.beginPath();X.strokeStyle=this.ringColor;X.lineWidth=this.ringWidth;X.arc(0,0,U,ac,aB,false);X.closePath();X.stroke();X.restore();X.save();X.beginPath();X.fillStyle=this.ringColor;X.arc(0,0,this.hubRadius,B,af,false);X.closePath();X.fill();X.restore();if(this.showTicks){X.save();var f=this.tickOuterRadius,aq=this.tickLength,v=aq/2,F=this.numberMinorTicks,am=this.span*Math.PI/180/(this.ticks.length-1),p=am/(F+1);for(aa=0;aa<this.ticks.length;aa++){X.beginPath();X.lineWidth=1.5+this.diameter/360;X.strokeStyle=this.ringColor;var ae=am*aa+aE;X.moveTo(-f*Math.cos(am*aa+aE),f*Math.sin(am*aa+aE));X.lineTo(-(f-aq)*Math.cos(am*aa+aE),(f-aq)*Math.sin(am*aa+aE));this._tickPoints.push([(f-aq)*Math.cos(am*aa+aE)+this._center[0]+this.canvas._offsets.left,(f-aq)*Math.sin(am*aa+aE)+this._center[1]+this.canvas._offsets.top,am*aa+aE]);X.stroke();X.lineWidth=1+this.diameter/440;if(aa<this.ticks.length-1){for(var Y=1;Y<=F;Y++){X.beginPath();X.moveTo(-f*Math.cos(am*aa+p*Y+aE),f*Math.sin(am*aa+p*Y+aE));X.lineTo(-(f-v)*Math.cos(am*aa+p*Y+aE),(f-v)*Math.sin(am*aa+p*Y+aE));X.stroke()}}}X.restore()}if(this.showTickLabels){var J,W,T,aO,g,G,n=0;var an=this.tickPadding*(1-1/(this.diameter/80+1));for(aa=0;aa<this.ticks.length;aa++){J=c('<div class="jqplot-meterGauge-tick" style="position:absolute;">'+this.ticks[aa][1]+"</div>");this.canvas._elem.after(J);aO=J.outerWidth(true);g=J.outerHeight(true);W=this._tickPoints[aa][0]-aO*(this._tickPoints[aa][2]-Math.PI)/Math.PI-an*Math.cos(this._tickPoints[aa][2]);T=this._tickPoints[aa][1]-g/2+g/2*Math.pow(Math.abs((Math.sin(this._tickPoints[aa][2]))),0.5)+an/3*Math.pow(Math.abs((Math.sin(this._tickPoints[aa][2]))),0.5);J.css({left:W,top:T});G=aO*Math.cos(this._tickPoints[aa][2])+g*Math.sin(Math.PI/2+this._tickPoints[aa][2]/2);n=(G>n)?G:n}}if(this.label&&this.labelPosition=="inside"){var W=this._center[0]+this.canvas._offsets.left;var an=this.tickPadding*(1-1/(this.diameter/80+1));var T=0.5*(this._center[1]+this.canvas._offsets.top-this.hubRadius)+0.5*(this._center[1]+this.canvas._offsets.top-this.tickOuterRadius+this.tickLength+an)+this.labelHeightAdjust;W-=this._labelElem.outerWidth(true)/2;T-=this._labelElem.outerHeight(true)/2;this._labelElem.css({left:W,top:T})}else{if(this.label&&this.labelPosition=="bottom"){var W=this._center[0]+this.canvas._offsets.left-this._labelElem.outerWidth(true)/2;var T=this._center[1]+this.canvas._offsets.top+this.innerPad+ +this.ringWidth+this.padding+this.labelHeightAdjust;this._labelElem.css({left:W,top:T})}}X.save();var ax=this.intervalInnerRadius||this.hubRadius*1.5;if(this.intervalOuterRadius==null){if(this.showTickLabels){var ag=(this.tickOuterRadius-this.tickLength-this.tickPadding-this.diameter/8)}else{var ag=(this.tickOuterRadius-this.tickLength-this.diameter/16)}}else{var ag=this.intervalOuterRadius}var P=this.max-this.min;var aD=this.intervals[this.intervals.length-1]-this.min;var y,Z,u=this.span*Math.PI/180;for(aa=0;aa<this.intervals.length;aa++){y=(aa==0)?aE:aE+(this.intervals[aa-1][0]-this.min)*u/P;if(y<0){y=0}Z=aE+(this.intervals[aa][0]-this.min)*u/P;if(Z<0){Z=0}X.beginPath();X.fillStyle=this.intervals[aa][2];X.arc(0,0,ax,y,Z,false);X.lineTo(ag*Math.cos(Z),ag*Math.sin(Z));X.arc(0,0,ag,Z,y,true);X.lineTo(ax*Math.cos(y),ax*Math.sin(y));X.closePath();X.fill()}X.restore();var ay=this.data[0][1];var R=this.max-this.min;if(this.pegNeedle){if(this.data[0][1]>this.max+R*3/this.span){ay=this.max+R*3/this.span}if(this.data[0][1]<this.min-R*3/this.span){ay=this.min-R*3/this.span}}var al=(ay-this.min)/R*this.span*Math.PI/180+this.startAngle;X.save();X.beginPath();X.fillStyle=this.ringColor;X.strokeStyle=this.ringColor;this.needleLength=(this.tickOuterRadius-this.tickLength)*0.85;this.needleThickness=(this.needleThickness<2)?2:this.needleThickness;var aK=this.needleThickness*0.4;var x=this.needleLength/10;var s=(this.needleThickness-aK)/10;var ar;for(var aa=0;aa<10;aa++){ar=this.needleThickness-aa*s;X.moveTo(x*aa*Math.cos(al),x*aa*Math.sin(al));X.lineWidth=ar;X.lineTo(x*(aa+1)*Math.cos(al),x*(aa+1)*Math.sin(al));X.stroke()}X.restore()}else{this._center=[(K-at*ai)/2+at*ai,(S-at*ah)/2+at*ah]}};c.jqplot.MeterGaugeAxisRenderer=function(){c.jqplot.LinearAxisRenderer.call(this)};c.jqplot.MeterGaugeAxisRenderer.prototype=new c.jqplot.LinearAxisRenderer();c.jqplot.MeterGaugeAxisRenderer.prototype.constructor=c.jqplot.MeterGaugeAxisRenderer;c.jqplot.MeterGaugeAxisRenderer.prototype.init=function(e){this.tickRenderer=c.jqplot.MeterGaugeTickRenderer;c.extend(true,this,e);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};c.jqplot.MeterGaugeLegendRenderer=function(){c.jqplot.TableLegendRenderer.call(this)};c.jqplot.MeterGaugeLegendRenderer.prototype=new c.jqplot.TableLegendRenderer();c.jqplot.MeterGaugeLegendRenderer.prototype.constructor=c.jqplot.MeterGaugeLegendRenderer;c.jqplot.MeterGaugeLegendRenderer.prototype.init=function(e){this.numberRows=null;this.numberColumns=null;c.extend(true,this,e)};c.jqplot.MeterGaugeLegendRenderer.prototype.draw=function(){if(this.show){var p=this._series;var x="position:absolute;";x+=(this.background)?"background:"+this.background+";":"";x+=(this.border)?"border:"+this.border+";":"";x+=(this.fontSize)?"font-size:"+this.fontSize+";":"";x+=(this.fontFamily)?"font-family:"+this.fontFamily+";":"";x+=(this.textColor)?"color:"+this.textColor+";":"";x+=(this.marginTop!=null)?"margin-top:"+this.marginTop+";":"";x+=(this.marginBottom!=null)?"margin-bottom:"+this.marginBottom+";":"";x+=(this.marginLeft!=null)?"margin-left:"+this.marginLeft+";":"";x+=(this.marginRight!=null)?"margin-right:"+this.marginRight+";":"";this._elem=c('<table class="jqplot-table-legend" style="'+x+'"></table>');var f=false,q=false,u,o;var w=p[0];if(w.show){var t=w.data;if(this.numberRows){u=this.numberRows;if(!this.numberColumns){o=Math.ceil(t.length/u)}else{o=this.numberColumns}}else{if(this.numberColumns){o=this.numberColumns;u=Math.ceil(t.length/this.numberColumns)}else{u=t.length;o=1}}var n,m,r,g,e,l,k,h;var v=0;for(n=0;n<u;n++){if(q){r=c('<tr class="jqplot-table-legend"></tr>').prependTo(this._elem)}else{r=c('<tr class="jqplot-table-legend"></tr>').appendTo(this._elem)}for(m=0;m<o;m++){if(v<t.length){l=this.labels[v]||t[v][0].toString();h=w.color;if(!q){if(n>0){f=true}else{f=false}}else{if(n==u-1){f=false}else{f=true}}k=(f)?this.rowSpacing:"0";g=c('<td class="jqplot-table-legend" style="text-align:center;padding-top:'+k+';"><div><div class="jqplot-table-legend-swatch" style="border-color:'+h+';"></div></div></td>');e=c('<td class="jqplot-table-legend" style="padding-top:'+k+';"></td>');if(this.escapeHtml){e.text(l)}else{e.html(l)}if(q){e.prependTo(r);g.prependTo(r)}else{g.appendTo(r);e.appendTo(r)}f=true}v++}}}}return this._elem};function a(j,h,f){f=f||{};f.axesDefaults=f.axesDefaults||{};f.legend=f.legend||{};f.seriesDefaults=f.seriesDefaults||{};f.grid=f.grid||{};var e=false;if(f.seriesDefaults.renderer==c.jqplot.MeterGaugeRenderer){e=true}else{if(f.series){for(var g=0;g<f.series.length;g++){if(f.series[g].renderer==c.jqplot.MeterGaugeRenderer){e=true}}}}if(e){f.axesDefaults.renderer=c.jqplot.MeterGaugeAxisRenderer;f.legend.renderer=c.jqplot.MeterGaugeLegendRenderer;f.legend.preDraw=true;f.grid.background=f.grid.background||"white";f.grid.drawGridlines=false;f.grid.borderWidth=(f.grid.borderWidth!=null)?f.grid.borderWidth:0;f.grid.shadow=(f.grid.shadow!=null)?f.grid.shadow:false}}function d(e){}c.jqplot.preInitHooks.push(a);c.jqplot.postParseOptionsHooks.push(d);c.jqplot.MeterGaugeTickRenderer=function(){c.jqplot.AxisTickRenderer.call(this)};c.jqplot.MeterGaugeTickRenderer.prototype=new c.jqplot.AxisTickRenderer();c.jqplot.MeterGaugeTickRenderer.prototype.constructor=c.jqplot.MeterGaugeTickRenderer})(jQuery);/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.4r1121
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(e){e.jqplot.PieRenderer=function(){e.jqplot.LineRenderer.call(this)};e.jqplot.PieRenderer.prototype=new e.jqplot.LineRenderer();e.jqplot.PieRenderer.prototype.constructor=e.jqplot.PieRenderer;e.jqplot.PieRenderer.prototype.init=function(q,u){this.diameter=null;this.padding=20;this.sliceMargin=0;this.fill=true;this.shadowOffset=2;this.shadowAlpha=0.07;this.shadowDepth=5;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.dataLabels="percent";this.showDataLabels=false;this.dataLabelFormatString=null;this.dataLabelThreshold=3;this.dataLabelPositionFactor=0.52;this.dataLabelNudge=2;this.dataLabelCenterOn=true;this.startAngle=0;this.tickRenderer=e.jqplot.PieTickRenderer;this._drawData=true;this._type="pie";if(q.highlightMouseDown&&q.highlightMouseOver==null){q.highlightMouseOver=false}e.extend(true,this,q);if(this.sliceMargin<0){this.sliceMargin=0}this._diameter=null;this._radius=null;this._sliceAngles=[];this._highlightedPoint=null;if(this.highlightColors.length==0){for(var s=0;s<this.seriesColors.length;s++){var r=e.jqplot.getColorComponents(this.seriesColors[s]);var o=[r[0],r[1],r[2]];var t=o[0]+o[1]+o[2];for(var p=0;p<3;p++){o[p]=(t>570)?o[p]*0.8:o[p]+0.3*(255-o[p]);o[p]=parseInt(o[p],10)}this.highlightColors.push("rgb("+o[0]+","+o[1]+","+o[2]+")")}}this.highlightColorGenerator=new e.jqplot.ColorGenerator(this.highlightColors);u.postParseOptionsHooks.addOnce(m);u.postInitHooks.addOnce(g);u.eventListenerHooks.addOnce("jqplotMouseMove",b);u.eventListenerHooks.addOnce("jqplotMouseDown",a);u.eventListenerHooks.addOnce("jqplotMouseUp",l);u.eventListenerHooks.addOnce("jqplotClick",f);u.eventListenerHooks.addOnce("jqplotRightClick",n);u.postDrawHooks.addOnce(i)};e.jqplot.PieRenderer.prototype.setGridData=function(t){var p=[];var u=[];var o=this.startAngle/180*Math.PI;var s=0;this._drawData=false;for(var r=0;r<this.data.length;r++){if(this.data[r][1]!=0){this._drawData=true}p.push(this.data[r][1]);u.push([this.data[r][0]]);if(r>0){p[r]+=p[r-1]}s+=this.data[r][1]}var q=Math.PI*2/p[p.length-1];for(var r=0;r<p.length;r++){u[r][1]=p[r]*q;u[r][2]=this.data[r][1]/s}this.gridData=u};e.jqplot.PieRenderer.prototype.makeGridData=function(t,u){var p=[];var v=[];var s=0;var o=this.startAngle/180*Math.PI;this._drawData=false;for(var r=0;r<t.length;r++){if(this.data[r][1]!=0){this._drawData=true}p.push(t[r][1]);v.push([t[r][0]]);if(r>0){p[r]+=p[r-1]}s+=t[r][1]}var q=Math.PI*2/p[p.length-1];for(var r=0;r<p.length;r++){v[r][1]=p[r]*q;v[r][2]=t[r][1]/s}return v};function h(o){return Math.sin((o-(o-Math.PI)/8/Math.PI)/2)}function j(u,t,o,v,r){var w=0;var q=t-u;var s=Math.abs(q);var p=o;if(v==false){p+=r}if(p>0&&s>0.01&&s<6.282){w=parseFloat(p)/2/h(q)}return w}e.jqplot.PieRenderer.prototype.drawSlice=function(B,z,y,u,w){if(this._drawData){var p=this._radius;var A=this.fill;var x=this.lineWidth;var s=this.sliceMargin;if(this.fill==false){s+=this.lineWidth}B.save();B.translate(this._center[0],this._center[1]);var D=j(z,y,this.sliceMargin,this.fill,this.lineWidth);var o=D*Math.cos((z+y)/2);var C=D*Math.sin((z+y)/2);if((y-z)<=Math.PI){p-=D}else{p+=D}B.translate(o,C);if(w){for(var v=0,t=this.shadowDepth;v<t;v++){B.save();B.translate(this.shadowOffset*Math.cos(this.shadowAngle/180*Math.PI),this.shadowOffset*Math.sin(this.shadowAngle/180*Math.PI));q(p)}for(var v=0,t=this.shadowDepth;v<t;v++){B.restore()}}else{q(p)}B.restore()}function q(r){if(y>6.282+this.startAngle){y=6.282+this.startAngle;if(z>y){z=6.281+this.startAngle}}if(z>=y){return}B.beginPath();B.fillStyle=u;B.strokeStyle=u;B.lineWidth=x;B.arc(0,0,r,z,y,false);B.lineTo(0,0);B.closePath();if(A){B.fill()}else{B.stroke()}}};e.jqplot.PieRenderer.prototype.draw=function(B,z,E,o){var W;var H=(E!=undefined)?E:{};var t=0;var s=0;var N=1;var L=new e.jqplot.ColorGenerator(this.seriesColors);if(E.legendInfo&&E.legendInfo.placement=="insideGrid"){var J=E.legendInfo;switch(J.location){case"nw":t=J.width+J.xoffset;break;case"w":t=J.width+J.xoffset;break;case"sw":t=J.width+J.xoffset;break;case"ne":t=J.width+J.xoffset;N=-1;break;case"e":t=J.width+J.xoffset;N=-1;break;case"se":t=J.width+J.xoffset;N=-1;break;case"n":s=J.height+J.yoffset;break;case"s":s=J.height+J.yoffset;N=-1;break;default:break}}var K=(H.shadow!=undefined)?H.shadow:this.shadow;var A=(H.fill!=undefined)?H.fill:this.fill;var C=B.canvas.width;var I=B.canvas.height;var Q=C-t-2*this.padding;var X=I-s-2*this.padding;var M=Math.min(Q,X);var Y=M;this._sliceAngles=[];var v=this.sliceMargin;if(this.fill==false){v+=this.lineWidth}var q;var G=0;var R,aa,Z,ab;var D=this.startAngle/180*Math.PI;for(var W=0,V=z.length;W<V;W++){aa=(W==0)?D:z[W-1][1]+D;Z=z[W][1]+D;this._sliceAngles.push([aa,Z]);q=j(aa,Z,this.sliceMargin,this.fill,this.lineWidth);if(Math.abs(Z-aa)>Math.PI){G=Math.max(q,G)}}if(this.diameter!=null&&this.diameter>0){this._diameter=this.diameter-2*G}else{this._diameter=Y-2*G}if(this._diameter<6){e.jqplot.log("Diameter of pie too small, not rendering.");return}var S=this._radius=this._diameter/2;this._center=[(C-N*t)/2+N*t+G*Math.cos(D),(I-N*s)/2+N*s+G*Math.sin(D)];if(this.shadow){for(var W=0,V=z.length;W<V;W++){ab="rgba(0,0,0,"+this.shadowAlpha+")";this.renderer.drawSlice.call(this,B,this._sliceAngles[W][0],this._sliceAngles[W][1],ab,true)}}for(var W=0;W<z.length;W++){this.renderer.drawSlice.call(this,B,this._sliceAngles[W][0],this._sliceAngles[W][1],L.next(),false);if(this.showDataLabels&&z[W][2]*100>=this.dataLabelThreshold){var F,U=(this._sliceAngles[W][0]+this._sliceAngles[W][1])/2,T;if(this.dataLabels=="label"){F=this.dataLabelFormatString||"%s";T=e.jqplot.sprintf(F,z[W][0])}else{if(this.dataLabels=="value"){F=this.dataLabelFormatString||"%d";T=e.jqplot.sprintf(F,this.data[W][1])}else{if(this.dataLabels=="percent"){F=this.dataLabelFormatString||"%d%%";T=e.jqplot.sprintf(F,z[W][2]*100)}else{if(this.dataLabels.constructor==Array){F=this.dataLabelFormatString||"%s";T=e.jqplot.sprintf(F,this.dataLabels[W])}}}}var p=(this._radius)*this.dataLabelPositionFactor+this.sliceMargin+this.dataLabelNudge;var P=this._center[0]+Math.cos(U)*p+this.canvas._offsets.left;var O=this._center[1]+Math.sin(U)*p+this.canvas._offsets.top;var u=e('<div class="jqplot-pie-series jqplot-data-label" style="position:absolute;">'+T+"</div>").insertBefore(o.eventCanvas._elem);if(this.dataLabelCenterOn){P-=u.width()/2;O-=u.height()/2}else{P-=u.width()*Math.sin(U/2);O-=u.height()/2}P=Math.round(P);O=Math.round(O);u.css({left:P,top:O})}}};e.jqplot.PieAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this)};e.jqplot.PieAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer();e.jqplot.PieAxisRenderer.prototype.constructor=e.jqplot.PieAxisRenderer;e.jqplot.PieAxisRenderer.prototype.init=function(o){this.tickRenderer=e.jqplot.PieTickRenderer;e.extend(true,this,o);this._dataBounds={min:0,max:100};this.min=0;this.max=100;this.showTicks=false;this.ticks=[];this.showMark=false;this.show=false};e.jqplot.PieLegendRenderer=function(){e.jqplot.TableLegendRenderer.call(this)};e.jqplot.PieLegendRenderer.prototype=new e.jqplot.TableLegendRenderer();e.jqplot.PieLegendRenderer.prototype.constructor=e.jqplot.PieLegendRenderer;e.jqplot.PieLegendRenderer.prototype.init=function(o){this.numberRows=null;this.numberColumns=null;e.extend(true,this,o)};e.jqplot.PieLegendRenderer.prototype.draw=function(){var r=this;if(this.show){var B=this._series;this._elem=e(document.createElement("table"));this._elem.addClass("jqplot-table-legend");var E={position:"absolute"};if(this.background){E.background=this.background}if(this.border){E.border=this.border}if(this.fontSize){E.fontSize=this.fontSize}if(this.fontFamily){E.fontFamily=this.fontFamily}if(this.textColor){E.textColor=this.textColor}if(this.marginTop!=null){E.marginTop=this.marginTop}if(this.marginBottom!=null){E.marginBottom=this.marginBottom}if(this.marginLeft!=null){E.marginLeft=this.marginLeft}if(this.marginRight!=null){E.marginRight=this.marginRight}this._elem.css(E);var I=false,A=false,o,y;var C=B[0];var p=new e.jqplot.ColorGenerator(C.seriesColors);if(C.show){var J=C.data;if(this.numberRows){o=this.numberRows;if(!this.numberColumns){y=Math.ceil(J.length/o)}else{y=this.numberColumns}}else{if(this.numberColumns){y=this.numberColumns;o=Math.ceil(J.length/this.numberColumns)}else{o=J.length;y=1}}var H,G;var q,w,v;var x,z,F;var D=0;var u,t;for(H=0;H<o;H++){q=e(document.createElement("tr"));q.addClass("jqplot-table-legend");if(A){q.prependTo(this._elem)}else{q.appendTo(this._elem)}for(G=0;G<y;G++){if(D<J.length){x=this.labels[D]||J[D][0].toString();F=p.next();if(!A){if(H>0){I=true}else{I=false}}else{if(H==o-1){I=false}else{I=true}}z=(I)?this.rowSpacing:"0";w=e(document.createElement("td"));w.addClass("jqplot-table-legend jqplot-table-legend-swatch");w.css({textAlign:"center",paddingTop:z});u=e(document.createElement("div"));u.addClass("jqplot-table-legend-swatch-outline");t=e(document.createElement("div"));t.addClass("jqplot-table-legend-swatch");t.css({backgroundColor:F,borderColor:F});w.append(u.append(t));v=e(document.createElement("td"));v.addClass("jqplot-table-legend jqplot-table-legend-label");v.css("paddingTop",z);if(this.escapeHtml){v.text(x)}else{v.html(x)}if(A){v.prependTo(q);w.prependTo(q)}else{w.appendTo(q);v.appendTo(q)}I=true}D++}}}}return this._elem};e.jqplot.PieRenderer.prototype.handleMove=function(q,p,t,s,r){if(s){var o=[s.seriesIndex,s.pointIndex,s.data];r.target.trigger("jqplotDataMouseOver",o);if(r.series[o[0]].highlightMouseOver&&!(o[0]==r.plugins.pieRenderer.highlightedSeriesIndex&&o[1]==r.series[o[0]]._highlightedPoint)){r.target.trigger("jqplotDataHighlight",o);d(r,o[0],o[1])}}else{if(s==null){k(r)}}};function c(s,r,p){p=p||{};p.axesDefaults=p.axesDefaults||{};p.legend=p.legend||{};p.seriesDefaults=p.seriesDefaults||{};var o=false;if(p.seriesDefaults.renderer==e.jqplot.PieRenderer){o=true}else{if(p.series){for(var q=0;q<p.series.length;q++){if(p.series[q].renderer==e.jqplot.PieRenderer){o=true}}}}if(o){p.axesDefaults.renderer=e.jqplot.PieAxisRenderer;p.legend.renderer=e.jqplot.PieLegendRenderer;p.legend.preDraw=true;p.seriesDefaults.pointLabels={show:false}}}function g(r,q,o){for(var p=0;p<this.series.length;p++){if(this.series[p].renderer.constructor==e.jqplot.PieRenderer){if(this.series[p].highlightMouseOver){this.series[p].highlightMouseDown=false}}}}function m(o){for(var p=0;p<this.series.length;p++){this.series[p].seriesColors=this.seriesColors;this.series[p].colorGenerator=e.jqplot.colorGenerator}}function d(t,r,q){var p=t.series[r];var o=t.plugins.pieRenderer.highlightCanvas;o._ctx.clearRect(0,0,o._ctx.canvas.width,o._ctx.canvas.height);p._highlightedPoint=q;t.plugins.pieRenderer.highlightedSeriesIndex=r;p.renderer.drawSlice.call(p,o._ctx,p._sliceAngles[q][0],p._sliceAngles[q][1],p.highlightColorGenerator.get(q),false)}function k(q){var o=q.plugins.pieRenderer.highlightCanvas;o._ctx.clearRect(0,0,o._ctx.canvas.width,o._ctx.canvas.height);for(var p=0;p<q.series.length;p++){q.series[p]._highlightedPoint=null}q.plugins.pieRenderer.highlightedSeriesIndex=null;q.target.trigger("jqplotDataUnhighlight")}function b(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];var p=jQuery.Event("jqplotDataMouseOver");p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q);if(t.series[q[0]].highlightMouseOver&&!(q[0]==t.plugins.pieRenderer.highlightedSeriesIndex&&q[1]==t.series[q[0]]._highlightedPoint)){var o=jQuery.Event("jqplotDataHighlight");o.which=s.which;o.pageX=s.pageX;o.pageY=s.pageY;t.target.trigger(o,q);d(t,q[0],q[1])}}else{if(u==null){k(t)}}}function a(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];if(s.series[p[0]].highlightMouseDown&&!(p[0]==s.plugins.pieRenderer.highlightedSeriesIndex&&p[1]==s.series[p[0]]._highlightedPoint)){var o=jQuery.Event("jqplotDataHighlight");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p);d(s,p[0],p[1])}}else{if(t==null){k(s)}}}function l(q,p,t,s,r){var o=r.plugins.pieRenderer.highlightedSeriesIndex;if(o!=null&&r.series[o].highlightMouseDown){k(r)}}function f(r,q,u,t,s){if(t){var p=[t.seriesIndex,t.pointIndex,t.data];var o=jQuery.Event("jqplotDataClick");o.which=r.which;o.pageX=r.pageX;o.pageY=r.pageY;s.target.trigger(o,p)}}function n(s,r,v,u,t){if(u){var q=[u.seriesIndex,u.pointIndex,u.data];var o=t.plugins.pieRenderer.highlightedSeriesIndex;if(o!=null&&t.series[o].highlightMouseDown){k(t)}var p=jQuery.Event("jqplotDataRightClick");p.which=s.which;p.pageX=s.pageX;p.pageY=s.pageY;t.target.trigger(p,q)}}function i(){if(this.plugins.pieRenderer&&this.plugins.pieRenderer.highlightCanvas){this.plugins.pieRenderer.highlightCanvas.resetCanvas();this.plugins.pieRenderer.highlightCanvas=null}this.plugins.pieRenderer={highlightedSeriesIndex:null};this.plugins.pieRenderer.highlightCanvas=new e.jqplot.GenericCanvas();var p=e(this.targetId+" .jqplot-data-label");if(p.length){e(p[0]).before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions,this))}else{this.eventCanvas._elem.before(this.plugins.pieRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-pieRenderer-highlight-canvas",this._plotDimensions,this))}var o=this.plugins.pieRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind("mouseleave",{plot:this},function(q){k(q.data.plot)})}e.jqplot.preInitHooks.push(c);e.jqplot.PieTickRenderer=function(){e.jqplot.AxisTickRenderer.call(this)};e.jqplot.PieTickRenderer.prototype=new e.jqplot.AxisTickRenderer();e.jqplot.PieTickRenderer.prototype.constructor=e.jqplot.PieTickRenderer})(jQuery);(function($){$.jqplot.PointLabels=function(options){this.show=$.jqplot.config.enablePlugins;this.location='n';this.labelsFromSeries=false;this.seriesLabelIndex=null;this.labels=[];this._labels=[];this.stackedValue=false;this.ypadding=6;this.xpadding=6;this.escapeHTML=true;this.edgeTolerance=-5;this.formatter=$.jqplot.DefaultTickFormatter;this.formatString='';this.hideZeros=false;this._elems=[];$.extend(true,this,options);};var locations=['nw','n','ne','e','se','s','sw','w'];var locationIndicies={'nw':0,'n':1,'ne':2,'e':3,'se':4,'s':5,'sw':6,'w':7};var oppositeLocations=['se','s','sw','w','nw','n','ne','e'];$.jqplot.PointLabels.init=function(target,data,seriesDefaults,opts,plot){var options=$.extend(true,{},seriesDefaults,opts);options.pointLabels=options.pointLabels||{};if(this.renderer.constructor===$.jqplot.BarRenderer&&this.barDirection==='horizontal'&&!options.pointLabels.location){options.pointLabels.location='e';}
this.plugins.pointLabels=new $.jqplot.PointLabels(options.pointLabels);this.plugins.pointLabels.setLabels.call(this);};$.jqplot.PointLabels.prototype.setLabels=function(){var p=this.plugins.pointLabels;var labelIdx;if(p.seriesLabelIndex!=null){labelIdx=p.seriesLabelIndex;}
else if(this.renderer.constructor===$.jqplot.BarRenderer&&this.barDirection==='horizontal'){labelIdx=0;}
else{labelIdx=(this._plotData.length===0)?0:this._plotData[0].length-1;}
p._labels=[];if(p.labels.length===0||p.labelsFromSeries){if(p.stackedValue){if(this._plotData.length&&this._plotData[0].length){for(var i=0;i<this._plotData.length;i++){p._labels.push(this._plotData[i][labelIdx]);}}}
else{var d=this.data;if(this.renderer.constructor===$.jqplot.BarRenderer&&this.waterfall){d=this._data;}
if(d.length&&d[0].length){for(var i=0;i<d.length;i++){p._labels.push(d[i][labelIdx]);}}
d=null;}}
else if(p.labels.length){p._labels=p.labels;}};$.jqplot.PointLabels.prototype.xOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case'nw':offset=-elem.outerWidth(true)-this.xpadding;break;case'n':offset=-elem.outerWidth(true)/2;break;case'ne':offset=this.xpadding;break;case'e':offset=this.xpadding;break;case'se':offset=this.xpadding;break;case's':offset=-elem.outerWidth(true)/2;break;case'sw':offset=-elem.outerWidth(true)-this.xpadding;break;case'w':offset=-elem.outerWidth(true)-this.xpadding;break;default:offset=-elem.outerWidth(true)-this.xpadding;break;}
return offset;};$.jqplot.PointLabels.prototype.yOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case'nw':offset=-elem.outerHeight(true)-this.ypadding;break;case'n':offset=-elem.outerHeight(true)-this.ypadding;break;case'ne':offset=-elem.outerHeight(true)-this.ypadding;break;case'e':offset=-elem.outerHeight(true)/2;break;case'se':offset=this.ypadding;break;case's':offset=this.ypadding;break;case'sw':offset=this.ypadding;break;case'w':offset=-elem.outerHeight(true)/2;break;default:offset=-elem.outerHeight(true)-this.ypadding;break;}
return offset;};$.jqplot.PointLabels.draw=function(sctx,options,plot){var p=this.plugins.pointLabels;p.setLabels.call(this);for(var i=0;i<p._elems.length;i++){p._elems[i].emptyForce();}
p._elems.splice(0,p._elems.length);if(p.show){var ax='_'+this._stackAxis+'axis';if(!p.formatString){p.formatString=this[ax]._ticks[0].formatString;p.formatter=this[ax]._ticks[0].formatter;}
var pd=this._plotData;var ppd=this._prevPlotData;var xax=this._xaxis;var yax=this._yaxis;var elem,helem;for(var i=0,l=p._labels.length;i<l;i++){var label=p._labels[i];if(p.hideZeros&&parseInt(p._labels[i],10)==0){label='';}
if(label!=null){label=p.formatter(p.formatString,label);}
helem=document.createElement('div');p._elems[i]=$(helem);elem=p._elems[i];elem.addClass('jqplot-point-label jqplot-series-'+this.index+' jqplot-point-'+i);elem.css('position','absolute');elem.insertAfter(sctx.canvas);if(p.escapeHTML){elem.text(label);}
else{elem.html(label);}
var location=p.location;if((this.fillToZero&&pd[i][1]<0)||(this.fillToZero&&this._type==='bar'&&this.barDirection==='horizontal'&&pd[i][0]<0)||(this.waterfall&&parseInt(label,10))<0){location=oppositeLocations[locationIndicies[location]];}
var ell=xax.u2p(pd[i][0])+p.xOffset(elem,location);var elt=yax.u2p(pd[i][1])+p.yOffset(elem,location);if(this._stack&&!p.stackedValue){if(this.barDirection==="vertical"){elt=(this._barPoints[i][0][1]+this._barPoints[i][1][1])/2+plot._gridPadding.top-0.5*elem.outerHeight(true);}
else{ell=(this._barPoints[i][2][0]+this._barPoints[i][0][0])/2+plot._gridPadding.left-0.5*elem.outerWidth(true);}}
if(this.renderer.constructor==$.jqplot.BarRenderer){if(this.barDirection=="vertical"){ell+=this._barNudge;}
else{elt-=this._barNudge;}}
elem.css('left',ell);elem.css('top',elt);var elr=ell+elem.width();var elb=elt+elem.height();var et=p.edgeTolerance;var scl=$(sctx.canvas).position().left;var sct=$(sctx.canvas).position().top;var scr=sctx.canvas.width+scl;var scb=sctx.canvas.height+sct;if(ell-et<scl||elt-et<sct||elr+et>scr||elb+et>scb){elem.remove();}
elem=null;helem=null;}}};$.jqplot.postSeriesInitHooks.push($.jqplot.PointLabels.init);$.jqplot.postDrawSeriesHooks.push($.jqplot.PointLabels.draw);})(jQuery);/**
 * jQuery.ScrollTo - Easy element scrolling using jQuery.
 * Copyright (c) 2007-2009 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 5/25/2009
 * @author Ariel Flesler
 * @version 1.4.2
 *
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 */
;(function(d){var k=d.scrollTo=function(a,i,e){d(window).scrollTo(a,i,e)};k.defaults={axis:'xy',duration:parseFloat(d.fn.jquery)>=1.3?0:1};k.window=function(a){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){var a=this,i=!a.nodeName||d.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!i)return a;var e=(a.contentWindow||a).document||a.ownerDocument||a;return d.browser.safari||e.compatMode=='BackCompat'?e.body:e.documentElement})};d.fn.scrollTo=function(n,j,b){if(typeof j=='object'){b=j;j=0}if(typeof b=='function')b={onAfter:b};if(n=='max')n=9e9;b=d.extend({},k.defaults,b);j=j||b.speed||b.duration;b.queue=b.queue&&b.axis.length>1;if(b.queue)j/=2;b.offset=p(b.offset);b.over=p(b.over);return this._scrollable().each(function(){var q=this,r=d(q),f=n,s,g={},u=r.is('html,body');switch(typeof f){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(f)){f=p(f);break}f=d(f,this);case'object':if(f.is||f.style)s=(f=d(f)).offset()}d.each(b.axis.split(''),function(a,i){var e=i=='x'?'Left':'Top',h=e.toLowerCase(),c='scroll'+e,l=q[c],m=k.max(q,i);if(s){g[c]=s[h]+(u?0:l-r.offset()[h]);if(b.margin){g[c]-=parseInt(f.css('margin'+e))||0;g[c]-=parseInt(f.css('border'+e+'Width'))||0}g[c]+=b.offset[h]||0;if(b.over[h])g[c]+=f[i=='x'?'width':'height']()*b.over[h]}else{var o=f[h];g[c]=o.slice&&o.slice(-1)=='%'?parseFloat(o)/100*m:o}if(/^\d+$/.test(g[c]))g[c]=g[c]<=0?0:Math.min(g[c],m);if(!a&&b.queue){if(l!=g[c])t(b.onAfterFirst);delete g[c]}});t(b.onAfter);function t(a){r.animate(g,j,b.easing,a&&function(){a.call(this,n,b)})}}).end()};k.max=function(a,i){var e=i=='x'?'Width':'Height',h='scroll'+e;if(!d(a).is('html,body'))return a[h]-d(a)[e.toLowerCase()]();var c='client'+e,l=a.ownerDocument.documentElement,m=a.ownerDocument.body;return Math.max(l[h],m[h])-Math.min(l[c],m[c])};function p(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);/*
 * jQuery.SerialScroll - Animated scrolling of series
 * Copyright (c) 2007-2009 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 06/14/2009
 * @author Ariel Flesler
 * @version 1.2.2
 * http://flesler.blogspot.com/2008/02/jqueryserialscroll.html
 */
;(function(a){var b=a.serialScroll=function(c){return a(window).serialScroll(c)};b.defaults={duration:1e3,axis:"x",event:"click",start:0,step:1,lock:!0,cycle:!0,constant:!0};a.fn.serialScroll=function(c){return this.each(function(){var t=a.extend({},b.defaults,c),s=t.event,i=t.step,r=t.lazy,e=t.target?this:document,u=a(t.target||this,e),p=u[0],m=t.items,h=t.start,g=t.interval,k=t.navigation,l;if(!r){m=d()}if(t.force){f({},h)}a(t.prev||[],e).bind(s,-i,q);a(t.next||[],e).bind(s,i,q);if(!p.ssbound){u.bind("prev.serialScroll",-i,q).bind("next.serialScroll",i,q).bind("goto.serialScroll",f)}if(g){u.bind("start.serialScroll",function(v){if(!g){o();g=!0;n()}}).bind("stop.serialScroll",function(){o();g=!1})}u.bind("notify.serialScroll",function(x,w){var v=j(w);if(v>-1){h=v}});p.ssbound=!0;if(t.jump){(r?u:d()).bind(s,function(v){f(v,j(v.target))})}if(k){k=a(k,e).bind(s,function(v){v.data=Math.round(d().length/k.length)*k.index(this);f(v,this)})}function q(v){v.data+=h;f(v,this)}function f(B,z){if(!isNaN(z)){B.data=z;z=p}var C=B.data,v,D=B.type,A=t.exclude?d().slice(0,-t.exclude):d(),y=A.length,w=A[C],x=t.duration;if(D){B.preventDefault()}if(g){o();l=setTimeout(n,t.interval)}if(!w){v=C<0?0:y-1;if(h!=v){C=v}else{if(!t.cycle){return}else{C=y-v-1}}w=A[C]}if(!w||t.lock&&u.is(":animated")||D&&t.onBefore&&t.onBefore(B,w,u,d(),C)===!1){return}if(t.stop){u.queue("fx",[]).stop()}if(t.constant){x=Math.abs(x/i*(h-C))}u.scrollTo(w,x,t).trigger("notify.serialScroll",[C])}function n(){u.trigger("next.serialScroll")}function o(){clearTimeout(l)}function d(){return a(m,p)}function j(w){if(!isNaN(w)){return w}var x=d(),v;while((v=x.index(w))==-1&&w!=p){w=w.parentNode}return v}})}})(jQuery);/**
 * MPageComponent constructor
 * @constructor
 */
function MPageComponent() {

	//General variables
	this.m_AutoSuggestAddTimerName = "";
	this.m_AutoSuggestScript = "";
	this.m_brlookbackUnits = 0;
	this.m_brlookbackUnitTypeFlag = 0;
	this.m_column = 0;
	this.m_componentPreferences = null;
	this.m_compDisp = true;
	this.m_compLoad = false;
	this.m_compLoadTimerName = "";
	this.m_compMenuId = "";
	this.m_componentId = 0.0;
	this.m_compRenderTimerName = "";
	this.m_componentTable = null;
	this.criterion = null;
	//m_dateFormat: 1 = date only,2= date/time and 3 = elapsed time
	this.m_dateFormat = 2;
	this.m_displayFilters = null;
	this.m_editMode = false;
	this.m_filterMappingsObj = {};
	this.m_footerText = "";
	//m_grouper_arr: an array of objects structure like {"label":"group label", "eventSets": []}
	this.m_grouper_arr = [];
	this.m_grouperFilterCatalogCodes = null;
	this.m_grouperFilterCatLabel = "";
	this.m_grouperFilterCriteria = null;
	this.m_grouperFilterEventSets = null;
	this.m_grouperFilterLabel = "";
	this.m_groups = null;
	this.m_hasActionsMenu = false;
	this.m_hasCompFilters = false;
	this.m_hasLookBackDropDown = false;
	this.m_includeLineNumber = false;
	this.m_isAlwaysExpanded = false;
	this.m_isCustomizeView = false;
	this.m_isExpanded = false;
	this.m_isPlusAdd = false;
	this.m_isScrollEnabled = false;
	this.m_iViewItemsArr = [];
	this.m_iViewMenuItems = null;
	this.m_label = "";
	this.m_link = "";
	this.m_lookbackDays = 0;
	this.m_lookBackMenuItems = null;
	this.m_lookbackUnits = 0;
	//m_lookbackUnitTypeFlag: 1 = hours,2=Days,3=Weeks,4= Months,5= Years
	this.m_lookbackUnitTypeFlag = 0;
	this.m_menuItems = null;
	this.m_menuOptionNames = [];
	this.m_menuOptions = [];
	this.m_newLink = false;
	this.m_pageGroupSeq = 0;
	this.m_renderStrategy = null;
	this.m_reportId = 0;
	this.m_reportMean = "";
	this.m_resourceRequired = false;
	this.m_rootComponentNode = null;
	this.m_sectionContentNode = null;
	this.m_sequence = 0;
	//m_scope: 1=person,2=encounter
	this.m_scope = 0;
	this.m_ScopeHTML = "";
	this.m_scrollNumber = 0;
	this.m_selectedDataGroup = null;
	this.m_selectedTimeFrame = null;
	this.m_styles = null;
	this.m_subLabel = "";
	//m_toggleStatus: 0 - component off, 1 - component on, 2 - component retuired
	this.m_toggleStatus = 1;
	this.m_totalResults = false;
	this.m_xOFy = false;

}

/* Adders - functions used to add content to MPageComponent object elements */
MPageComponent.prototype.addDisplayFilter = function(value) {
	if(this.m_displayFilters === null) {
		this.m_displayFilters = [];
	}
	this.m_displayFilters.push(value);
};

/**
 * Add a filter mapping object to the collection of filter mappings.  Filter mappings are referenced by name, so if a filter already
 * exists with the same name it will be overwritten.
 * @param {String} filterName The name of the filter object to add.
 * @param {Object} filterObject The object containing all of the filter properties used when loading settings.
 */
MPageComponent.prototype.addFilterMappingObject = function(filterName, filterObject) {
	this.m_filterMappingsObj[filterName] = filterObject;
};

MPageComponent.prototype.addIViewMenuItem = function(value) {
	if(this.m_iViewMenuItems === null) {
		this.m_iViewMenuItems = [];
	}
	this.m_iViewMenuItems.push(value);
};

MPageComponent.prototype.addLookbackMenuItem = function(value) {
	if(this.m_lookBackMenuItems === null) {
		this.m_lookBackMenuItems = [];
	}
	this.m_lookBackMenuItems.push(value);
};

MPageComponent.prototype.addGroup = function(value) {
	if(this.m_groups === null) {
		this.m_groups = [];
	}
	this.m_groups.push(value);
};

MPageComponent.prototype.addGrouperFilterCatalogCodes = function(value) {
	if(this.m_grouperFilterCatalogCodes === null) {
		this.m_grouperFilterCatalogCodes = [];
	}
	this.m_grouperFilterCatalogCodes.push(value);
};

MPageComponent.prototype.addGrouperFilterCriteria = function(value) {
	if(this.m_grouperFilterCriteria === null) {
		this.m_grouperFilterCriteria = [];
	}
	this.m_grouperFilterCriteria.push(value);

};

MPageComponent.prototype.addGrouperFilterEventSets = function(value) {
	this.addGrouperFilterCriteria(value);
};

MPageComponent.prototype.addMenuDither = function(itemName) {
	var menuItem = _g(this.m_menuOptions[itemName].id);
	if(menuItem) {
		Util.Style.acss(menuItem, "opts-menu-item-dthr");
		this.m_menuOptions[itemName].isMenuDithered = true;
	}
};

MPageComponent.prototype.addMenuItem = function(value) {
	if(this.m_menuItems === null) {
		this.m_menuItems = [];
	}
	this.m_menuItems.push(value);
};

MPageComponent.prototype.addMenuOption = function(itemName, id, text, ditherOnLoad, evtType, fn) {
	var actionSec = _g("optsMenuActions" + this.m_componentId);
	if(actionSec) {
		if(!actionSec.hasChildNodes()) {
			var isMenuDithered = (ditherOnLoad) ? ditherOnLoad : false;
			this.m_menuOptions[itemName] = {
				itemName : itemName,
				id : id,
				text : text,
				ditherOnLoad : ditherOnLoad,
				isMenuDithered : isMenuDithered,
				evtType : evtType,
				fn : fn
			};
			this.m_menuOptionNames.push(itemName);
		}
	}
};

/* Getters - functions used to retrieve items stored within the MPageComponent object*/
MPageComponent.prototype.getAutoSuggestAddScript = function() {
	return (this.m_AutoSuggestScript);
};

MPageComponent.prototype.getAutoSuggestAddTimerName = function() {
	return (this.m_AutoSuggestAddTimerName);
};

MPageComponent.prototype.getBrLookbackUnits = function() {
	return (this.m_brlookbackUnits);
};

MPageComponent.prototype.getBrLookbackUnitTypeFlag = function() {
	return (this.m_brlookbackUnitTypeFlag);
};

MPageComponent.prototype.getColumn = function() {
	return (this.m_column);
};

MPageComponent.prototype.getCompColor = function() {
	var style = this.getStyles();
	if(style) {
		return style.getColor();
	}
	else {
		return;
	}
};

MPageComponent.prototype.getComponentId = function() {
	return (this.m_componentId);
};

MPageComponent.prototype.getComponentLoadTimerName = function() {
	return (this.m_compLoadTimerName);
};

MPageComponent.prototype.getComponentRenderTimerName = function() {
	return (this.m_compRenderTimerName);
};

/**
 * Architectural method of creating a component's table to ensure that necessary fields are set.
 * Namely the namespace of the table which ensures unique identifiers for table DOM elements. 
 * This helps to enforce namespacing.
 */
MPageComponent.prototype.getComponentTable = function() {
	return this.m_componentTable;
};

/**
 * For each compoent a criterion is defined for usage.  This criterion contains information such
 * as the person, encounter, personnel, etc.
 * @return {Criterion} Returns a Criterion object containing information such as the patient, encounter, personnel.
 */
MPageComponent.prototype.getCriterion = function() {
	return (this.criterion);
};

MPageComponent.prototype.getCustomizeView = function() {
	return this.m_isCustomizeView;
};

MPageComponent.prototype.getDateFormat = function() {
	//1 = date only,2= date/time and 3 = elapsed time
	return (this.m_dateFormat);
};

MPageComponent.prototype.getDisplayEnabled = function() {
	return (this.m_compDisp);
};

MPageComponent.prototype.getDisplayFilters = function() {
	return this.m_displayFilters;
};

MPageComponent.prototype.getFilters = function() {
	return (this.m_filters);
};

/**
 * Gets the array of filter mapping objects used to apply MPages View level settings.
 * @return {Array[Object]} An array of filter mapping objects.
 */
MPageComponent.prototype.getFilterMappingsObj = function() {
	return this.m_filterMappingsObj;
};

MPageComponent.prototype.getFooterText = function() {
	return (this.m_footerText);
};

MPageComponent.prototype.getGrouperCatalogCodes = function(index) {
	if(index !== null && !isNaN(index)) {
		return (this.m_grouper_arr[index]) ? this.m_grouper_arr[index].catalogCodes : "";
	}
};

MPageComponent.prototype.getGrouperCatLabel = function(index) {
	if(index !== null && !isNaN(index)) {
		return (this.m_grouper_arr[index]) ? this.m_grouper_arr[index].catLabel : "";
	}
};

MPageComponent.prototype.getGrouperCriteria = function(index) {
	if(index !== null && !isNaN(index)) {
		return (this.m_grouper_arr[index]) ? this.m_grouper_arr[index].criteria : "";
	}
};

MPageComponent.prototype.getGrouperFilterCatalogCodes = function() {
	return this.m_grouperFilterCatalogCodes;
};

MPageComponent.prototype.getGrouperFilterCatLabel = function() {
	return this.m_grouperFilterCatLabel;
};

MPageComponent.prototype.getGrouperFilterCriteria = function() {
	return this.m_grouperFilterCriteria;
};

MPageComponent.prototype.getGrouperFilterEventSets = function() {
	return (this.getGrouperFilterCriteria());
};

MPageComponent.prototype.getGrouperFilterLabel = function() {
	return this.m_grouperFilterLabel;
};

MPageComponent.prototype.getGrouperEventSets = function(index) {
	return this.getGrouperCriteria(index);
};

MPageComponent.prototype.getGrouperLabel = function(index) {
	if(index !== null && !isNaN(index)) {
		return (this.m_grouper_arr[index]) ? this.m_grouper_arr[index].label : "";
	}
};

MPageComponent.prototype.getGroups = function() {
	if(this.m_groups === null) {
		this.m_groups = [];
	}
	return (this.m_groups);
};

MPageComponent.prototype.getGrp1CatalogCodes = function() {
	return this.getGrouperCatalogCodes(0);
};

MPageComponent.prototype.getGrp1CatLabel = function() {
	return this.getGrouperCatLabel(0);
};

MPageComponent.prototype.getGrp1Criteria = function() {
	return this.getGrouperCriteria(0);
};

MPageComponent.prototype.getGrp1EventSets = function() {
	return this.getGrouperCriteria(0);
};

MPageComponent.prototype.getGrp1Label = function() {
	return this.getGrouperLabel(0);
};

MPageComponent.prototype.getGrp2CatalogCodes = function() {
	return this.getGrouperCatalogCodes(1);
};

MPageComponent.prototype.getGrp2CatLabel = function() {
	return this.getGrouperCatLabel(1);
};

MPageComponent.prototype.getGrp2Criteria = function() {
	return this.getGrouperCriteria(1);
};

MPageComponent.prototype.getGrp2EventSets = function() {
	return this.getGrouperCriteria(1);
};

MPageComponent.prototype.getGrp2Label = function() {
	return this.getGrouperLabel(1);
};

MPageComponent.prototype.getGrp3CatalogCodes = function() {
	return this.getGrouperCatalogCodes(2);
};

MPageComponent.prototype.getGrp3CatLabel = function() {
	return this.getGrouperCatLabel(2);
};

MPageComponent.prototype.getGrp3Criteria = function() {
	return this.getGrouperCriteria(2);
};

MPageComponent.prototype.getGrp3EventSets = function() {
	return this.getGrouperCriteria(2);
};

MPageComponent.prototype.getGrp3Label = function() {
	return this.getGrouperLabel(2);
};

MPageComponent.prototype.getGrp4CatalogCodes = function() {
	return this.getGrouperCatalogCodes(3);
};

MPageComponent.prototype.getGrp4CatLabel = function() {
	return this.getGrouperCatLabel(3);
};

MPageComponent.prototype.getGrp4Criteria = function() {
	return this.getGrouperCriteria(3);
};

MPageComponent.prototype.getGrp4EventSets = function() {
	return this.getGrouperCriteria(3);
};

MPageComponent.prototype.getGrp4Label = function() {
	return this.getGrouperLabel(3);
};

MPageComponent.prototype.getGrp5CatalogCodes = function() {
	return this.getGrouperCatalogCodes(4);
};

MPageComponent.prototype.getGrp5CatLabel = function() {
	return this.getGrouperCatLabel(4);
};

MPageComponent.prototype.getGrp5Criteria = function() {
	return this.getGrouperCriteria(4);
};

MPageComponent.prototype.getGrp5EventSets = function() {
	return this.getGrouperCriteria(4);
};

MPageComponent.prototype.getGrp5Label = function() {
	return this.getGrouperLabel(4);
};

MPageComponent.prototype.getGrp6CatalogCodes = function() {
	return this.getGrouperCatalogCodes(5);
};

MPageComponent.prototype.getGrp6CatLabel = function() {
	return this.getGrouperCatLabel(5);
};

MPageComponent.prototype.getGrp6Criteria = function() {
	return this.getGrouperCriteria(5);
};

MPageComponent.prototype.getGrp6EventSets = function() {
	return this.getGrouperCriteria(5);
};

MPageComponent.prototype.getGrp6Label = function() {
	return this.getGrouperLabel(5);
};

MPageComponent.prototype.getGrp7CatalogCodes = function() {
	return this.getGrouperCatalogCodes(6);
};

MPageComponent.prototype.getGrp7CatLabel = function() {
	return this.getGrouperCatLabel(6);
};

MPageComponent.prototype.getGrp7Criteria = function() {
	return this.getGrouperCriteria(6);
};

MPageComponent.prototype.getGrp7EventSets = function() {
	return this.getGrouperCriteria(6);
};

MPageComponent.prototype.getGrp7Label = function() {
	return this.getGrouperLabel(6);
};

MPageComponent.prototype.getGrp8CatalogCodes = function() {
	return this.getGrouperCatalogCodes(7);
};

MPageComponent.prototype.getGrp8CatLabel = function() {
	return this.getGrouperCatLabel(7);
};

MPageComponent.prototype.getGrp8Criteria = function() {
	return this.getGrouperCriteria(7);
};

MPageComponent.prototype.getGrp8EventSets = function() {
	return this.getGrouperCriteria(7);
};

MPageComponent.prototype.getGrp8Label = function() {
	return this.getGrouperLabel(7);
};

MPageComponent.prototype.getGrp9CatalogCodes = function() {
	return this.getGrouperCatalogCodes(8);
};

MPageComponent.prototype.getGrp9CatLabel = function() {
	return this.getGrouperCatLabel(8);
};

MPageComponent.prototype.getGrp9Criteria = function() {
	return this.getGrouperCriteria(8);
};

MPageComponent.prototype.getGrp9EventSets = function() {
	return this.getGrouperCriteria(8);
};

MPageComponent.prototype.getGrp9Label = function() {
	return this.getGrouperLabel(8);
};

MPageComponent.prototype.getGrp10CatalogCodes = function() {
	return this.getGrouperCatalogCodes(9);
};

MPageComponent.prototype.getGrp10CatLabel = function() {
	return this.getGrouperCatLabel(9);
};

MPageComponent.prototype.getGrp10Criteria = function() {
	return this.getGrouperCriteria(9);
};

MPageComponent.prototype.getGrp10EventSets = function() {
	return this.getGrouperCriteria(9);
};

MPageComponent.prototype.getGrp10Label = function() {
	return this.getGrouperLabel(9);
};

MPageComponent.prototype.getHasActionsMenu = function() {
	return this.m_hasActionsMenu;
};

MPageComponent.prototype.getPreferencesObj = function() {
	return this.m_componentPreferences;
};

MPageComponent.prototype.getIViewItemsArrElement = function(index, nameSelect) {
	if(index !== null && !isNaN(index)) {
		switch(nameSelect) {
			case "BAND":
				return (this.m_iViewItemsArr[index]) ? this.m_iViewItemsArr[index].bandName : "";
			case "SECTION":
				return (this.m_iViewItemsArr[index]) ? this.m_iViewItemsArr[index].sectionName : "";
			case "ITEM":
				return (this.m_iViewItemsArr[index]) ? this.m_iViewItemsArr[index].itemName : "";
			default:
				return "";
		}
	}
};

MPageComponent.prototype.getIViewMenuItems = function() {
	return this.m_iViewMenuItems;
};

MPageComponent.prototype.getLabel = function() {
	return (this.m_label);
};

MPageComponent.prototype.getLink = function() {
	return (this.m_link);
};

MPageComponent.prototype.getLookbackDays = function() {
	return (this.m_lookbackDays);
};

MPageComponent.prototype.getLookbackMenuItems = function() {
	return this.m_lookBackMenuItems;
};

MPageComponent.prototype.getLookbackUnits = function() {
	return (this.m_lookbackUnits);
};

MPageComponent.prototype.getLookbackUnitTypeFlag = function() {
	return (this.m_lookbackUnitTypeFlag);
};

/**
 * Retrieves the menu that is created by the architecture for this component
 * @return {Menu} The Menu object created for this component by the architecture
 */
MPageComponent.prototype.getMenu = function(){
	return MP_MenuManager.getMenuObject(this.m_compMenuId);	
};

MPageComponent.prototype.getMenuItems = function() {
	return this.m_menuItems;
};

MPageComponent.prototype.getMenuOptionNames = function() {
	return this.m_menuOptionNames;
};

MPageComponent.prototype.getMenuOptions = function() {
	return this.m_menuOptions;
};

MPageComponent.prototype.getMPageName = function() {
	return (this.m_MPageName);
};

MPageComponent.prototype.getPageGroupSequence = function() {
	return (this.m_pageGroupSeq);
};

MPageComponent.prototype.getRenderStrategy = function() {
	return this.m_renderStrategy;
};

MPageComponent.prototype.getReportId = function() {
	return (this.m_reportId);
};

MPageComponent.prototype.getReportMean = function() {
	return (this.m_reportMean);
};

MPageComponent.prototype.getRootComponentNode = function() {
	if(this.m_rootComponentNode === null) {
		var style = this.getStyles();
		this.m_rootComponentNode = _g(style.getId());
	}
	return (this.m_rootComponentNode);
};

MPageComponent.prototype.getSectionContentNode = function() {
	if(this.m_sectionContentNode === null) {
		var style = this.getStyles();
		this.m_sectionContentNode = _g(style.getContentId());
	}
	return (this.m_sectionContentNode);
};

MPageComponent.prototype.getSelectedDataGroup = function() {
	return (this.m_selectedDataGroup);
};

MPageComponent.prototype.getSelectedTimeFrame = function() {
	return (this.m_selectedTimeFrame);
};

MPageComponent.prototype.getSequence = function() {
	return (this.m_sequence);
};

MPageComponent.prototype.getScope = function() {
	return (this.m_scope);
};

MPageComponent.prototype.getScopeHTML = function() {
	return (this.m_ScopeHTML);
};

MPageComponent.prototype.getScrollNumber = function() {
	return (this.m_scrollNumber);
};

MPageComponent.prototype.getSubLabel = function() {
	return (this.m_subLabel);
};

MPageComponent.prototype.getToggleStatus = function() {
	return this.m_toggleStatus;
};

/* Checkers - functions used to check the state of variables contained within the MPageComponent object */
MPageComponent.prototype.hasInfoButton = function() {
	return (this.m_hasInfoButton);
};

MPageComponent.prototype.setHasInfoButton = function(value) {
	this.m_hasInfoButton = (value == 1 ? true : false);
};

MPageComponent.prototype.isInfoButtonEnabled = function() {
	return (this.m_isInfoEnabled);
};

MPageComponent.prototype.setIsInfoButtonEnabled = function(value) {
	this.m_isInfoEnabled = (value == 1 ? true : false);
};

MPageComponent.prototype.showInfoButton = function(compObj, stateInd) {
	var compID = this.m_componentId;
	var contentBodyObj = this.getSectionContentNode();
	//Then search node for info-icon
	infoButtons = $(contentBodyObj).find(".info-icon");
	if(stateInd){
	  $(infoButtons).removeClass("hidden");
	}
	else{
	  $(infoButtons).addClass("hidden");
	}
};

MPageComponent.prototype.hasCompFilters = function() {
	return (this.m_hasCompFilters);
};

MPageComponent.prototype.hasLookBackDropDown = function() {
	return (this.m_hasLookBackDropDown);
};

MPageComponent.prototype.isDisplayable = function() {
	if(this.isComponentFiltered()){
		return false;
	}
	return this.m_compDisp;
};

/**
 * Checks the display filters for the component.
 * @return {boolean} True if the component should not be displayed because of a filter, false otherwise.
 */
MPageComponent.prototype.isComponentFiltered = function(){
	if(this.m_displayFilters !== null && this.m_displayFilters.length > 0) {
		for(var x = this.m_displayFilters.length; x--; ) {
			var displayFilter = this.m_displayFilters[x];
			if(displayFilter.checkFilters() === false) {
				CERN_EventListener.removeAllListeners(this, this);
				return true;
			}
		}
	}
	return false;	
};

MPageComponent.prototype.isAlwaysExpanded = function() {
	return (this.m_isAlwaysExpanded);
};

MPageComponent.prototype.isEditMode = function() {
	return (this.m_editMode);
};

MPageComponent.prototype.isExpanded = function() {
	return (this.m_isExpanded);
};

MPageComponent.prototype.isIViewAdd = function() {
};

/**
 * Return true if the component has been defined as including the line number within the
 * title text of the component.
 */
MPageComponent.prototype.isLineNumberIncluded = function() {
	return this.m_includeLineNumber;
};

MPageComponent.prototype.isLoaded = function() {
	return (this.m_compLoad);
};

MPageComponent.prototype.isMenuDithered = function(itemName) {
	return this.m_menuOptions[itemName].isMenuDithered;
};

MPageComponent.prototype.isNewLink = function() {
	return (this.m_newLink);
};

MPageComponent.prototype.isPlusAddEnabled = function() {
	return (this.m_isPlusAdd);
};

MPageComponent.prototype.isResourceRequired = function() {
	return (this.m_resourceRequired);
};

/**
 * @deprecated Number of results is to be displayed at all times.  Removing the ability to modify.
 */
MPageComponent.prototype.isResultsDisplayEnabled = function() {
	return (this.m_totalResults);
};

MPageComponent.prototype.isScrollingEnabled = function() {
	return (this.m_isScrollEnabled);
};

MPageComponent.prototype.getStyles = function() {
	return (this.m_styles);
};

/**
 * @deprecated Number of results is to be displayed in the (X) format.  Removing the ability to modify.
 */
MPageComponent.prototype.isXofYEnabled = function() {
	return (this.m_xOFy);
};

/* Setters - functions used to set the values of MPageComponent object elements*/
MPageComponent.prototype.setAlwaysExpanded = function(value) {
	this.m_isAlwaysExpanded = value;
};

MPageComponent.prototype.setAutoSuggestAddScript = function(value) {
	this.m_AutoSuggestScript = value;
};

MPageComponent.prototype.setAutoSuggestAddTimerName = function(value) {
	this.m_AutoSuggestAddTimerName = value;
};

MPageComponent.prototype.setBrLookbackUnits = function(value) {
	this.m_brlookbackUnits = value;
};

MPageComponent.prototype.setBrLookbackUnitTypeFlag = function(value) {
	this.m_brlookbackUnitTypeFlag = value;
};

MPageComponent.prototype.setColumn = function(value) {
	this.m_column = value;
};

MPageComponent.prototype.setCompColor = function(color) {
	var style = this.getStyles();
	if(style) {
		if(color && color.length > 0) {
			style.setColor(color);
		}
	}
};

MPageComponent.prototype.setCompFilters = function(value) {
	this.m_hasCompFilters = value;
};

MPageComponent.prototype.setComponentId = function(value) {
	this.m_componentId = value;
	var styles = this.getStyles();
	if(styles !== null) {
		styles.setComponentId(value);
	}
};

MPageComponent.prototype.setComponentLoadTimerName = function(value) {
	this.m_compLoadTimerName = value;
};

MPageComponent.prototype.setComponentRenderTimerName = function(value) {
	this.m_compRenderTimerName = value;
};

MPageComponent.prototype.setComponentTable = function(componentTable) {
	if(!ComponentTable.prototype.isPrototypeOf(componentTable)) {
		throw new Error("Called setComponentTable on MPageComponent with non ComponentTable type for componentTable parameter");
	}
	this.m_componentTable = componentTable;
};

/**
 * Sets the criterion
 * @param {Criterion} value The Criterion object in which to initialize the component with.
 */
MPageComponent.prototype.setCriterion = function(value) {
	this.criterion = value;
};

MPageComponent.prototype.setCustomizeView = function(value) {
	this.m_isCustomizeView = value;
};

MPageComponent.prototype.setDateFormat = function(value) {
	this.m_dateFormat = value;
};

MPageComponent.prototype.setDisplayEnabled = function(value) {
	this.m_compDisp = value;
};

MPageComponent.prototype.setDisplayFilters = function(value) {
	this.m_displayFilters = value;
};

MPageComponent.prototype.setEditMode = function(value) {
	this.m_editMode = value;
};

MPageComponent.prototype.setExpandCollapseState = function(value) {
	this.m_isExpanded = value;
	var i18nCore = i18n.discernabu;
	var parentNode = this.getRootComponentNode();
	var expColNode = Util.Style.g("sec-hd-tgl", parentNode, "span");
	if(value) {
		Util.Style.rcss(parentNode, "closed");
		expColNode[0].innerHTML = "-";
		expColNode[0].title = i18nCore.HIDE_SECTION;
	}
	else {
		Util.Style.acss(parentNode, "closed");
		expColNode[0].innerHTML = "+";
		expColNode[0].title = i18nCore.SHOW_SECTION;
	}
};

MPageComponent.prototype.setExpanded = function(value) {
	this.m_isExpanded = value;
};

/**
 * Sets the filter mappings object which will be used when loading settings from the preferences model.  The filterObj parameter must
 * not be null.  If it is null it will be ignored.
 * @param {Object} filterObj An object which contains the filter mappings of the MPageView object
 * @return {Boolean} True if the m_filterMappingsObj was set to filterObj, false otherwise
 */
MPageComponent.prototype.setFilterMappingsObj = function(filterObj) {
	if(filterObj) {
		this.m_filterMappingsObj = filterObj;
		return true;
	}
	return false;
};

MPageComponent.prototype.setFooterText = function(value) {
	this.m_footerText = value;
};

MPageComponent.prototype.setGrouperCatalogCodes = function(index, CatalogCodeItem) {
	if(index !== null && !isNaN(index)) {
		if(this.m_grouper_arr[index]) {
			this.m_grouper_arr[index].catalogCodes = CatalogCodeItem;
		}
		else {
			this.m_grouper_arr[index] = {};
			this.m_grouper_arr[index].catalogCodes = CatalogCodeItem;
		}
	}
};

MPageComponent.prototype.setGrouperCatLabel = function(index, label) {
	if(index !== null && !isNaN(index)) {
		if(this.m_grouper_arr[index]) {
			this.m_grouper_arr[index].catLabel = label;
		}
		else {
			this.m_grouper_arr[index] = {};
			this.m_grouper_arr[index].catLabel = label;
		}
	}
};

MPageComponent.prototype.setGrouperCriteria = function(index, Criteria) {
	if(index !== null && !isNaN(index)) {
		if(this.m_grouper_arr[index]) {
			this.m_grouper_arr[index].criteria = Criteria;
		}
		else {
			this.m_grouper_arr[index] = {};
			this.m_grouper_arr[index].criteria = Criteria;
		}
	}
};

MPageComponent.prototype.setGrouperEventSets = function(index, EventSetItem) {
	this.setGrouperCriteria(index, EventSetItem);
};

MPageComponent.prototype.setGrouperLabel = function(index, label) {
	if(index !== null && !isNaN(index)) {
		if(this.m_grouper_arr[index]) {
			this.m_grouper_arr[index].label = label;
		}
		else {
			this.m_grouper_arr[index] = {};
			this.m_grouper_arr[index].label = label;
		}
	}
};

MPageComponent.prototype.setGrp1CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(0, value);
};

MPageComponent.prototype.setGrp1CatLabel = function(value) {
	this.setGrouperCatLabel(0, value);
};

MPageComponent.prototype.setGrp1Criteria = function(value) {
	this.setGrouperCriteria(0, value);
};

MPageComponent.prototype.setGrp1EventSets = function(value) {
	this.setGrouperCriteria(0, value);
};

MPageComponent.prototype.setGrp1Label = function(value) {
	this.setGrouperLabel(0, value);
};

MPageComponent.prototype.setGrp2CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(1, value);
};

MPageComponent.prototype.setGrp2CatLabel = function(value) {
	this.setGrouperCatLabel(1, value);
};

MPageComponent.prototype.setGrp2Criteria = function(value) {
	this.setGrouperCriteria(1, value);
};

MPageComponent.prototype.setGrp2EventSets = function(value) {
	this.setGrouperCriteria(1, value);
};

MPageComponent.prototype.setGrp2Label = function(value) {
	this.setGrouperLabel(1, value);
};

MPageComponent.prototype.setGrp3CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(2, value);
};

MPageComponent.prototype.setGrp3CatLabel = function(value) {
	this.setGrouperCatLabel(2, value);
};

MPageComponent.prototype.setGrp3Criteria = function(value) {
	this.setGrouperCriteria(2, value);
};

MPageComponent.prototype.setGrp3EventSets = function(value) {
	this.setGrouperCriteria(2, value);
};

MPageComponent.prototype.setGrp3Label = function(value) {
	this.setGrouperLabel(2, value);
};

MPageComponent.prototype.setGrp4CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(3, value);
};

MPageComponent.prototype.setGrp4CatLabel = function(value) {
	this.setGrouperCatLabel(3, value);
};

MPageComponent.prototype.setGrp4Criteria = function(value) {
	this.setGrouperCriteria(3, value);
};

MPageComponent.prototype.setGrp4EventSets = function(value) {
	this.setGrouperCriteria(3, value);
};

MPageComponent.prototype.setGrp4Label = function(value) {
	this.setGrouperLabel(3, value);
};

MPageComponent.prototype.setGrp5CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(4, value);
};

MPageComponent.prototype.setGrp5CatLabel = function(value) {
	this.setGrouperCatLabel(4, value);
};

MPageComponent.prototype.setGrp5Criteria = function(value) {
	this.setGrouperCriteria(4, value);
};

MPageComponent.prototype.setGrp5EventSets = function(value) {
	this.setGrouperCriteria(4, value);
};

MPageComponent.prototype.setGrp5Label = function(value) {
	this.setGrouperLabel(4, value);
};

MPageComponent.prototype.setGrp6CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(5, value);
};

MPageComponent.prototype.setGrp6CatLabel = function(value) {
	this.setGrouperCatLabel(5, value);
};

MPageComponent.prototype.setGrp6Criteria = function(value) {
	this.setGrouperCriteria(5, value);
};

MPageComponent.prototype.setGrp6EventSets = function(value) {
	this.setGrouperCriteria(5, value);
};

MPageComponent.prototype.setGrp6Label = function(value) {
	this.setGrouperLabel(5, value);
};

MPageComponent.prototype.setGrp7CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(6, value);
};

MPageComponent.prototype.setGrp7CatLabel = function(value) {
	this.setGrouperCatLabel(6, value);
};

MPageComponent.prototype.setGrp7Criteria = function(value) {
	this.setGrouperCriteria(6, value);
};

MPageComponent.prototype.setGrp7Label = function(value) {
	this.setGrouperLabel(6, value);
};

MPageComponent.prototype.setGrp8CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(7, value);
};

MPageComponent.prototype.setGrp8CatLabel = function(value) {
	this.setGrouperCatLabel(7, value);
};

MPageComponent.prototype.setGrp8Criteria = function(value) {
	this.setGrouperCriteria(7, value);
};

MPageComponent.prototype.setGrp8EventSets = function(value) {
	this.setGrouperCriteria(7, value);
};

MPageComponent.prototype.setGrp8Label = function(value) {
	this.setGrouperLabel(7, value);
};

MPageComponent.prototype.setGrp9CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(8, value);
};

MPageComponent.prototype.setGrp9CatLabel = function(value) {
	this.setGrouperCatLabel(8, value);
};

MPageComponent.prototype.setGrp9Criteria = function(value) {
	this.setGrouperCriteria(8, value);
};

MPageComponent.prototype.setGrp9EventSets = function(value) {
	this.setGrouperCriteria(8, value);
};

MPageComponent.prototype.setGrp9Label = function(value) {
	this.setGrouperLabel(8, value);
};

MPageComponent.prototype.setGrp10CatalogCodes = function(value) {
	this.setGrouperCatalogCodes(9, value);
};

MPageComponent.prototype.setGrp10CatLabel = function(value) {
	this.setGrouperCatLabel(9, value);
};

MPageComponent.prototype.setGrp10Criteria = function(value) {
	this.setGrouperCriteria(9, value);
};

MPageComponent.prototype.setGrp10EventSets = function(value) {
	this.setGrouperCriteria(9, value);
};

MPageComponent.prototype.setGrp10Label = function(value) {
	this.setGrouperLabel(9, value);
};

MPageComponent.prototype.setGrouperFilterCatalogCodes = function(value) {
	this.m_grouperFilterCatalogCodes = value;
};

MPageComponent.prototype.setGrouperFilterCatLabel = function(value) {
	this.m_grouperFilterCatLabel = value;
};

MPageComponent.prototype.setGrouperFilterCriteria = function(value) {
	this.m_grouperFilterCriteria = value;
};

MPageComponent.prototype.setGrouperFilterEventSets = function(value) {
		this.setGrouperFilterCriteria(value);
};

MPageComponent.prototype.setGrouperFilterLabel = function(value) {
	this.m_grouperFilterLabel = value;
};

MPageComponent.prototype.setGroups = function(value) {
	this.m_groups = value;
};

MPageComponent.prototype.setHasActionsMenu = function(value) {
	this.m_hasActionsMenu = value;
};

MPageComponent.prototype.setLookBackDropDown = function(value) {
	this.m_hasLookBackDropDown = value;
};

/**
 * Allows each component to define, based on requirements, whether or not to display the number of
 * line items within the title text of the component.
 * @param {Boolean} value If true, the line number associated to the component will display within the
 * title text of the component.  Else, the line number will not display within the title text of the
 * component.
 */
MPageComponent.prototype.setIncludeLineNumber = function(value) {
	this.m_includeLineNumber = value;
};

MPageComponent.prototype.setIViewItemsArrElement = function(index, sBandName, sSectionName, sItemName) {
	if(index !== null && !isNaN(index)) {
		this.m_iViewItemsArr[index] = {
			bandName : sBandName,
			sectionName : sSectionName,
			itemName : sItemName
		};
	}
};

MPageComponent.prototype.setIViewMenuItems = function(value) {
	this.m_iViewMenuItems = value;
};

MPageComponent.prototype.setLabel = function(value) {
	this.m_label = value;
};

MPageComponent.prototype.setLink = function(value) {
	this.m_link = value;
};

MPageComponent.prototype.setLoaded = function(value) {
	this.m_compLoad = value;
};

MPageComponent.prototype.setLookbackDays = function(value) {
	this.m_lookbackDays = value;
};

MPageComponent.prototype.setLookbackMenuItems = function(value) {
	this.m_lookBackMenuItems = value;
};

MPageComponent.prototype.setLookbackUnits = function(value) {
	this.m_lookbackUnits = value;
};

MPageComponent.prototype.setLookbackUnitTypeFlag = function(value) {
	this.m_lookbackUnitTypeFlag = value;
};

/**
 * Sets the menu object that will be used for this component.  The actual menu object is not stored in the component
 * but is instead stored in the MP_MenuManager cache for Menu objects so it can be accessed outside of the component.
 * @param {Menu} menuObj The menu object that will be used when rendering this components menu
 */
MPageComponent.prototype.setMenu = function(menuObj) {
	//Store the id for this menu so we can fetch it in the getMenu function
	this.m_compMenuId = menuObj.getId();
	//Store the Menu object into the MenuManager cache of Menu objects
	MP_MenuManager.updateMenuObject(menuObj);
};

MPageComponent.prototype.setMenuItems = function(value) {
	this.m_menuItems = value;
};

MPageComponent.prototype.setMenuOptionNames = function(value) {
	if(value) {
		this.m_menuOptionNames = value;
	}
	else {
		this.m_menuOptionNames = [];
	}
};

MPageComponent.prototype.setMenuOptions = function(value) {
	if(value) {
		this.m_menuOptions = value;
	}
	else {
		this.m_menuOptions = [];
	}
};

MPageComponent.prototype.setMenuOptionText = function(itemName, text) {
	if(text) {
		this.m_menuOptions[itemName].text = text;
		var menuItem = _g(this.m_menuOptions[itemName].id);
		if(menuItem) {
			menuItem.innerHTML = text;
		}
	}
};

MPageComponent.prototype.setMPageName = function(value) {
	this.m_MPageName = value;
};

MPageComponent.prototype.setNewLink = function(value) {
	this.m_newLink = value;
};

MPageComponent.prototype.setPageGroupSequence = function(value) {
	this.m_pageGroupSeq = value;
};

MPageComponent.prototype.setPreferencesObj = function(value) {
	this.m_componentPreferences = value;
};

MPageComponent.prototype.setRenderStrategy = function(renderStrategy) {
	if(renderStrategy && RenderStrategy.prototype.isPrototypeOf(renderStrategy)) {
		renderStrategy.setComponentToRender(this);
		this.m_renderStrategy = renderStrategy;
	}
};

MPageComponent.prototype.setPlusAddEnabled = function(value) {
	this.m_isPlusAdd = value;
};

MPageComponent.prototype.setReportId = function(value) {
	this.m_reportId = value;
};

MPageComponent.prototype.setReportMean = function(value) {
	this.m_reportMean = value;
};

MPageComponent.prototype.setResourceRequired = function(value) {
	this.m_resourceRequired = value;
};

/**
 * @deprecated Number of results is to be displayed at all times.  Removing the ability to modify.
 */
MPageComponent.prototype.setResultsDisplayEnabled = function(value) {
	this.m_totalResults = value;
};

MPageComponent.prototype.setRootComponentNode = function(value) {
	this.m_rootComponentNode = value;
};

MPageComponent.prototype.setScope = function(value) {
	this.m_scope = value;
};

MPageComponent.prototype.setScopeHTML = function(value) {
	this.m_ScopeHTML = value;
};

MPageComponent.prototype.setScrollingEnabled = function(value) {
	this.m_isScrollEnabled = value;
};

MPageComponent.prototype.setScrollNumber = function(value) {
	this.m_scrollNumber = value;
};

MPageComponent.prototype.setSectionContentNode = function(value) {
	this.m_sectionContentNode = value;
};

MPageComponent.prototype.setSelectedDataGroup = function(value) {
	this.m_selectedDataGroup = value;
};

MPageComponent.prototype.setSelectedTimeFrame = function(value) {
	this.m_selectedTimeFrame = value;
};

MPageComponent.prototype.setSequence = function(value) {
	this.m_sequence = value;
};

MPageComponent.prototype.setStyles = function(value) {
	this.m_styles = value;
};

MPageComponent.prototype.setSubLabel = function(value) {
	this.m_subLabel = value;
};

MPageComponent.prototype.setToggleStatus = function(toggleStatus) {
	if( typeof toggleStatus === "string") {
		this.m_toggleStatus = parseInt(togleStatus, 10);
	}
	else if( typeof toggleStatus === "number") {
		this.m_toggleStatus = toggleStatus;
	}
};

/**
 * @deprecated Number of results is to be displayed in the (X) format.  Removing the ability to modify.
 */
MPageComponent.prototype.setXofYEnabled = function(value) {
	this.m_xOFy = value;
};

/* Miscellaneous - A variety of functions which are used when rendering the component */

/**
 * Applies a template (class) to the sec-content element, allowing the component to inherit the specified template and its styles
 * @param {string} template : The template (class) to apply to the component
 */
MPageComponent.prototype.applyTemplate = function(template) {
	var contentNode = this.getSectionContentNode();
	Util.Style.acss(contentNode, template);
};

MPageComponent.prototype.createAccordionContent = function(){
	return this.m_renderStrategy.createComponentFilter();
};

MPageComponent.prototype.createAccordionControls = function(){
	var i18nCore = i18n.discernabu;
	var mnuCompId = this.getComponentId();
	var pageControl = $("<div></div>").addClass("lb-pg-hd lb-page-ctrl");
	
	//Create the filter controls
	var setDefaultControl = $("<a></a>").addClass("setDefault").html(i18nCore.SET_AS_DEFAULT);
	var clearAllControl = $("<a></a>").addClass("resetAll").html(i18nCore.RESET_ALL);
	
	// Attach the click events
	setDefaultControl.click(function(){ 
		MP_Core.AppUserPreferenceManager.SaveCompPreferences(mnuCompId); 
	});
	clearAllControl.click(function(){
		MP_Core.AppUserPreferenceManager.ClearCompPreferences(mnuCompId);
	});
	pageControl.append(setDefaultControl);
	pageControl.append(clearAllControl);
	
	return pageControl;
};

MPageComponent.prototype.createMenu = function() {
	var arr = this.m_menuOptionNames;
	var l = arr.length;
	var actionSec = _g("optsMenuActions" + this.m_componentId);
	if(actionSec) {
		if(actionSec.hasChildNodes()) {
			actionSec.innerHTML = "";
		}

		var d = Util.ce('div');
		for(var i = 0; i < l; i++) {
			var optClass = 'opts-menu-item';
			var curOpt = this.m_menuOptions[arr[i]];
			if(curOpt.ditherOnLoad) {
				optClass += ' opts-menu-item-dthr';
			}

			var t = Util.cep("div", {
				id : curOpt.id,
				className : optClass
			});
			t.innerHTML = curOpt.text;
			if(curOpt.evtType && typeof curOpt.fn === 'function') {
				Util.addEvent(t, curOpt.evtType, curOpt.fn);
			}
			d.appendChild(t);
		}

		if(l > 0) {
			var personalizeSec = _g("optsMenupersonalize" + this.m_componentId);
			if(personalizeSec) {
				Util.Style.acss(personalizeSec, "opts-personalize-sec-divider");
			}
		}
		actionSec.appendChild(d);
	}
};

/**
 * This function is used to parse the various fields of a bedrock component filter.  The objects created from the
 * parsing are returned to the calling function so the application of the filter values can be made.
 * @param {object}	compFilter : The JSON object for a component filter containing all of the necessary information
 * for the specific component filer.
 * @return {[MPageGroupValue]} An array of MPageGroupValue objects.
 */
MPageComponent.prototype.getFilterValues = function(compFilter) {
	var value = null;
	var valueArr = [];
	var valueCnt = compFilter.VALUES.length;
	var valueObj = null;
	var x = 0;
	for( x = 0; x < valueCnt; x++) {
		valueObj = compFilter.VALUES[x];
		value = new MPageGroupValue();
		value.setId(valueObj.PARENT_ENTITY_ID);
		value.setName(valueObj.PARENT_ENTITY_NAME);
		value.setMeaning(valueObj.CDF_MEANING);
		value.setDescription(valueObj.FREETEXT_DESC);
		value.setSequence(valueObj.GROUP_SEQ);
		value.setValueSequence(valueObj.VALUE_SEQ);
		value.setValueTypeFlag(valueObj.VALUE_TYPE_FLAG);
		value.setQualifierFlag(valueObj.QUALIFIER_FLAG);
		valueArr.push(value);
	}
	return valueArr;
};

/**
 * Initializes hover functionality for all elements within a specified node that follow a specific pattern:
 * A DL element of class "result-info" immediately followed by an element of class "result-details"
 * @param {node} baseNode : The element to search within (The "scope" of the search)
 */
MPageComponent.prototype.initHovers = function(baseNode) {
	// Obtain all results with the "result-info" class in the base element
	var results = Util.Style.g("result-info", baseNode, "DL");
	// Initialize hovers for each result that follows the pattern
	for(var i = results.length; i--; ) {
		var curResult = results[i];
		// Obtain the element that immediately follows the result in the DOM
		var nextElement = Util.gns(curResult);
		if(nextElement) {
			// If this next element has a "result-details" class, call hs() to set up the hover
			if(Util.Style.ccss(nextElement, "result-details")) {
				hs(curResult, nextElement, this);
			}
		}
	}
};

/**
 * This function is used to process the Category Type Assignment information from a component filter.
 * @param {object} compFilter This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadCategoryTypeAssignments = function(compFilter) {
	var ctaArr = null;
	var ctaCnt = 0;
	var ctaVal = null;
	var curSeq = -1;
	var grouper = null;
	var group = null;
	var x = 0;
	ctaArr = this.getFilterValues(compFilter);
	ctaCnt = ctaArr.length;
	grouper = new MPageGrouper();
	for( x = 0; x < ctaCnt; x++) {
		ctaVal = ctaArr[x];
		if(ctaVal.getSequence() != curSeq) {
			group = new MPageCodeValueGroup();
			curSeq = ctaVal.getSequence();
			group.setSequence(curSeq);
			grouper.addGroup(group);
		}
		group.addCode(ctaVal.getId());
	}
	this.addGroup(grouper);
};

/**
 * This function is used to process the Clinical Event Grouper information from a component filter.
 * @param {object} compFilter This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadCEGroupers = function(compFilter) {
	var ceArr = null;
	var ceCnt = 0;
	var curSeq = -1;
	var desc = "";
	var group = null;
	var grouper = null;
	var groupArr = null;
	var groupCnt = 0;
	var id = 0;
	var value = null;
	var x = 0;
	var y = 0;
	//Understood that these grouped results have a title and then a list of event codes associated
	//to them.  The identifier for each group is that the group sequence is the same for the results.
	//Only one field will have a free text description, the other results will be event codes

	//because bedrock is nice enough to store the grouping of event codes seperate from a flat list of
	//the codes, overwrite the existing group with the new MPageGrouper
	groupArr = this.getGroups();
	if(groupArr && groupArr.length !== 0) {
		groupCnt = groupArr.length;
		for(x = 0; x < groupCnt; x++) {
			group = groupArr[x];
			if(group.getSequence() == compFilter.FILTER_SEQ) {
				ceArr = this.getFilterValues(compFilter);
				ceCnt = ceArr.length;
				grouper = new MPageGrouper();
				grouper.setGroupId(group.getGroupId());
				//for alignment with sequencing of groups
				grouper.setGroupName(group.getGroupName());
				for( y = 0; y < ceCnt; y++) {
					value = ceArr[y];
					if(value.getSequence() != curSeq) {
						curSeq = value.getSequence();
						group = new MPageEventCodeGroup();
						group.setSequence(curSeq);
						grouper.addGroup(group);
					}
					id = value.getId();
					desc = value.getDescription();
					if(id > 0) {
						group.addEventCode(id);
					}
					if(desc !== "") {
						group.setGroupName(desc);
					}
				}
				groupArr[x] = grouper;
			}
		}
	}
};

/**
 * This function is used to process the component color information from a component filter.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadComponentColor = function(compFilter) {
	var colorArr = null;
	var color = null;

	//Make sure the color hasn't already been set by the user preferences
	if(!this.getCompColor()) {
		colorArr = this.getFilterValues(compFilter);
		//Only use the first color returned
		color = colorArr[0].m_meaning.replace("_", "").toLowerCase();
		this.setCompColor(color);
	}
};

/**
 * This function is used to process the Event Code information from a component filter.  This function also handles sequenced Event
 * Code filters.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadEventCodes = function(compFilter) {
	var compGroups = null;
	var compGroupCnt = 0;
	var ecArr = [];
	var ecCnt = 0;
	var group = null;
	var newGroup = false;
	var x = 0;

	//Locate existing group with the same id
	compGroups = this.getGroups();
	compGroupCnt = compGroups.length;
	for( x = 0; x < compGroupCnt; x++) {
		if(compGroups[x].getSequence() == compFilter.FILTER_SEQ) {
			group = compGroups[x];
			break;
		}
	}

	//Check to see if the existing group is already available.
	if(group) {
		if(group.isSequenced()) {
			//If the group is already sequenced we should be done with this set of event codes
			return;
		}
		else {
			//If the group is available and not already sequenced the we are now examining the
			//EVENT_SEQ and need to clear the previous set of event codes
			group.setEventCodes(null);
		}
	}
	else {
		//No group exists for this component filter so create one.
		group = new MPageEventCodeGroup();
		group.setGroupId(compFilter.BR_DATAMART_FILTER_ID);
		group.setGroupName(compFilter.FILTER_MEAN);
		group.setSequence(compFilter.FILTER_SEQ);
		//Set a flag indicating that we are creating a new group
		newGroup = true;
	}

	//Load the event codes
	group.setSequenced(compFilter.FILTER_CATEGORY_MEAN === "EVENT_SEQ" ? true : false);
	ecArr = this.getFilterValues(compFilter);
	ecCnt = ecArr.length;
	for( x = 0; x < ecCnt; x++) {
		group.addEventCode(ecArr[x].getId());
	}

	//Store the group in the component
	if(newGroup) {
		this.addGroup(group);
	}
};

/**
 * This function is used to process the Event Set information from a component filter.  This function also handles sequenced Event
 * Set filters.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadEventSets = function(compFilter) {
	var compGroups = null;
	var compGroupCnt = 0;
	var esArr = null;
	var esCnt = 0;
	var esValue = null;
	var group = null;
	var groupIndx = 0;
	var isMultiValue = false;
	var newGroup = null;
	var seqGroup = null;
	var tempAr = [];
	var tempMap = [];
	var x = 0;
	//Locate existing group with the same id
	compGroups = this.getGroups();
	compGroupCnt = compGroups.length;
	for( x = 0; x < compGroupCnt; x++) {
		if(compGroups[x].getSequence() == compFilter.FILTER_SEQ) {
			group = compGroups[x];
			groupIndx = x;
			break;
		}
	}

	//Check to see if the existing group is already available
	if(group) {
		if(MPageSequenceGroup.prototype.isPrototypeOf(group) || group.isSequenced()) {
			//If the group is already sequenced we should be done with this set of event sets
			return;
		}
		else {
			//If the group is available and not already sequenced the we are now examining the
			//EVENT_SET_SEQ and need to clear the previous set of event codes
			group.setEventSets(null);
		}
	}
	else {
		//No group exists for this component filter so create one
		group = new MPageEventSetGroup();
		group.setGroupId(compFilter.BR_DATAMART_FILTER_ID);
		group.setGroupName(compFilter.FILTER_MEAN);
		group.setSequence(compFilter.FILTER_SEQ);
		newGroup = true;
	}

	//Load the event sets
	group.setSequenced(compFilter.FILTER_CATEGORY_MEAN === "EVENT_SET_SEQ" ? true : false);
	esArr = this.getFilterValues(compFilter);
	esCnt = esArr.length;
	for( x = 0; x < esCnt; x++) {
		esValue = esArr[x];
		group.addEventSet(esValue.getId());
		tempAr.push(esValue.getId());
		//The isMultiValue is special logic used when loading Vitals sequencing on paired results.
		if(esValue.getName() != "CODE_VALUE") {
			isMultiValue = true;
		}
		MP_Util.AddItemToMapArray(tempMap, esValue.getName(), esValue.getId());
	}
	//The isMultiValue is special logic used when loading Vitals sequencing on paired results.
	if(isMultiValue) {
		seqGroup = new MPageSequenceGroup();
		seqGroup.setMultiValue(isMultiValue);
		seqGroup.setItems(tempAr);
		seqGroup.setMapItems(tempMap);
		seqGroup.setSequence(group.getSequence());
		seqGroup.setGroupId(group.getGroupId());
		seqGroup.setGroupName(group.getGroupName());
		if(newGroup){
			this.addGroup(seqGroup);
		}
		else{
			compGroups[groupIndx] = seqGroup;
		}
		return;
	}

	//Store the group in the component
	if(newGroup) {
		this.addGroup(group);
	}
};

/**
 * This function is used to process the iView Options information from a component filter.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadIViewOptions = function(compFilter) {
	var iViewArr = null;
	var iViewCnt = 0;
	var iViewItem = null;
	var menuItem = null;
	var x = 0;
	iViewArr = this.getFilterValues(compFilter);
	iViewCnt = iViewArr.length;
	for( x = 0; x < iViewCnt; x++) {
		iViewItem = iViewArr[x];
		menuItem = new MP_Core.MenuItem();
		menuItem.setName(iViewItem.getName());
		menuItem.setDescription(iViewItem.getDescription());
		menuItem.setId(iViewItem.getId());
		menuItem.setValSequence(iViewItem.getValueSequence());
		menuItem.setValTypeFlag(iViewItem.getValueTypeFlag());
		this.addIViewMenuItem(menuItem);
	}
};

/**
 * This function loads the specialized filter mappings for a component if required.
 * @return {null}
 */
MPageComponent.prototype.loadFilterMappings = function() {
	//Do nothing:  The component will implement this function if necessary
};

/**
 * This function loads the default filter mappings used for all components.  These filter mappings will attempt to handle the parsing
 * and processing of a variety of standard filter types.  If a component needs to handle these types of component filters in a
 * specialized way the component should override the specific filter and handle the processing of the data on its own.
 * @return {null}
 */
MPageComponent.prototype.loadDefaultFilterMappings = function() {
	//Create filter mappings objects complete with any fields necessary
	this.addFilterMappingObject("EVENT", {
		setFunction : this.loadEventCodes,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("EVENT_SET", {
		setFunction : this.loadEventSets,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("PRIM_EVENT_SET", {
		setFunction : this.loadEventSets,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("COLOR_THEME_CDS", {
		setFunction : this.loadComponentColor,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("LOOK_BACK", {
		setFunction : this.loadLookbackOptions,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("PF_MULTI_SELECT", {
		setFunction : this.loadPowerFormOptions,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("IVIEW_SELECT", {
		setFunction : this.loadIViewOptions,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("CAT_TYPE_ASSIGN", {
		setFunction : this.loadCategoryTypeAssignments,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("CE_GROUP", {
		setFunction : this.loadCEGroupers,
		type : "DEFAULT_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("EVENT_SEQ", {
		setFunction : this.loadEventCodes,
		type : "DEFAULT_SEQUENCED_FILTER",
		field : "ALL"
	});
	this.addFilterMappingObject("EVENT_SET_SEQ", {
		setFunction : this.loadEventSets,
		type : "DEFAULT_SEQUENCED_FILTER",
		field : "ALL"
	});
};

/**
 * This function is used to process the Lookback Options information from a component filter.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadLookbackOptions = function(compFilter) {
	var lbArr = null;
	var lbCnt = 0;
	var lookback = null;
	var menuItem = null;
	var x = 0;
	lbArr = this.getFilterValues(compFilter);
	lbCnt = lbArr.length;
	for( x = 0; x < lbCnt; x++) {
		lookback = lbArr[x];
		menuItem = new MP_Core.MenuItem();
		menuItem.setName(lookback.getName());
		menuItem.setDescription(lookback.getDescription());
		menuItem.setMeaning(lookback.getMeaning());
		switch(lookback.getMeaning().toUpperCase()) {
			case"HOURS":
				menuItem.setId(1);
				break;
			case"DAYS":
				menuItem.setId(2);
				break;
			case"WEEKS":
				menuItem.setId(3);
				break;
			case"MONTHS":
				menuItem.setId(4);
				break;
			case"YEARS":
				menuItem.setId(5);
				break;
		}
		this.addLookbackMenuItem(menuItem);
	}
	//Add the default value to the menu
	menuItem = new MP_Core.MenuItem();
	menuItem.setName("CODE_VALUE");
	menuItem.setDescription(this.getBrLookbackUnits());
	menuItem.setId(this.getBrLookbackUnitTypeFlag());
	this.addLookbackMenuItem(menuItem);
};

/**
 * This function is utilized to load the individual filter mappings for a component.  These filter mappings are either defined as a
 * default or defined within the individual implementation of a component.
 * @param {object} mappedFilter : The filter mapping object that will be used to load the compFilter information for the component.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 */
MPageComponent.prototype.loadMappedSettings = function(mappedFilter, compFilter) {
	var field = null;
	var type = null;
	var setFunction = null;
	var valueArr = [];
	var valueCnt = 0;
	var value = null;
	var setValues = [];
	var x = 0;
	valueArr = this.getFilterValues(compFilter);
	valueCnt = valueArr.length;

	//Check to make sure all of the necessary elements are established for the filter mapping
	field = mappedFilter.field;
	type = mappedFilter.type;
	setFunction = mappedFilter.setFunction;
	if(!setFunction || !field || !type) {
		return false;
	}

	//Prepare the parameters to pass into the filter setFunction
	for( x = 0; x < valueCnt; x++) {
		value = valueArr[x];
		switch(field.toUpperCase()) {
			case "FREETEXT_DESC":
				setValues.push(value.getDescription());
				break;
			case "PARENT_ENTITY_ID":
				setValues.push(value.getId());
				break;
			case "NOMEN":
				setValues.push({
					nomen_id : value.getId(),
					seq : value.getValueSequence(),
					qual_flag : value.getQualifierFlag()
				});
				break;
			case "VALUE_SEQ":
				setValues.push({
					id : value.getId(),
					seq : value.getValueSequence()
				});
				break;
			case "LOOK_BACK":
				setValues.push({
					value : value.getDescription(),
					units : value.getMeaning()
				});
				break;
			default:
				break;
		}
	}

	//Make the call into the setFunction with the appropriate parameters.
	switch(type.toUpperCase()) {
		case "ARRAY":
		case "NOMEN":
		case "VALUE_SEQ":
			//Using the call function will pass the setValues in as one array of values
			setFunction.call(this, setValues);
			break;
		case "STRING":
		case "NUMBER":
		case "OBJECT":
			//using the apply function will pass the array setValues in as multiple parameters to the setFunction
			setFunction.apply(this, setValues);
			break;
		case "BOOLEAN":
			setFunction.call(this, (setValues[0] === "1") ? true : false);
			break;
		default:
			//Call the function that the component developer has defined to set the value.  This is generic and what is done with the
			//compFilter is up to the component developer.
			setFunction.call(this, compFilter);
			break;
	}
};

/**
 * This function is used to process the PowerForm Options information from a component filter.
 * @param {object} compFilter : This component filter object which contains all of the necessary information for this specific
 * component filter
 * @return {null}
 */
MPageComponent.prototype.loadPowerFormOptions = function(compFilter) {
	var menuItem = null;
	var pfArr = null;
	var pfCnt = 0;
	var powerForm = null;
	var x = 0;
	pfArr = this.getFilterValues(compFilter);
	pfCnt = pfArr.length;
	for( x = 0; x < pfCnt; x++) {
		powerForm = pfArr[x];
		menuItem = new MP_Core.MenuItem();
		menuItem.setName(powerForm.getName());
		menuItem.setDescription(powerForm.getDescription());
		menuItem.setId(powerForm.getId());
		this.addMenuItem(menuItem);
	}
};

MPageComponent.prototype.openTab = function() {
	alert("ERROR: openTab has not been implemented within the component");
};

MPageComponent.prototype.removeMenuDither = function(itemName) {
	var menuItem = _g(this.m_menuOptions[itemName].id);
	if(menuItem) {
		Util.Style.rcss(menuItem, "opts-menu-item-dthr");
		this.m_menuOptions[itemName].isMenuDithered = false;
	}
};

MPageComponent.prototype.renderAccordion = function(component) {};

/**
 * This function will be used to resize the component based on the type.
 */
MPageComponent.prototype.resizeComponent = function() {
	var calcHeight = "";
	var compHeight = 0;
	var compDOMObj = null;
	var compType = null;
	var container = null;
	var contentBodyHeight = 0;
	var contentBodyObj = null;
	var miscHeight = 20;
	var viewHeight = 0;
	compType = this.getStyles().getComponentType();

	if(compType === CERN_COMPONENT_TYPE_WORKFLOW) {
		container = $("#vwpBody");
		if(!container.length) {
			return;
		}
		viewHeight = $(container).height();

		//Make sure component is rendered
		compDOMObj = $("#" + this.getStyles().getId());
		if(!compDOMObj.length) {
			return;
		}

		//Get the overall height of the content-body section if available at this time
		contentBodyObj = $(compDOMObj).find(".content-body");
		if(contentBodyObj.length) {
			//Get the overall component height
			compHeight = compDOMObj.height();
			//Get the height of the content-body
			contentBodyHeight = $(contentBodyObj).height();
			//Calculate the estimated max height of the components content-body element
			calcHeight = (viewHeight - (compHeight - contentBodyHeight + miscHeight)) + "px";
			//apply the max-height settings
			$(contentBodyObj).css("max-height", calcHeight).css("overflow-y", "auto");
		}
	}
	//If the component has a component table, call the table's post-resize function
	if(this.m_componentTable) {
		this.m_componentTable.updateAfterResize();
	}
};

MPageComponent.prototype.RetrieveRequiredResource = function() {
	alert("ERROR: RetrieveRequiredResource has not been implemented within the component");
};

MPageComponent.prototype.sortGrouperArrayByLabel = function() {
	this.m_grouper_arr.sort(function(a, b) {
		if(a.label && b.label) {
			aLabel = a.label.toUpperCase();
			bLabel = b.label.toUpperCase();
			if(aLabel < bLabel) {
				return -1;
			}
			else {
				if(aLabel === bLabel) {
					return 0;
				}
				else {
					return 1;
				}
			}
		}
		else if(a.catLabel && b.catLabel) {
			aCatLabel = a.catLabel.toUpperCase();
			bCatLabel = b.catLabel.toUpperCase();
			if(aCatLabel < bCatLabel) {
				return -1;
			}
			else {
				if(aCatLabel === bCatLabel) {
					return 0;
				}
				else {
					return 1;
				}
			}
		}
		else if(a.label || a.catLabel) {
			return 1;
		}
		else {
			return -1;
		}
	});

};

MPageComponent.prototype.updateLabel = function(value) {
	this.m_label = value;
	var rootComponentNode = this.getRootComponentNode();
	var secHead = Util.gc(rootComponentNode, 0);
	var secTitle = Util.gc(Util.Style.g('sec-title', secHead, 'span')[0], 0);
	var anchor = _gbt("a", secTitle);
	if(anchor[0]) {//If secTitle is a link update the link
		anchor[0].innerHTML = value;
	}
	else {//otherwise update just the title
		secTitle.innerHTML = value;
	}
};

MPageComponent.prototype.updateSubLabel = function(value) {
	//Update the Label sub header
	this.m_subLabel = value;
	var rootComponentNode = this.getRootComponentNode();
	var totalCount = Util.Style.g("sec-total", rootComponentNode, "span");
	totalCount[0].innerHTML = this.m_subLabel;
};

/* Core - These are the core functions called when instantiating, initializing, rendering and
* finalizing component.  If you are adding or modifying these functions in any way be sure you
* understand the full implications of your actions as ALL components and MPage */

/**
 * Perform any special setup needed for the components before being rendered.  The core functionality saves the criterion
 * object in the component and loads the default filter mappings for all components.
 * @param {Criterion} criterion A criterion object which will be used when performing component actions.
 */
MPageComponent.prototype.initializeComponent = function(criterion) {

	//Set the criterion object for the component
	this.setCriterion(criterion);

	//Load the base component filter mappings and any other mappings the component may need.
	this.loadDefaultFilterMappings();
	this.loadFilterMappings();

	//Perform any other initialization that needs to be done for the component.
};

/**
 * This function is used to load all of the component's settings.  The first part of this process loads all of the architectural
 * settings like the expand/collapse state, component color etc...  First the default and Bedrock defined settings are applied.
 * Once those have been set the User's preferences are then used to override any default settings that have been applied.  The
 * second part of the process sets the non-architectural settings like event set and event code settings defined on a per component
 * basis.  This process uses filter mappings to apply the setting in various ways.  The filter mappings can come from the component
 * definition or from an older switch case in the bedrock.js file.
 * @param {object} compSettings : An object which contains all of the settings that will be applied to a specific component.
 */
MPageComponent.prototype.loadComponentSettings = function(compSettings) {
	var compFilter = null;
	var filterCnt = 0;
	var filterMappingObj = null;
	var mappedFilter = null;
	var oldBRSetPrefFunc = null;
	var prefManager = MP_Core.AppUserPreferenceManager;
	var userPrefs = null;
	var x = 0;

	//Load the default settings
	this.setComponentId(compSettings.BR_DATAMART_FILTER_ID);
	this.setReportId(compSettings.BR_DATAMART_REPORT_ID);
	this.setReportMean(compSettings.REPORT_MEAN);
	this.setLabel(compSettings.LABEL);
	this.setMenuOptionNames(null);
	this.setMenuOptions(null);
	this.setLink(compSettings.LINK);
	this.setResultsDisplayEnabled(compSettings.TOTAL_RESULTS);
	this.setXofYEnabled(compSettings.X_OF_Y);
	this.setScrollNumber(compSettings.SCROLL_NUM);
	this.setScrollingEnabled(compSettings.SCROLL_ENABLED);
	this.setPlusAddEnabled((compSettings.ISPLUSADD == 1 ? true : false));
	this.setDateFormat(compSettings.DATE_DISPLAY_FLAG);
	this.setBrLookbackUnits(compSettings.LOOKBACKUNITS || 0);
	this.setBrLookbackUnitTypeFlag(compSettings.LOOKBACKTYPEFLAG || 0);
	//The following bedrock settings are not applied if they have already been set at the component level
	this.setLookbackDays(this.getLookbackDays() || compSettings.LOOKBACK_DAYS || 0);
	this.setLookbackUnits(this.getLookbackUnits() || compSettings.LOOKBACKUNITS || 0);
	this.setLookbackUnitTypeFlag(this.getLookbackUnitTypeFlag() || compSettings.LOOKBACKTYPEFLAG || 0);
	this.setScope(this.getScope() || compSettings.SCOPE);

	//Retrieve the user level preferences for this component
	userPrefs = prefManager.GetComponentById(compSettings.BR_DATAMART_FILTER_ID);
	//Load the user level settings if available
	if(userPrefs) {
		this.setIsInfoButtonEnabled(userPrefs.IsInfoButtonEnabled);
		this.setExpanded(userPrefs.expanded);
		this.setColumn(userPrefs.col_seq);
		this.setSequence(userPrefs.row_seq);
		this.setPageGroupSequence(userPrefs.group_seq);
		this.setGrouperFilterLabel(userPrefs.grouperFilterLabel || "");
		this.setGrouperFilterCatalogCodes(userPrefs.grouperFilterCatalogCodes || null);
		this.setGrouperFilterCatLabel(userPrefs.grouperFilterCatLabel || "");
		this.setGrouperFilterCriteria(userPrefs.grouperFilterCriteria || null);
		this.setSelectedTimeFrame(userPrefs.selectedTimeFrame || null);
		this.setSelectedDataGroup(userPrefs.selectedDataGroup || null);
		this.setPreferencesObj(userPrefs.preferencesObj || null);
		if(userPrefs.compThemeColor) {
			this.setCompColor(userPrefs.compThemeColor);
		}
		//Set the component toggle status.  If defined as 'Required' in bedrock, override the users prefs.
		//0 - off, 1 - on, 2 - required
		if(userPrefs.toggleStatus !== "undefined" && userPrefs.toggleStatus !== null) {
			if(compSettings.TOGGLE_STATUS !== 2) {
				this.setToggleStatus(userPrefs.toggleStatus);
			}
			else {
				this.setToggleStatus(compSettings.TOGGLE_STATUS);
			}
		}
		else {
			this.setToggleStatus(compSettings.TOGGLE_STATUS);
		}
	}
	else {
		//No user settings for this component so load client level settings
		this.setExpanded(compSettings.EXPANDED);
		this.setColumn(compSettings.COL_SEQ);
		this.setSequence(compSettings.ROW_SEQ);
		this.setPageGroupSequence(compSettings.GROUP_SEQ);
		this.setCompColor(compSettings.THEME);
		this.setToggleStatus(compSettings.TOGGLE_STATUS);
	}

	//Load all of the non-standard component settings
	filterMappingObj = this.getFilterMappingsObj();
	filterCnt = compSettings.FILTER.length;
	for( x = 0; x < filterCnt; x++) {
		compFilter = compSettings.FILTER[x];

		//Check for component defined filters
		mappedFilter = filterMappingObj[compFilter.FILTER_MEAN];
		if(mappedFilter) {
			//Call the loadMappedSettings function to load the settings
			this.loadMappedSettings(mappedFilter, compFilter);
			continue;
		}
		else {
			//Attempt to check the older bedrock filter loading
			oldBRSetPrefFunc = MP_Bedrock.MPage.Component.getComponentFilterFuncsPassthrough(this.getStyles().getNameSpace(), compSettings.REPORT_MEAN);
			if(oldBRSetPrefFunc(this, compFilter.FILTER_MEAN, this.getFilterValues(compFilter))) {
				continue;
			}

			//Check the default mappings if there were no custom mappings
			mappedFilter = filterMappingObj[compFilter.FILTER_CATEGORY_MEAN];
			if(mappedFilter) {
				//Call the appropriate function of the mapped object
				mappedFilter.setFunction.call(this, compFilter);
				continue;
			}
		}
	}
};

/**
 * This function is used to create the component menu
 */
MPageComponent.prototype.createMainMenu = function() {
	if(this.isDisplayable()){
		var compId = "mainCompMenu" + this.getStyles().getId();
		var compMenu = new Menu(compId);
		compMenu.setIsRootMenu(true);
		compMenu.setAnchorElementId(compId);
		compMenu.setAnchorActiveClass("opts-menu-open");
		compMenu.setTypeClass("menu-wrkflw-comp-menu");
		compMenu.setAnchorConnectionCorner(["bottom","right"]);
		compMenu.setContentConnectionCorner(["top", "right"]);
		compMenu.setContentParentId(this.getStyles().getId());
		
		//Set this components menu which will also add it to the MenuManager
		this.setMenu(compMenu);
	}
};

/**
 * This function is used to setup any display filters that a component might have.  For instance the Growth Chart
 * component is only valid for individuals younger than the age of 20 yrs, so it should not display when the
 * patient is older than that age.
 */
MPageComponent.prototype.loadDisplayFilters = function() {
	//should be implemented at the component level for setting up display filters.
};

/**
 * This function is used to begin the data retrieval process.  It determines if the component should attempt to retrieve its
 * required data or if it requires some additional resource before it can start the data retrieval process.
 */
MPageComponent.prototype.startComponentDataRetrieval = function() {
	if(this.isResourceRequired()) {
		//This component requires data from a shared resource before it can start the data retrieval process.
		this.RetrieveRequiredResources();
	}
	else {
		//Make the necessary calls to start the components data retrieval process.
		this.retrieveComponentData();
	}
};

/**
 * This function is used to make the necessary data retrieval calls for the component.  The base functionality will call the
 * InsertDate function for older components which have not yet been updated to the generic component loading scheme.
 */
MPageComponent.prototype.retrieveComponentData = function() {
	try {
		if( typeof this.InsertData == 'function') {
			this.InsertData();
		}
	}
	catch(err) {
		MP_Util.LogJSError(err, this, "base-component.js", "retrieveComponentData");
		throw (err);
	}

};

/**
 * This is the older base class implementation of the components data retrieval script.  This function should be overridden for each
 * component.
 * @deprecated Component developers should now be suing the retrieveComponentData() function.
 */
MPageComponent.prototype.InsertData = function() {
	alert("ERROR: InsertData has not been implemented within the component");
};

/**
 * This function is used to pass the data retrieved for the component to the component for rendering.  The base functionality will
 * call the HandleSuccess function for older components which have not yet been updated to the generic component loading scheme.
 * Newer components will override this function as its main rendering function.
 * @param {object} recordData : The data object returned to the component form its data retrieval calls.
 */
MPageComponent.prototype.renderComponent = function(recordData) {
	//call the default HandleSuccess function if the component has not yet implemented the renderComponent function
	this.HandleSuccess(recordData);
};

/**
 * This is the older base class implementation of the components rendering script.  This function should be overridden for each
 * component.
 * @deprecated Component developers should now be suing the renderComponent() function.
 */
MPageComponent.prototype.HandleSuccess = function() {
	alert("ERROR: HandleSuccess has not been implemented within the component");
};

/**
 * This function will allow the component to handle any preprocessing that may need to take place before
 * calls are made to retrieve the data for the component.  The base class implementation does not perform any
 * actions at this time, but may in the future.  It is recommend that component developers overriding this function
 * still call the base class implementation.
 */
MPageComponent.prototype.preProcessing = function() {

};

/*
 * This function is used to finalize the component once it has finished generating its content.  It will be used to insert the
 * html or jquery element passed into the function into the component's section content node.  Once the content has been added
 * the function will then initialize hovers, initialize subsection toggles and initialize scrolling.
 * @param {string | jQuery} componentContent This will be an HTML string or a jQuery object which will be appended to the
 * component's section content node.
 * @param {string} resultCountText This will be an HTML string or a jQuery object which will be used as the result count shown
 * next to the component title.
 */
MPageComponent.prototype.finalizeComponent = function(componentContent, resultCountText) {
	//replace count text
	var rootComponentNode = this.getRootComponentNode();
	//There are certain circumstances where a components DOM element will have been removed.
	//ie. selecting a view from the viewpoint drop down and then selecting another.
	if(rootComponentNode) {
		var totalCount = Util.Style.g("sec-total", rootComponentNode, "span");
		if(resultCountText) {
			//Make sure the count text is not hidden.
			$(totalCount).removeClass("hidden");
			totalCount[0].innerHTML = resultCountText;
		}
		else {
			//If there is no count text to show then hide the element so it doesn't take up space.
			$(totalCount).addClass("hidden");
		}

		//replace content with HTML or a jQery object
		var node = this.getSectionContentNode();
		if(typeof componentContent == "string"){
			node.innerHTML = componentContent;
		}
		else{
			$(node).html(componentContent);
		}
		//init hovers
		this.initHovers(node);

		//init subsection toggles
		MP_Util.Doc.InitSubToggles(node, "sub-sec-hd-tgl");

		//init scrolling
		MP_Util.Doc.InitScrolling(Util.Style.g("scrollable", node, "div"), this.getScrollNumber(), "1.6");

		//Check to see if the component has an error message displayed
		var errorElement = $(rootComponentNode).find(".error-message");
		if (errorElement.length) {
			//Add an error icon to the component title
			$(rootComponentNode).find(".sec-title span:first-child").addClass("error-icon-component");
			//Ensure the bottom border on the error message is red and the padding is consistent
			$(errorElement).css("border", "1px solid #C00").css("padding", "2px 4px");
			//Fire and event to inform any listener that the component has errored
			CERN_EventListener.fireEvent(this, this, EventListener.EVENT_ERROR_UPDATE, {
						"error": true
					});
		}
		else{
			//Remove the error icon in the component title
			$(rootComponentNode).find(".sec-title span:first-child").removeClass("error-icon-component");
			//Fire and event to inform any listener that the component has not errored
			CERN_EventListener.fireEvent(this, this, EventListener.EVENT_ERROR_UPDATE, {
						"error": false
					});
		}
		//If the component has a table, call the finalize method
		if(this.m_componentTable) {
			this.m_componentTable.finalize();
		}
	}
};

/**
 * This function will be used to save single component preferences with the option of being save synchronous or asynchronous
 */
MPageComponent.prototype.savePreferences = function(saveAsync) {
	MP_Core.AppUserPreferenceManager.UpdateSingleCompPreferences(this,saveAsync);
};

/**
 * This function will be used to handle any processing that needs to take place after the component has been rendered.  If the
 * component developer needs to implement this function it is recommended that the base function is still called within the new
 * implementation.
 */
MPageComponent.prototype.postProcessing = function() {
	//Resize the component appropriately if it is shown within a workflow
	this.resizeComponent();

	//Any additional functionality that needs to happen after the component is rendered can happen here.
};
/**
 * The MPageView object
 * @constructor
 * @author Greg Howdeshell
 * @author Steven Lewis
 */
function MPageView() {

	/*Variables*/
	this.banner = true;
	this.components = null;
	this.componentIds = null;
	this.container = null;
	this.criterion = null;
	this.helpFileName = "";
	this.helpFileURL = "https://wiki.ucern.com/display/r1mpagesHP/MPages+Help+Pages";
	this.isCustomizeView = false;
	this.m_categoryMean = "";
	this.m_capTimerName = "";
	this.m_csEnabled = false;
	this.m_dpEnabled = false;
	this.m_filterMappingsObj = {};
	this.m_helpFilePath = "";
	this.m_helpFileURL = "";
	this.m_isCustomizeEnabled = true;
	this.m_pageSettings = null;
	this.m_printableReportName = null;
	this.m_subTimerName = "";
	this.m_titleAnchors = null;
	this.name = null;
	this.pageId = 0.0;
	this.viewpointIndicator = false;
	this.allExpanded = false;
}

/** Adders **/

/**
 * Adds the id of a component to the list of component ids contained in this MPageView object.
 * @param (Number) compId The primary key of a component contained in this MPageView object.
 */
MPageView.prototype.addComponentId = function(compId) {
	if(this.componentIds === null) {
		this.componentIds = [];
	}
	this.componentIds.push(compId);
};

/**
 * Adds a component to the existing MPage
 * @param {MPageComponent} componentObj The MPageComponent object to add to the MpageView
 */
MPageView.prototype.addComponent = function(componentObj) {
	if(this.components === null) {
		this.components = [];
	}
	this.components.push(componentObj);
};

/**
 * Add a filter mapping object to the collection of mappings.  Filter mappings are referenced by name, so if a filter already exists
 * with the same name it will be overwritten.
 * @param {String} filterName The name of the filter object to add.
 * @param {Object} filterObject The object containing all of the filter properties used when loading settings.
 */
MPageView.prototype.addFilterMappingObject = function(filterName, filterObject) {
	this.m_filterMappingsObj[filterName] = filterObject;
};

/**
 * Adds the HTML code for an anchor tag to be shown at the top of an MPages View.  The parameter passed in should be syntactically
 * correct HTML as it will be placed directly into the DOM.
 * @param {String} anchorHTML The HTML markup for the anchor to be added to the MPages View.
 */
MPageView.prototype.addTitleAnchor = function(anchorHTML) {
	if(this.m_titleAnchors === null) {
		this.m_titleAnchors = [];
	}
	this.m_titleAnchors.push(anchorHTML);
};

/** Getters **/

/**
 * Gets the name of the capitalization timer for this instance of the MPageView object.
 * @return {String} The name of the capitalization timer.
 */
MPageView.prototype.getCapTimerName = function() {
	return this.m_capTimerName;
};

/**
 * Gets the category mean assigned to this instance of the MPageView object.
 * @return {String} The category mean of this MPageView object.
 */
MPageView.prototype.getCategoryMean = function() {
	return this.m_categoryMean;
};

/**
 * Gets the array of component ids that are set to load with this instance of the MPageView object.
 * @return {Array[Number]} An array of components ids
 */
MPageView.prototype.getComponentIds = function() {
	return (this.componentIds);
};

/**
 * Gets the array of MPageComponent objects associated to this instance of the MPageView object.
 * @return {Array[MPageComponent]} An array of MPageComponent objects.
 */
MPageView.prototype.getComponents = function() {
	return this.components;
};

/**
 * Gets the container that this view resides in
 * @return {Object} the container for this view
 */
MPageView.prototype.getContainer = function() {
	return this.container;
};

/**
 * Returns the criterion object stored in the MPageView object.  The criterion object contains information such as the person_id,
 * encntr_id, personnel_id, etc.
 * @return {Criterion} A Criterion object containing information such as the person_id, encntr_id, personnel_id, etc.
 */
MPageView.prototype.getCriterion = function() {
	return (this.criterion);
};

/**
 * Gets the the flag which determines if the user is allowed to customize a MPages View or not.
 * @return {Boolean} A boolean flag which determines if the user is allowed to customize a MPages View or not.
 */
MPageView.prototype.getCustomizeEnabled = function() {
	return this.m_isCustomizeEnabled;
};

/**
 * Gets the the flag which determines whether or not to add the customization option to the MPages View.
 * @return {Boolean} A boolean flag which determines whether or not to add the customization option to the MPages View.
 */
MPageView.prototype.getCustomizeView = function() {
	return this.isCustomizeView;
};

/**
 * Gets the array of filter mapping objects used to apply MPages View level settings.
 * @return {Array[Object]} An array of filter mapping objects.
 */
MPageView.prototype.getFilterMappingsObj = function() {
	return this.m_filterMappingsObj;
};

/**
 * Return the help file name that is to be loaded when the help file icon is clicked.
 * @return {String} An string containing the file path location of a help file.
 */
MPageView.prototype.getHelpFileName = function() {
	return this.helpFileName;
};

/**
 * Return the help file URL that is to be loaded when the help file icon is clicked.
 * @return {String} The URL of the help file
 */
MPageView.prototype.getHelpFileURL = function() {
	return this.helpFileURL;
};

/**
 * Gets the name associated to the MPages View
 * @return {String} The name of the MPages View
 */
MPageView.prototype.getName = function() {
	return this.name;
};

/**
 * Gets the primary key associated to the MPageView object.
 * @return {Number} The key of the MPageView object
 */
MPageView.prototype.getPageId = function() {
	return this.pageId;
};

/**
 * Gets the page level settings object loaded from the preferences model.
 * @return {Object} The preferences object used to set the MPageView object settings.
 */
MPageView.prototype.getPageSettings = function() {
	return this.m_pageSettings;
};

/**
 * Returns the printable report name if it has been set.
 * @return {String} The name given to the printable report.
 */
MPageView.prototype.getPrintableReportName = function() {
	return this.m_printableReportName;
};

/**
 * Gets the subtimer name to be associated with the capitalization timer.
 * @return {String} The name of the subtimer
 */
MPageView.prototype.getSubTimerName = function() {
	return this.m_subTimerName;
};

/**
 * Gets the array of HTML anchor elements that will be added to the MPages View.
 * @return {Array[String]} An array of HTML string which makeup the MPages options
 */
MPageView.prototype.getTitleAnchors = function() {
	return this.m_titleAnchors;
};

/** Boolean Checks **/

/**
 * A check for the banner flag which determines if the demographic banner should be displayed in the MPages View.
 * @return {Boolean} True if the patient demographic banner should be displayed within the MPages View.  False otherwise.
 */
MPageView.prototype.isBannerEnabled = function() {
	return this.banner;
};

/**
 * A check for the viewpoint indicator flag which determines if the MPageView is being shown in a Viewpoint or not.
 * @return {Boolean} True if the MPageView is being shown in a viewpoint.  False otherwise.
 */
MPageView.prototype.getViewpointIndicator = function() {
	return this.viewpointIndicator;
};

/**
 * A check for the m_csEnabled flag which determines if the chart search functionality should be available for the user.
 * @return {Boolean} True if chart search is to be displayed within the MPage.  False otherwise.
 */
MPageView.prototype.isChartSearchEnabled = function() {
	return this.m_csEnabled;
};

/**
 * A check for the m_dpEnabled flag which determines if the discharge process functionality should be available for the user.
 * @return {Boolean} True if discharge process icon is to be displayed within the MPage.  False otherwise.
 */
MPageView.prototype.isDischargeProcessEnabled = function() {
	return this.m_dpEnabled;
};

/**
 * A check for the allExpanded flag which determines if all the components are currently expanded or not.
 * @return {Boolean} True if all components are expanded.  False otherwise.
 */
MPageView.prototype.isAllExpanded = function() {
	return this.allExpanded;
};

/** Setters **/

/**
 * Sets whether or not to display the patient demographic banner.
 * @param {Boolean} value The boolean value in which to note to display or not display the patient demographic banner.
 */
MPageView.prototype.setBannerEnabled = function(bannerEnabled) {
	this.banner = bannerEnabled;
};

/**
 * Sets the name of the capitalization timer for this instance of the MPageView object.  The capTimerName parameter must be a string,
 * otherwise it is ignored.
 * @param {String} The name of the capitalization timer.
 * @return {Boolean} True if the capitalization timer name was set, false otherwise.
 */
MPageView.prototype.setCapTimerName = function(capTimerName) {
	if(capTimerName && typeof capTimerName == "string") {
		this.m_capTimerName = capTimerName;
		return true;
	}
	return false;
};

/**
 * Sets the category mean of the MPageView object.  The categoryMean parameter must be a string, otherwise it is ignored.
 * @param {String} categoryMean The category mean of the MPageView object
 */
MPageView.prototype.setCategoryMean = function(categoryMean) {
	if(categoryMean && typeof categoryMean == "string") {
		this.m_categoryMean = categoryMean;
		return true;
	}
	return false;
};

/**
 * Sets whether or not to display chart search functionality
 * @param {Boolean} showChartSearch The boolean value in which to note to display or not display chart search.
 */
MPageView.prototype.setChartSearchEnabled = function(showChartSearch) {
	this.m_csEnabled = showChartSearch;
};

/**
 * Sets the container that this view resides within (either in viewpoint or not)
 * @param {Object} container the DOM container that this view will reside in
 */
MPageView.prototype.setContainer = function(container) {
	if(container) {
		this.container = container;
	}
};

/**
 * Sets whether or not to discharge process functionality
 * @param {Boolean} discharge process The boolean value in which to note to display or not display discharge process.
 */
MPageView.prototype.setDischargeProcessEnabled = function(showDischargeProcess) {
	this.m_dpEnabled = showDischargeProcess;
};

/**
 * Sets the array of components ids which are the primary keys to the MPageComponent objects that are part of this MPageView object.
 * @param {Array[Number]} compIdArr The array of component ids.
 */
MPageView.prototype.setComponentIds = function(compIdArr) {
	this.componentIds = compIdArr;
};

/**
 * Sets the list of MPageComponent objects which are contained within this MPageView object.
 * @param {Array[MPageComponent]} componentArr The array of MPageComponent objects which are contained within this MPageView object.
 */
MPageView.prototype.setComponents = function(componentArr) {
	this.components = componentArr;
};

/**
 * Sets the Criterion object for this instance of the MPageView object.
 * @param {Criterion} criterionObj The Criterion object in which to initialize the MPageView object with.
 */
MPageView.prototype.setCriterion = function(criterionObj) {
	this.criterion = criterionObj;
};

/**
 * Sets the flag which determines if the customization option will be enabled or disabled within the MPages View.
 * @param {Boolean} customizedEnabled A flag which determines if customization of the MPages View is enabled or disabled.
 */
MPageView.prototype.setCustomizeEnabled = function(customizedEnabled) {
	this.m_isCustomizeEnabled = customizedEnabled;
};

/**
 * Sets the flag which determines if the customization option will be shown to the user or not on the MPages View.
 * @param {Boolean} customizeView A flag which determines if the customization option will be shown to the user or not.
 */
MPageView.prototype.setCustomizeView = function(customizeView) {
	this.isCustomizeView = customizeView;
};

/**
 * Sets the filter mappings object which will be used when loading settings from the preferences model.  The filterObj parameter must
 * not be null.  If it is null it will be ignored.
 * @param {Object} filterObj An object which contains the filter mappings of the MPageView object
 * @return {Boolean} True if the m_filterMappingsObj was set to filterObj, false otherwise
 */
MPageView.prototype.setFilterMappingsObj = function(filterObj) {
	if(filterObj) {
		this.m_filterMappingsObj = filterObj;
		return true;
	}
	return false;
};

/**
 * Sets the help file name that is to be loaded when the help file icon is clicked.
 * @param {String} fileName The name of the help file to be loaded when the help icon is clicked.
 */
MPageView.prototype.setHelpFileName = function(fileName) {
	this.helpFileName = fileName;
};

/**
 * Sets the help file URL that is to be loaded when the help file icon is clicked.
 * @param {String} fileURL The name of the help file to be loaded when the help icon is clicked.
 */
MPageView.prototype.setHelpFileURL = function(fileURL) {
	this.helpFileURL = fileURL;
};

/**
 * Sets the name given to the MPages View.  The mpageName parameter must not be blank or null.  If it is the existing name will not
 * be modified.
 * @param {String} mpageName the name to be given to the MPages View
 * @return {Boolean} True if the MPages View name was set, otherwise false.
 */
MPageView.prototype.setName = function(mpageName) {
	if(mpageName && typeof mpageName == "string") {
		this.name = mpageName;
		return true;
	}
	return false;
};

/**
 * Sets the primary key associated to the MPageView object.
 * @param {Number} mpageId The primary key to be associated to the MPageView object.
 */
MPageView.prototype.setPageId = function(mpageId) {
	this.pageId = mpageId;
};

/**
 * Sets the page settings object used when initializing MPageView object elements.
 * @param {Object} settingsObj The settings object from the preferences model.
 */
MPageView.prototype.setPageSettings = function(settingsObj) {
	if(settingsObj) {
		this.m_pageSettings = settingsObj;
		return true;
	}
	return false;
};

/**
 * Sets the printable report script/name of the MPages View iff the reportName is a string.
 * @param {String} value The reportName value will hold the script name (from bedrock) that will be used/executed to print a report.
 */
MPageView.prototype.setPrintableReportName = function(reportName) {
	if(reportName && typeof reportName == "string") {
		this.m_printableReportName = reportName;
		return this.m_printableReportName;
	}
	return null;
};

/**
 * Sets the name of the capitalization subtimer.
 * @param {String} timerName The name to give to the capitalization subtimer
 */
MPageView.prototype.setSubTimerName = function(timerName) {
	if(timerName && typeof timerName == "string") {
		this.m_subTimerName = timerName;
		return true;
	}
	return false;
};

/**
 * Sets the array of anchors/additional options to be shown on MPages View.  The strings passed in the anchorArr should be
 * syntactically correct HTML as it will be placed directly into the DOM.
 * @param {Array[String]} anchorArr An array of HTML strings which will be loaded into the MPages View.
 */
MPageView.prototype.setTitleAnchors = function(anchorArr) {
	this.m_titleAnchors = anchorArr;
};

/**
 * Sets the flag which determines if all components are expanded or collapsed.
 * @param {Boolean} allExpandedInd A flag which determines if all the components are expanded or collapsed. True means
 * all are expanded, false means all are collapsed.
 */
MPageView.prototype.setIsAllExpanded = function(allExpandedInd) {
	this.allExpanded = allExpandedInd;
};

/**
 * Sets the flag which determines if the MPageView is being shown in a viewpoint or not.
 * @param {Boolean} viewpointInd A flag which determines if the MPageView is being shown in a viewpoint or not.
 */
MPageView.prototype.setViewpointIndicator = function(viewpointInd) {
	this.viewpointIndicator = viewpointInd;
};

/** Initialization and rendering functions for the MPageView objects **/

/**
 * Initializes the MPageView with the basic information needed to render the MPages View.  This includes registering unload and
 * resize events with the custom component framework, loading the default filtermappings for the MPageView, creating timers
 * based on the timer names in m_capTimerName and m_subTimerName and finally creating and storing the criterion object in the
 * MPageView object.  This function can be extended and/or overwritten in a MPageView prototyped object.
 * @this {MPageView}
 * @return {boolean} True if the MPagesView was initialized successfully, false otherwise
 */
MPageView.prototype.initializeMPageView = function() {
	try {

		//Load the filter mappings
		this.loadFilterMappings();

		//Load the timer information
		this.setCapTimerName("CAP:MPG Launch MPage");
		this.setSubTimerName(this.getCategoryMean());

		//Create the MPage timers based on names set in the MPageView object
		this.createMPageTimerObject();

		//Create and set the criterion object for the MPageView
		this.setCriterion(createPageCriterion(this.getCategoryMean()));

		//Set the viewpoint indicator to true if this is a viewpoint, otherwise false
		this.setViewpointIndicator(( typeof m_viewpointJSON == "undefined") ? false : true);

		return true;
	}
	catch(err) {
		MP_Util.LogJSError(err, null, "MPageView.js", "initializeMPageView");
		throw err;
	}
};

/**
 * Loads and stores the settings from the preferences model into the MPageView object.  This includes setting the page id, loading
 * the application and user preferences model and applying the filter mappings loaded in the MPageView.loadFilterMappings() function.
 * It is not recommended to override or extend this function.
 * @this {MPageView}
 * @return {boolean} True if the page settings were loaded successfully, false otherwise
 */
MPageView.prototype.loadPageSettings = function() {
	var bValue = "";
	var filter = null;
	var filterMappingsObj = null;
	var pageFilters = null;
	var pageSettings = null;
	var sValue = "";
	var x = 0;

	try {
		//Retrieve and store the page level settings from the preference model
		pageSettings = this.getPageSettingsObject();
		if(!pageSettings) {
			throw new Error(i18n.VIEW_SETTINGS_UNAVAILABLE);
		}
		this.setPageSettings(pageSettings);

		//Set the page id from the bedrock contents
		this.setPageId(pageSettings.BR_DATAMART_CATEGORY_ID);

		//Create the preference manager for user preferences
		MP_Core.AppUserPreferenceManager.Initialize(this.getCriterion(), this.getCategoryMean());
		if(pageSettings.USER_PREFS.PREF_STRING.length > 0) {
			MP_Core.AppUserPreferenceManager.SetPreferences(pageSettings.USER_PREFS.PREF_STRING);
		}

		//Set the page level settings
		filterMappingsObj = this.getFilterMappingsObj();
		pageFilters = pageSettings.PARAMS;
		for( x = pageFilters.length; x--; ) {
			filter = filterMappingsObj[pageFilters[x].FILTER_MEAN];
			if(filter) {
				sValue = "";
				bValue = "";
				switch (filter.type.toUpperCase()) {
					case "BOOLEAN":
						if(pageFilters[x].VALUES[0] && typeof pageFilters[x].VALUES[0][filter.field] != 'undefined') {
							sValue = pageFilters[x].VALUES[0][filter.field];
							bValue = (sValue === "0") ? false : true;
							filter.setFunction.call(this, bValue);
						}
						break;
					case "STRING":
						if(pageFilters[x].VALUES[0] && typeof pageFilters[x].VALUES[0][filter.field] != 'undefined') {
							sValue = pageFilters[x].VALUES[0][filter.field];
							filter.setFunction.call(this, sValue);
						}
						break;
				}
			}
		}
		return true;
	}
	catch(err) {
		MP_Util.LogJSError(err, null, "MPageView.js", "loadPageSettings");
		throw err;
	}
};

/**
 * Perform the initialization of all of the components which will appear on this MPages View.  Initialization includes loading all
 * preferences from the preference model into the components, applying user level settings to the components and finally storing
 * the newly created MPageComponent objects in the components[] array of the MPageView object.  It is not recommend to overwrite
 * this function, but it can be extended to further setup the components of an MPages View.  For example, setting forced lookback
 * ranges for certain components on an Mpages View.
 * @this {MPageView}
 * @return {boolean} True if the component settings were initialized properly, false otherwise
 */
MPageView.prototype.initializeComponents = function() {
	var component = null;
	var componentsArr = [];
	var componentCnt = 0;
	var compSettings = null;
	var dateCheck = null;
	var pageSettings = null;
	var x = 0;

	try {
		//Load the component ids and initialize the components
		pageSettings = this.getPageSettings();
		componentsArr = pageSettings.COMPONENT;
		componentCnt = componentsArr.length;
		for( x = 0; x < componentCnt; x++) {
			compSettings = componentsArr[x];
			//Create the component and prepare it for rendering
			component = this.createMPageComponentObject(compSettings.FILTER_MEAN);
			if(component) {
				//Initialize the component
				component.initializeComponent(this.getCriterion());
				//Set Component Preferences based on bedrock settings and user preferences
				component.loadComponentSettings(compSettings);
				//Load the display filters of the component
				component.loadDisplayFilters();
				//Let the component handle any preprocessing actions that may need to take place before it will be rendered
				component.preProcessing();
				//Add the component to the component array
				this.addComponent(component);
				//Add the component id to the list of ids
				this.addComponentId(componentsArr[x].BR_DATAMART_REPORT_ID);
			}
		}
		return true;
	}
	catch(err) {
		MP_Util.LogJSError(err, null, "MPageView.js", "initializeComponents");
		throw err;
	}
};

/**
 * This function is used to create the necessary MPageComponent object based on the filterMean for the component.
 */
MPageView.prototype.createMPageComponentObject = function(compFilterMean) {
	var criterion = this.getCriterion();
	var CompDef = null;
	//Check to see if the component has registered itself
	CompDef = MP_Util.getObjectDefinitionMapping(compFilterMean);
	if(CompDef) {
		return new CompDef(criterion);
	}

	//If the compDef is not defined we will fall back to our trusty switch case.
	switch(compFilterMean.toUpperCase()) {
		case "DMS_ALLERGIES":
		case "WF_ALLERGY":
			return new AllergyComponentWF(criterion);
		case "ALLERGY":
			return new AllergyComponent(criterion);
		case "ANCIL_DOC":
			return new DocumentComponent(criterion);
		case "APNEA":
			return new ABDComponent(criterion);
		case "APPOINTMENTS":
			return new AppointmentsComponent(criterion);
		case "CLIN_DOC":
			return new DocumentComponent(criterion);
		case "CONSOL_PROBLEMS":
		case "NARRATIVE_PROBLEM":
			return new CvComponent(criterion);
		case "WF_CONSOL_PROBLEMS":
			return new Cv2Component(criterion);
		case "CURR_STATUS":
			return new CurStatusComponentO1(criterion);
		case "DC_ACTIVITIES":
			return new ActivitiesComponent(criterion);
		case "DC_CARE_MGMT":
			return new DischargePlanningComponent(criterion);
		case "DMS_DIAGNOSIS":
		case "DC_DIAGNOSIS":
		case "DIAGNOSIS":
		case "DX":
			return new DiagnosesComponent(criterion);
		case "DC_ORDER":
			return new DischargeOrdersComponent(criterion);
		case "DC_READINESS":
			return new DischargeIndicatorComponent(criterion);
		case "DC_RESULTS":
			return new ResultsComponent(criterion);
		case "DC_SOCIAL":
			return new SocialComponent(criterion);
		case "ED_TIMELINE":
			return new TimelineComponent(criterion);
		case "WF_FAMILY_HX":
			return new FamilyHistoryComponentO2(criterion);
		case "FAMILY_HX":
			return new FamilyHistoryComponent(criterion);
		case "FIM":
			return new FunIndepMeasuresComponentO1(criterion);
		case "FLAG_EVENTS":
			return new FlaggedEventsComponent(criterion);
		case "FLD_BAL":
			return new IntakeOutputComponent(criterion);
		case "FOLLOWUP":
			return new FollowUpComponent(criterion);
		case "FUTURE_ORD":
			return new FutureOrdersComponent(criterion);
		case "GOALS":
			return new GoalsComponentO1(criterion);
		case "GRAPH":
			return new RespTimelineComponent(criterion);
		case "GRAPHS":
			return new VSTimelineComponent(criterion);
		case "GROWTH_CHART":
			return new GrowthChartComponent(criterion);
		case "HEALTH_MAINT":
			return new HmiComponent(criterion);
		case "HOME_MEDS":
			return new HomeMedicationsComponent(criterion);
		case "ICU_FLOWSHEET":
			return new ICUFlowsheetComponent(criterion);
		case "IMMUNIZATIONS":
			return new ImmunizationComponent(criterion);
		case "INCOMPLETE_ORDERS":
		case "ORDERS":
			return new OrdersComponent(criterion);
		case "ORD_SEL_ADD_FAV_FOLDER":
			return new OrderSelectionComponent(criterion);
		case "INTER_TEAM":
			return new InterTeamComponentO1(criterion);
		case "DMS_LAB":
			return new LabPagerComponent(criterion);
		case "LAB":
			return new LaboratoryComponent(criterion);
		case "LINES":
			return new LinesTubesDrainsComponent(criterion);
		case "MEDS":
			return new MedicationsComponent(criterion);
		case "MED_REC":
			return new MedicationReconciliationComponent(criterion);
		case "WF_MBIOLOGY":
			return new MicrobiologyComponentWF(criterion);
		case "MICRO":
			return new MicrobiologyComponent(criterion);
		case "NC_DC_PLAN":
			return new DischargePlanComponent(criterion);
		case "NC_OVERDUE_TASKS":
		case "OVERDUE_TASKS":
			return new TaskActivityComponent(criterion);
		case "NC_PLAN":
			return new PlanofCareComponent(criterion);
		case "NC_PSYCHOSOC":
			return new PsychosocialFactorsComponent(criterion);
		case "NC_PT_ASSESS":
			return new PatientAssessmentComponent(criterion);
		case "NC_PT_BACKGROUND":
			return new PatientBackgroundComponent(criterion);
		case "NEO_OVERVIEW":
			return new NeonateOverviewComponent(criterion);
		case "NEO_TASK_TIMELINE":
			return new NeonateTaskTimelineComponent(criterion);
		case "NEO_WEIGHT":
			return new NeonateMeasurementComponent(criterion);
		case "NEO_HYPERBILI":
			return new NeonateBilirubinComponent(criterion);
		case "NEO_TRANSFUSION":
			return new NeonateTransfusionComponent(criterion);
		case "NEW_DOC":
			return new NewDocumentEntryComponent(criterion);
		case "NEW_ORDERS":
			return new NewOrderEntryComponent(criterion);
		case "NOTES":
			return new NotesRemindersComponent(criterion);
		case "ORDER_HX":
			return new OrderHistoryComponent(criterion);
		case "WF_PAST_MHX":
		case "PAST_MED_HX":
		case "PAST_MHX":
			return new PastMedicalHistoryComponent(criterion);
		case "PATH":
			return new PathologyComponent(criterion);
		case "PAT_ED":
		case "PT_ED":
			return new PatientFamilyEduSumComponent(criterion);
		case "PRECAUTIONS":
			return new PrecautionsComponentO1(criterion);
		case "PREG_ASSESS":
			return new PresAssessInitialExamComponent(criterion);
		case "PREG_ASSESS_2":
			return new PregAssessment2Component(criterion);
		case "PREG_ASSESS_3":
			return new PregAssessment3Component(criterion);
		case "PREG_BIRTH_PLAN":
			return new BirthPlanComponent(criterion);
		case "PREG_ED":
			return new EducationAndCounselingComponent(criterion);
		case "PREG_EDD_MAINT":
			return new EDDMaintenanceComponent(criterion);
		case "PREG_FETAL_MON":
			return new FetalMonitoringComponent(criterion);
		case "PREG_GENETIC_SCR":
			return new GeneticScreeningComponent(criterion);
		case "WF_PREG_HX":
			return new PregnancyHistoryComponentO2(criterion);
		case "PREG_HX":
			return new PregnancyHistoryComponent(criterion);
		case "PREG_OVERVIEW":
			return new PregnancyOverviewComponent(criterion);
		case "PREG_RESULTS":
			return new ResultTimelineComponent(criterion);
		case "DMS_PROBLEMS":
		case "PROBLEM":
			return new ProblemsComponent(criterion);
		case "PROC_HX":
			return new ProcedureComponent(criterion);
		case "PT_INFO":
			return new PatientInfoComponent(criterion);
		case "QM":
			return new QualityMeasuresComponent(criterion);
		case "RAD":
			return new DiagnosticsComponent(criterion);
		case "RESP":
			return new RespiratoryComponent(criterion);
		case "RESP_ASSESS":
			return new RespAssessmentsComponent(criterion);
		case "RESP_TX":
			return new RespTreatmentsComponent(criterion);
		case "RESTRAINTS":
			return new RestraintsComponent(criterion);
		case "SIG_EVENTS":
			return new SignificantEventO1Component(criterion);
		case "WF_SOCIAL_HX":
			return new SocialHistoryComponentO2(criterion);
		case "SOCIAL_HX":
			return new SocialHistoryComponent(criterion);
		case "WF_PROC_HX":
			return new ProcedureComponentO3(criterion);
		case "SURG_PROC_HX":
			return new Procedure2Component(criterion);
		case "TREATMENTS":
			return new TreatmentsComponentO1(criterion);
		case"TRIAGE_DOCUMENT":
			return new TriageDocComponent(criterion);
		case "VENT_MON":
			return new VentMonitoringComponent(criterion);
		case "VISITS":
			return new VisitsComponent(criterion);
		case "VS":
			return new VitalSignComponent(criterion);
		case "WF_RAD":
			return new DiagnosticsComponent2(criterion);
		case "WF_VS":
			return new VitalSignComponentWF(criterion);
		case "WEIGHT":
			return new WeightsComponent(criterion);
		case "WF_MEDS":
			return new MedicationsComponentO2(criterion);
		case "PROC_INFO":
			return new ProceduralInfoComponent(criterion);
		case "PERIOP_TRACK":
			return new PeriopTrackComponent(criterion);
		case "INTRAOP_SUMMARY":
			return new IntraopSummaryComponent(criterion);
		case "PREOP_CHECKLIST":
			return new PreopChcklstComponent(criterion);
		case "POSTOP_SUMMARY":
			return new PostopSummaryComponent(criterion);
		case "HIV_PROFILE":
			return new HIVProfileComponent(criterion);
		case "EP_DA":
			return new DiscernAnalyticsComponent(criterion);
		case "DMS_REFERENCE":
			return new ClinicalDecSuppComponent(criterion);
		case "DMS_SCREENINGS":
			return new ScreeningsComponent(criterion);
		case "DMS_DIET":
			return new DietsComponent(criterion);
		case "DMS_ANTIDIABETIC":
			return new MedsSpecificComponent(criterion);
		case "DMS_MEDS_GLUC_LVL":
			return new MedsGlucoseComponent(criterion);
		case "DMS_INS_24_HRS":
			return new InsulinReqComponent(criterion);
		case "DMS_GRAPH":
			return new DiabetesGraphComponent(criterion);
		case "CLIN_TRIALS":
			return new ClinicalTrialsComponent(criterion);
		case "CHEMO_REVIEW":
			return new ChemotherapyReviewComponent(criterion);
		case "WF_ASSESSMENT_PLAN":
			return new DocumentationIPComponent(criterion);
		case "WF_CHIEF_COMPLAINT":
			return new ChiefComplaintComponent(criterion);
		case "WF_CLIN_DOC":
			return new DocumentComponent2(criterion);
		case "WF_FLD_BAL":
			return new IntakeOutputOpt2Component(criterion);
		case "WF_HOME_MEDS":
			return new HomeMedicationsComponent2(criterion);
		case "WF_HX_PRESENT_ILL":
			return new DocumentationHPIComponent(criterion);
		case "WF_NEW_ORDERS":
			return new NewOrderEntryO2Component(criterion);
		case "WF_ORDER_HX":
			return new OrderHistoryOpt2Component(criterion);
       	case "WF_ORDER_PROFILE":
       		return new OrderProfileComponent(criterion);
		case "WF_PHYSICAL_EXAM":
			return new DocumentationPEComponent(criterion);
		case "WF_REVIEW_SYMPT":
			return new DocumentationROSComponent(criterion);
		case "THER_TREAT":
			return new TherTreatmentComponent(criterion);
		case "SAFETY":
			return new SafetyComponent(criterion);
		case "BH_ASSESSMENTS":
			return new BhAssessmentComponent(criterion);
		default:
			alert("Unknown filter mean: [" + compFilterMean + "]");
			return null;
	}
};

/**
 * Creates a new instance of a render strategy. By default, it returns a Summary Render Strategy
 * @return {RenderStrategy}
 */
MPageView.prototype.createNewRenderStrategy = function() {
	return new SummaryRenderStrategy();
};

/**
 * Used to render the MPages View once it has been initialized and setup.  Calls the MP_Util.Doc.InitLayout function to render the
 * HTML of the page layout.  Once the page layout has been rendered, the Chart Search functionality and demo banner are added to
 * the MPage View.  Finally the component script calls are executed within the MP_Util.Doc.RenderLayout() function call.  It is
 * not recommended to override this function.  If special logic needs to be executed when loading the Chart Search functionality
 * or loading the Demographics Banner, those specific functions can be overridden instead.
 * @this {MPageView} 
 * @return {boolean} True if the page was rendered successfully, false otherwise 
 */
MPageView.prototype.renderMPage = function() {
	var viewpointCatMeaning = null;
	var component = null;
	var compCnt = 0;
	var componentList = null;
	var x = 0;
	var groups = [];
	var group = null;
	var collapsedComponents = [];
	var numberRows = 0;
	var numberGroups = 0;

	try {
		//Store the container, so we can easily access it later
		this.setContainer((this.getViewpointIndicator()) ? $("#" + this.getCategoryMean()) : $(document.body));

		//Check to see if any component are defined for this MPageView.  Return if there are not any
		componentList = this.getComponents();		
		compCnt = componentList.length;
		if(compCnt === 0) {
			throw new Error(i18n.VIEW_SETTINGS_UNAVAILABLE);
		}
		//viewpointCatMeaning is used only when loading a MPage View within a Viewpoint
		viewpointCatMeaning = (this.getViewpointIndicator()) ? this.getCategoryMean() : null;

		//If we're not in a viewpoint, add the page title
		if(!this.getViewpointIndicator()) {
			MP_Util.Doc.AddPageTitle(this.getName(), this.getContainer(), this.getCriterion().debug_ind, this.getCustomizeEnabled(), this.getTitleAnchors(), this.getHelpFileName(), this.getHelpFileURL(), this.getCriterion(), null);
		}
		//If the page demo banner is enabled
		if(this.isBannerEnabled()) {
			$(this.getContainer()).append($("<div></div>").attr("id", "banner" + this.getCriterion().category_mean).addClass("demo-banner"));
		}		
		
		//Render the component shells
		this.renderComponents(componentList);
		
		//Get the component list as the group/column list
		componentList = MP_Util.GetComponentArray(componentList);

		//Create the page level menu
		this.loadPageMenu();

		//Initialize Chart search if available
		this.loadChartSearch();

		//Initialize Discharge Process if available
		this.loadDischargeProcess();

		//Load the demo banner if available
		this.loadDemoBanner();

		//Additional page setup
		MP_Util.Doc.AddCustomizeLink(this.getCriterion());
		MP_Util.Doc.SetupExpandCollapse(this.getCategoryMean());
		MP_Util.Doc.SetupCompFilters(this.getComponents());
		MP_Util.Doc.CreateCompMenus(this.getComponents(), false);
		MP_Util.Doc.InitDragAndDrop(this.getCategoryMean());
		
		numberGroups = componentList.length;
		
		//Create the correct ordering
		for(var i = 0; i < numberGroups; i++) {
			groups[i] = {};
			groups[i].ROWS = [];
			group = componentList[i];
			var numberColumns = group.length;
			//Iterate through the columns of the group
			for(var j = 0; j < numberColumns; j++) {
				var column = group[j];
				numberRows = column.length;
				for(var k = 0; k < numberRows; k++) {
					component = column[k];
					if(!groups[i].ROWS[k]) {
						groups[i].ROWS[k] = [];
					}
					if(component.isDisplayable() && component.isExpanded() && !component.isLoaded()) {
						groups[i].ROWS[k].push(component);
					} else if(component.isDisplayable() && !component.isExpanded() && !component.isLoaded()) {
						collapsedComponents.push(component);
					}
				}
			}
		}
		//Start the data retrieval for expanded components
		for(var i = 0; i < numberGroups; i++) {
			group = groups[i];
			numberRows = group.ROWS.length;
			for(var j = 0; j < numberRows; j++) {
				var row = group.ROWS[j];
				var numberComponents = row.length;
				for(var k = 0; k < numberComponents; k++) {
					component = row[k];
					component.setLoaded(true);
					component.startComponentDataRetrieval();
				}
			}
		}
		//Now start the data retrieval for the collapsed components
		for(var i = 0; i < collapsedComponents.length; i++) {
			component = collapsedComponents[i];
			component.setLoaded(true);
			component.startComponentDataRetrieval();
		}
		return true;
	}
	catch(err) {
		MP_Util.LogJSError(err, null, "MPageView.js", "renderMPage");
		throw err;
	}
};

/**
 * This function renders the components in the correct layout format
 * @param {List<MPageComponent>} the list of components to render
 */
MPageView.prototype.renderComponents = function(components, parentContainer) {
	if(!components || !components.length) {
		MP_Util.LogError("No components were provided to the renderComponents() method");
		return;
	}
	this.storeViewComponents(components);	
	var columnArray = null;
	var componentGroupArray = MP_Util.GetComponentArray(components);
	var container = (this.getContainer() || parentContainer);
	for(var x = 0; x < componentGroupArray.length; x++) {
		columnArray = componentGroupArray[x];
		var columnLength = columnArray.length;
		var columnSuperDiv = $("<div></div>").addClass("col-group");
		$(container).append($("<div></div>").append(columnSuperDiv));
		switch(columnLength) {
			case 1:
				columnSuperDiv.addClass("one-col");
				break;
			case 2:
				columnSuperDiv.addClass("two-col");
				break;
			case 3:
				columnSuperDiv.addClass("three-col");
				break;
			case 4:
				columnSuperDiv.addClass("four-col");
				break;
			default:
				columnSuperDiv.addClass("five-col");
		}
		var outerCol1 = $("<div></div>").addClass("col-outer1");
		var outerCol2 = $("<div></div>").addClass("col-outer2");
		outerCol2.append(outerCol1);
		columnSuperDiv.append(outerCol2);
		for(var y = 0; y < columnLength; y++) {
			var columnClassName = "col" + (y + 1);
			var componentArray = columnArray[y];
			var columnDiv = $("<div></div>").addClass(columnClassName).appendTo(outerCol1);
			for(var z = 0, zl = componentArray.length; z < zl; z++) {
				var component = componentArray[z];
				//Give the component a render strategy based on the view you are in
				component.setRenderStrategy(this.createNewRenderStrategy());
				columnDiv.append(component.getRenderStrategy().createComponentShell());
			}
		}
	}
};

/**
 * Any post processing that needs to be completed by the MPageView object will be completed in this function.  No functionality has
 * been implemented at this time for the base function, but this can be overridden in objects which prototype the MPagesView object.
 */
MPageView.prototype.postProcessing = function() {

};

/**
 * Stores the components in the CERN_MPageComponents global object
 * @param {List<MPageComponent>} the list of MpageComponents to store in the global object
 */
MPageView.prototype.storeViewComponents = function(components) {
	MP_Util.addComponentsToGlobalStorage(components);
};

/** Support functions used for the MPageView objects **/

/**
 * Loads the default MPage View level filter mappings.  These mappings can be overwritten by using the
 * MPageView.setFilterMappingObject() function with the same name as any of the existing filter mappings.  Filter mappings can also
 * be overridden by defining a loadFilterMappings function in a MPageView prototyped
 * object.
 * @this {MPageView}
 * @return null
 */
MPageView.prototype.loadFilterMappings = function() {
	//A filter mapping that indicates whether the Demographics Banner will be displayed.
	this.addFilterMappingObject("BANNER", {
		setFunction : this.setBannerEnabled,
		type : "Boolean",
		field : "FREETEXT_DESC"
	});
	//A filter mapping that indicates whether the Chart Search will be displayed.
	this.addFilterMappingObject("CHART_SEARCH", {
		setFunction : this.setChartSearchEnabled,
		type : "Boolean",
		field : "FREETEXT_DESC"
	});
	//A filter mapping that indicates whether the Discharge Process will be displayed.
	this.addFilterMappingObject("DISCHARGE_PROCESS", {
		setFunction : this.setDischargeProcessEnabled,
		type : "Boolean",
		field : "FREETEXT_DESC"
	});
	//A filter mapping used to set the Label/name of an MPages View.  This name is used for the actual MPage name and the name used on
	// the viewpoint tab.
	this.addFilterMappingObject("VIEWPOINT_LABEL", {
		setFunction : this.setName,
		type : "String",
		field : "FREETEXT_DESC"
	});
	//A filter mapping used to set the printable report name.
	//The filter mean for this setting is named PREG_PRINT but it is not isolated to just the Pregnancy Summary.  It also applies to the
	// View Builder
	//MPages as well and is a setting to call a printable Discern report.
	this.addFilterMappingObject("PREG_PRINT", {
		setFunction : this.setPrintableReportName,
		type : "String",
		field : "FREETEXT_DESC"
	});
};

/**
 * Makes the call to add the Chart Search controls to the MPage if it should be available to the user.  Can be overwritten by a
 * MPagesView prototyped object if special functionality is need for the Chart Search controls.
 * @this {MPageView}
 * @return {Boolean} True if the Chart Search was added to the page, false otherwise.
 */
MPageView.prototype.loadChartSearch = function() {
	//Ignore chart search when being loaded in viewpoints since the chart search functionality is handled at the viewpoint level.
	if(this.getViewpointIndicator()) {
		return false;
	}

	if(this.isChartSearchEnabled()) {
		MP_Util.Doc.AddChartSearch(this.getCriterion(), false);
		return true;
	}
	return false;
};

/**
 * Makes the call to add the Discharge Process Icon to the MPage if it should be available to the user.  Can be overwritten by a
 * MPagesView prototyped object if special functionality is need for the Discharge Process Icon.
 * @this {MPageView}
 * @return {Boolean} True if the Discharge Process was added to the page, false otherwise.
 */
MPageView.prototype.loadDischargeProcess = function() {
	//Ignore Discharge Process when being loaded in viewpoints since the Discharge Process functionality is handled at the viewpoint
	// level.
	if(this.getViewpointIndicator()) {
		return false;
	}

	if(this.isDischargeProcessEnabled()) {
		this.AddDischargeProcess(this.getCriterion());
		return true;
	}

};

/**
 * Adds Discharge Process to the page.
 * @param {Object} criterion The criterion object
 */
MPageView.prototype.AddDischargeProcess = function(criterion) {
	var dpSpan = Util.cep("span", {
		title : i18n.CLICK_TO_GO_TO_DISCHARGE_PROCESS
	});
	dpSpan.innerHTML = "<a id=depart-process-icon></a>";

	var pgCtrl = _g("pageCtrl" + criterion.category_mean);

	pgCtrl.parentNode.insertBefore(dpSpan, pgCtrl);
	dpSpan.onclick = function() {
		OpenDischargeProcess(criterion.encntr_id, criterion.person_id, criterion.provider_id);
	};

};

/**
 * Makes the call to add the Demographics Banner to the MPage if it should be shown on the MPages View.  Can be overwritten by a
 * MPagesView prototyped object if special functionality is need for the Demographics Banner.
 * @this {MPageView}
 * @return {Boolean} True if the Demographics Banner was added to the page, false otherwise.
 */
MPageView.prototype.loadDemoBanner = function() {
	var patDemoBanner = null;

	if(this.isBannerEnabled()) {
		patDemoBanner = _g("banner" + this.getCategoryMean());
		if(patDemoBanner) {
			CERN_DEMO_BANNER_O1.GetPatientDemographics(patDemoBanner, this.getCriterion());
			return true;
		}
	}
	return false;
};

/**
 * Base implementation for loading the component selection menu.  This option is not supported in all MPages, thus this function
 * should be implemented in the individual MPagesView Objects.
 * @this {MPageView}
 * @return {Boolean} True if the component selection menu option was added to the page, false otherwise.
 */
MPageView.prototype.loadComponentSelection = function() {
	return null;
};

/**
 * If the m_printableReport element is populated for the MPageView then add the Print Report menu option to the page menu.
 * @this (MPageView)
 * @return {Boolean} True if the Printable Report menu option was added to page, false otherwise.
 */
MPageView.prototype.loadPrintableReportMenuItem = function() {
	var criterion = this.getCriterion();
	var printItem = null;
	var printReport = this.getPrintableReportName();
	
	//Check to see if this MPageView has a printable report
	if(!printReport){
		return null;
	}
	//Create the menu item since a printable report name has been retrieved
	printItem = new MenuSelection("printReport" + this.getCategoryMean());
	printItem.setLabel(i18n.PRINT_REPORT);
	printItem.setClickFunction(function(){
		MP_Util.PrintReport(printReport, criterion.person_id + ".0", criterion.encntr_id + ".0");
	});
	return printItem;
};

/**
 * Adds help menu item to the page level menu.
 * @this (MPageView)
 * @return {Boolean} True if the help menu option was added to page, false otherwise.
 */
MPageView.prototype.loadHelpMenuItem = function() {
	var helpMenuItem = null;
	var that = this;
	
	//Create the menu item that will be added to the page level menu
	helpMenuItem = new MenuSelection("helpMenu" + this.getCategoryMean());
	helpMenuItem.setLabel(i18n.discernabu.HELP);
	helpMenuItem.setClickFunction(function(){
		MP_Util.Doc.LaunchHelpWindow(that.getHelpFileURL());
	});
	return helpMenuItem;
};

/**
 * Adds expand/collapse menu item to the page level menu.
 * @this (MPageView)
 * @return {Boolean} True if the Expand/Collapse menu option was added to page, false otherwise.
 */
MPageView.prototype.loadExpandCollapseAllMenuItem = function() {
	var categoryMean = this.getCategoryMean();
	var expColItem = null;
	var i18nCore = i18n.discernabu;
	var that = this;
	
	expColItem = new MenuSelection("expandCollapse" + categoryMean);
	expColItem.setLabel(i18nCore.EXPAND_ALL);
	expColItem.setCloseOnClick(false);
	expColItem.setSelectedClass("");
	expColItem.setClickFunction(function(){
		var toggleContainer = null;
		try {
			toggleContainer = (that.getViewpointIndicator() ? $("#" + categoryMean) : $(document.body));
			if(!toggleContainer.length) {
				MP_Util.LogWarn("The container that houses the components to be toggled was not found");
				return false;
			}
			if(that.isAllExpanded()) {
				//All components are currently expanded
				$(toggleContainer).find(".section").addClass("closed");
				expColItem.setLabel(i18nCore.EXPAND_ALL);
			}
			else {
				//All components are currently collapsed
				$(toggleContainer).find(".section").removeClass("closed");
				expColItem.setLabel(i18nCore.COLLAPSE_ALL);
			}
			//Invert boolean for whether components are expanded or collapsed
			that.setIsAllExpanded(!that.isAllExpanded());
		}
		catch (err) {
			MP_Util.LogJSError(err, null, "MPageView.js", "toggleExpandCollapse");
		}
	});
	return expColItem;
};

/**
 * Creates the MPage View level timer objects based on the m_capTimerName and m_subTimerName strings set in the individual MPageView
 * prototyped objects, ie DischargeSummaryMPage.
 * @this {MPagesView}
 * @return null
 */
MPageView.prototype.createMPageTimerObject = function() {
	var capTimerName = "";
	var mPageTimer = null;
	var subTimerName = "";
	capTimerName = this.getCapTimerName();
	subTimerName = this.getSubTimerName();

	if(capTimerName) {
		mPageTimer = MP_Util.CreateTimer(capTimerName);
		if(mPageTimer) {
			mPageTimer.SubTimerName = (subTimerName) ? subTimerName : "";
			mPageTimer.Stop();
		}
	}
};

/**
 * This function is used to retrieve the settings for a specific MPage View.  If the settings are already available in the
 * m_bedrockMPage object then those will be returned.  If the settings are not available then they will be retrieved using
 * the mp_view_data_load script.
 * @this {MPageView}
 * @return {Object} An object which contains the settings for this MPageView object.
 */
MPageView.prototype.getPageSettingsObject = function() {
	var x = 0;
	var categoryMean = this.getCategoryMean();
	var criterion = this.getCriterion();
	var pageSettings = null;

	if(m_bedrockMpage) {
		//Bedrock settings already available.
		MP_Util.LogDebug("Bedrock JSON: " + JSON.stringify(m_bedrockMpage));
		for( x = m_bedrockMpage.MPAGE.length; x--; ) {
			if(categoryMean === m_bedrockMpage.MPAGE[x].CATEGORY_MEAN.toUpperCase()) {
				return m_bedrockMpage.MPAGE[x];
			}
		}
	}

	//Page settings not available.  Retrieve them from the Database.
	var cclParams = ["^MINE^", criterion.provider_id + ".0", criterion.position_cd + ".0", "^" + categoryMean + "^"];
	var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
	info.onreadystatechange = function() {
		if(this.readyState == 4 && this.status == 200) {
			try {
				MP_Util.LogScriptCallInfo(null, this, "MPageView.js", "getPageSettings");
				m_bedrockMpage = JSON.parse(info.responseText).BR_MPAGE;
				pageSettings = m_bedrockMpage.MPAGE[0];
			}
			catch (err) {
				MP_Util.LogJSError(err, null, "MPageView.js", "getPageSettings");
				pageSettings = null;
			}
		}
		if(this.readyState == 4) {
			MP_Util.ReleaseRequestReference(this);
		}
	};

	//Call the ccl program and send the parameter string
	if(CERN_BrowserDevInd) {
		var url = "MP_VIEW_DATA_LOAD?parameters=" + cclParams.join(",");
		info.open("GET", url, false);
		info.send(null);
	}
	else {
		info.open('GET', "MP_VIEW_DATA_LOAD", false);
		info.send(cclParams.join(","));
	}

	return pageSettings;
};

MPageView.prototype.createLayoutMenu = function(){
	var categoryMean = this.getCategoryMean();
	var mPageObj = this;
	
	var layoutSelector = new DynamicMenu("layoutSelction" + categoryMean);
	layoutSelector.setLabel(i18n.discernabu.VIEW_LAYOUT);
	layoutSelector.setIsRootMenu(false);
	layoutSelector.setAnchorConnectionCorner(["top", "left"]);
	layoutSelector.setContentConnectionCorner(["top", "right"]);
	layoutSelector.setContentCreationFunction(function() {
		var col1 = null;
		var col2 = null;
		var col3 = null;
		var curColGroupClass = "";
		var i18nCore = i18n.discernabu;
		var initialColCnt = 0;
		var layoutClasses = [];
		var menuContainer = null;
		//Determine Which dom element to examine to get the column layout
		var vpParent = ( typeof m_viewpointJSON == "string") ? "#" + categoryMean + " " : "";
		//Determine how many columns are currently being shown so we can highlight that element in the menu
		var colGroups = $(vpParent + '.col-group:last');
		if(colGroups.length){
			curColGroupClass = $(colGroups).attr('class').replace("col-group ", "");
		}
		switch (curColGroupClass) {
			case "three-col":
				initialColCnt = 3;
				break;
			case "two-col":
				initialColCnt = 2;
				break;
			case "one-col":
				initialColCnt = 1;
				break;
		}
		
		//create the menu contents
		menuContainer = $("<div></div>").addClass("menu-layout-menu").attr("id", layoutSelector.getId());
		layoutClasses = ['view-layout1', 'view-layout2', 'view-layout3'];
		layoutClasses[initialColCnt - 1] += " view-layout-selected";
		//Apply click events to each col section
		categoryMean = (vpParent) ? categoryMean : "";
		col1 = $("<div class='" + layoutClasses[0] + "' data-cols='1'>" + i18nCore.COLUMN_ONE + "</div>").click(function() {
			//Update the selectedClass
			var selectorId = layoutSelector.getId();
			$("#" + selectorId + " .view-layout-selected").removeClass("view-layout-selected");
			$("#" + selectorId + " .view-layout1").addClass("view-layout-selected");
			//Update the layout
			if(colGroups.length){
				MP_Util.Doc.changeLayoutPassthrough(1, categoryMean);
			}
		});

		col2 = $("<div class='" + layoutClasses[1] + "' data-cols='2'>" + i18nCore.COLUMN_TWO + "</div>").click(function() {
			//Update the selectedClass
			var selectorId = layoutSelector.getId();
			$("#" + selectorId + " .view-layout-selected").removeClass("view-layout-selected");
			$("#" + selectorId + " .view-layout2").addClass("view-layout-selected");
			//Update the layout
			if(colGroups.length){
				MP_Util.Doc.changeLayoutPassthrough(2, categoryMean);
			}			
		});

		col3 = $("<div class='" + layoutClasses[2] + "' data-cols='3'>" + i18nCore.COLUMN_THREE + "</div>").click(function() {
			//Update the selectedClass
			var selectorId = layoutSelector.getId();
			$("#" + selectorId + " .view-layout-selected").removeClass("view-layout-selected");
			$("#" + selectorId + " .view-layout3").addClass("view-layout-selected");
			//Update the layout
			if(colGroups.length){
				MP_Util.Doc.changeLayoutPassthrough(3, categoryMean);
			}
		});
		
		resetLayout = $("<div class='reset-layout' data-cols='0'>" + i18nCore.RESET_LAYOUT + "</div>").click(function() {
			//Update the layout
			if(colGroups.length){
				MP_Util.Doc.ResetLayoutSettings(mPageObj);
			}
		});
		menuSeperator = $("<div></div>").addClass("menu-item").addClass("menu-separator");
		//Append the layout selections
		$(menuContainer).append(col1, col2, col3,menuSeperator,resetLayout); 		
		//Rerturn the jQuery object
		return menuContainer;
	});
	return layoutSelector;
};

MPageView.prototype.createClearPrefsMenuItem = function(){
	var clearPrefs = new MenuSelection("clearPrefs" + this.getCategoryMean());
	clearPrefs.setLabel(i18n.discernabu.CLEAR_PREFERENCES);
	clearPrefs.setCloseOnClick(true);
	clearPrefs.setClickFunction(function(elementId) {
		var i18nCore = i18n.discernabu;
		var confirmMsg = i18nCore.CLEAR_ALL_PREFS + "<br />" + i18nCore.CLEAR_ALL_PREFS_CANCEL;
		MP_Util.AlertConfirm(confirmMsg, i18nCore.CLEAR_PREFERENCES, i18nCore.CONFIRM_CLEAR, i18nCore.CONFIRM_CANCEL, true, MP_Core.AppUserPreferenceManager.ClearPreferences);
	});
	return clearPrefs;
};

MPageView.prototype.loadDragAndDropMenuItem = function(){
	var activeView = $("#" + this.getCategoryMean());
	var parentEleId = "";
	if(activeView.length) {
		parentEleId = "#" + this.getCategoryMean();
	}
	else {
		activeView = $(document.body);
	}
	
	var dnd = new MenuSelection("dragNDrop" + this.getCategoryMean());
	dnd.setLabel(i18n.DRAG_AND_DROP);
	dnd.setCloseOnClick(false);
	dnd.setClickFunction(function(){
		if(dnd.isSelected()){
			//Add the Drag and Drop css class from the view container
			$(activeView).addClass("dnd-enabled");
			
			// re-enables sortable
			$(parentEleId + " .col-outer1:last .col1," + parentEleId + " .col-outer1:last .col2," + parentEleId + " .col-outer1:last .col3").sortable("enable");
			// update the cursor back to the move icon
			$(parentEleId + " .col-outer1:last .sec-hd").css("cursor", "move");
		}
		else{
			//Remove the Drag and Drop css class from the view container
			$(activeView).removeClass("dnd-enabled");

			//Disables Drag and Drop in the View
			$(parentEleId + " .col-outer1:last .col1," + parentEleId + " .col-outer1:last .col2," + parentEleId + " .col-outer1:last .col3").sortable("disable");
			//Update the cursor to switch from the move icon to auto
			$(parentEleId + " .col-outer1:last .sec-hd").css("cursor", "auto");
		}
	});
	return dnd;
};

/**
 * Loads the page menu for a specific MPageView object.
 * @this {MPageView}
 */
MPageView.prototype.loadPageMenu = function() {
	var categoryMean = this.getCategoryMean();
	var tempMenuItem = null;

	//Create the menu object for this page
	var pageMenu = new Menu("pageMenu" + categoryMean);
	pageMenu.setTypeClass("menu-page-menu");
	pageMenu.setIsRootMenu(true);
	pageMenu.setAnchorElementId("pageMenu" + categoryMean);
	pageMenu.setAnchorConnectionCorner(["bottom", "right"]);
	pageMenu.setContentConnectionCorner(["top", "right"]);
	pageMenu.setLabel("");

	//Create the layout selector menu item
	tempMenuItem = this.createLayoutMenu();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}
	
	//Create the drag and drop menu item
	tempMenuItem = this.loadDragAndDropMenuItem();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}
	
	//Load the Expand/Collapse Menu Option
	tempMenuItem = this.loadExpandCollapseAllMenuItem();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}

	//Load the Component Selection menu option
	tempMenuItem = this.loadComponentSelection();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}

	//Load the Print report menu item
	tempMenuItem = this.loadPrintableReportMenuItem();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}
	
	//Add a seperator
	pageMenu.addMenuItem(new MenuSeparator("separator"));

	//Create the clear preferences menu item
	tempMenuItem = this.createClearPrefsMenuItem();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}
	
	//Create the clear preferences menu item
	tempMenuItem = this.loadHelpMenuItem();
	if(MenuItem.prototype.isPrototypeOf(tempMenuItem)){
		pageMenu.addMenuItem(tempMenuItem);
	}
	
	//Add the menu object to the menu manager
	MP_MenuManager.addMenuObject(pageMenu);

	//Update the click event on the menu to launch this menu when clicked.
	$("#pageMenu" + categoryMean).unbind("click").click(function() {
		if(pageMenu.isActive()){
			MP_MenuManager.closeMenuStack(true);
		}
		else{
			MP_MenuManager.showMenu("pageMenu" + categoryMean);
		}
	});
};
/**
 * @author JS026207
 */
var browserDevInd = null;
var DASH_CORE = function() {

    function createDashboardLayout(mPage, parentNode) {
        var components = mPage.getComponents();
        MP_Util.addComponentsToGlobalStorage(components);

        createFilterSection(mPage, parentNode);
        createHelpLink(mPage, parentNode);
        createDashComponentSection(mPage, parentNode);
    }

    function createCarouselLayout(mPage, parentNode) {
        var components = mPage.getComponents();
        MP_Util.addComponentsToGlobalStorage(components);

        createFilterSection(mPage, parentNode);
        createCarouselComponentSection(mPage, parentNode, components);
    }

    function createFerrisLayout(mPage, parentNode) {
        var components = mPage.getComponents();
        MP_Util.addComponentsToGlobalStorage(components);

        createFilterSection(mPage, parentNode);
        createFerrisComponentSection(mPage, parentNode, components);
    }

    function createHelpLink(mPage, parentNode) {
        var dashboardConfig = MP_Resources.getSharedResource("dashConfig") || {};
        var helpLinkURL = dashboardConfig.helpLinkURL || {};

        var helpLinkDiv = $("<div/>").addClass('help-link-div').appendTo(parentNode);
        var helpLink = $("<div/>").addClass('help-link').appendTo(helpLinkDiv);
        helpLink.click(function() {
            window.open(helpLinkURL, "", "menubar=yes,toolbar=yes,scrollbars=yes,resizable=yes,location=yes,height=768,width=1024");
        });
    }

    function createFilterSection(mPage, parentNode) {
        var dashboardConfig = MP_Resources.getSharedResource("dashConfig") || {};
        var filterConfig = dashboardConfig.pageFilters || {};

        var filterRow = $("<div/>").addClass('dash-filter-row').appendTo(parentNode);

        try {
            var fcLen = filterConfig.length;
            var filterContainer, filterLvl1Config, filterGroupConfig, filterGroup, filterGroupLabel, filterGroupFiltersConfig, filterLvl2Config, value, inputID, containingDiv;
            var f1Idx = 0, f2Idx = 0;
            var filter1Lmt = fcLen, filter2Lmt;
            for (; f1Idx < filter1Lmt; f1Idx++) {
                filterLvl1Config = filterConfig[f1Idx];
                if (filterLvl1Config.filterGroup) {
                    filterGroupConfig = filterLvl1Config.filterGroup || {};

                    if (filterGroupConfig.visible) {
                        filterGroup = $("<div></div>").addClass('dash-filter-group').appendTo(filterRow);
                        filterGroupLabel = $("<div>" + filterGroupConfig.label + "</div>").addClass('dash-filter-group-label');
                        filterGroupLabel.appendTo(filterGroup);

                        filterGroupFiltersConfig = filterGroupConfig.filters;
                        filter2Lmt = filterGroupFiltersConfig.length;
                        for ( f2Idx = 0; f2Idx < filter2Lmt; f2Idx++) {
                            filterLvl2Config = filterGroupFiltersConfig[f2Idx];
                            if (filterLvl2Config.visible !== filterGroupConfig.visible) {
                                value = filterLvl2Config.value || filterLvl2Config.filterDef.defaultVal;
                                inputID = 'dash-filter-' + f1Idx + '-' + f2Idx;

                                createFilterControl(filterGroup, filterLvl2Config, inputID, value);
                            }
                        }
                    }
                } else {
                    containingDiv = $("<div/>").appendTo(filterRow);
                    value = filterLvl1Config.value || filterLvl1Config.filterDef.defaultVal;
                    inputID = 'dash-filter-' + f1Idx;

                    createFilterControl(containingDiv, filterLvl1Config, inputID, value);
                }
            }

            if (fcLen) {
                filterContainer = $("<div/>").appendTo(filterRow);
                var filterRefreshButton = $("<button id='refreshButton'>Refresh</button>").addClass("dash-filter-refresh-button");
                filterRefreshButton.appendTo(filterContainer);
                filterRefreshButton.button().click(function(event) {
                    // TODO: This needs to have a more generic implimentation.
                    getCustomLocationValues();
                    $(".dash-target").empty();
                    $(".error-message").remove();
                    $(".chart-details-dialog").find("tr").remove();
                    MP_Util.Doc.ReloadAllComponents(mPage);
                });
            }

        } catch (err) {
            var message = 'Failure occured loading Filters.';
            filterRow.html(message);
            MP_Util.LogError(message);
            MP_Util.LogJSError(err, null, "mp_core.js", "CreateDashFilterSection");
        }

        filterRow = $("<div></div>").addClass('dash-filter-divider').appendTo(parentNode);
    }

    function createFilterControl(filterGroup, config, inputID, value) {
        var filterDef = config.filterDef;
        var filterType = filterDef.type;
        filterContainer = $("<div/>").addClass('dash-filter-container').appendTo(filterGroup);
        var isHidden = config.visible === false;
        if (isHidden) {
            filterContainer.addClass('hidden');
        }
        filterLabel = $("<div>" + config.label + "</div>").addClass('dash-filter-label');
        filterLabel.appendTo(filterContainer);

        switch (filterType) {
            case 'Select':
                var isParent = filterDef.isParent;
                var filterOptions = filterDef.options;
                filterField = $('<select id="' + inputID + '"></select>').addClass('dash-filter-control');
                filterField.appendTo(filterContainer);

                filterField.addClass(filterDef.name);
                //Add the options to the select element if provided.
                if (filterOptions) {
                    $.each(filterOptions, function(id, display) {
                        filterField.append($("<option></option>").attr("value", id).text(display));
                    });
                    filterField.val(value);
                } else {
                    //Run the select list data query
                    dashLoadSelectData(filterGroup, filterField, filterDef, value);                    
                }
                break;
            case 'CustomLocation':
                createCustomLocationControl(filterGroup, filterDef, value, filterContainer, inputID);
                break;
            case 'DatePicker':
                filterField = $('<input type="text" id="' + inputID + '">').addClass('dash-filter-control');
                filterField.appendTo(filterContainer);
                filterField.addClass(filterDef.name);
                var tmpDate;
                // If the config has a date set, use it, otherwise use TODAY.
                if (value) {
                    tmpDate = new Date(value);
                } else {
                    tmpDate = new Date();
                }
                filterField.datepicker({
                    showButtonPanel : true
                });
                filterField.datepicker("setDate", tmpDate);

                //TODO: Add Internationalization here
                //$.datepicker.setDefaults( $.datepicker.regional[ "fr" ] );

                break;
        }
    }

    function dashLoadSelectData(filterGroup, filterField, filterDef, value) {
        var codes = [];
        var requestObj = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
        requestObj.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                MP_Util.LogScriptCallInfo(null, this, "dash_core.js", filterDef.dataCall);
                var jsonEval = JSON.parse(this.responseText);
                if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
                    codes = jsonEval.RECORD_DATA.VALUES;
                    $.each(codes, function() {
                        filterField.append($("<option></option>").attr("value", this.ID).text(this.DISPLAY));
                    });
                    filterField.val(value);
                }
            }
            if (this.readyState == 4) {
                MP_Util.ReleaseRequestReference(this);
            }
        };
        //  Call the ccl progam and send the parameter string
        var params = [];
        params.push(filterDef.dataCallParams);
        if (filterDef && filterDef.parentControl) {
            // Get the selected text of the parent Select element
            params.push($(filterGroup).find("." + filterDef.parentControl).val());
        }
        if (CERN_BrowserDevInd) {
            var url = filterDef.dataCall + "?parameters=" + params.join(',');
            requestObj.open('GET', url, false);
            requestObj.send(null);
        } else {
            requestObj.open('GET', filterDef.dataCall, false);
            requestObj.send(params.join(','));
        }
    }

    // Create an alpha sort
    function SortByName(a, b) {
        var aName = a.DISPLAY.toLowerCase();
        var bName = b.DISPLAY.toLowerCase();
        return ((aName < bName) ? -1 : ((aName > bName) ? 1 : 0));
    }

    function dashLoadCustLocSelectData(filterField, filterDef, parentID, value, type, async) {
        var codes = [];
        var requestObj = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
        requestObj.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                // Empty the Select control
                $(filterField).find("option").remove();
                MP_Util.LogScriptCallInfo(null, this, "dash_core.js", filterDef.dataCall);
                var jsonEval = JSON.parse(this.responseText);
                if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
                    codes = jsonEval.RECORD_DATA.VALUES;

                    // Sort the items
                    codes.sort(SortByName);
                    // Load the items into the Select control
                    $.each(codes, function() {
                        filterField.append($("<option></option>").attr("value", this.ID).text(this.DISPLAY));
                    });
                    // Select the default value, if able.
                    $(filterField).val(value);
                    // Trigger the change event of the control.
                    $(filterField).change();
                }
            }
            if (this.readyState == 4) {
                MP_Util.ReleaseRequestReference(this);
            }
        };
        //  Call the ccl progam and send the parameter string
        var params = [];
        parentID = ((parentID === undefined) || (parentID === null)) ? "0.0" : parentID;
        params.push("^MINE^");
        params.push("0.0");
        params.push(type);
        params.push(parentID);
        if (CERN_BrowserDevInd) {
            var url = filterDef.dataCall + "?parameters=" + params.join(',');
            requestObj.open('GET', url, async);
            requestObj.send(null);
        } else {
            requestObj.open('GET', filterDef.dataCall, async);
            requestObj.send(params.join(','));
        }
    }

    function createCustomLocationControl(filterGroup, filterDef, value, filterContainer, inputID) {
        // Create hidden controls to hold the id and type
        $("<input/>").attr("value", 0).addClass('dashHiddenID hidden').appendTo(filterContainer);
        $("<input/>").attr("value", "^FACILITY^").addClass('dashHiddenType hidden').appendTo(filterContainer);

        // Create the Facility mini-control
        var facilityContainer = $("<div/>").addClass("dash-loc-ctrl-group").appendTo(filterContainer);
        var facilityAnchorControl = $("<a/>").addClass('dash-loc-ctrl facilityControl hidden').appendTo(facilityContainer);
        var facilitySelectControl = $("<select/>").addClass('dash-loc-ctrl facilityControl facilitySelectControl').appendTo(facilityContainer);
        // Create the Area mini control
        var areaContainer = $("<div/>").addClass("dash-loc-ctrl-group").appendTo(filterContainer);
        var areaAnchorControl = $("<a/>").addClass('dash-loc-ctrl areaControl').text("select area").appendTo(areaContainer);
        var areaSelectControl = $("<select/>").addClass('dash-loc-ctrl areaControl areaSelectControl hidden').appendTo(areaContainer);
        // Create the Room mini control
        var roomContainer = $("<div/>").addClass("dash-loc-ctrl-group hidden").appendTo(filterContainer);
        var roomAnchorControl = $("<a/>").addClass('dash-loc-ctrl roomControl roomAnchorControl hidden').appendTo(roomContainer);
        var roomSelectControl = $("<select/>").addClass('dash-loc-ctrl roomControl roomSelectControl hidden').appendTo(roomContainer);

        facilityAnchorControl.click(function(event) {
            facilityAnchorControl.text($(".dash-filter-container .facilitySelectControl option:selected").text());
            facilityAnchorControl.addClass("hidden");
            facilitySelectControl.removeClass("hidden");
            areaAnchorControl.text("select area");
            areaAnchorControl.removeClass("hidden");
            areaSelectControl.addClass("hidden");
            roomContainer.addClass("hidden");
            roomAnchorControl.addClass("hidden");
            roomSelectControl.addClass("hidden");
        });
        facilitySelectControl.change(function(event) {
            facilityAnchorControl.text($(this).text());
            areaSelectControl.find('option').remove().end().append('<option value="loading">Loading...</option>').val('loading');
            var filterDefaults = filterDef.defaultVals || [];
            dashLoadCustLocSelectData(areaSelectControl, filterDef, $(".dash-filter-container .facilitySelectControl").val(), filterDefaults[1], "^AREA^", true);
        });

        areaAnchorControl.click(function(event) {
            facilityAnchorControl.text($(".dash-filter-container .facilitySelectControl option:selected").text());
            facilityAnchorControl.removeClass("hidden");
            facilitySelectControl.addClass("hidden");
            roomAnchorControl.text("select room");
            areaAnchorControl.addClass("hidden");
            areaSelectControl.removeClass("hidden");
            roomContainer.removeClass("hidden");
            roomAnchorControl.removeClass("hidden");
            roomSelectControl.addClass("hidden");
        });
        areaSelectControl.change(function(event) {
            roomSelectControl.find('option').remove().end().append('<option value="loading">Loading...</option>').val('loading');
            var filterDefaults = filterDef.defaultVals || [];
            dashLoadCustLocSelectData(roomSelectControl, filterDef, $(".dash-filter-container .areaSelectControl").val(), filterDefaults[2], "^ROOM^", true);
            if (areaSelectControl.hasClass("hidden") === false) {
                areaAnchorControl.text($(this).text());
            }
        });

        roomAnchorControl.click(function(event) {
            areaAnchorControl.text($(".dash-filter-container .areaSelectControl option:selected").text());
            facilityAnchorControl.removeClass("hidden");
            facilitySelectControl.addClass("hidden");
            areaAnchorControl.removeClass("hidden");
            areaSelectControl.addClass("hidden");
            roomAnchorControl.addClass("hidden");
            roomSelectControl.removeClass("hidden");
        });

        // On first load of the page, process defaults.
        // Load the Facility drop down.
        var filterDefaults = filterDef.defaultVals || [];
        dashLoadCustLocSelectData(facilitySelectControl, filterDef, 0, filterDefaults[0], "^FACILITY^", false);
        // Set the currently selected item into the hidden fields.
        var selectedFacilityID = facilitySelectControl.val();
        // If the currently selected item in the drop down is the default value, go on to the Area control.
        if (selectedFacilityID == filterDefaults[0]) {
            // Load the Area drop down.
            dashLoadCustLocSelectData(areaSelectControl, filterDef, selectedFacilityID, filterDefaults[1], "^AREA^", false);
            // If the Area default value was set, continue setting the Area as the 'active' filter level.
            if (filterDefaults[1] !== "0") {
                facilityAnchorControl.text($(".dash-filter-container .facilitySelectControl option:selected").text());
                areaAnchorControl.trigger("click");
                // Set the currently selected item into the hidden fields.
                var selectedAreaID = areaSelectControl.val();
                // If the currently selected item in the drop down is the default value, go on to the Room control.
                if (selectedAreaID == filterDefaults[1]) {
                    // Load the Room drop down.
                    dashLoadCustLocSelectData(roomSelectControl, filterDef, selectedAreaID, filterDefaults[2], "^ROOM^", false);
                    // If the Room default value was set, continue setting the Room as the 'active' filter level.
                    if (filterDefaults[2] !== "0") {
                        areaAnchorControl.text($(".dash-filter-container .areaSelectControl option:selected").text());
                        roomAnchorControl.trigger("click");
                        // Set the currently selected item into the hidden fields.
                        var selectedRoomID = roomSelectControl.val();
                    }
                }
            }
        }
        $("#refreshButton").trigger("click");
    }

    function getCustomLocationValues() {
        var roomSelectControl = $(".dash-filter-row .roomSelectControl");
        if (roomSelectControl.hasClass("hidden") === false) {
            id = roomSelectControl.val();
            type = "^ROOM^";
        } else {
            var areaSelectControl = $(".areaSelectControl");
            if (areaSelectControl.hasClass("hidden") === false) {
                id = areaSelectControl.val();
                type = "^AREA^";
            } else {
                var facilitySelectControl = $(".facilitySelectControl");
                id = facilitySelectControl.val();
                type = "^FACILITY^";
            }
        }
        $(".dash-filter-row .dashHiddenID").val(id);
        $(".dash-filter-row .dashHiddenType").val(type);
    }

    /**
     * Demo code
     */
    function moveToFerrisPosition(comp, newPos, components, XRadius, YRadius, ferrisTrayCenterX, ferrisTrayCenterY) {
        var maxPos = components.length;
        var curPos = parseInt($(comp).attr("carouselPos"), 10);
        var compSizeModDefault = 0.40;
        var compSizeModifier;
        if (newPos <= 0) {
            newPos = maxPos + newPos;
        }
        while (curPos != newPos) {
            curPos--;

            if (curPos === 0) {
                curPos = maxPos;
            } else {
                curPos = newPos;
            }

            var angle = angleIncrement * Math.round(curPos - 1) - 1.65;
            var ferrisTrayPositionRelativeX = XRadius * Math.cos(angle);
            var ferrisTrayPositionRelativeY = YRadius * Math.sin(angle);
            var ferrisTrayPositionAbsoluteX = ferrisTrayCenterX + ferrisTrayPositionRelativeX;
            var ferrisTrayPositionAbsoluteY = ferrisTrayCenterY + ferrisTrayPositionRelativeY - YRadius;
            // TODO: ferrisTrayWidth isn't properly in scope here.
            var diminishValue = 1 - (ferrisTrayPositionAbsoluteX / ferrisTrayWidth);
            var componentSizePercentage = compSizeModifier * diminishValue;
            var componentHeight = ferrisTrayHeight * componentSizePercentage;
            var componentWidth = componentHeight;
            var componentPositionOffsetX = componentWidth / 2;
            var componentPositionOffsetY = componentHeight / 2;

            $(comp).stop().animate({
                width : componentWidth,
                height : componentHeight,
                top : ferrisTrayPositionAbsoluteY,
                left : ferrisTrayPositionAbsoluteX - componentPositionOffsetX
                // Setting z-index here would be good.
                //, 'font-size' : diminishValue+'%'
            }, 800, function() {
                $(comp).css('opacity', diminishValue).css('postition', 'absolute').css('z-index', ferrisTrayPositionAbsoluteY);
            });
            $(comp).css('postition', 'absolute').css('z-index', -ferrisTrayPositionAbsoluteY);
        }
        $(comp).attr('carouselPos', curPos);
    }

    /**
     * Demo code
     */
    function moveToCarouselPosition(comp, newPos, components, XRadius, YRadius, DashboardCenterX, dashboardCenterY) {
        var maxPos = components.length;
        var curPos = parseInt($(comp).attr("carouselPos"), 10);
        var compSizeModDefault = 0.40;
        var compSizeModifier;
        if (newPos <= 0) {
            newPos = maxPos + newPos;
        }
        while (curPos != newPos) {
            curPos--;
            if (curPos === 1) {
                compSizeModifier = compSizeModDefault * 2;
            } else {
                compSizeModifier = compSizeModDefault;
            }

            if (curPos === 0) {
                curPos = maxPos;
            } else {
                curPos = newPos;
            }

            var angle = angleIncrement * Math.round(curPos - 1) - 1.65;
            var carouselPositionRelativeX = XRadius * Math.cos(angle);
            var carouselPositionRelativeY = YRadius * Math.sin(angle);
            var carouselPositionAbsoluteX = dashboardCenterX + carouselPositionRelativeX;
            var carouselPositionAbsoluteY = dashboardCenterY + carouselPositionRelativeY - YRadius;
            // TODO: dashboardWidth isn't properly in scope here.
            var diminishValue = 1 - (carouselPositionAbsoluteX / dashboardWidth);
            var componentSizePercentage = compSizeModifier * diminishValue;
            var componentHeight = dashboardHeight * componentSizePercentage;
            var componentWidth = componentHeight;
            var componentPositionOffsetX = componentWidth / 2;
            var componentPositionOffsetY = componentHeight / 2;

            $(comp).stop().animate({
                width : componentWidth,
                height : componentHeight,
                top : carouselPositionAbsoluteY,
                left : carouselPositionAbsoluteX - componentPositionOffsetX
                // Setting z-index here would be good.
                //, 'font-size' : diminishValue+'%'
            }, 800, function() {
                $(comp).css('opacity', diminishValue).css('postition', 'absolute').css('z-index', carouselPositionAbsoluteY);
            });
            $(comp).css('postition', 'absolute').css('z-index', -carouselPositionAbsoluteY);
        }
        $(comp).attr('carouselPos', curPos);
    }

    /**
     * Demo code
     */
    function moveToSidebar(comp, components) {
        $(comp).stop().animate({
            top : 0,
            left : 0
        });
        $(comp).removeAttr('carouselPos').click(function() {
            $(comp).attr('carouselPos', -1);
            moveToCarouselPosition(this, 1, components);
        });
    }

    function createDashComponentSection(mPage, parentNode) {
        var dashboardConfig = MP_Resources.getSharedResource("dashConfig");
        var numColumns = "12";
        var numRows = "12";
        var components = mPage.getComponents();
        var parentHeight = $("body").height() - 25;
        var parentWidth = $("body").width();
        var sibsHeight = $('dash-filter-row').height();
        var defaultHeightPercent = (1 / numRows);
        var defaultWidthPercent = 1 / numColumns;
        var defaultHeight = Math.floor((parentHeight - sibsHeight) * defaultHeightPercent);
        var defaultWidth = Math.floor(parentWidth * defaultWidthPercent);

        var content = $("<div/>").addClass("col-group dash-row").appendTo(parentNode);

        $(components).each(function() {
            var tmpComponent = $(this)[0];
            var style = tmpComponent.getStyles();
            style.m_className += " dash-sec";
            style.m_contentClass += " dash-sec-content";
            style.m_headerClass += " dash-sec-hd";
            style.m_secTitle += " dash-sec-title";

            var tmpWidth = defaultWidth * (tmpComponent.m_gridPosRight - tmpComponent.m_gridPosLeft + 1);
            var tmpHeight = defaultHeight * (tmpComponent.m_gridPosBottom - tmpComponent.m_gridPosTop + 1) - (numRows * 2);
            var tmpPosLeft = tmpComponent.m_gridPosLeft - 1;
            var tmpPosTop = tmpComponent.m_gridPosTop - 1;
            var dividerLineLength = 0.6;
            var dividerLineMarginLength = (1 - dividerLineLength) / 2;

            var component = $(MP_Util.Doc.CreateComponent(tmpComponent, null)).width(tmpWidth).height(tmpHeight);
            component.attr('gridPosRight', tmpComponent.m_gridPosRight).attr('gridPosLeft', tmpComponent.m_gridPosLeft);
            component.attr('gridPosTop', tmpComponent.m_gridPosTop).attr('gridPosBottom', tmpComponent.m_gridPosBottom);
            component.appendTo(content);

            $(component).css({
                top : parentHeight / 2 - tmpHeight / 2,
                left : parentWidth / 2 - tmpWidth / 2
            });
            $(component).stop().animate({
                left : (tmpPosLeft * defaultWidth),
                top : (tmpPosTop * defaultHeight)
            }, 1000);
        });

        $(window).resize(function() {
            $(".section").each(function() {
                var parentHeight = $("body").height() - 25;
                var parentWidth = $("body").width();
                var sibsHeight = $('dash-filter-row').height();
                var defaultHeightPercent = (1 / numRows);
                var defaultWidthPercent = 1 / numColumns;
                var defaultHeight = Math.floor((parentHeight - sibsHeight) * defaultHeightPercent);
                var defaultWidth = Math.floor(parentWidth * defaultWidthPercent);
                var tmpWidth = defaultWidth * ($(this).attr("gridPosRight") - $(this).attr("gridPosLeft") + 1);
                var tmpHeight = defaultHeight * ($(this).attr("gridPosBottom") - $(this).attr("gridPosTop") + 1) - (numRows * 2);
                var tmpPosLeft = $(this).attr("gridPosLeft") - 1;
                var tmpPosTop = $(this).attr("gridPosTop") - 1;
                $(this).width(tmpWidth).height(tmpHeight);

                $(this).stop().animate({
                    left : (tmpPosLeft * defaultWidth),
                    top : (tmpPosTop * defaultHeight)
                });
            });
        });
    }

    /**
     * Demo code
     */
    function createCarouselComponentSection(mPage, parentNode, components) {
        $(parentNode).css('background', '#000');
        var row = $("<div></div>").addClass("col-group one-col dash-row").appendTo(parentNode);

        for (var idx = 0, lmt = components.length; idx < lmt; idx++) {
            var tmpComponent = components[idx];
            tmpComponent.setAlwaysExpanded(true);
            var style = tmpComponent.getStyles();
            style.m_className += " dash-sec dash-carousal-sec";
            style.m_contentClass += " dash-sec-content dash-carousal-sec-content";
            style.m_headerClass += " dash-sec-hd dash-carousal-sec-hd";
            style.m_secTitle += " dash-sec-title dash-carousal-sec-title";
            $(MP_Util.Doc.CreateComponent(tmpComponent, null)).attr('carouselPos', -1).appendTo(row);
        }

        numOfCharts = components.length;
        angleIncrement = (Math.PI * 2) / numOfCharts;
        dashboardWidth = $(parentNode).width();
        dashboardHeight = $(parentNode).innerHeight();
        dashboardCenterX = dashboardWidth * 0.5;
        dashboardCenterY = dashboardHeight * 0.5;
        carouselXRadius = dashboardCenterX * 0.5;
        carouselYRadius = dashboardCenterY * 0.5;
        chartCnt = 0;

        $('.section').each(function() {
            //$(this).css('dash-carousal-sec');
            chartCnt++;
            var tmpID = 'container' + chartCnt;

            moveToCarouselPosition(this, chartCnt, components, carouselXRadius, carouselYRadius, dashboardCenterX, dashboardCenterY);

            $(this).click(function() {
                //Make this recursive.
                var thisCaroPos = $(this).attr("carouselPos");
                if (thisCaroPos) {
                    var caroPosInt = parseInt(thisCaroPos, 10);
                    if (caroPosInt !== 1) {
                        moveToCarouselPosition(this, 1, components, carouselXRadius, carouselYRadius, dashboardCenterX, dashboardCenterY);

                        $(this).siblings().each(function() {
                            var sibCaroPos = $(this).attr("carouselPos");
                            if (sibCaroPos) {
                                moveToCarouselPosition(this, parseInt(sibCaroPos, 10) - (thisCaroPos - 1), components, carouselXRadius, carouselYRadius, dashboardCenterX, dashboardCenterY);
                            }
                        });
                    } else {
                        moveToSidebar(this, components);
                    }
                } else {
                    $(this).attr('carouselPos', -1);
                }
            });
        });
    }

    /**
     * Demo code
     */
    function createFerrisComponentSection(mPage, parentNode, components) {
        // Create the tray to hold the Ferris Wheel of charts
        var ferrisSect = $("<div></div>").addClass("one-col dash-ferris-row dash-ferris-parent-sec").appendTo(parentNode);

        // Create a Pin button for sliding the tray in and out.
        //TODO: This needs to be styled better.
        var ferrisTrayPin = $("<button id='ferrisTrayPin'>F</button>").appendTo(parentNode).addClass("ferris-tray-pin");
        ferrisTrayPin.button().click(function(event) {
            ferrisSect.toggle("slide");
        });

        // Create the Dashboard Section.
        var dashboardSect = $("<div></div>").addClass("one-col dash-ferris-row dash-parent-sec").appendTo(parentNode);

        // Add the Components to the Ferriswheel Section
        for (var idx = 0, lmt = components.length; idx < lmt; idx++) {
            var tmpComponent = components[idx];
            tmpComponent.setAlwaysExpanded(true);
            var style = tmpComponent.getStyles();
            style.m_className += " dash-sec dash-ferris-sec";
            style.m_contentClass += " dash-sec-content dash-ferris-sec-content";
            style.m_headerClass += " dash-sec-hd dash-ferris-sec-hd";
            style.m_secTitle += " dash-sec-title dash-ferris-sec-title";
            var comp = $(MP_Util.Doc.CreateComponent(tmpComponent, null));
            comp.attr('carouselPos', idx).attr('widthMulti', tmpComponent.m_widthMultiplier).appendTo(ferrisSect);
        }

        $(".section").draggable({
            grid : [40, 40]
        }).resizable();

        $(".dash-ferris-row").sortable({
            connectWith : ".dash-ferris-row"
        });

        $(".dash-parent-sec").sortable({
            over : function(event, ui) {
                ui.item.removeClass("dash-ferris-sec");
                ui.item.addClass("dash-chart-sec");
                ui.item.unbind("click");
            }
        });

        $(".dash-ferris-parent-sec").sortable({
            over : function(event, ui) {
                ui.item.removeClass("dash-chart-sec");
                ui.item.addClass("dash-ferris-sec");
                ui.item.click(function() {
                    $('.section').each(function() {
                        var thisCaroPos = $(this).attr("carouselPos");
                        if (thisCaroPos) {
                            var caroPosInt = parseInt(thisCaroPos, 10);
                            moveToFerrisPosition(this, caroPosInt - 1, components, ferrisXRadius, ferrisYRadius, dashboardCenterX, dashboardCenterY);
                        }
                    });
                });
            }
        });

        numOfCharts = components.length;
        angleIncrement = (Math.PI * 2) / numOfCharts;
        ferrisTrayWidth = $(ferrisSect).width();
        ferrisTrayHeight = $(ferrisSect).innerHeight();
        ferrisTrayCenterX = ferrisTrayWidth * 0.5;
        ferrisTrayCenterY = ferrisTrayHeight * 0.5;
        ferrisXRadius = ferrisTrayCenterX * 0.5;
        ferrisYRadius = ferrisTrayCenterY * 0.5;
        chartCnt = 0;

        $('.section').each(function() {
            chartCnt++;
            var tmpID = 'container' + chartCnt;

            moveToFerrisPosition(this, chartCnt, components, ferrisXRadius, ferrisYRadius, ferrisTrayCenterX, ferrisTrayCenterY);

            $(this).click(function() {
                $('.section').each(function() {
                    var thisCaroPos = $(this).attr("carouselPos");
                    if (thisCaroPos) {
                        var caroPosInt = parseInt(thisCaroPos, 10);
                        moveToFerrisPosition(this, caroPosInt - 1, components, ferrisXRadius, ferrisYRadius, ferrisTrayCenterX, ferrisTrayCenterY);
                    }
                });
            });
        });
    }

    return {

        /**
         * Initializes the page layout, depending on the layout type defined in the config file
         */
        InitDashboardLayout : function(mPage, helpFile, helpURL, categoryMeaning) {
            var i18nCore = i18n.discernabu;
            var criterion = mPage.getCriterion();
            browserDevInd = (parseInt(criterion.debug_ind, 10) & 0x01 === 1) ? true : false;
            var body = document.body;

            var mpComps = mPage.getComponents();
            var dashboardConfig = MP_Resources.getSharedResource("dashConfig");
            var layoutType = dashboardConfig.layoutType || "";

            switch (layoutType.toUpperCase()) {
                case "DASHBOARD":
                    createDashboardLayout(mPage, body);
                    break;
                case "CAROUSEL":
                    createCarouselLayout(mPage, body);
                    break;
                case "FERRISWHEEL":
                    createFerrisLayout(mPage, body);
                    break;
                default:
                    createDashboardLayout(mPage, body);
            }

            //TODO: What of this needs to stay?
            MP_Util.Doc.AddCustomizeLink(criterion);
            MP_Util.Doc.CreatePageMenu(categoryMeaning, criterion.category_mean);
        },

        /**
         * Starting with the Component Filters collection, extract the Filters (regardless of visibility or editability),
         * and add to a new collection.
         * This new collection will allow for altering of the filter values for each individual Component, independent
         * of the main page, like when drilling down.         *
         */
        CombineCmptAndPageFilters : function(cmptFilters, component) {
            var processedFilters = [];
            var processedFilter = {};
            var criterion = component.getCriterion();
            var dashConfig = MP_Resources.getSharedResource("dashConfig");
            var pageFilters = dashConfig.pageFilters || {};
            var lmt = cmptFilters.length;
            var idx, filterDefinition;
            // For each filter
            for ( idx = 0; idx < lmt; idx++) {
                filter = cmptFilters[idx];
                // If it's a Filter Group, call this method recursively on that subgroup
                if (filter.filterGroup) {
                    var group = filter.filterGroup;
                    var groupFilters = group.filters;
                    var processedFilterGroup = {
                        id : group.id,
                        label : group.label,
                        visible : group.visible,
                        editable : group.editable
                    };
                    processedFilterGroup.filters = DASH_CORE.CombineCmptAndPageFilters(groupFilters, component);
                    processedFilter = processedFilterGroup;
                } else {
                    filterDefinition = filter.filterDef || {};
                    // Set the Filter properties
                    var id = filter.id || filterDefinition.id || idx;
                    var label = filter.label || filterDefinition.label || "";
                    var type = filter.type || filterDefinition.type || "";
                    var visible = filter.visible || filterDefinition.visible || false;
                    var editable = filter.editable || filterDefinition.editable || false;
                    // Set the value to the default defined in the Filter or Filter Definition.
                    var value = filter.value || filterDefinition.defaultVal;
                    // Ignore non-parameter Filters
                    if (filterDefinition.nonParam) {
                        continue;
                    } else {
                        var predefinedType = filterDefinition.type;
                        switch (predefinedType) {
                            // If the Filter is of Type Criterion, look up the value in the Criterion object.
                            case "Criterion" :
                                var predefinedProperty = filterDefinition.property;
                                if ( typeof predefinedProperty === "string") {
                                    if (filterDefinition.property.toUpperCase() == "PROVIDERID") {
                                        value = criterion.provider_id;
                                    }
                                }
                                break;
                            // If the Filter is of Type DatePicker, pull the value from the control then add the timeStamp
                            case "DatePicker" :
                                value = $(".dash-filter-row ." + filterDefinition.name).val();
                                if (value) {
                                    value = value + " " + filterDefinition.timeStamp;
                                }
                                break;
                            // Default behavior is to pull the value from the filter control or use the default if it is empty.
                            default :
                                value = $(".dash-filter-row ." + filterDefinition.name).val() || value;
                        }
                        // Create the Filter Object
                        processedFilter = {
                            id : id,
                            label : label,
                            type : type,
                            visible : visible,
                            editable : editable,
                            value : value
                        };
                    }
                }
                processedFilters.push(processedFilter);
            }
            return processedFilters;
        },

        /**
         * Converts the current values of a collection of filters into parameters for use in a CCL call.
         * @param {Object} filters
         */
        GetParamsFromFilters : function(filters) {
            var params = [];
            var idx = 0;
            var lmt = filters.length;
            for (; idx < lmt; idx++) {
                var filter = filters[idx];
                var filterVal = filter.value;
                // If it's a grouper, call again recursively
                if (filter.filters) {
                    params.push(DASH_CORE.GetParamsFromFilters(filter.filters));
                } else {
                    if (filter.type == "DatePicker") {
                        var filterDate = new Date(filterVal);
                        filterVal = "^" + MP_Util.CreateDateParameter(filterDate) + "^";
                    }
                    params.push(filterVal);
                }
            }
            return params;
        },

        /**
         * Displays a default or customized message when no data is found by the data call.
         * @param {Object} component
         */
        DisplayNoDataMessage : function(component) {
            var componentID = component.getComponentId();
            var title = component.m_Config.chartConfig.title || component.m_Config.label || "";
            var messages = component.m_Config.messages || {};
            var noDataMessage = messages.noData || "No data found";
            var thisContent = [];

            thisContent.push('<div id="', componentID, '" class="dash-target jqplot-target">');
            thisContent.push('<div class="jqplot-title dash-sec-title">', title, "</div>");
            thisContent.push('<div class="dash-sec-message">', noDataMessage, "</div>");
            thisContent.push("</div>");

            MP_Util.Doc.FinalizeComponent(thisContent.join(""), component, 0);
        },

        /**
         * Creates the details table for the cooresponding chart and sets it up in a popup dialog.
         * @param {Object} targetIdent The identifier of the parent chart.
         * @param {Object} results The data to display in the table.
         * @param {Object} config The configuration for the parent chart (for extraction of the column configuration.)
         */
        loadDetailTable : function(targetIdent, results, config) {
            if (!results.length) {
                return;
            }

            var detailsButton = $("#" + targetIdent + "DetailsBtn");
            if (!detailsButton.length) {
                detailsButton = $("<div id='" + targetIdent + "DetailsBtn' title='Open detail table'></div>").addClass("chart-details-button");
                detailsButton.appendTo("#dash" + targetIdent);
            }
            var detailsDialog = $("#" + targetIdent + "DetailsDialog");
            if (!detailsDialog.length) {
                detailsDialog = $("<div id='" + targetIdent + "DetailsDialog' title='Details'></div>").addClass("chart-details-dialog").appendTo("#" + targetIdent);
            } else {
                detailsDialog.empty();
            }

            var detailsTable = $("<table id='" + targetIdent + "DetailsTable'></table>").appendTo(detailsDialog);
            $("<div id='" + targetIdent + "Pager'></div>").appendTo(detailsDialog);

            var colNames = config.detailTableColumnNames || [];
            var colModel = config.detailTableColumnModel || [];
            var tmpData = [];
            var idx1, idx2;
            var resultsLen = results.length;
            // TODO: it might be much easier to just create an array and objects and then converted it to string when you are done.
            tmpData.push("[");
            for ( idx1 = 1; idx1 < resultsLen; idx1++) {
                var dataRow = results[idx1];
                tmpData.push((idx1 != 1) ? "," : "");
                tmpData.push("{");
                for ( idx2 = 0; idx2 < dataRow.VALUES.length; idx2++) {
                    tmpData.push((idx2) ? "," : "");
                    tmpData.push('"', results[0].VALUES[idx2].VALUE, '":"', dataRow.VALUES[idx2].VALUE, '"');
                }
                tmpData.push("}");
            }
            tmpData.push("]");

            var gridData;
            gridData = JSON.parse(tmpData.join(""));
            detailsTable.jqGrid({
                datatype : "local",
                data : gridData,
                height : "100%",
                width : "95%",
                colNames : colNames,
                colModel : colModel,
                rowNum : 15,
                pager : '#' + targetIdent + 'Pager',
                gridView : true
            });
            detailsTable.navGrid('#' + targetIdent + 'Pager', {
                edit : false,
                add : false,
                del : false,
                search : true
            });
            detailsTable.jqGrid('navButtonAdd', '#' + targetIdent + 'Pager', {
                title : "Copy to clipboard",
                caption : "",
                buttonicon : "ui-icon-clipboard",
                onClickButton : function() {
                    DASH_CORE.CreateCTCForDetailTable(gridData);
                }
            });

            detailsDialog.dialog({
                autoOpen : false,
                width : "auto",
                show : "slide",
                hide : "puff",
                height : "500"
            });

            detailsButton.click(function() {
                $(detailsDialog).dialog("open");
            });
        },

        /**
         * Sets up the Copy To Clipboard function for a jqGrid dataset.
         * @param {Object} gridData The 'data' object from a jqGrid control.
         */
        CreateCTCForDetailTable : function(gridData) {
            var i = 0, ii = 0, j = 0;
            var dataStr = "";
            var colNames = [];
            for (i in gridData[0]) {
                colNames[ii++] = i;
                dataStr += i + "\t";
            }// capture col names
            dataStr += "\n";
            var datalen = gridData.length;
            var nameLen = colNames.length;

            for ( i = 0; i < datalen; i++) {
                for ( j = 0; j < nameLen; j++) {
                    dataStr += gridData[i][colNames[j]] + "\t";
                    // output each column as tab delimited
                }
                dataStr += "\n";
                // output each row with end of line
            }
            dataStr += "\n";
            // end of line at the end

            window.prompt("To copy to clipboard, press [Ctrl]+C, then paste into Excel.", dataStr);
        },

        /**
         *  Adds the 'convert to image' button to a jqPlot component.
         * @param {Object} componentID
         */
        CreateConvertImageButton : function(componentID) {
            var cnvtToImgBtn = $("#" + componentID + "CnvtToImgBtn");
            if (!cnvtToImgBtn.length) {
                cnvtToImgBtn = $("<div id='" + componentID + "CnvtToImgBtn' title='View as Image...'></div>").addClass("chart-image-button");
                cnvtToImgBtn.appendTo("#dash" + componentID);
            }
            var imgDialog = $("#" + componentID + "ImgDialog");
            if (!imgDialog.length) {
                imgDialog = $("<div id='" + componentID + "ImgDialog' title='Image'></div>").appendTo("#" + componentID);
            } else {
                imgDialog.empty();
            }
            imgDialog.dialog({
                autoOpen : false,
                width : 500,
                height : "auto",
                show : "blind",
                hide : "fade"
            });
            cnvtToImgBtn.click(function() {
                var dialogImg = imgDialog.find("#" + componentID + "img");
                if (!dialogImg.length) {
                    var imgData = $("#" + componentID).jqplotToImageStr({});
                    var imgElem = $("<img/>").attr("id", componentID + "img").attr("src", imgData).attr("title", "Right-click for options").addClass("chart-image");
                    imgElem.appendTo(imgDialog);
                }
                imgDialog.dialog("open");
            });
        },

        /**
         *  Makes the data call for the details table, if any, and sets up the details table.
         * @param {Object} component
         */
        GetChartDetails : function(component) {
            var componentID = component.getComponentId();
            var dataCall = component.m_detailDataCall;
            if (dataCall) {
                var cmptConfig = component.m_Config;
                var cmptFilters = cmptConfig.componentFilters;
                var combinedFilters = DASH_CORE.CombineCmptAndPageFilters(cmptFilters, component);
                var sendAr = DASH_CORE.GetParamsFromFilters(combinedFilters);
                if (CERN_BrowserDevInd) {
                    var request = new MP_Core.ScriptRequest(null, null);
                    request.setProgramName(dataCall);
                    request.setParameters(sendAr);
                    request.setAsync(true);
                    MP_Core.XMLCCLRequestCallBack(null, request, function(response) {
                        if (response.getResponse().STATUS_DATA.STATUS == "S") {
                            var results = response.getResponse().RESULTS;
                            DASH_CORE.loadDetailTable(componentID, results, cmptConfig);
                        }
                    });
                } else {
                    var info = new XMLCclRequest();
                    info.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            MP_Util.LogScriptCallInfo(null, this, "dash_core.js", dataCall);
                            var jsonEval = JSON.parse(this.responseText);
                            if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
                                var results = jsonEval.RECORD_DATA.RESULTS || [];
                                DASH_CORE.loadDetailTable(componentID, results, cmptConfig);
                            }
                        }
                        if (this.readyState == 4) {
                            MP_Util.ReleaseRequestReference(this);
                        }
                    };
                    info.open("GET", dataCall, true);
                    info.send(sendAr.join(","));
                }
            }
        },

        /**
         * Checks datapoints against configured threshold values and applies styles to those points that meet or exceed the threshold.
         * @param {Object} component
         */
        CheckThresholds : function(component) {
            var componentID = component.getComponentId();
            var thresholds = component.m_Config.thresholds;

            $(thresholds).each(function() {
                var threshold = this;
                $(component.m_ChartData).each(function() {
                    $(this).each(function() {
                        if (this[threshold.measure] >= threshold.limit) {
                            $("#" + componentID).addClass("dash-sec-alert");
                        }
                    });
                });
            });
            $(thresholds).each(function() {
                var threshold = this;
                $("#" + componentID + " .jqplot-series-0").each(function() {
                    if (parseInt($(this).text(), 10) >= threshold.limit) {
                        var label = this;
                        $(threshold.actions).each(function() {
                            var action = this;
                            $(label).css(action.effect, action.value);
                        });
                    }
                });
            });
        },

        /**
         * Binds methods to the Component and Window 'resize' event to trigger a resize of the contents of the Dashboard.
         * @param {Object} component
         */
        BindResizeEvent : function(component) {
            var componentID = component.getComponentId();
            // Resize the plot when the content div resizes.
            $("#dashContent" + componentID).bind("resize", function(event, ui) {
                component.m_plot.replot({
                    resetAxes : true
                });
            });

            // Resize the plot when the window resizes.
            $(window).resize(function(e) {
                // This if is a workaround for a known bug in jquery ui dialog resize event.
                if (e.target == window) {
                    component.m_plot.replot({
                        resetAxes : true
                    });
                }
            });
        }
    };
}();

var criterion = null;
var sortType = 0;
var sortOrder = 0;
var patObjs = null;
var activeList = [];
var nmWidthCls = 30 / 2;
var losWidthCls = 30 / 4;
var dcWidthCls = 30 / 4;
var sHov = "";
var estDcdt = "";
var appName = "$APP_AppName$";
var tabName;
var cnt = 2;
var totalHeight = (document.documentElement.clientHeight) - 165 + 'px' ;
var continueInd = 1;
var callCnt = 0;
var begVal = 0;
var patObj = null;
var CERN_DISCHARGE_DASHBOARD = function () {
	return {
		RenderDischargeDashboard: function () {
            MP_Util.LogInfo("In RenderDischargeDashboard()");
            var js_criterion = JSON.parse(MPAGE_REPLY_DATA);
            var replyData = js_criterion.REPLY_DATA;
            criterion = { provider_id: replyData.PROVIDER_ID, static_content: replyData.FULL_FOLDER_PATH, position_cd: replyData.POSITION_CD, category_meaning: replyData.CATEGORY_MEAN, executable: replyData.APPLICATION_NAME, dashboard_title: replyData.DASHBOARD_TITLE, dashboard_page_title: replyData.DASHBOARD_PAGE_TITLE, patient_list_label: replyData.PATIENT_LIST_LABEL, loading_text: replyData.LOADING_TEXT, debug_ind: replyData.DEBUG_IND, tab_name: replyData.PC_TAB_NAME };

			//The below regexp searches the tab name for the ASCii values and replaces them with the actual special character.
			tabName = criterion.tab_name.replace(/&#(\d+);/g, function (m, n) { return String.fromCharCode(n); });
            CERN_BrowserDevInd = (parseInt(criterion.debug_ind, 10)&1===1)?true:false;
            var info = (CERN_BrowserDevInd)?new XMLHttpRequest():new XMLCclRequest();
            info.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                	MP_Util.LogScriptCallInfo(null, info, "discharge-dashboard.js", "RenderDischargeDashboard");
                    var body = document.body;
					var patListAr = [];
					var jsonEval = JSON.parse(this.responseText);
					var jsonObj = jsonEval.RECORD_DATA;
					var jsStatus = jsonObj.STATUS_DATA.STATUS;
                    
					patListAr.push("<div class='pg-hd'><h1><span class='pg-title'>",criterion.dashboard_page_title,"</span></h1>",
				  	"</div><div id='drdBanner'></div><div id='drdFilters'><span class='drd-filter-lbl'>",criterion.patient_list_label,
					"</span><select id='drdPatLists'><option>",criterion.loading_text,",",
				  	"</option></select></div><div class='col-group'><div class='col-outer2'><div class='col-outer1'>",
				  	"<div class='col1'><div id='drdPat'></div>");
					
					var  patListHTML = patListAr.join("");
					body.innerHTML += patListHTML;
					var patLists = _g("drdPatLists");
					
					if (jsStatus == "Z") {
						var txt = i18n.NO_LISTS_DEFINED;
						patLists.options[0] = new Option(txt, 0);
					}
					else if (jsStatus == "S") {
						var ptlObj = jsonObj.QUAL;
						var ptlLists = [];
						var ptlLen = ptlObj.length;
						for (var i=0; i<ptlLen; i++){
							var ptlItem = ptlObj[i];
							var ptlList = {
								NAME : ptlItem.NAME,
								ID : ptlItem.PATIENT_LIST_ID
							};
							ptlLists.push(ptlList);
							
							var ptlItem = ptlLists[i];
							patLists.options[i] = new Option(ptlItem.NAME, ptlItem.ID);
						}
						loadPatientList();
						Util.addEvent(patLists, "change", loadPatientList);
					}
					else {
						patLists.options[0] = new Option(i18n.ERROR_RETREIVING_DATA, 0);
					}
                    
                }
                if (this.readyState == 4) {
                    MP_Util.ReleaseRequestReference(this);
                }
            };
            var params="'mine',"+criterion.provider_id+".0";
			if (CERN_BrowserDevInd) {
				var url="mp_drd_patient_list?parameters=" + params;
				info.open("GET", url, true);
				info.send(null);
			} else {
				info.open("GET", "mp_drd_patient_list", true);
				info.send(params);
			}
        },
		sortPatients: function(colNum, typ) {
			if (typ != 0) {
				var spnPar = _g('drdHdrRow');
				var tdAr = Util.Style.g("drd-pat-col-hdr", spnPar, "TD");
				for (var t = 0; t < tdAr.length; t++) {
					var td = tdAr[t];
					if (t == colNum) {
						if (!Util.Style.ccss(td, "uline")) 
							Util.Style.acss(td, "uline");
					}
					else {
						if (Util.Style.ccss(td, "uline")) 
							Util.Style.rcss(td, "uline");
					}
				}
			}
			var sortOrd = 0;
			if (typ == sortType) {
				sortOrd = (sortOrder + 1) % 2;
				sortOrder = sortOrd;
			}
			else if (typ == 0) {
				sortOrd = 1;
				sortOrder = 1;
			}
			sortOrder = sortOrd;
			sortType = typ;
			switch (typ) {
				case 1:  // Name
					function sortByName(a, b) {
						var sortRes = 0;
						if (a.NAME.toUpperCase() < b.NAME.toUpperCase()) {
							sortRes = 1;
						}
						else {
							sortRes = -1;
						}
						if (sortOrd == 1) {
							sortRes = sortRes * -1;
						}
						return sortRes;
					}
					activeList.sort(sortByName);
					break;
				case 2:  // Length of stay sort
					function sortByLos(a, b) {
						var sortRes = 0;
						if (a.LOS_SEQ < b.LOS_SEQ) {
							sortRes = 1;
						}
						else {
							sortRes = -1;
						}
						if (sortOrd == 1) {
							sortRes = sortRes * -1;
						}

						return sortRes;
					}
					activeList.sort(sortByLos);
					break;
				case 3:  
					function sortByDiscDt(a, b){
							var sortRes = 0;
							if (a.DISCHARGE_DATE < b.DISCHARGE_DATE) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByDiscDt);
					break;
				case 4://"orders":  
					function sortByOrderStatus(a, b){
							var sortRes = 0;
							if (a.ORD_STATUS_FLAG < b.ORD_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByOrderStatus);
					break;
				case 5://"diagnosis":  
					function sortByDxStatus(a, b){
							var sortRes = 0;
							if (a.DX_STATUS_FLAG < b.DX_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByDxStatus);
					break;
				case 6://"pat-ed":  
					function sortByPatEdStatus(a, b){
							var sortRes = 0;
							if (a.PED_STATUS_FLAG < b.PED_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByPatEdStatus);
					break;
				case 7://"follow-up":  
					function sortByFuStatus(a, b){
							var sortRes = 0;
							if (a.FU_STATUS_FLAG < b.FU_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByFuStatus);
					break;
				case 8://"med-rec":  
					function sortByMedStatus(a, b){
							var sortRes = 0;
							if (a.MED_STATUS_FLAG <= b.MED_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByMedStatus);
					break;
				case 9://"documents":  
					function sortByDocStatus(a, b){
							var sortRes = 0;
							if (a.DOC_STATUS_FLAG < b.DOC_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByDocStatus);
					break;
				case 10://"activities":  
					function sortByActivitiesStatus(a, b){
							var sortRes = 0;
							if (a.ACT_STATUS_FLAG < b.ACT_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByActivitiesStatus);
					break;		
				case 11://"social":  
					function sortBySocialStatus(a, b){
							var sortRes = 0;
							if (a.SOC_STATUS_FLAG < b.SOC_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortBySocialStatus);
					break;	
				case 12://"care-mgmt":  
					function sortByCareMgmtStatus(a, b){
							var sortRes = 0;
							if (a.CM_STATUS_FLAG < b.CM_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByCareMgmtStatus);
					break;		
				case 13://"results":  
					function sortByResults(a, b){
							var sortRes = 0;
							if (a.RES_STATUS_FLAG < b.RES_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByResults);
					break;	
				case 14://"quality-meas":  
					function sortByQM(a, b){
							var sortRes = 0;
						//	alert(a.QM_STATUS_FLAG +"--"+ b.QM_STATUS_FLAG)
							if (a.QM_STATUS_FLAG <= b.QM_STATUS_FLAG) {
								sortRes = 1;
							}
							else {
								sortRes = -1;
							}
							if (sortOrd == 1) {
								sortRes = sortRes * -1;
							}
							return sortRes;
					}
						activeList.sort(sortByQM);
					break;
			}
			var jsActivePats = [];
			var activePats = "";
			var patContent = _g("patContent");
			var activeLen = activeList.length;
			
			jsActivePats.push("<div id='drdPatTable1' class='drd-pat-table1-content'>");
					
			//Load all the rest
			for (var a= 0; a < activeLen; a++) {
				jsActivePats.push("<div id='drdDataTable",activeList[a].ENCNTR_ID,"' class='test'>");
				jsActivePats.push(activeList[a].HTML);
				jsActivePats.push ("</div>");
			}
			
			jsActivePats.push ("</div></div>");
			activePats = jsActivePats.join("");
			if (patContent == null) {
				var patSec = _g("drdPat");
				patSec.innerHTML = i18n.NO_PATIENTS
			}
			else {
				patContent.innerHTML = activePats;
				var activePatEl = _g('drdPatTable1');
				activePatEl.style.height = totalHeight;
				CERN_DISCHARGE_DASHBOARD.secInit("drd-pat");
				CERN_DISCHARGE_DASHBOARD.highlightEvenRows();
			}
		},	
		highlightEvenRows: function(){
			var tRAr = Util.Style.g("test", document, "DIV");
			var indexCnt = 0;
			for (var t = 0; t < tRAr.length; t++) {
				var tr = tRAr[t];
				if (!Util.Style.ccss(tr, "hide")) {
					if (indexCnt % 2) {
						Util.Style.rcss(tr, "test");
						Util.Style.acss(tr, "even");
					}
					else {
						Util.Style.rcss(tr, "test");
						Util.Style.acss(tr, "odd");
					}
					indexCnt = indexCnt + 1;
				}
			}
		},
		secInit: function(pre) {
			gen = Util.Style.g(pre + "-info")
			for (var i = 0, l = gen.length; i < l; i++) {
				var m = gen[i];
				if (m) {
					var nm = Util.gns(Util.gns(m));
					if (nm) {
						if (Util.Style.ccss(nm, "hvr")) {
							hs(m, nm);
						}
					}
				}
			}
		}
    };
	
	function load(url, callback, params, hdrInd) {
		var xhr = (CERN_BrowserDevInd)?new XMLHttpRequest():new XMLCclRequest();
		callCnt = callCnt + 1;
		if (callCnt === 5) {
			continueInd = 0;
		}

		xhr.onreadystatechange = checkReady;
		
		if (CERN_BrowserDevInd) {
			var browserUrl = url + "?parameters=" + params;
			xhr.open("GET", browserUrl, true);
			xhr.send(null);
		} else {
			xhr.open('GET', url, true);
			xhr.send(params);
		}
		function checkReady() { //check to see if request is ready
			if (xhr.readyState === 4) { // 4 = "loaded"
				if (xhr.status === 200) { // 200 = OK
					callback(xhr.responseText, hdrInd);
					if (url == "mp_get_disch_ind_json") {
						callCnt = callCnt - 1;						
						if (callCnt < 5) {
							continueInd = 1;
						}
					}
				}
				else {
					alert(i18n.ERROR_RETREIVING_DATA);
				}
			}
		}
	}

	function loadPatientList (){
		var patSec = _g("drdPat");
		patSec.innerHTML = "<span class='drd-pat-txt'>"+i18n.LOADING_DATA+"...</span>";
		var patLists = _g("drdPatLists");
		
		patLists.onchange = function(){
			window.name = patLists.options[patLists.options.selectedIndex].value;	
		}

		var listID = 0;
		if (window.name.length > 0)
		{
			listID = window.name;
			for (var i=0; i<patLists.options.length; i++) {
				if (patLists.options[i].value == window.name)
				{
					patLists.options[i].selected = true;
				}
			}
		}
		else
		{
			listID = patLists.options[patLists.options.selectedIndex].value;
			window.name = listID;
		}

		var params = "^MINE^," +criterion.provider_id+ ".0," +listID+".0,^"+criterion.category_meaning+"^";
		load("mp_get_disch_avail_patients", loadPatients, params, 0);
	}
	
	function loadPatients(availPatList, hdrInd){
		var patData = availPatList;
		var jsonEval = JSON.parse(patData);
		patObjs = jsonEval;
		var jsonObj = jsonEval.RECORD_DATA;
		var jsStatus = jsonObj.STATUS_DATA.STATUS;
		var patHdrHTML = "";
		var patDataRows = [];
		var patLen = 0, statLen = 0;
		var patSec = _g("drdPat");
		var params = "/PERSONID=" + -1 + " /ENCNTRID=" + -1 + " /FIRSTTAB=^" + tabName + "^";
		patObj = jsonObj.PATIENTS;
		activeList = [];
		patLen = patObj.length;
		
		if (patLen == 0) {
			patHdrHTML = "<span class='pat-txt'>"+i18n.NO_PATIENTS+"</span>";
			patSec.innerHTML = patHdrHTML;
		}
		else {
			var widthClass = 69.5;
			var patHdrAr = ["<div id='drdPatSec' class='drd-pat-sec'><div id='drdTableHdr' class='drd-table-hdr'><table class='drd-pat-table'><tr id='drdHdrRow'  class='drd-pat-table-hdr'><td class='drd-pat-col-hdr' style='width: " + nmWidthCls + "%'><span id='patName' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(0,1); return false;'>",i18n.PATIENT_NAME,"</span></td><td class='drd-pat-col-hdr' style='width: " + losWidthCls + "%'><span id='los' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(1, 2); return false;'>",i18n.LENGTH_OF_STAY,"<br/>(DD:HH:MM)</span></td><td id='eddHdr' class='drd-pat-col-hdr' style='width: " + dcWidthCls + "%;border-right:#E6E8F1 3px solid;'><span id='edd' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(2,3); return false;'>",i18n.ESTIMATED_DISCHARGE_DATE,"</span></td><td class='drd-pat-col-hdr' style= 'width: " + widthClass + "%'><span>",i18n.LOADING_DATA,"...</span></td></tr></table></div><div id='patContent'></div>"];
			patHdrHTML = patHdrAr.join("");
			patSec.innerHTML = patHdrHTML;

			patDataRows.push("<div id='drdPatTable1' style='position:relative; height:"+totalHeight+";  overflow-y:scroll; overflow-x:hidden; border:2px solid #F6F6F6'>");
			
			for (var i = 0; i < patLen; i++) {
				var patItem = patObj[i];
				var patId = patItem.PERSON_ID;
				var encId = patItem.ENCNTR_ID;
				var patDataSingleRow = [];
				var patDataSingleHTML = "";
				sHov="<div class='hvr hover'><dl><dt><span>",i18n.NAME,":</span></dt><dd><span>"+patItem.PERSON_NAME
				+"</span></dd><dt><span>",i18n.MRN,":</span></dt><dd><span>"+patItem.MRN+"</span></dd><dt><span>",i18n.DOB,":</span></dt><dd><span>"+fmtDt(patItem.DOB, "shortDate2")
				+"</span></dd><dt><span>",i18n.LOCATION,":</span></dt><dd><span>"+patItem.NU_ROOM_BED+"</span></dd></dl></div>";
				
				if (patItem.EST_DC != "") {
					estDcdt = fmtDt(patItem.EST_DC, "shortDate2");
				}
				else {
					estDcdt = "--";
				}
				
				//populate the patient demographic headerresult row for each patient in dashboard.
				params = "/PERSONID=" + patId + " /ENCNTRID=" + encId + " /FIRSTTAB=^" + tabName + "^";
				if(tabName) {
					patDataSingleRow.push("<div id='drdDataTable",encId,"' class ='test'><table class='drd-pat-table1'><tr id='drdDataCols",encId,"'><td class='drd-pat-name' style='width: ",nmWidthCls,"%'><dl class='drd-pat-info'><dt><span>",i18n.NAME,"</span></dt><dd><span><a class= 'drd-pat-link' href='javascript:APPLINK(0,\"",appName,"\",\"",params,"\");'>", patItem.PERSON_NAME, "</a></span><br/><span class='drd-within'>", patItem.GENDER_AGE, "</span><br/><span class='drd-within'>", patItem.ROOM_BED, "</span></dd></dl><h4 class='drd-pat-det-hd'><span>",i18n.PATIENT_INFO,"</span></h4>",sHov,"</td><td class='drd-pat-col-hdr' style='width: ",losWidthCls,"%'><span>", patItem.LOS, "</span></td><td class='drd-pat-col-hdr' style='width: ",dcWidthCls,"%; border-right:3px solid #E6E8F1;'><span>", estDcdt, "</span></td><td class='drd-pat-col-hdr' style='width: " + widthClass + "%'><span>",i18n.LOADING_DATA,"...</span></td></tr></table></div>");
				}
				else {
					patDataSingleRow.push("<div id='drdDataTable",encId,"' class ='test'><table class='drd-pat-table1'><tr id='drdDataCols",encId,"'><td class='drd-pat-name' style='width: ",nmWidthCls,"%'><dl class='drd-pat-info'><dt><span>",i18n.NAME,"</span></dt><dd><span>", patItem.PERSON_NAME, "</span><br/><span class='drd-within'>", patItem.GENDER_AGE, "</span><br/><span class='drd-within'>", patItem.ROOM_BED, "</span></dd></dl><h4 class='drd-pat-det-hd'><span>",i18n.PATIENT_INFO,"</span></h4>",sHov,"</td><td class='drd-pat-col-hdr' style='width: ",losWidthCls,"%'><span>", patItem.LOS, "</span></td><td class='drd-pat-col-hdr' style='width: ",dcWidthCls,"%; border-right:3px solid #E6E8F1;'><span>", estDcdt, "</span></td><td class='drd-pat-col-hdr' style='width: " + widthClass + "%'><span>",i18n.LOADING_DATA,"...</span></td></tr></table></div>");
				}
				patDataSingleHTML = patDataSingleRow.join("");
				patDataRows.push(patDataSingleHTML);
				var thisPatArr = [];
				var thisPatHTML = "";   			
				thisPatArr.push(patDataSingleHTML);
				thisPatHTML = thisPatArr.join("");
				
				var thisPat = {
					NAME: patItem.PERSON_NAME,
					PERSON_ID: patId,
					ENCNTR_ID: encId,
					DOB: patItem.DOB,
					MRN: patItem.MRN,
					NU_ROOM_BED: patItem.NU_ROOM_BED,
					GENDER_AGE: patItem.GENDER_AGE,
					ROOM_BED: patItem.ROOM_BED,
					LOS: patItem.LOS,
					LOS_SEQ: patItem.LOS_SEQ,
					DISCHARGE_DATE: estDcdt,
					DX_STATUS_FLAG: 0,
					RES_STATUS_FLAG: 0,
					SOC_STATUS_FLAG: 0,
					DOC_STATUS_FLAG: 0,
					CM_STATUS_FLAG: 0,
					ACT_STATUS_FLAG: 0,
					MED_STATUS_FLAG: 0,
					PED_STATUS_FLAG: 0,
					FU_STATUS_FLAG: 0,
					ORD_STATUS_FLAG: 0,
					QM_STATUS_FLAG: 0,
					HTML: thisPatHTML
				};
				
				activeList.push(thisPat);
			}

			patDataRows.push ("</div></div>");
			patDataHTML = patDataRows.join("");
			var patContent = _g("patContent");
			if (patContent) {
				patContent.innerHTML = patDataHTML;
			}
			CERN_DISCHARGE_DASHBOARD.secInit("drd-pat");
			CERN_DISCHARGE_DASHBOARD.highlightEvenRows();
		}
		
		//Make the calls to get data for each patient
		if	(patLen > 0) {
			if (patLen <= 5) {
				for (var i = 0; i < patLen; i++) {
					var patItem = patObj[i];
					var params = "^MINE^," +patItem.PERSON_ID+ "," +patItem.ENCNTR_ID+",^"+criterion.category_meaning+"^," +criterion.provider_id+ "," +criterion.position_cd;
					load("mp_get_disch_ind_json", loadPatientStatusData, params, i);
				}
			} else {
				begVal = 0;
				callCnt = 0;
				asynchThrottleControl();
			}
		}
	}
	
	function asynchThrottleControl() {
		var patCount = patObj.length;
		if (begVal < patCount) {
			if (continueInd > 0) {
				var patItem = patObj[begVal];
				var params = "^MINE^," +patItem.PERSON_ID+ "," +patItem.ENCNTR_ID+",^"+criterion.category_meaning+"^," +criterion.provider_id+ "," +criterion.position_cd;
				load("mp_get_disch_ind_json", loadPatientStatusData, params, begVal);
				begVal = begVal + 1;
			}
			var funcName = function(){
				asynchThrottleControl();
			};
			setTimeout(funcName, 50);
		}
	}
	
	function loadPatientStatusData(xhr, hdrInd) {
		var compData = xhr;
		var jsonEval = JSON.parse(compData);
		var jsonObj = jsonEval.RECORD_DATA;
		var jsStatus = jsonObj.STATUS_DATA.STATUS;
		var jsComp = jsonObj.COMPONENTS;
		var dxSeq, resSeq, fuSeq,medSeq, docSeq, socSeq,actSeq, cmSeq,pedSeq, ordSeq, qmSeq;
		var spanId = "";
		var type = 0;
		var compDataRows = [];
		var compDataHTML = "";
		var statLen = jsComp.length-1;
		var dobDt = "";
		if (statLen >0){
			var widthClass = 69.5 / (statLen);
		} else {
			var widthClass = 69.5;
		}
		if (hdrInd === 0) {
			loadColumnHeaders(jsComp);
		}

		var params = "/PERSONID=" + jsonObj.PERSON_ID + " /ENCNTRID=" + jsonObj.ENCNTR_ID + " /FIRSTTAB=^" + tabName + "^";
		var activeLen = activeList.length;
		for (var s = 0; s < activeLen; s++) {
			if (activeList[s].PERSON_ID === jsonObj.PERSON_ID && activeList[s].ENCNTR_ID === jsonObj.ENCNTR_ID) {
				if (activeList[s].DOB) {
					dobDt = fmtDt(activeList[s].DOB, "shortDate2");
				} else {
					dobDt = "^^";
				}
				var sHov="<div class='hvr hover'><dl><dt><span>"+i18n.NAME+":</span></dt><dd><span>"+activeList[s].NAME
				+"</span></dd><dt><span>"+i18n.MRN+":</span></dt><dd><span>"+activeList[s].MRN+"</span></dd><dt><span>"+i18n.DOB+":</span></dt><dd><span>"+dobDt+"</span></dd><dt><span>"+i18n.LOCATION+":</span></dt><dd><span>"+activeList[s].NU_ROOM_BED+"</span></dd></dl></div>";
				var k=jsComp.length;
				for (var j= 0; j < k; j++) 
					{
					var estDtTmItem = jsComp[j];
					
					if (estDtTmItem.CONTENT_TYPE === "disch-readiness") 
						{
						    if (estDtTmItem.ESTIMATED_DISCH_DATE) 
								{
									activeList[s].DISCHARGE_DATE = fmtDt(estDtTmItem.ESTIMATED_DISCH_DT_TM, "shortDate2");
								}
							else 
								{
									activeList[s].DISCHARGE_DATE = "--";
								}
						}			
					}
				if (statLen >0) {
					compDataRows.push("<table class='drd-pat-table1' class ='test'><tr id='drdDataCols",jsonObj.ENCNTR_ID,"'><td class='drd-pat-name' style='width: ",nmWidthCls,"%'><dl class='drd-pat-info'><dt><span>Name</span></dt><dd><span><a class= 'drd-pat-link' href='javascript:APPLINK(0,\"",appName,"\",\"",params,"\");'>", activeList[s].NAME, "</a></span><br/><span class='drd-within'>", activeList[s].GENDER_AGE, "</span><br/><span class='drd-within'>", activeList[s].ROOM_BED, "</span></dd></dl><h4 class='drd-pat-det-hd'><span>Patient Info</span></h4>",sHov,"</td><td class='drd-pat-col-hdr' style='width: ",losWidthCls,"%'><span>", activeList[s].LOS, "</span></td><td class='drd-pat-col-hdr' style='width: ",dcWidthCls,"%; border-right:#E6E8F1 3px solid;'><span>", activeList[s].DISCHARGE_DATE, "</span></td>");
					
					for (var j= 0; j < jsComp.length; j++) {
						var statHdrItem = jsComp[j];
						switch (statHdrItem.CONTENT_TYPE) {
							case "diagnosis":
								dxSeq =	statHdrItem.STATUS_FLAG;
								break;
							case "follow-up":
								fuSeq =	statHdrItem.STATUS_FLAG;
								break;
							case "pat-edu":
								pedSeq =	statHdrItem.STATUS_FLAG;
								break;
							case "med-rec":
								medSeq = statHdrItem.STATUS_FLAG;
								break;
							case "orders":
								ordSeq = statHdrItem.STATUS_FLAG;
								break;
							case "documents":
								docSeq = statHdrItem.STATUS_FLAG;
								break;
							case "activities":
								actSeq = statHdrItem.STATUS_FLAG;
								break;
							case "care-mgmt":
								cmSeq =	statHdrItem.STATUS_FLAG;
								break;
							case "social":
								socSeq = statHdrItem.STATUS_FLAG;
								break;
							case "quality-meas":
								qmSeq =	statHdrItem.STATUS_FLAG;
								break;		
						}
												
						//populate the 	data rows for each section in dashboard.
						if ("orders|diagnosis|pat-edu|follow-up|med-rec|documents|activities|social|care-mgmt|quality-meas".indexOf(statHdrItem.CONTENT_TYPE) >= 0) {
						   compDataRows.push("<td class='drd-pat-col-hdr' style='width: ",widthClass,"%'><span>", getDischargeStatus(statHdrItem.CONTENT_TYPE, statHdrItem.STATUS_FLAG), "</span></td>");
						}
					}
					
					for (var i= 0; i < jsComp.length; i++) {
						var statHdrItem = jsComp[i];
						if (statHdrItem.CONTENT_TYPE === "results") {
							//If there is no result set flg to -1 so that the '--' is displayed
							if(statHdrItem.STATUS_FLAG === 0 || statHdrItem.STATUS_FLAG === 3) {
								resSeq = -1;
							}
							else {
								resSeq = statHdrItem.RESULT_FLAG;
							}
							
							//Force the results section data into the last column
						   compDataRows.push("<td class='drd-pat-col-hdr' style='width: ",widthClass,"%'><span>", getDischargeStatus(statHdrItem.CONTENT_TYPE, resSeq), "</span></td>");
						}
					}
				} else {
					compDataRows.push("<table class='drd-pat-table1' class ='test'><tr id='drdDataCols",jsonObj.ENCNTR_ID,"'><td class='drd-pat-name' style='width: ",nmWidthCls,"%'><dl class='drd-pat-info'><dt><span>Name</span></dt><dd><span><a class= 'drd-pat-link' href='javascript:APPLINK(0,\"",appName,"\",\"",params,"\");'>", activeList[s].NAME, "</a></span><br/><span class='drd-within'>", activeList[s].GENDER_AGE, "</span><br/><span class='drd-within'>", activeList[s].ROOM_BED, "</span></dd></dl><h4 class='drd-pat-det-hd'><span>Patient Info</span></h4>",sHov,"</td><td class='drd-pat-col-hdr' style='width: ",losWidthCls,"%'><span>", activeList[s].LOS, "</span></td><td class='drd-pat-col-hdr' style='width: ",dcWidthCls,"%; border-right:#E6E8F1 3px solid;'><span>", activeList[s].DISCHARGE_DATE, "</span></td><td class='drd-pat-col-hdr' style='width: ",widthClass,"%'><span>",i18n.NO_RESULTS_FOUND,"</span></td>");
				}
				compDataRows.push("</tr></table>");
				compDataHTML = compDataRows.join("");
				var dataRowId = 'drdDataTable' + jsonObj.ENCNTR_ID;
				var dataRowDiv = _g(dataRowId);
				if (dataRowDiv) {
					dataRowDiv.innerHTML = compDataHTML;
				}
			}
		}
		
		for (var t = 0; t < activeLen; t++) {
			if (activeList[t].PERSON_ID === jsonObj.PERSON_ID && activeList[t].ENCNTR_ID === jsonObj.ENCNTR_ID) {
				activeList[t].DX_STATUS_FLAG = dxSeq;
				activeList[t].RES_STATUS_FLAG = resSeq;
				activeList[t].SOC_STATUS_FLAG = socSeq;
				activeList[t].DOC_STATUS_FLAG = docSeq;
				activeList[t].CM_STATUS_FLAG = cmSeq;
				activeList[t].ACT_STATUS_FLAG = actSeq;
				activeList[t].MED_STATUS_FLAG = medSeq;
				activeList[t].PED_STATUS_FLAG = pedSeq;
				activeList[t].FU_STATUS_FLAG = fuSeq;
				activeList[t].ORD_STATUS_FLAG = ordSeq;
				activeList[t].QM_STATUS_FLAG = qmSeq;
				activeList[t].HTML = compDataHTML;
			}
		}
		
		var patContent = _g("patContent");
		CERN_DISCHARGE_DASHBOARD.secInit("drd-pat", patContent);
		CERN_DISCHARGE_DASHBOARD.highlightEvenRows();
	}
	
	function loadColumnHeaders(compAr) {
		var compHdrAr = [];
		var compHdrHTML = "";
		var spanId = "";
		var type = 0;
		var parentHdrDiv = _g('drdTableHdr');
		
		if (compAr.length > 0) {
			var colLen = compAr.length-1;
			var widthClass = 69.5 / (colLen);
			compHdrAr.push("<table class='drd-pat-table'><tr id='drdHdrRow'  class='drd-pat-table-hdr'><td class='drd-pat-col-hdr' style='width: " + nmWidthCls + "%'><span id='patName' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(0,1); return false;'>",i18n.PATIENT_NAME,"</span></td><td class='drd-pat-col-hdr' style='width: " + losWidthCls + "%'><span id='los' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(1, 2); return false;'>",i18n.LENGTH_OF_STAY,"<br/>(DD:HH:MM)</span></td><td id='eddHdr' class='drd-pat-col-hdr' style='width: " + dcWidthCls + "%;border-right:#E6E8F1 3px solid;'><span id='edd' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(2,3); return false;'>",i18n.ESTIMATED_DISCHARGE_DATE,"</span></td>");

			for (var l = 0; l < compAr.length; l++) {
				statHdrItem = compAr[l];
				switch (statHdrItem.CONTENT_TYPE) {
					case "diagnosis":
						type = 5;
						break;
					case "follow-up":
						type = 7;
						break;
					case "pat-edu":
						type = 6;
						break;
					case "med-rec":
						type = 8;
						break;
					case "orders":
						type = 4;
						break;
					case "documents":
						type = 9;
						break;
					case "activities":
						type = 10;
						break;
					case "care-mgmt":
						type = 12;
						break;
					case "social":
						type = 11;
						break;
					case "quality-meas":
						type = 14;
						break;		
				}
				//Populate the header values for each data column
				if ("orders|diagnosis|pat-edu|follow-up|med-rec|documents|activities|social|care-mgmt|quality-meas".indexOf(statHdrItem.CONTENT_TYPE) >= 0) {   
					cnt = cnt+1;
					compHdrAr.push("<td class='drd-pat-col-hdr' style='width:",widthClass,"%'><span id='drd",type,"' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(",cnt,",",type,"); return false;'>",statHdrItem.NAME,"</span></td>");
				}
			}
			
			//Force the "results" column to the end
			for (var i= 0; i < compAr.length; i++) {
				statHdrItem = compAr[i];
				if (statHdrItem.CONTENT_TYPE == "results") {
					spanId = "13";
					type = 13;
					
					//Force results section header into the last column  
					cnt = cnt+1;
					compHdrAr.push("<td class='drd-pat-col-hdr' style='width:",widthClass,"%'><span id='drd",type,"' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(",cnt,",",type,"); return false;'>",statHdrItem.NAME,"</span></td>");
				}
			}
		} else {
			var widthClass = 69.5;
			compHdrAr.push("<table class='drd-pat-table'><tr id='drdHdrRow'  class='drd-pat-table-hdr'><td class='drd-pat-col-hdr' style='width: " + nmWidthCls + "%'><span id='patName' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(0,1); return false;'>",i18n.PATIENT_NAME,"</span></td><td class='drd-pat-col-hdr' style='width: " + losWidthCls + "%'><span id='los' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(1, 2); return false;'>",i18n.LENGTH_OF_STAY,"<br/>(DD:HH:MM)</span></td><td id='eddHdr' class='drd-pat-col-hdr' style='width: " + dcWidthCls + "%;border-right:#E6E8F1 3px solid;'><span id='edd' onclick='CERN_DISCHARGE_DASHBOARD.sortPatients(2,3); return false;'>",i18n.ESTIMATED_DISCHARGE_DATE,"</span></td><td class='drd-pat-col-hdr' style='width:",widthClass,"%'><span>",i18n.NO_RESULTS_FOUND,"</span></td></tr></table>");
		}
		compHdrAr.push("</tr></table>");
		compHdrHTML = compHdrAr.join("");
		if (parentHdrDiv) {
			parentHdrDiv.innerHTML = compHdrHTML;
		}
	}
	
	function getDischargeStatus (statName,flg ){
		var defimgLnk = "<span title='"+i18n.NOT_STARTED+"' class='drd-not-started'>&nbsp;</span>";
		var statusIcon = defimgLnk;
		if("results".indexOf(statName) >= 0)
		{
			statusIcon = getResultStatus(flg);
		}
		else{
			statusIcon = getStatus(flg);
		}
		
		return statusIcon;
		
	}

	function getStatus(flg){	
		var stat =flg;
		var  imgLnk = "";
		if (stat == 0 ||stat==3){
			imgLnk ="<span title='"+i18n.NOT_STARTED+"' class='drd-not-started'>&nbsp;</span>";
			return imgLnk;	
		}
		else if (stat==2 ||stat==4){
			imgLnk ="<span title='"+i18n.COMPLETED+"' class='drd-completed'>&nbsp;</span>";
			return imgLnk;	
		}
		else if (stat ==1 || stat==5){
			imgLnk ="<span title='"+i18n.IN_PROGRESS+"' class='drd-in-progress'>&nbsp;</span>";
			return imgLnk;	
		}
		else{
			imgLnk ="<span title='"+i18n.NOT_STARTED+"' class='drd-not-started'>&nbsp;</span>";
			}
		return imgLnk;	
		
	}

	function getResultStatus(stat) {
		var  imgLnk = "";
		if (stat == 0) { //result
			imgLnk = "<span title='"+i18n.COMPLETED+"' class='drd-results-completed'>&nbsp;</span>";
			return imgLnk;
		}
		else if (stat == 1) { //crit result
			imgLnk = "<span title='"+i18n.CRITICAL+"' class='drd-results-critical'>&nbsp;</span>";
			return imgLnk;
		}	
		else  { //no result
			imgLnk = "--";
			return imgLnk;
		}
	}

	function fmtDt(dt, mask) {
		if (dt) {
			var dateTime = new Date();
			dateTime.setISO8601(dt);	
			if (mask) {
				return dateTime.format(mask);
			}
			else {
				return dateTime.format("longDateTime3");
			}
		}
		else {
			return "^^";
		}
	}
} ();/* Hover Mouse Over */
/* Hover Mouse Over */
function hmo(evt, n, comp){
    evt = evt || window.event;
    var s = n.style, p = getPosition(evt), vp = gvs(), so = gso(), left = p.x + 20, top = p.y + 20;
    n._ps = n.previousSibling;
    n.hmo = true;
    
    //Helper function to check if the hover's previous sibling (the one that initiates the hover) has been removed from the DOM.
    function checkHoverSourceExists() {
    	try {
	    	//If we're not hovering over the element anymore, then stop checking
	    	if(!n.hmo) {
	    		return;
	    	}
	    	//If the hover's anchor no longer exists, remove the hover and return
	    	if(!$(comp.getSectionContentNode()).find($(n._ps)).length) {
	    		$(n).remove();
	    		return;
	    	}
	    	//If we've made it this far, the hover anchor still exists and we are still hovering, so continue polling.
	    	setTimeout(checkHoverSourceExists, 1000);
    	} catch(exe) {
    		return;
    	}
    }
    
    function hover(){
        if (n.hmo === true) { //make sure the cursor has not moused out prior to displaying
        	//Make call to begin checking that the hover's parent has not been removed from the DOM
        	checkHoverSourceExists();
			if (comp) {
				if (comp.isEditMode()) {
					 clearTimeout(n.timer);
					return;
				}
			}
			
			s.display = "block";	
		    if(left + n.offsetWidth > vp[1] + so[1]) {
				left = left - 40 - n.offsetWidth;
				if(left < 0) {
					left = 0;
				}
			}

			if(top + n.offsetHeight > vp[0] + so[0]) {
				if(top - 40 - n.offsetHeight < so[0]) {
					if(left > 0) {
						top = 10 + so[0];
					}
				} else {
					top = top - 40 - n.offsetHeight;
				}
			}
			document.body.appendChild(n);	
            s.left = left + "px";
            s.top = top + "px";
            n.show = true;
        }
    }
    n.timer = setTimeout(hover, 500);
}
/* Hover Mouse Move */
function hmm(evt, n, comp){
	
    if (!n.show) {
        return;
    }
    
    if (comp) {
		if (comp.isEditMode()) {
			clearTimeout(n.timer);
			return;
		}
	}
    var s = n.style, p = getPosition(evt), vp = gvs(), so = gso(), left = p.x + 20, top = p.y + 20;
    
    if (left + n.offsetWidth > vp[1] + so[1]) {
        left = left - 40 - n.offsetWidth;
        if (left < 0) {
            left = 0;
        }
    }
    
    if (top + n.offsetHeight > vp[0] + so[0]) {
        if (top - 40 - n.offsetHeight < so[0]) {
            if (left > 0) {
                top = 10 + so[0];
            }
        }
        else {
            top = top - 40 - n.offsetHeight;
        }
    }
    evt = evt || window.event;
    s.top = top + "px";
    s.left = left + "px";
}

/* Hover Mouse Out*/
function hmt(evt, n, comp){
	if (comp) {
		if (comp.isEditMode()) {
			clearTimeout(n.timer);
			return;
		}
	}
    n.hmo = false;
    if (!n._ps) 
        n._ps = n.previousSibling;
    clearTimeout(n.timer);
    evt = evt || window.event;
    n.style.display = "";
    Util.ia(n, n._ps);
    n.show = false;
}

/* Hover Setup */
function hs(e, n, comp){
    var priorBgColor = e.style.backgroundColor;
    var priorBorderColor = e.style.borderColor;
	var editMode;
	if (n && n.tagName == "DIV") {
        e.onmouseenter = function(evt){
		if (comp) {
			 if (comp.isEditMode()) {
				return;
			}
		}	
			e.onmouseover = null;
			e.onmouseout = null;
			hmo(evt, n, comp);
        };
        e.onmouseover = function(evt){
		if (comp) {
			 if (comp.isEditMode()|| Util.Style.ccss(this, "row-selected")) {
				return;
			}
		}
			e.style.backgroundColor = "#FFFFCC";
            e.style.borderColor = "#CCCCCC";
            hmo(evt, n, comp);
        };
        e.onmousemove = function(evt){
		if (comp) {
			 if (comp.isEditMode()|| Util.Style.ccss(this, "row-selected")) {
				return;
			}
		}
			e.style.backgroundColor = "#FFFFCC";
            e.style.borderColor = "#CCCCCC";
            hmm(evt, n, comp);
        };
        e.onmouseout = function(evt){
            e.style.backgroundColor = priorBgColor;
            e.style.borderColor = priorBorderColor;
            hmt(evt, n, comp);
        };
        e.onmouseleave = function(evt){
            e.style.backgroundColor = priorBgColor;
            e.style.borderColor = priorBorderColor;
            e.onmouseover = null;
            e.onmouseout = null;
            hmt(evt, n, comp);
        };
        e.onmouseup = function(evt){
            if (comp) {
                if (!comp.isEditMode()) {
                    return;
                }
                
                e.style.backgroundColor = priorBgColor;
                e.style.borderColor = priorBorderColor;
                hmt(evt, n, comp);
            }
        };
        Util.Style.acss(n, "hover");
    }
}

////// Healthe library 
 /*extern window, document*/
 /**
  * @fileOverview
 
     <h1>Utility Methods</h1>
     <p>
     These are universal utility methods, designed for speed, size and agnostic browser support. There are several namespaces:
     </p>
     <dl>
         <dt>Util</dt>
         <dd>General Utility methods</dd>
         <dd>Included in util.core.js</dd>
         <dt>Util.EventCache</dt>
         <dd>Object for ensuring proper garbage collection.</dd>
         <dd>Included in util.core.js</dd>
         <dt>Util.Convert</dt>
         <dd>Conversion Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.convert.js is not included.</dd>
         <dt>Util.Cookie</dt>
         <dd>Cookie Management Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.cookie.js is not included.</dd>
         <dt>Util.Detect</dt>
         <dd>Detection Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.detect.js is not included.</dd>
         <dt>Util.i18n</dt>
         <dd>Internationalization (i18n) Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.i18n.js is not included.</dd>
         <dt>Util.Load</dt>
         <dd>DOM-Loaded event Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.load.js is not included.</dd>
         <dt>Util.Pos</dt>
         <dd>Positioning Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.pos.js is not included.</dd>
         <dt>Util.Style</dt>
         <dd>CSS Utility methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.style.js is not included.</dd>
         <dt>Util.Timeout</dt>
         <dd>Session Management methods</dd>
         <dd>External module; will be an <strong>empty object</strong> if util.timeout.js is not included.</dd>
     </dl>
     <h2>Notes</h2>
     <p>All modules are aggregated together by Maven into a single file, util.js.</p>
     <p>Validated with JSLint.</p>
  */
 
 /**
  * Returns an element based on the id provided, <code>null</code> if no element exists.
  * @param {String} i The id.
  * @return {Node} An element with the id specified, <code>null</code> if no such element exists.
  * @static
  * @global
  * @fullname Get Element By ID
  */
 function _g(i) {
     return document.getElementById(i);
 }
 
 /**
  * Returns all elements from within the specified context matching the tag name provided, <code>null</code> if no
  * elements exist.
  * @param {String} t The tag name.
  * @param {Node} [e] The element to search within. Defaults to the document body.
  * @return {array} An array of elements with the tag name specified, <code>null</code> if no elements exist.
  * @static
  * @global
  * @fullname Get Elements By Tag Name
  */
 function _gbt(t, e) {
     e = e || document;
     return e.getElementsByTagName(t);
 }
 
 /**
  * Utility methods
  * @namespace Util
  * @static
  * @global
  */
 var Util = function () {
 
     var _e = [], _d = document, _w = window;
 
     return {
         /**
          * The Event Cache makes it possible to ensure all events attached to the DOM or browser instances are
          * properly "flushed away" after the page is unloaded. This prevents memory leaks in some implementations.
          *
          * @property
          * @memberof Util
          * @name EventCache
          */
         EventCache : function () {
             var l = [];
             return {
 
                 /**
                  * Add an event to the Event Cache.
                  * @param {Node} o The element or object to which the event is attached.
                  * @param {String} e The event name, e.g. "click" or "mouseover".
                  * @param {Function} f The function attached.
                  *
                  * @static
                  * @function
                  * @memberof Util.EventCache
                  * @name add
                  */
                 add : function (o, e, f) {
                     l.push(arguments);
                 },
 
                 /**
                  * Remove an event from the Event Cache.
                  * @param {Node} o The element or object to which the event is attached.
                  * @param {String} e The event name, e.g. "click" or "mouseover".
                  * @param {Function} f The function to detach.
                  *
                  * @static
                  * @function
                  * @memberof Util.EventCache
                  * @name remove
                  */
                 remove : function (o, e, f) {
                     var n;
                     for (var i = l.length - 1; i >= 0; i = i - 1) {
                         if (o == l[i][0] && e == l[i][1] && f == l[i][2]) {
                             n = l[i];
                             if (n[0].removeEventListener) {
                                 n[0].removeEventListener(n[1], n[2], n[3]);
                             }
                             else if (n[0].detachEvent) {
                                 if (n[1].substring(0, 2) != "on") {
                                     n[1] = "on" + n[1];
                                 }
                                 n[0].detachEvent(n[1], n[0][e + f]);
                             }
                         }
                     }
                 },
 
                 /**
                  * Remove all events from the Cache.
                  *
                  * @static
                  * @function
                  * @memberof Util.EventCache
                  * @name flush
                  */
                 flush : function () {
                     var e;
                     for (var i = l.length - 1; i >= 0; i = i - 1) {
                         var o = l[i];
                         if (o[0].removeEventListener) {
                             o[0].removeEventListener(o[1], o[2], o[3]);
                         }
                         e = o[1];
                         if (o[1].substring(0, 2) != "on") {
                             o[1] = "on" + o[1];
                         }
                         if (o[0].detachEvent) {
                             o[0].detachEvent(o[1], o[2]);
                             if (o[0][e + o[2]]) {
                                 o[0].detachEvent(o[1], o[0][e + o[2]]);
                             }
                         }
                     }
                 }
             };
         }(),
 
         /**
          * Creates an element within the document, without a parent, as if by <code>document.createElement</code>. This method
          * has better performance, as it caches instances of created objects and clones them, rather than manipulate the
          * document directly.
          * @param {String} t The tag name of the element to create.
          * @return {Node} A new element.
          *
          * @static
          * @function
          * @memberof Util
          * @name ce
          * @fullname Create Element
          */
         ce : function (t) {
             var a = _e[t];
             if (!a) {
                 a = _e[t] = _d.createElement(t);
             }
             if (!a) {
                 return null;
             }
             else {
                 return a.cloneNode(false);
             }
         },
 
         /**
          * Creates an element within the document, without a parent, as if by <code>document.createElement</code>. Any
          * given properites will then be set onto the newly created element. This method has better performance, as it
          * caches instances of created objects and clones them, rather than manipulate the document directly.
          * @param {String} t The tag name of the element to create.
          * @param {Object} [p] The properties to set onto the created element, (e.g. <code>{ "href" : "index.html", "name" : "theName"}</code>).
          * @return {Node} A new element.
          * 
          * @static
          * @function
          * @memberof Util
          * @name cep
          * @fullname Create Element with Properties
          */
         cep : function (t, p) {
             var e = this.ce(t);
             return this.mo(e, p);
         },
 
         /**
          * Merges two option objects.
          * @param {Object} o1 The option object to be modified.
          * @param {Object} o2 The option object containing properties to be copied.
          * @param {Boolean} d True if properties on o1 should be immutable, false otherwise.
          * @return {Object} An object containing properties.
          *
          * @static
          * @function
          * @memberof Util
          * @name mo
          * @fullname Merge Objects
          */
         mo : function (o1, o2, d) {
             o1 = o1 || {};
             o2 = o2 || {};
             var p;
             for (p in o2) {
                 if (p) {
                     o1[p] = (o1[p] === undefined) ? o2[p] : !d ? o2[p] : o1[p];
                 }
             }
             return o1;
         },
 
         /**
          * Deletes an element from the DOM.
          * @param {Node} e The element to delete.
          *
          * @static
          * @function
          * @memberof Util
          * @name de
          * @fullname Delete Element
          */
         de : function (e) {
             if (e) {
                 this.gp(e).removeChild(e);
             }
         },
 
         /**
          * Universal event-bubbling cancel method.
          * @param {event} e The event object, (not required in IE).
          *
          * @static
          * @function
          * @memberof Util
          * @name cancelBubble
          * @fullname Cancel Event Bubble
          */
         cancelBubble : function (e) {
             e = _w.event || e;
             if (!e) {
                 return;
             }
 
             if (e.stopPropagation) {
                 e.stopPropagation();
             }
             else {
                 e.cancelBubble = true;
             }
         },
 
         /**
          * Universal event default behavior prevention method.
          * @param {event} e The event object, (not required in IE).
          *
          * @static
          * @function
          * @memberof Util
          * @name preventDefault
          * @fullname Prevent Default Behavior
          */
         preventDefault : function (e) {
             e = _w.event || e;
 
             if (!e) {
                 return;
             }
 
             if (e.preventDefault) {
                 e.preventDefault();
             }
             else {
                 e.returnValue = false;
             }
         },
 
         /**
          * Returns the an element's offset values, traversing the tree for an accurate value.
          * @param {Node} e The element to evaluate.
          * @return {array} The offset left and offset top, in pixels, in the form of [left, top].
          *
          * @static
          * @function
          * @memberof Util
          * @name goff
          * @fullname Get Element Offset Values
          */
         goff : function (e) {
             var l = 0, t = 0;
             if (e.offsetParent) {
                 while (e.offsetParent) {
                     l += e.offsetLeft;
                     t += e.offsetTop;
                     e = e.offsetParent;
                 }
             }
             else if (e.x || e.y) {
                 l += e.x || 0;
                 t += e.y || 0;
             }
             return [l, t];
         },
 
         /**
          * Returns an accurate parent node; Some browsers will return a Text Node.
          * @param {Node} e The element to evaluate.
          * @return {Node} The actual parent node.
          *
          * @static
          * @function
          * @memberof Util
          * @name gp
          * @fullname Get Parent
          */
         gp : function (e) {
             if (!e.parentNode) {
                 return e;
             }
             e = e.parentNode;
             while (e.nodeType === 3 && e.parentNode) {
                 e = e.parentNode;
             }
             return e;
         },
		 
 
         /**
          * Some browsers will return a Text Node, so this method returns an accurate child node.
          * @param {Node} e The element to evaluate.
          * @param {int} [i] The child node index, default is 0.
          * @return {Node} The actual child node.
          *
          * @static
          * @function
          * @memberof Util
          * @name gc
          * @fullname Get Child Node
          */
         gc : function (e, i) {
             i = i || 0;
             var j = -1;
 
             if (!e.childNodes[i]) {
                 return null;
             }
 
             e = e.childNodes[0];
             while (e && j < i) {
                 if (e.nodeType === 1) {
                     j++;
                     if (j === i) {
                         break;
                     }
                 }
                 e = this.gns(e);
             }
             return e;
         },
 
         /**
          * For a given node, returns a list of children of NODETYPE 1, (Element).
          * @param {Node} e The node to evaluate.
          * @return {array} A collection of child nodes.
          *
          * @static
          * @function
          * @memberof Util
          * @name gcs
          * @fullname Get All Child Nodes
          */
         gcs : function (e) {
 
             var r = [], es = e.childNodes;
             for (var i = 0; i < es.length; i++) {
                 var x = es[i];
                 if (x.nodeType === 1) {
                     r.push(x);
                 }
             }
             return r;
         },
 
         /**
          * Returns an accurate next sibling node; Some browsers will return a Text Node.
          * @param {Node} e The element to evaluate.
          * @return {Node} The actual next sibling node.
          *
          * @static
          * @function
          * @memberof Util
          * @name gns
          * @fullname Get Next True Sibling
          */
         gns : function (e) {
			if (!e) {
				return null;
			}
             var a = e.nextSibling;
             while (a && a.nodeType !== 1) {
                 a = a.nextSibling;
             }
             return a;
         },
 
         /**
          * Returns an accurate previous sibling node; Some browsers will return a Text Node.
          * @param {Node} e The element to evaluate.
          * @return {Node} The actual previous sibling node.
          *
          * @static
          * @function
          * @memberof Util
          * @name gps
          * @fullname Get Previous True Sibling
          */
         gps : function (e) {
             var a = e.previousSibling;
             while (a && a.nodeType !== 1) {
                 a = a.previousSibling;
             }
             return a;
         },
 
         /**
          * Appends a child to the specified node.
          * @param {Node} e The element to append.
          * @param {Node} p The new parent node.
          * @return {Node} The appended element.
          *
          * @static
          * @function
          * @memberof Util
          * @name ac
          * @fullname Append Child
          */
         ac : function (e, p) {
             p.appendChild(e);
             return e;
         },
 
         /**
          * Insert a node after a specified node.
          * @param {Node} nn The new node to insert.
          * @param {Node} rn The reference node for insertion.
          *
          * @static
          * @function
          * @memberof Util
          * @name ia
          * @fullname Insert After
          */
         ia : function (nn, rn) {
             var p = Util.gp(rn), n = Util.gns(rn);
             if (n) {
                 p.insertBefore(nn, n);
             }
             else {
                 Util.ac(nn, p);
             }
         },
 
         /**
          * Adds a Javscript event to the given element with full browser compatiblity and plugs for any memory leaks.
          * @param {Node} o The object receiving the event.
          * @param {String} e The event name to attach.
          * @param {Function} f The function to run when the event is invoked.
          *
          * @static
          * @function
          * @memberof Util
          * @name addEvent
          * @fullname Add Javascript Event
          */
         addEvent : function (o, e, f) {
 
             function ae(obj, evt, fnc) {
                 if (!obj.myEvents) {
                     obj.myEvents = {};
                 }
 
                 if (!obj.myEvents[evt]) {
                     obj.myEvents[evt] = [];
                 }
 
                 var evts = obj.myEvents[evt];
                 evts[evts.length] = fnc;
             }
 
             function fe(obj, evt) {
 
                 if (!obj || !obj.myEvents || !obj.myEvents[evt]) {
                     return;
                 }
 
                 var evts = obj.myEvents[evt];
 
                 for (var i = 0, len = evts.length; i < len; i++) {
                     evts[i]();
                 }
             }
 
             if (o.addEventListener) {
                 o.addEventListener(e, f, false);
                 Util.EventCache.add(o, e, f);
             }
             else if (o.attachEvent) {
                 o["e" + e + f] = f;
                 o[e + f] = function () {
                     o["e" + e + f](window.event);
                 };
                 o.attachEvent("on" + e, o[e + f]);
                 Util.EventCache.add(o, e, f);
             }
             else {
                 ae(o, e, f);
                 o['on' + e] = function () {
                     fe(o, e);
                 };
             }
         },
 
         /**
          * Remove a Javscript event from the given element with full browser compatiblity and plugs for any memory leaks.
          * @param {Node} o The object honoring the event.
          * @param {String} e The event name.
          * @param {Function} f The function to remove.
          *
          * @static
          * @function
          * @memberof Util
          * @name removeEvent
          * @fullname Remove Javascript Event
          */
         removeEvent : function (o, e, f) {
             Util.EventCache.remove(o, e, f);
         },
 
         /**
         * Uses the native browser window object to create a new window.
         * <p>
         * <strong>NOTE:</strong> This method will utilize DOM methodology only <em>truly</em> supported by desktop
         * browsers. While some mobile browsers may allow this call, most will not. Use with caution, in specific use
         * cases.
         * </p>
         *
         * @param {String} u The url of the popup to open.
         * @param {String} n The name of the popup window.
         * @param {Object} [o The object params. If an object is not provided, the browser defaults will be used.
         * @param {String} [o.lb]  Include location bar, (default is true).
         * @param {String} [o.mb] Include menu bar, (default is true).
         * @param {String} [o.rz] Allow resize, (default is true).
         * @param {String} [o.scb] Include scrollbars, (default is true).
         * @param {String} [o.stb] Include status bar, (default is true).
         * @param {String} [o.tb] Include toolbar, (default is true).
         * @param {int} [o.w] The value for the width of the popup window.
         * @param {int} [o.h] The value for the height of the popup window.
         * @param {int} [o.tp] The value for top. (NOT SUPPORTED YET)
         * @param {int} [o.lft] The value for the left position of the popup. (NOT SUPPORTED YET)
         * @param {int} [o.sx] The screen x value. (NOT SUPPORTED YET)
         * @param {int} [o.sy] The screen y value. (NOT SUPPORTED YET)
         * @param {String} [o.dp] The value for the dependent popup property (yes or no). (NOT SUPPORTED YET)
         * @param {String} [o.dr] The value for the directories property (yes or no). (NOT SUPPORTED YET)
         * @param {String} [o.fs] The value for the fullscreen property (yes or no). (NOT SUPPORTED YET)
         * @return <code>True</code> if the window popup was successful, <code>false</code> otherwise or if the client
         * does not support popup windows.
         *
         * @static
         * @function
         * @memberof Util
         * @name popup
         * @fullname Popup New Window
         */
         popup : function (u, n, o) {
             if (!window.open) {
                 return false;
             }
 
             var d = {
                 w : screen.width,
                 h : screen.height,
                 rz : true,
                 mb : true,
                 scb : true,
                 stb : true,
                 tb : true,
                 lb : true,
                 tp : null,
                 lft : null,
                 sx : null,
                 sy : null,
                 dp : "no",
                 dr : "no",
                 fs : "no"
             };
 
             function f(n, v)
             {
                 if (!v) {
                     return "";
                 }
                 return n + '=' + v + ',';
             }
 
             function fs() {
                 o = o || {};
                 var p, n = {};
                 for (p in d) {
                     if (p) {
                         n[p] = o[p] !== undefined ? o[p] : d[p];
                     }
                 }
                 return n;
             }
 
             o = fs();
             var p = f("dependent", o.dp) + f("directories", o.dr) + f("fullscreen", o.fs) + f("location", o.lb ? 1 : 0) + f("menubar", o.mb) + f("resizable", o.rz ? 1 : 0) + f("scrollbars", o.scb ? 1 : 0) + f("status", o.stb ? 1 : 0) + f("toolbar", o.tb ? 1 : 0) + f("top", o.tp) + f("left", o.lft) + f("width", o.w) + f("height", o.h) + f("screenX", o.sx) + f("screenY", o.sy);
             p = p.substring(0, p.length - 1);
             var nw = window.open(u, n, p);
             window.blur();
 
             if (nw.focus) {
                 nw.focus();
             }
 
             return true;
         },
         Convert : {},
         Cookie : {},
         Detect : {},
         i18n : {},
         Load : {},
         Pos : {},
         Style : {},
         Timeout : {}
     };
 }();
 
 /**
  * Insert a node after a specified node.
  * @param {Node} nn The new node to insert.
  * @param {Node} rn The reference node for insertion.
  *
  * @deprecated
  * @static
  * @global
  */
 function insertAfter(nn, rn) {
     Util.ia(nn, rn);
 }

 Util.addEvent(window, 'unload', Util.EventCache.flush);

 /*extern _gbt, Util*/

 /**
 * @fileOverview
 *
 * <h1>CSS Utility module and namespace</h1>
 * <p>This module assists with managing CSS selectors and classnames.</p>
 * <h2>Usage</h2>
 * <p>Import this file <em>after</em> util.core.js.</p>
 */

 /**
 * Style Utility methods.
 * @namespace Util.Style
 * @global
 * @static
 */
 Util.Style = function() {

     return {
         /**
         * Indicates if an element has been applied with a single given CSS Classname.
         * @param {Node} e The element to evaluate.
         * @param {String} c The single CSS Classname to check.
         * @return {Boolean} True if the classname contains the given class, false otherwise.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name ccss
         * @fullname Contains CSS Class
         */
         ccss: function(e, c) {
             if (typeof (e.className) === 'undefined' || !e.className) {
                 return false;
             }
             var a = e.className.split(' ');
             for (var i = 0, b = a.length; i < b; i++) {
                 if (a[i] === c) {
                     return true;
                 }
             }
             return false;
         },

         /**
         * Adds a given CSS Classname to the given element.
         * @param {Node} e The element to evaluate.
         * @param {String} c The classname to apply.
         * @return {Node} The element with the CSS Classname applied.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name acss
         * @fullname Add CSS Class
         */
         acss: function(e, c) {
             if (this.ccss(e, c)) {
                 return e;
             }
             e.className = (e.className ? e.className + ' ' : '') + c;
             return e;
         },

         /**
         * Removes a given CSS Classname from the given element.
         * @param {Node} e The element to evaluate.
         * @param {String} c The classname to remove.
         * @return {Node} The element, with the CSS Classname removed.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name rcss
         * @fullname Remove CSS Class
         */
         rcss: function(e, c) {
             if (!this.ccss(e, c)) {
                 return e;
             }
             var a = e.className.split(' '), d = "";
             for (var i = 0, b = a.length; i < b; i++) {
                 var f = a[i];
                 if (f !== c) {
                     d += d.length > 0 ? (" " + f) : f;
                 }
             }
             e.className = d;
             return e;
         },

         /**
         * Toggles a given CSS Classname on a given element.
         * @param {Node} e The element to evaluate.
         * @param {String} c The classname to toggle.
         * @return {Boolean} True if the element now contains the classname, false if it was removed.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name tcss
         * @fullname Toggle CSS Class
         */
         tcss: function(e, c) {
             if (this.ccss(e, c)) {
                 this.rcss(e, c);
                 return false;
             }
             else {
                 this.acss(e, c);
                 return true;
             }
         },

         /**
         * Clears any opacity setting back to whatever is defined in CSS.
         * @param {Node} e The element whose opacity setting should be reset.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name co
         * @fullname Clear Opacity
         */
         co: function(e) {
             e.style.MozOpacity = "";
             e.style.opacity = "";
             e.style.filter = "";
         },

         /**
         * Returns an array of elements with the designated classname.
         * @param {String} c The CSS classname.
         * @param {Node} [e] The parent element to search within, defaults to document.
         * @param {String} [t] The tagname to scope the results, defaults to all tags.
         *
         * @static
         * @function
         * @memberof Util.Style
         * @name g
         * @fullname Get Elements by Classname
         */
         g: function(c, e, t) {
             e = e || document;
             t = t || '*';
             var ns = [], es = _gbt(t, e), l = es.length;
             for (var i = 0, j = 0; i < l; i++) {
                 if (this.ccss(es[i], c)) {
                     ns[j] = es[i];
                     j++;
                 }
             }
             return ns;
         }
     };
 } ();
 
 Util.Pos = function () {

    return {
        /**
         * Returns the actual scrolled offset within the window.
         * @return {array} A Javascript array containing the distance scrolled within the window as [top distance, left distance].
         *
         * @static
         * @function
         * @memberof Util.Pos
         * @name gso
         * @fullname Get Scrolled Offset
         */
        gso : function () {
            var d = document, b = d.body, w = window, e = d.documentElement, et = e.scrollTop, bt = b.scrollTop, el = e.scrollLeft, bl = b.scrollLeft;
            if (typeof w.pageYOffset === "number") {
                return [w.pageYOffset, w.pageXOffset];
            }
            if (typeof et === "number") {
                if (bt > et || bl > el) {
                    return [bt, bl];
                }
                return [et, el];
            }
            return [bt, bl];
        },

        /**
         * Returns an array of offset parameters for a given element.
         * @param {Node} e The element to evaluate. If null, undefined or invalid, zeroed offsets are returned.
         * @return {array} A Javascript array of the given element's offsets, relative to any scrolled distance within the window,
         * indexed as [top, left, height, width].  The array will be zeroed out if the element provided is invalid.
         *
         * @static
         * @function
         * @memberof Util.Pos
         * @name goo
         * @fullname Get Object Offsets
         */
        goo : function (e) {
            if (e) {
                return [e.offsetTop, e.offsetLeft, e.offsetHeight, e.offsetWidth];
            }
            return [0, 0, 0, 0];
        },

        /**
         * Returns the true position of a given object by parsing the offset tree.
         * @param {Node} e The DOM element.
         * @return {array} A Javascript array containing the "true" top and left of the given element indexed as [top, left].  The
         * array will be zeroed out if the element provided is invalid.
         *
         * @static
         * @function
         * @memberof Util.Pos
         * @name gop
         * @fullname Get Object Position
         */
        gop : function (e) {
            var l = 0, t = 0;
            if (e.offsetParent)
            {
                l = e.offsetLeft;
                t = e.offsetTop;
                e = e.offsetParent;
                while (e)
                {
                    l += e.offsetLeft;
                    t += e.offsetTop;
                    e = e.offsetParent;
                }
            }
            return [t, l];
        },

        /**
         * Returns an array of size characteristics for the viewport.
         * @return {array} The size of the viewport as a Javascript array, indexed as [height, width].
         *
         * @static
         * @function
         * @memberof Util.Pos
         * @name gvs
         * @fullname Get Viewport Size
         */
        gvs : function () {
            var n = window, d = document, b = d.body, e = d.documentElement;
             // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight
            if (typeof n.innerWidth !== 'undefined') {
                return [n.innerHeight, n.innerWidth];
            }
            // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)
            else if (typeof e !== 'undefined' && typeof e.clientWidth !== 'undefined' && e.clientWidth !== 0) {
                return [e.clientHeight, e.clientWidth];
            }
            // older versions of IE
            else {
                return [b.clientHeight, b.clientWidth];
            }
        }
    };
}();

//////end healthe library

// The following functions were copied from Util.Core, a module within the Healthe Widget Library
// http://prototyping.healthe.cerner.corp/repo/release/site/com.cerner.healthe.navigator/healthe-widget-library/1.2/jsdoc/

function getPosition(e) {
    e = e || window.event;
    var cursor = { x: 0, y: 0 };
    if (e.pageX || e.pageY) {
        cursor.x = e.pageX;
        cursor.y = e.pageY;
    }
    else {
        var de = document.documentElement;
        var b = document.body;
        cursor.x = e.clientX +
                               (de.scrollLeft || b.scrollLeft) - (de.clientLeft || 0);
        cursor.y = e.clientY +
                               (de.scrollTop || b.scrollTop) - (de.clientTop || 0);
    }
    return cursor;
}

// The following functions were copied from Util.Style, a module within the Healthe Widget Library
// http://prototyping.healthe.cerner.corp/repo/release/site/com.cerner.healthe.navigator/healthe-widget-library/1.2/jsdoc/

function gvs() {
    var n = window, d = document, b = d.body, e = d.documentElement;
    // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight
    if (typeof n.innerWidth !== 'undefined') {
        return [n.innerHeight, n.innerWidth];
    }
    // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)
    else if (typeof e !== 'undefined' && typeof e.clientWidth !== 'undefined' && e.clientWidth !== 0) {
        return [e.clientHeight, e.clientWidth];
    }
    // older versions of IE
    else {
        return [b.clientHeight, b.clientWidth];
    }
}

function gso() {
    var d = document, b = d.body, w = window, e = d.documentElement, et = e.scrollTop, bt = b.scrollTop, el = e.scrollLeft, bl = b.scrollLeft;
    if (typeof w.pageYOffset === "number") {
        return [w.pageYOffset, w.pageXOffset];
    }
    if (typeof et === "number") {
        if (bt > et || bl > el) {
            return [bt, bl];
        }
        return [et, el];
    }
    return [bt, bl];
}
/**
 * Project: mp_component_defs
 * Version 1.0.0
 * Released 7/6/2010
 * @author Greg Howdeshell
 */

Function.prototype.method = function(name, func) {
	this.prototype[name] = func;
	return this;
};

Function.method('inherits', function(Parent) {
	var d = {}, p = (this.prototype = new Parent());
	this.method('uber', function uber(name) {
		if(!( name in d)) {
			d[name] = 0;
		}
		var f, r, t = d[name], v = Parent.prototype;
		if(t) {
			while(t) {
				v = v.constructor.prototype;
				t -= 1;
			}
			f = v[name];
		}
		else {
			f = p[name];
			if(f == this[name]) {
				f = v[name];
			}
		}
		d[name] += 1;
		r = f.apply(this, Array.prototype.slice.apply(arguments, [1]));
		d[name] -= 1;
		return r;
	});
	return this;
});

/**
 * Creates getters and setters for the class based on attributeName.
 *
 * Example:
 *
 * MyClass.createAttribute("Color", "blue");
 *
 * The call above will create this.getColor() and this.setColor(value).
 * A member variable mColor will also be created, with the default value of
 * "blue".
 *
 */
Function.prototype.createAttribute = function(attributeName, defaultValue) {
	this.prototype["m_" + attributeName] = defaultValue;

	this.prototype["get" + attributeName] = function() {
		return this["m_" + attributeName];
	};

	this.prototype["set" + attributeName] = function(value) {
		this["m_" + attributeName] = value;
	};

};

function MPageComponentInteractive() {
	this.m_DocPrivObj = null;
	this.m_DocPrivMask = 0;

	MPageComponentInteractive.method("setPrivObj", function(value) {
		this.m_DocPrivObj = value;
	});


	MPageComponentInteractive.method("getDocPrivObj", function() {
		return (m_DocPrivObj);
	});


	MPageComponentInteractive.method("setIsCompViewable", function(value) {
		this.m_isCompViewable = value;
	});


	MPageComponentInteractive.method("setIsCompAddable", function(value) {
		this.m_isCompAddable = value;
	});


	MPageComponentInteractive.method("setIsCompModifiable", function(value) {
		this.m_isCompModifiable = value;
	});


	MPageComponentInteractive.method("setIsCompUnchartable", function(value) {
		this.m_isCompUnchartable = value;
	});


	MPageComponentInteractive.method("setIsCompSignable", function(value) {
		this.m_isCompSignable = value;
	});


	MPageComponentInteractive.method("getCompPrivMask", function() {
		var VIEW_MASK = parseInt("1", 2);
		var ADD_MASK = parseInt("10", 2);
		var MODIFY_MASK = parseInt("100", 2);
		var UNCHART_MASK = parseInt("1000", 2);
		var SIGN_MASK = parseInt("10000", 2);
		var privMask = 0;
		privMask = ((this.m_isCompViewable) ? VIEW_MASK : 0) | //Add View Privs if true
		((this.m_isCompAddable) ? ADD_MASK : 0) | //Add Add Privs if true
		((this.m_isCompModifiable) ? MODIFY_MASK : 0) | //Add Mod Privs if true
		((this.m_isCompUnchartable) ? UNCHART_MASK : 0) | //Add Uchart Privs if true
		((this.m_isCompSignable) ? SIGN_MASK : 0);
		//Add Sign Privs if true

		return (privMask);
	});


	MPageComponentInteractive.method("getPrivFromArray", function(eventCd, array) {
		var i = array.length;
		while(i--) {
			if(eventCd == array[i].EVENT_CD) {
				return (true);
			}
		}
		return (false);
	});


	MPageComponentInteractive.method("isResultEventCodeSignable", function(eventCd) {
		if(this.getPrivFromArray(eventCd, m_DocPrivObj.getResponse().EVENT_PRIVILEGES.VIEW_RESULTS.GRANTED.EVENT_CODES)) {
			return (true);
		}
		else {
			return (false);
		}
	});


	MPageComponentInteractive.method("isResultEventCodeAddable", function(eventCd) {
		if(this.getPrivFromArray(eventCd, m_DocPrivObj.getResponse().EVENT_PRIVILEGES.ADD_DOCUMENTATION.GRANTED.EVENT_CODES)) {
			return (true);
		}
		else {
			return (false);
		}
	});


	MPageComponentInteractive.method("isResultEventCodeModifiable", function(eventCd) {
		if(this.getPrivFromArray(eventCd, m_DocPrivObj.getResponse().EVENT_PRIVILEGES.MODIFY_DOCUMENTATION.GRANTED.EVENT_CODES)) {
			return (true);
		}
		else {
			return (false);
		}
	});


	MPageComponentInteractive.method("isResultEventCodeUnchartable", function(eventCd) {
		if(this.getPrivFromArray(eventCd, m_DocPrivObj.getResponse().EVENT_PRIVILEGES.UNCHART_DOCUMENTATION.GRANTED.EVENT_CODES)) {
			return (true);
		}
		else {
			return (false);
		}
	});


	MPageComponentInteractive.method("isResultEventCodeSignable", function(eventCd) {
		if(this.getPrivFromArray(eventCd, m_DocPrivObj.getResponse().EVENT_PRIVILEGES.SIGN_DOCUMENTATION.GRANTED.EVENT_CODES)) {
			return (true);
		}
		else {
			return (false);
		}
	});


	MPageComponentInteractive.method("getEventCdPrivs", function(component, eventArr) {
		var criterion = this.getCriterion();
		var paramEventCd = MP_Util.CreateParamArray(eventArr, 1);
		var paramPrivMask = this.getCompPrivMask();
		var sendAr = ["^MINE^", criterion.provider_id + ".0", paramEventCd, "0.0", paramPrivMask, criterion.ppr_cd + ".0"];
		var request = new MP_Core.ScriptRequest(this, "ENG:MPG.MPCINTERACTIVE - Get Doc prefs");
		request.setParameters(sendAr);
		request.setName("getCompPrivs");
		request.setProgramName("MP_GET_PRIVS_BY_CODE_JSON");
		request.setAsync(false);
		MP_Core.XMLCCLRequestCallBack(component, request, this.processEventCdReply);

	});


	MPageComponentInteractive.method("processEventCdReply", function(reply) {
		m_DocPrivObj = reply;
	});

}

MPageComponentInteractive.inherits(MPageComponent);

/*
 * The MPage grouper provides a means in which to group MPageGroups together into an
 * array for results such as Blood Pressure where each group is a sequence of events.
 */
function MPageGrouper() {
	this.m_groups = null;
	MPageGrouper.method("setGroups", function(value) {
		this.m_groups = value;
	});


	MPageGrouper.method("getGroups", function() {
		return this.m_groups;
	});


	MPageGrouper.method("addGroup", function(value) {
		if(this.m_groups === null) {
			this.m_groups = [];
		}
		this.m_groups.push(value);
	});

}

MPageGrouper.inherits(MPageGroup);

function MPageGroup() {
	this.m_groupName = "";
	this.m_groupSeq = 0;
	this.m_groupId = 0;
	MPageGroup.method("setGroupId", function(value) {
		this.m_groupId = value;
	});


	MPageGroup.method("getGroupId", function() {
		return this.m_groupId;
	});


	MPageGroup.method("setGroupName", function(value) {
		this.m_groupName = value;
	});


	MPageGroup.method("getGroupName", function() {
		return this.m_groupName;
	});


	MPageGroup.method("setSequence", function(value) {
		this.m_groupSeq = value;
	});


	MPageGroup.method("getSequence", function() {
		return this.m_groupSeq;
	});

}

function MPageEventSetGroup() {
	this.m_eventSets = null;
	this.m_isSequenced = false;
	MPageEventSetGroup.method("isSequenced", function() {
		return this.m_isSequenced;
	});


	MPageEventSetGroup.method("setSequenced", function(value) {
		this.m_isSequenced = value;
	});


	MPageEventSetGroup.method("getEventSets", function() {
		return this.m_eventSets;
	});


	MPageEventSetGroup.method("setEventSets", function(value) {
		this.m_eventSets = value;
	});


	MPageEventSetGroup.method("addEventSet", function(value) {
		if(this.m_eventSets === null) {
			this.m_eventSets = [];
		}
		this.m_eventSets.push(value);
	});

}

MPageEventSetGroup.inherits(MPageGroup);

function MPageCatalogCodeGroup() {
	this.m_catalogCodes = null;
	this.m_isSequenced = false;
	MPageCatalogCodeGroup.method("isSequenced", function() {
		return this.m_isSequenced;
	});


	MPageCatalogCodeGroup.method("setSequenced", function(value) {
		this.m_isSequenced = value;
	});


	MPageCatalogCodeGroup.method("getCatalogCodes", function() {
		return this.m_catalogCodes;
	});


	MPageCatalogCodeGroup.method("setCatalogCodes", function(value) {
		this.m_catalogCodes = value;
	});


	MPageCatalogCodeGroup.method("addCatalogCode", function(value) {
		if(this.m_catalogCodes === null) {
			this.m_catalogCodes = [];
		}
		this.m_catalogCodes.push(value);
	});

}

MPageCatalogCodeGroup.inherits(MPageGroup);

function MPageEventCodeGroup() {
	this.m_eventCodes = null;
	this.m_isSequenced = false;
	MPageEventCodeGroup.method("isSequenced", function() {
		return this.m_isSequenced;
	});


	MPageEventCodeGroup.method("setSequenced", function(value) {
		this.m_isSequenced = value;
	});


	MPageEventCodeGroup.method("getEventCodes", function() {
		return this.m_eventCodes;
	});


	MPageEventCodeGroup.method("setEventCodes", function(value) {
		this.m_eventCodes = value;
	});


	MPageEventCodeGroup.method("addEventCode", function(value) {
		if(this.m_eventCodes === null) {
			this.m_eventCodes = [];
		}
		this.m_eventCodes.push(value);
	});

}

MPageEventCodeGroup.inherits(MPageGroup);

function MPageCodeValueGroup() {
	this.m_codes = null;
	MPageCodeValueGroup.method("getCodes", function() {
		return this.m_codes;
	});


	MPageCodeValueGroup.method("setCodes", function(value) {
		this.m_codes = value;
	});


	MPageCodeValueGroup.method("addCode", function(value) {
		if(this.m_codes === null) {
			this.m_codes = [];
		}
		this.m_codes.push(value);
	});

}

MPageCodeValueGroup.inherits(MPageGroup);

//The MPageSequenceGroup is a grouper of items such as filter means, event codes, event sets, etc.
function MPageSequenceGroup() {
	this.m_items = null;
	this.m_mapItems = null;
	this.m_isMultiType = false;
	
	MPageSequenceGroup.method("getItems", function() {
		return this.m_items;
	});


	MPageSequenceGroup.method("setItems", function(value) {
		this.m_items = value;
	});


	MPageSequenceGroup.method("addItem", function(value) {
		if(this.m_items === null) {
			this.m_items = [];
		}
		this.m_items.push(value);
	});


	MPageSequenceGroup.method("setMultiValue", function(value) {
		this.m_isMultiType = value;
	});


	MPageSequenceGroup.method("isMultiValue", function() {
		return (this.m_isMultiType);
	});


	MPageSequenceGroup.method("getMapItems", function() {
		return this.m_mapItems;
	});


	MPageSequenceGroup.method("setMapItems", function(value) {
		this.m_mapItems = value;
	});

}

MPageSequenceGroup.inherits(MPageGroup);

function MPageGroupValue() {
	this.m_description = "";
	this.m_id = 0.0;
	this.m_meaning = "";
	this.m_name = "";
	this.m_qualifierFlag = 0;
	this.m_sequence = 0;
	this.m_valSequence = 0;
	this.m_valTypeFlag = 0;
}

MPageGroupValue.prototype.getId = function() {
	return this.m_id;
};

MPageGroupValue.prototype.setId = function(id) {
	this.m_id = id;
};

MPageGroupValue.prototype.getName = function() {
	return this.m_name;
};

MPageGroupValue.prototype.setName = function(name) {
	this.m_name = name;
};

MPageGroupValue.prototype.getSequence = function() {
	return this.m_sequence;
};

MPageGroupValue.prototype.setSequence = function(sequence) {
	this.m_sequence = sequence;
};

MPageGroupValue.prototype.getDescription = function() {
	return this.m_description;
};

MPageGroupValue.prototype.setDescription = function(description) {
	this.m_description = description;
};

MPageGroupValue.prototype.getMeaning = function() {
	return this.m_meaning;
};

MPageGroupValue.prototype.setMeaning = function(meaning) {
	this.m_meaning = meaning;
};

MPageGroupValue.prototype.getValueSequence = function(){
    return this.m_valSequence;
};

MPageGroupValue.prototype.setValueSequence = function(valSequence){
    this.m_valSequence = valSequence;
};

MPageGroupValue.prototype.getValueTypeFlag = function(){
    return this.m_valTypeFlag;
};

MPageGroupValue.prototype.setValueTypeFlag = function(valTypeFlag){
    this.m_valTypeFlag = valTypeFlag;
};

MPageGroupValue.prototype.getQualifierFlag = function(){
    return this.m_qualifierFlag;
};

MPageGroupValue.prototype.setQualifierFlag = function(qualFlag){
    this.m_qualifierFlag = qualFlag;
}; 



var CERN_COMPONENT_TYPE_SUMMARY = 1;
var CERN_COMPONENT_TYPE_WORKFLOW = 2;

function ComponentStyle() {
	this.m_nameSpace = "";
	this.m_id = "";
	this.m_className = "section";
	this.m_contentId = "";
	this.m_contentClass = "sec-content";
	this.m_headerClass = "sec-hd";
	this.m_headToggle = "sec-hd-tgl";
	this.m_secTitle = "sec-title";
	this.m_aLink = "";
	this.m_secTotal = "sec-total";
	this.m_info = "";
	this.m_subSecHeaderClass = "sub-sec-hd";
	this.m_subSecTitleClass = "sub-sec-title";
	this.m_subSecContentClass = "sub-sec-content";
	this.m_contentBodyClass = "content-body";
	this.m_searchBoxDiv = "search-box-div";
	this.m_subTitleDisp = "sub-title-disp";
	// If a component may be on a page multiple times, a unique identifier such as the component id will need to be set on the style
	// The unique identifier is only utilized on styles that are placeholders to be replaced at a later point.
	this.m_componentId = 0;
	this.m_color = "";
	//This is the component type which determines how it will be rendered in the View
	this.m_componentType = null;

	/**
	 * Initializes the component style with the provided namespace to utilize throughout the component.
	 * @param {Object} value
	 */
	ComponentStyle.method("initByNamespace", function(value) {
		this.m_nameSpace = value;
		this.m_id = value;
		this.m_className += (" " + value + "-sec");
		this.m_contentId = value + "Content";
		this.m_aLink = value + "Link";
		this.m_info = value + "-info";
	});


	ComponentStyle.method("getNameSpace", function() {
		return this.m_nameSpace;
	});


	ComponentStyle.method("getId", function() {
		return this.m_id + this.m_componentId;
	});


	ComponentStyle.method("getClassName", function() {
		return this.m_className;
	});


	ComponentStyle.method("getColor", function() {
		return this.m_color;
	});


	ComponentStyle.method("getContentId", function() {
		return this.m_contentId + this.m_componentId;
	});


	ComponentStyle.method("getContentBodyClass", function() {
		return this.m_contentBodyClass;
	});


	ComponentStyle.method("getContentClass", function() {
		return this.m_contentClass;
	});


	ComponentStyle.method("getHeaderClass", function() {
		return this.m_headerClass;
	});


	ComponentStyle.method("getHeaderToggle", function() {
		return this.m_headToggle;
	});


	ComponentStyle.method("getTitle", function() {
		return this.m_secTitle;
	});


	ComponentStyle.method("getLink", function() {
		return this.m_aLink;
	});


	ComponentStyle.method("getTotal", function() {
		return this.m_secTotal;
	});


	ComponentStyle.method("getInfo", function() {
		return this.m_info;
	});


	ComponentStyle.method("getSearchBoxDiv", function() {
		return this.m_searchBoxDiv;
	});


	ComponentStyle.method("getSubSecContentClass", function() {
		return this.m_subSecContentClass;
	});


	ComponentStyle.method("getSubSecContentClass", function() {
		return this.m_subSecContentClass;
	});


	ComponentStyle.method("getSubSecHeaderClass", function() {
		return this.m_subSecHeaderClass;
	});


	ComponentStyle.method("getSubSecTitleClass", function() {
		return this.m_subSecTitleClass;
	});


	ComponentStyle.method("getSubTitleDisp", function() {
		return this.m_subTitleDisp;
	});


	ComponentStyle.method("getComponentType", function() {
		return this.m_componentType;
	});


	ComponentStyle.method("setComponentId", function(value) {
		this.m_componentId = value;
	});


	ComponentStyle.method("setNameSpace", function(value) {
		this.m_nameSpace = value;
	});


	ComponentStyle.method("setId", function(value) {
		this.m_id = value;
	});


	ComponentStyle.method("setClassName", function(value) {
		this.m_className = value;
	});


	ComponentStyle.method("setColor", function(value) {
		this.m_color = value;
		this.setClassName(this.getClassName() + " " + value);
	});


	ComponentStyle.method("setContextId", function(value) {
		this.m_contentId = value;
	});


	ComponentStyle.method("setContentBodyClass", function(value) {
		this.m_contentBodyClass = value;
	});


	ComponentStyle.method("setContentClass", function(value) {
		this.m_contentClass = value;
	});


	ComponentStyle.method("setContextClass", function(value) {
		this.m_contentClass = value;
	});


	ComponentStyle.method("setHeaderClass", function(value) {
		this.m_headerClass = value;
	});


	ComponentStyle.method("setHeaderToggle", function(value) {
		this.m_headToggle = value;
	});


	ComponentStyle.method("setSearchBoxDiv", function(value) {
		this.m_searchBoxDiv = value;
	});


	ComponentStyle.method("setSubSecContentClass", function(value) {
		this.m_subSecContentClass = value;
	});


	ComponentStyle.method("setSubSecHeaderClass", function(value) {
		this.m_subSecHeaderClass = value;
	});


	ComponentStyle.method("setSubSecTitleClass", function(value) {
		this.m_subSecTitleClass = value;
	});


	ComponentStyle.method("setSubTitleDisp", function(value) {
		this.m_subTitleDisp = value;
	});


	ComponentStyle.method("setTitle", function(value) {
		this.m_secTitle = value;
	});


	ComponentStyle.method("setLink", function(value) {
		this.m_aLink = value;
	});


	ComponentStyle.method("setTotal", function(value) {
		this.m_secTotal = value;
	});


	ComponentStyle.method("setInfo", function(value) {
		this.m_info = value;
	});


	ComponentStyle.method("setComponentType", function(value) {
		this.m_componentType = value;
	});

}

/**
 * Sorts the MPage Components by group sequence, then by column, and lastly by row.
 * @param {MPageComponent} c1 Component one to compare against
 * @param {MPageComponent} c2 Component two to compare against
 * @return {Short} Returns the sequence in which the components should display.
 *
 * @author Greg Howdeshell
 */
function SortMPageComponentRows(c1, c2) {
	if(c1.getSequence() < c2.getSequence()) {
		return -1;
	}
	if(c1.getSequence() > c2.getSequence()) {
		return 1;
	}
	return 0;
}

function SortMPageComponentCols(c1, c2) {
	if(c1.getColumn() < c2.getColumn()) {
		return -1;
	}
	if(c1.getColumn() > c2.getColumn()) {
		return 1;
	}
	return SortMPageComponentRows(c1, c2);
}

function SortMPageComponents(c1, c2) {
	if(c1.getPageGroupSequence() < c2.getPageGroupSequence()) {
		return -1;
	}
	if(c1.getPageGroupSequence() > c2.getPageGroupSequence()) {
		return 1;
	}
	return SortMPageComponentCols(c1, c2);
}
/*
 The scope of an MPage object and Components are during rendering of the page.  However,
 once the page has been rendered these items are lost.  Because there is a need to refresh
 components, the components on a 'page' must be globally stored to allow for refreshing of data.
 */
var CERN_EventListener = null;
var CERN_MPageComponents = null;
//A global object which keeps a mapping of Report Means to the components which should be instantiated.
//Supporting functionality is located in the MP_Util namespace
var CERN_ObjectDefinitionMapping = {};
var CERN_TabManagers = null;
var CERN_MPages = null;
var CERN_BrowserDevInd = false;
var CERN_PersonalFav = null;
var CK_DATA = {};

var STR_PAD_LEFT = 1;
var STR_PAD_RIGHT = 2;
var STR_PAD_BOTH = 3;

Array.prototype.addAll = function(v) {
	if(v && v.length > 0) {
		for(var x = 0, xl = v.length; x < xl; x++) {
			this.push(v[x]);
		}
	}
};

/*Listen for a ctrl + \ key combination and activate debugging once pressed*/
document.onkeypress = function(evt){
	if (!evt) {
        evt = window.event;
    }
	if(evt.ctrlKey==1 && evt.keyCode == 28){
		//Activate blackbird logging
		if(log && log.activateLogging){
			log.activateLogging();
		}
	}
};
/*
 * Overriding the browsers ability to catch errors so we can handle them how we would like.
 */
window.onerror = function(message, file, lineNumber) {
	var errorModal = null;
	var refreshButton = null;
	var closeButton = null;

	//Log the error message to the JSLogger
	MP_Util.LogError(i18n.UNEXPECTED_ERROR_CAUGHT + "<br />" + i18n.discernabu.JS_ERROR + ": " + message + "<br />" + i18n.FILE + ": " + file + "<br />" + i18n.LINE_NUMBER + ": " + lineNumber);

	//Throw the error when we are developing in a browser
	if(CERN_BrowserDevInd) {
		throw (new Error(i18n.UNEXPECTED_ERROR_CAUGHT + "<br />" + i18n.discernabu.JS_ERROR + ": " + message + "<br />" + i18n.FILE + ": " + file + "<br />" + i18n.LINE_NUMBER + ": " + lineNumber));
	}
	else {
		//Create a modal dialog and ask the user if they would like to refresh or continue
		errorModal = MP_ModalDialog.retrieveModalDialogObject("errorModal");
		if(!errorModal) {
			errorModal = MP_Util.generateModalDialogBody("errorModal", "error", i18n.PAGE_ERROR, i18n.PAGE_ERROR_ACTION);
			errorModal.setHeaderTitle(i18n.ERROR_OCCURED);
			//Create and add the refresh button
			refreshButton = new ModalButton("refreshButton");
			refreshButton.setText(i18n.REFRESH).setCloseOnClick(true);
			refreshButton.setOnClickFunction(function() {
				//Refresh the page
				var cclParams = [];
				var criterion = JSON.parse(m_criterionJSON).CRITERION;
				if( typeof m_viewpointJSON == "undefined") {
					cclParams = ["^MINE^", criterion.PERSON_ID + ".0", criterion.ENCNTRS[0].ENCNTR_ID + ".0", criterion.PRSNL_ID + ".0", criterion.POSITION_CD + ".0", criterion.PPR_CD + ".0", "^" + criterion.EXECUTABLE + "^", "^^", "^" + criterion.STATIC_CONTENT.replace(/\\/g, "\\\\") + "^", "^" + criterion.CATEGORY_MEAN + "^", criterion.DEBUG_IND];
					CCLLINK("MP_DRIVER", cclParams.join(","), 1);
				}
				else {
					var viewpointJSON = JSON.parse(m_viewpointJSON).VIEWPOINTINFO_REC;
					cclParams = ["^MINE^", criterion.PERSON_ID + ".0", criterion.ENCNTRS[0].ENCNTR_ID + ".0", criterion.PRSNL_ID + ".0", criterion.POSITION_CD + ".0", criterion.PPR_CD + ".0", "^" + criterion.EXECUTABLE + "^", "^" + criterion.STATIC_CONTENT.replace(/\\/g, "\\\\") + "^", "^" + viewpointJSON.VIEWPOINT_NAME_KEY + "^", criterion.DEBUG_IND, "^^", 0, "^" + viewpointJSON.ACTIVE_VIEW_CAT_MEAN + "^"];
					CCLLINK(CERN_driver_script, cclParams.join(","), 1);
				}
			});


			errorModal.addFooterButton(refreshButton);
			//Create and add the close button
			closeButton = new ModalButton("closeButton");
			closeButton.setText(i18n.CLOSE).setCloseOnClick(true);
			errorModal.addFooterButton(closeButton);
		}
		MP_ModalDialog.updateModalDialogObject(errorModal);
		MP_ModalDialog.showModalDialog("errorModal");

		//Returning true supresses the error in FireFox and IE but allows it to propegate in Chrome
		return true;
	}
};

/**
 * Core utility methods
 * @namespace
 */
var MP_Core = function() {
	return {
		

		/**
		 * This function returns the appropriate result object.
		 * @param result - is the MP_Core.Measurement object.
		 * @param codeArray -  The array has the code values corresponding to the result object.
		 * @param dateMask - This consists of the required date format.
		 */
		GetString: function(result, codeArray, dateMask, excludeUOM) {
			var obj = ( result instanceof MP_Core.Measurement) ? result.getResult() : MP_Util.Measurement.GetObject(result, codeArray);
			if ( obj instanceof MP_Core.QuantityValue) {
				if (excludeUOM) {
					return obj.getValue();
				}
				return obj.toString();
			}
			else if ( obj instanceof Date) {
				return obj.format(dateMask);
			}
			return obj;
		},

		/**
		 * This function checks for the appropriate result type.
		 * @param result - is the MP_Core.Measurement object.
		 * @param codeArray -  The array has the code values corresponding to the result object.
		 */
		GetObject: function(result, codeArray) {
			switch (result.CLASSIFICATION.toUpperCase()) {
				case "QUANTITY_VALUE":
					return new GetQuantityValue(result, codeArray);
				case "STRING_VALUE":
					return new GetStringValue(result);
				case "DATE_VALUE":
					//we are currently not returning any date_value results. a common method shall be implemented if/when necessary
					return new GetDateValue(result);
				case "CODIFIED_VALUES":
				case "CODE_VALUE":
					return new GetCodedResult(result);
				case "ENCAPSULATED_VALUE":
					return new GetEncapsulatedValue(result);
			}
		},
		/**
		 * @param {Object} num Numeric to format
		 * @param {Object} dec Number of decimal places to retain.
		 * @deprecated Use mp_formatter.NumericFormatter.
		 */
		SetPrecision: function(num, dec) {
			var nf = MP_Util.GetNumericFormatter();
			//'^' to not comma seperate values, and '.' for defining the precision
			return nf.format(num, "^." + dec);
		},
		/**
		 * This function associates the proper style to the result if the result has a modifies status.
		 * @param result - is the MP_Core.Measurement object.
		 */

		GetModifiedIcon: function(result) {
			return (result.isModified()) ? "<span class='res-modified'>&nbsp;</span>" : "";
		},
		/**
		 * This function returns the normalcy class associated with the result
		 * @param result - is the MP_Core.Measurement object.
		 */

		GetNormalcyClass: function(result) {
			var normalcy = "res-normal";
			var normalcyMeaning = result.getNormalcy();
			if (normalcyMeaning) {
				switch (normalcyMeaning.meaning) {
					case "LOW":
						normalcy = "res-low";
						break;
					case "HIGH":
						normalcy = "res-high";
						break;
					case "ABNORMAL":
						normalcy = "res-abnormal";
						break;
					case "CRITICAL":
					case "EXTREMEHIGH":
					case "PANICHIGH":
					case "EXTREMELOW":
					case "PANICLOW":
					case "VABNORMAL":
					case "POSITIVE":
						normalcy = "res-severe";
						break;
				}
			}
			return normalcy;
		},
		/**
		 * This function associates appropriate styles to the results.
		 * @param result - is the MP_Core.Measurement object.
		 * @param excludeUOM - This value indicates whether to add the Unit of measurement or not.
		 */
		GetNormalcyResultDisplay: function(result, excludeUOM) {
			var ar = ["<span class='", MP_Core.GetNormalcyClass(result), "'><span class='res-ind'>&nbsp;</span><span class='res-value'>", MP_Core.GetEventViewerLink(result, MP_Util.Measurement.GetString(result, null, "longDateTime2", excludeUOM)), "</span>", MP_Util.Measurement.GetModifiedIcon(result), "</span>"];
			return ar.join("");
		},
		/**
		 * This function links the result viewer to the respective results.
		 * @param result - is the MP_Core.Measurement object.
		 * @param sResultDisplay - This contains the  value that needs to be displayed.
		 */
		GetEventViewerLink: function(result, sResultDisplay) {
			var params = [result.getPersonId(), result.getEncntrId(), result.getEventId(), "\"EVENT\""];
			var ar = ["<a onclick='MP_Util.LaunchClinNoteViewer(", params.join(","), "); return false;' href='#'>", sResultDisplay, "</a>"];
			return ar.join("");
		},

		/**
		 * This function retrieves the "encapsulated_value" type of results.
		 * @param result - is the MP_Core.Measurement object.
		 */
		GetEncapsulatedValue: function(result) {
			var ar = [];
			var encap = result.ENCAPSULATED_VALUE;
			if (encap && encap.length > 0) {
				for (var n = 0, nl = encap.length; n < nl; n++) {
					var txt = encap[n].TEXT_PLAIN;
					if (txt){
						ar.push(txt);
					}
						
				}
			}
			return ar.join("");
		},

		/**
		 * This function retrieves the "quantity_value" type of results.
		 * @param result - is the MP_Core.Measurement object.
		 * @param codeArray -  The array has the code values corresponding to the result object.
		 */
		GetQuantityValue: function(result, codeArray) {
			var qv = new MP_Core.QuantityValue();
			qv.init(result, codeArray);
			return qv;
		},
		/**
		 * This function retrieves the "date_value" type of results.
		 * @param result - is the MP_Core.Measurement object.
		 */
		GetDateValue: function(result) {
			for (var x = 0, xl = result.DATE_VALUE.length; x < xl; x++) {
				var date = result.DATE_VALUE[x];
				if (date.DATE) {
					var dateTime = new Date();
					dateTime.setISO8601(date.DATE);
					return dateTime;
				}
			}
			return null;
		},
		/**
		 * This function retrieves the "code_value" type of results.
		 * @param result - is the MP_Core.Measurement object.
		 */
		GetCodedResult: function(result) {
			var cdValue = result.CODE_VALUE;
			var ar = [];
			for (var n = 0, nl = cdValue.length; n < nl; n++) {
				var values = cdValue[n].VALUES;
				for (var p = 0, pl = values.length; p < pl; p++) {
					ar.push(values[p].SOURCE_STRING);
				}
				var sOther = cdValue[n].OTHER_RESPONSE;
				if (sOther){
					ar.push(sOther);
					}
					
			}
			return ar.join(", ");
		},

		/**
		 * This function retrieves the "string_value" type of results.
		 * @param result - is the MP_Core.Measurement object.
		 */
		GetStringValue: function(result) {
			var strValue = result.STRING_VALUE;
			var ar = [];
			for (var n = 0, nl = strValue.length; n < nl; n++) {
				ar.push(strValue[n].VALUE);
			}
			return ar.join(", ");
		},
		/**
		 * The criterion object stores information about the request in context such as the patient/person, encounter/visit,
		 * provider/personnel, relationship etc.
		 */
		Criterion : function(jsCrit, static_content) {
			var m_patInfo = null;
			var m_prsnlInfo = null;
			var m_periop_cases = null;
			var m_encntrOverride = [];

			this.person_id = jsCrit.PERSON_ID;
			this.encntr_id = (jsCrit.ENCNTRS.length > 0) ? jsCrit.ENCNTRS[0].ENCNTR_ID : 0;
			this.provider_id = jsCrit.PRSNL_ID;
			this.executable = jsCrit.EXECUTABLE;
			this.static_content = static_content;
			this.position_cd = jsCrit.POSITION_CD;
			this.ppr_cd = jsCrit.PPR_CD;
			this.debug_ind = jsCrit.DEBUG_IND;
			CERN_BrowserDevInd = (parseInt(this.debug_ind, 10) & 0x01 === 1) ? true : false;
			this.help_file_local_ind = jsCrit.HELP_FILE_LOCAL_IND;
			this.category_mean = jsCrit.CATEGORY_MEAN;
			this.locale_id = (this.debug_ind) ? "en_us" : jsCrit.LOCALE_ID;
			//@deprecated as of 3.3.1 and should be removed as of greater than or equal to 3.4
			this.device_location = "";

			var encntrOR = jsCrit.ENCNTR_OVERRIDE;

			if(encntrOR) {
				for(var x = encntrOR.length; x--; ) {
					m_encntrOverride.push(encntrOR[x].ENCNTR_ID);
				}
			}
			else {
				m_encntrOverride.push(this.encntr_id);
			}

			this.setPatientInfo = function(value) {
				m_patInfo = value;
			};


			this.getPatientInfo = function() {
				return m_patInfo;
			};


			this.setPeriopCases = function(value) {
				m_periop_cases = value;
			};


			this.getPeriopCases = function() {
				return m_periop_cases;
			};


			this.getPersonnelInfo = function() {
				if(!m_prsnlInfo) {
					m_prsnlInfo = new MP_Core.PersonnelInformation(this.provider_id, this.person_id);
				}
				return m_prsnlInfo;
			};

			/**
			 * @return List of encounters that are considered 'ACTIVE'.
			 * In the rare case that encounter override is needed, this will return the encounter neccessary to pass
			 * to a service for retrieval of data.
			 */
			this.getEncounterOverride = function() {
				return m_encntrOverride;
			};

		},
		PatientInformation: function() {
			var m_dob = null;
			var m_sex = null;

			this.setSex = function(value) {
				m_sex = value;
			};
			this.getSex = function() {
				return m_sex;
			};
			this.setDOB = function(value) {
				m_dob = value;
			};
			this.getDOB = function() {
				return m_dob;
			};
		},

		PeriopCases: function() {
			var m_case_id = null;
			var m_prior_ind = null;
			var m_days = null;
			var m_hours = null;
			var m_mins = null;
			var m_cntdwn_desc_flag = null;

			this.setCaseID = function(value) {
				m_case_id = value;
			};
			this.getCaseID = function() {
				return m_case_id;
			};
			this.setDays = function(value) {
				m_days = value;
			};
			this.getDays = function() {
				return m_days;
			};
			this.setHours = function(value) {
				m_hours = value;
			};
			this.getHours = function() {
				return m_hours;
			};
			this.setMins = function(value) {
				m_mins = value;
			};
			this.getMins = function() {
				return m_mins;
			};
			this.setCntdwnDscFlg = function(value) {
				m_cntdwn_desc_flag = value;
			};
			this.getCntdwnDscFlg = function() {
				return m_cntdwn_desc_flag;
			};
		},

		ScriptRequest: function(component, loadTimerName) {
			var m_comp = component;
			var m_load = loadTimerName;
			var m_name = "";
			var m_programName = "";
			var m_params = null;
			var m_async = true;
			var m_responseHandler = null;
			var m_timer = null;
			var m_source = null;
			
			this.logCompletion = function(reply) {
				MP_Util.LogInfo("<b>Request Ended</b><br /><ul>" +
						"<li>program: " + m_programName +"</li>" +
						"<li>end_time: " + new Date() + "</li>"+
						"<li>status: " + reply.status + "</li></ul>");					
			};
			
			this.logStart = function() {
				MP_Util.LogInfo("<b>Request Started</b><br /><ul>" +
						"<li>program: " + m_programName +"</li>" +
						"<li>start_time: " + new Date() + "</li></ul>");	
			};
			
			this.start = function() {
				var request = CERN_BrowserDevInd ? new XMLHttpRequest() : new XMLCclRequest();
				var self = this;
				request.onreadystatechange = function(){
					//Ignore all states except 4 (finished)
					if(this.readyState !== 4) {
						return;
					}
					self.logCompletion(this);
					//Notify of completion
					self.notify();
					try {
						//If we have a response handler, use it to handle the response object
						if(self.getResponseHandler()) {
							self.getResponseHandler().handleResponse(this);
						}
					} catch(exe) {
						if(self.getTimer()) {
							self.getTimer().abort();
						}
					} finally {
						if(self.getTimer()) {
							self.getTimer().stop();
						}
					}
					MP_Util.ReleaseRequestReference(this);
				};
				//If this request has a timer, start it now
				if(this.getTimer()) {
					this.getTimer().start();
				}
				this.logStart();
				//If in browser, use an http request
				if (CERN_BrowserDevInd) {
					var url = this.getProgramName() + "?parameters=" + this.getParameters().join(",");
				    request.open("GET", url, self.isAsync());
				    request.send(null);
				} else {
					request.open("GET", this.getProgramName(), this.isAsync());
				    request.send(this.getParameters().join(","));
				}
			};
			
			this.notify = function() {
				//We only notify the manager if the request was started by the manager
				if(this.getSource() !== RequestManager.SOURCE) {
					return;
				}
				MP_RequestManager.notify();
			};
			
			this.getResponseHandler = function() {
				return m_responseHandler;
			};
			
			this.setResponseHandler = function(responseHandler) {
				m_responseHandler = responseHandler;
			};
			
			this.getTimer = function() {
				return m_timer;
			};
			
			this.setTimer = function(timer) {
				m_timer = timer;
			};

			this.getComponent = function() {
				return m_comp;
			};
			this.getLoadTimer = function() {
				return m_load;
			};
			this.setName = function(value) {
				m_name = value;
			};
			this.getName = function() {
				return m_name;
			};
			this.setProgramName = function(value) {
				m_programName = value;
			};
			this.getProgramName = function() {
				return m_programName;
			};
			this.setParameters = function(value) {
				m_params = value;
			};
			this.getParameters = function() {
				return m_params;
			};
			this.setAsync = function(value) {
				m_async = value;
			};
			this.isAsync = function() {
				return m_async;
			};
			this.getSource = function() {
				return m_source;
			};
			this.setSource = function(source) {
				m_source = source;
			};
		},
		ScriptReply: function(component) {
			//used to syne a request to a reply
			var m_name = "";
			//by default every script reply is 'f'ailed unless otherwise noted
			var m_status = "F";
			var m_err = "";
			var m_resp = null;
			var m_comp = component;

			this.setName = function(value) {
				m_name = value;
			};
			this.getName = function() {
				return m_name;
			};
			this.setStatus = function(value) {
				m_status = value;
			};
			this.getStatus = function() {
				return m_status;
			};
			this.setError = function(value) {
				m_err = value;
			};
			this.getError = function() {
				return m_err;
			};
			this.setResponse = function(value) {
				m_resp = value;
			};
			this.getResponse = function() {
				return m_resp;
			};
			this.getComponent = function() {
				return m_comp;
			};
		},
		PersonnelInformation: function(prsnlId, patientId) {
			var m_prsnlId = prsnlId;
			//if m_viewableEncntrs remains null, error in retrieval of viewable encntr
			var m_viewableEncntrs = null;
			//load valid encounter list from patcon wrapper
			var patConObj = null;
			try {
				patConObj = window.external.DiscernObjectFactory("PVCONTXTMPAGE");
				MP_Util.LogDiscernInfo(null, "PVCONTXTMPAGE", "mp_core.js", "PersonnelInformation");
				if (patConObj) {
					m_viewableEncntrs = patConObj.GetValidEncounters(patientId);
					MP_Util.LogDebug("Viewable Encounters: " + m_viewableEncntrs);
				}
			}
			catch (e) {
			}
			finally {
				//release used memory
				patConObj = null;
			}

			this.getPersonnelId = function() {
				return m_prsnlId;
			};
			/**
			 * Returns the associated encounter that the provide has the ability to see
			 */
			this.getViewableEncounters = function() {
				return m_viewableEncntrs;
			};
		},
		XMLCclRequestWrapper: function(component, program, paramAr, async) {
			var request = new MP_Core.ScriptRequest(component, component.getComponentLoadTimerName());
			request.setProgramName(program);
			request.setParameters(paramAr);
			request.setAsync(async);
			MP_Core.XmlStandardRequest(component, request, null);
		},
		/**
		 * As a means in which to provide the consumer to handle the response of the script request, this method
		 * provide an encapsulated means in which to call the XMLCCLRequest and return a ReplyObject with data
		 * about the response that can be utilized for evaluation.
		 * @param component [REQUIRED] The component in which is executing the request
		 * @param request [REQUIRED] The Request Object containing the information about the script being executed
		 * @param funcCallBack [REQUIRED] The function to execute once the execution of the request has been completed
		 */
		XMLCCLRequestCallBack: function(component, request, funcCallback) {
			//Use the new standard request system
			MP_Core.XmlStandardRequest(component, request, funcCallback);						
		},
		XmlStandardRequest: function(component, request, callback){
			var i18nCore = i18n.discernabu;
			var errMsg = [];
			var renderTimer = null;
			var responseHandler = null;
			var replyObject = null;
			var recordData = null;
			//Helper function to create an error message from a reply
			function getErrorMessage(reply) {
				var errorMessage = [];
				var ss = null;
				errorMessage.push("<b>", i18nCore.DISCERN_ERROR, "</b><br /><ul><li>", i18nCore.STATUS, ": ", reply.status, "</li><li>", i18nCore.REQUEST, ": ", reply.requestText, "</li>");
				var statusData = recordData.STATUS_DATA;
				if (statusData.SUBEVENTSTATUS.length && statusData.SUBEVENTSTATUS.length > 0) {
					for (var x = 0, xl = statusData.SUBEVENTSTATUS.length; x < xl; x++) {
						ss = statusData.SUBEVENTSTATUS[x];
						errorMessage.push("<li>", i18nCore.ERROR_OPERATION, ": ", ss.OPERATIONNAME, "</li><li>", i18nCore.ERROR_OPERATION_STATUS, ": ", ss.OPERATIONSTATUS, "</li><li>", i18nCore.ERROR_TARGET_OBJECT, ": ", ss.TARGETOBJECTNAME, "</li><li>", i18nCore.ERROR_TARGET_OBJECT_VALUE, ": ", ss.TARGETOBJECTVALUE, "</li>");
					}
				}
				else if (statusData.SUBEVENTSTATUS.length === undefined) {
					ss = statusData.SUBEVENTSTATUS;
					errorMessage.push("<li>", i18nCore.ERROR_OPERATION, ": ", ss.OPERATIONNAME, "</li><li>", i18nCore.ERROR_OPERATION_STATUS, ": ", ss.OPERATIONSTATUS, "</li><li>", i18nCore.ERROR_TARGET_OBJECT, ": ", ss.TARGETOBJECTNAME, "</li><li>", i18nCore.ERROR_TARGET_OBJECT_VALUE, ": ", ss.TARGETOBJECTVALUE, "</li>");
				}
				errorMessage.push("</ul>");
				return errorMessage;
			}
			//Create a new custom response handler
			responseHandler = new CustomResponseHandler();
			replyObject = new MP_Core.ScriptReply(component);
			replyObject.setName(request.getName());
			//Set the timer on the request. It will not start until the request is started.
			request.setTimer(new RequestTimer().setTimerName(request.getLoadTimer()).setSubTimerName((component && MPageComponent.prototype.isPrototypeOf(component)) ? component.getCriterion().category_mean : null));
			//Set the success response handler. This occurs when a script was successfully executed and returned
			responseHandler.setSuccessHandler(function(reply){
				try {
					MP_Util.LogScriptCallInfo(component, reply, "mp_core.js", "XmlStandardRequest");
					var jsonEval = JSON.parse(reply.responseText);
					recordData = jsonEval.RECORD_DATA;
					//Set the response and status
					replyObject.setResponse(recordData);
					replyObject.setStatus(recordData.STATUS_DATA.STATUS);
					//No data
					if (recordData.STATUS_DATA.STATUS == "Z") {
						if(component && MPageComponent.prototype.isPrototypeOf(component) && !callback) {
							component.finalizeComponent(MP_Util.HandleNoDataResponse(component.getStyles().getNameSpace()), (component.isLineNumberIncluded() ? "(0)" : ""));
						}
					}
					//Successful return with data
					else if (recordData.STATUS_DATA.STATUS == "S") {
						//Attempt to render the component with this successful return
						try {
							//If we are given a component and it is an MPageComponent, we render it
							if(component && MPageComponent.prototype.isPrototypeOf(component) && !callback) {
								renderTimer = MP_Util.CreateTimer(component.getComponentRenderTimerName(), component.getCriterion().category_mean);
								var secTitle = Util.Style.g("sec-total", component.getRootComponentNode(), "span");
								secTitle[0].innerHTML = i18nCore.RENDERING_DATA + "...";
								//Call the generic component loading renderComponent function so the component can render its content.
								component.renderComponent(recordData);
							}
						}
						catch (err) {
							MP_Util.LogJSError(err, component, "mp_core.js", "XmlStandardRequest");
							if(renderTimer) {
								renderTimer.Abort();
								renderTimer = null;
							}
							throw (err);
						} finally {
							if(renderTimer) {
								renderTimer.Stop();
							}
						}
					}
					//Neither Z or S, so we consider this a problem
					else {
						MP_Util.LogScriptCallError(component, reply, "mp_core.js", "XmlStandardRequest");
						//Get the error message from the reply
						errMsg = getErrorMessage(reply);
						replyObject.setError(errMsg.join(""));
						if(component && MPageComponent.prototype.isPrototypeOf(component) && !callback) {
							component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("")), (component.isLineNumberIncluded() ? "(0)" : ""));
						}
					}
					//If a callback was provided, do that now.
					if(callback && typeof callback === "function") {
						callback(replyObject);
					}
				} catch (err) {
					MP_Util.LogJSError(err, component, "mp_core.js", "XMLCclRequestWrapper");
					errMsg = [];
					errMsg.push("<b>", i18nCore.JS_ERROR, "</b><br /><ul><li>", i18nCore.MESSAGE, ": ", err.message, "</li><li>", i18nCore.NAME, ": ", err.name, "</li><li>", i18nCore.NUMBER, ": ", (err.number & 0xFFFF), "</li><li>", i18nCore.DESCRIPTION, ": ", err.description, "</li></ul>");
					if(component && MPageComponent.prototype.isPrototypeOf(component)) {
						component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("")), "");
					}
					//Throw the error so it will be caught by the ResponseHandler
					throw (err);
				} finally {
					if(component && typeof component.postProcessing != "undefined"){
						//After the component has rendered call the postProcessing function to perform any additional actions
						component.postProcessing();
					}
				}
			});
			//Set the request error handler. This occurs when there was an error in performing the script request.
			responseHandler.setErrorHandler(function(reply){
				MP_Util.LogScriptCallError(component, reply, "mp_core.js", "XMLCclRequestWrapper");
				errMsg = [];
				errMsg.push("<b>", i18nCore.DISCERN_ERROR, "</b><br /><ul><li>", i18nCore.STATUS, ": ", reply.status, "</li><li>", i18nCore.REQUEST, ": ", reply.requestText, "</li></ul>");
				replyObject.setError(errMsg.join(""));
				if(component && MPageComponent.prototype.isPrototypeOf(component) && !callback) {
					component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("")), "");
				}
				if(callback && typeof callback === "function") {
					callback(replyObject);
				}
				if(component && typeof component.postProcessing != "undefined"){
					//After the component has rendered call the postProcessing function to perform any additional actions
					component.postProcessing();
				}
			});
			//Set the response handler to the custom one we made above
			request.setResponseHandler(responseHandler);
			MP_RequestManager.performRequest(request);
		},
		XMLCCLRequestThread: function(name, component, request) {
			var m_name = name;
			var m_comp = component;

			var m_request = request;
			m_request.setName(name);

			this.getName = function() {
				return m_name;
			};
			this.getComponent = function() {
				return m_comp;
			};
			this.getRequest = function() {
				return m_request;
			};
		},
		XMLCCLRequestThreadManager: function(callbackFunction, component, handleFinalize) {
			var m_threads = null;
			var m_replyAr = null;

			var m_isData = false;
			var m_isError = false;

			this.addThread = function(thread) {
				if (!m_threads) {
					m_threads = [];
				}
				m_threads.push(thread);
			};

			this.begin = function() {
				if (m_threads && m_threads.length > 0) {
					for ( x = m_threads.length; x--; ) {
						//start each xmlcclrequest
						var thread = m_threads[x];
						MP_Core.XMLCCLRequestCallBack(thread.getComponent(), thread.getRequest(), this.completeThread);
					}
				}
				else {
					if (handleFinalize) {
						var countText = (component.isLineNumberIncluded() ? "(0)" : "");
						component.finalizeComponent(MP_Util.HandleNoDataResponse(component.getStyles().getNameSpace()), countText);
						//After the component has rendered call the postProcessing function to perform any additional actions
						component.postProcessing();
					}
					else {
						callbackFunction(null, component);
					}
				}
			};

			this.completeThread = function(reply) {
				if (!m_replyAr) {
					m_replyAr = [];
				}
				if (reply.getStatus() === "S") {
					m_isData = true;
				}
				else if (reply.getStatus() === "F") {
					m_isError = true;
				}

				m_replyAr.push(reply);
				if (m_replyAr.length === m_threads.length) {
					var countText = (component.isLineNumberIncluded() ? "(0)" : "");
					var errMsg = null;
					try {
						if (handleFinalize) {
							if (m_isError) {
								//handle error response
								errMsg = [];
								for (var x = m_replyAr.length; x--; ) {
									var rep = m_replyAr[x];
									if (rep.getStatus() === "F") {
										errMsg.push(rep.getError());
									}
								}
								component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("<br />")), "");
							}
							else if (!m_isData) {
								//handle no data
								countText = (component.isLineNumberIncluded() ? "(0)" : "");
								component.finalizeComponent(MP_Util.HandleNoDataResponse(component.getStyles().getNameSpace()), countText);
							}
							else {
								callbackFunction(m_replyAr, component);
							}
						}
						else {
							callbackFunction(m_replyAr, component);
						}
					}
					catch(err) {
						MP_Util.LogJSError(err, component, "mp_core.js", "XMLCCLRequestThreadManager");
						var i18nCore = i18n.discernabu;
						errMsg = ["<b>", i18nCore.JS_ERROR, "</b><br /><ul><li>", i18nCore.MESSAGE, ": ", err.message, "</li><li>", i18nCore.NAME, ": ", err.name, "</li><li>", i18nCore.NUMBER, ": ", (err.number & 0xFFFF), "</li><li>", i18nCore.DESCRIPTION, ": ", err.description, "</li></ul>"];
						component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("")), "");
					}
					finally {
						if(component && typeof component.postProcessing != "undefined") {
							//After the component has rendered call the postProcessing function to perform any additional actions
							component.postProcessing();
						}
					}
				}
			};
		},
		MapObject: function(name, value) {
			this.name = name;
			this.value = value;
		},
		/**
		 * An object to store the attributes of a single tab.
		 * @param {Object} key The id associated to the tab.
		 * @param {Object} name The name to be displayed on the tab.
		 * @param {Object} components The components to be associated to the tab.
		 */
		TabItem: function(key, name, components, prefIdentifier) {
			this.key = key;
			this.name = name;
			this.components = components;
			this.prefIdentifier = prefIdentifier;
		},
		TabManager: function(tabItem) {
			var m_isLoaded = false;
			var m_tabItem = tabItem;
			//By default a tab and all it's components are not fully expanded
			var m_isExpandAll = false;
			var m_isSelected = false;
			this.toggleExpandAll = function() {
				m_isExpandAll = (!m_isExpandAll);
			};
			this.loadTab = function() {
				if (!m_isLoaded) {
					m_isLoaded = true;
					var components = m_tabItem.components;
					if (components) {
						for (var xl = 0; xl < components.length; xl++) {
							var component = components[xl];
							if (component.isDisplayable() && component.isExpanded()) {
								component.InsertData();
							}
						}
						for (var xl = 0; xl < components.length; xl++) {
							var component = components[xl];
							if (component.isDisplayable() && !component.isExpanded()) {
								component.InsertData();
							}
						}
					}
				}
			};
			this.getTabItem = function() {
				return m_tabItem;
			};
			this.getSelectedTab = function() {
				return m_isSelected;
			};
			this.setSelectedTab = function(value) {
				m_isSelected = value;
			};
		},
		ReferenceRangeResult: function() {
			//results
			var m_valNLow = -1, m_valNHigh = -1, m_valCLow = -1, m_valCHigh = -1;
			//units of measure
			var m_uomNLow = null, m_uomNHigh = null, m_uomCLow = null, m_uomCHigh = null;
			this.init = function(refRange, codeArray) {
				var nf = MP_Util.GetNumericFormatter();
				m_valCLow = nf.format(refRange.CRITICAL_LOW.NUMBER);
				if (refRange.CRITICAL_LOW.UNIT_CD != "") {
					m_uomCLow = MP_Util.GetValueFromArray(refRange.CRITICAL_LOW.UNIT_CD, codeArray);
				}
				m_valCHigh = nf.format(refRange.CRITICAL_HIGH.NUMBER);
				if (refRange.CRITICAL_HIGH.UNIT_CD != "") {
					m_uomCHigh = MP_Util.GetValueFromArray(refRange.CRITICAL_HIGH.UNIT_CD, codeArray);
				}
				m_valNLow = nf.format(refRange.NORMAL_LOW.NUMBER);
				if (refRange.NORMAL_LOW.UNIT_CD != "") {
					m_uomNLow = MP_Util.GetValueFromArray(refRange.NORMAL_LOW.UNIT_CD, codeArray);
				}
				m_valNHigh = nf.format(refRange.NORMAL_HIGH.NUMBER);
				if (refRange.NORMAL_HIGH.UNIT_CD != "") {
					m_uomNHigh = MP_Util.GetValueFromArray(refRange.NORMAL_HIGH.UNIT_CD, codeArray);
				}
			};
			this.getNormalLow = function() {
				return m_valNLow;
			};
			this.getNormalHigh = function() {
				return m_valNHigh;
			};
			this.getNormalLowUOM = function() {
				return m_uomNLow;
			};
			this.getNormalHighUOM = function() {
				return m_uomNHigh;
			};
			this.getCriticalLow = function() {
				return m_valCLow;
			};
			this.getCriticalHigh = function() {
				return m_valCHigh;
			};
			this.getCriticalLowUOM = function() {
				return m_uomCLow;
			};
			this.getCriticalHighUOM = function() {
				return m_uomCHigh;
			};
			this.toNormalInlineString = function() {
				var low = (m_uomNLow) ? m_uomNLow.display : "";
				var high = (m_uomNHigh) ? m_uomNHigh.display : "";
				if (m_valNLow != 0 || m_valNHigh != 0) {
					return (m_valNLow + "&nbsp;" + low + " - " + m_valNHigh + "&nbsp;" + high);
				}
				else {
					return "";
				}
			};
			this.toCriticalInlineString = function() {
				var low = (m_uomCLow) ? m_uomCLow.display : "";
				var high = (m_uomCHigh) ? m_uomCHigh.display : "";
				if (m_valCLow != 0 || m_valCHigh != 0) {
					return (m_valCLow + "&nbsp;" + low + " - " + m_valCHigh + "&nbsp;" + high);
				}
				else {
					return "";
				}
			};
		},

		QuantityValue: function() {
			var m_val, m_precision;
			var m_uom = null;
			var m_refRange = null;
			var m_rawValue = 0;
			var m_hasModifier = false;
			this.init = function(result, codeArray) {
				var quantityValue = result.QUANTITY_VALUE;
				var referenceRange = result.REFERENCE_RANGE;
				for (var l = 0, ll = quantityValue.length; l < ll; l++) {
					var numRes = quantityValue[l].NUMBER;
					m_precision = quantityValue[l].PRECISION;
					if (!isNaN(numRes)) {
						m_val = MP_Util.Measurement.SetPrecision(numRes, m_precision);
						m_rawValue = numRes;
					}
					if (quantityValue[l].MODIFIER_CD != "") {
						var modCode = MP_Util.GetValueFromArray(quantityValue[l].MODIFIER_CD, codeArray);
						if (modCode) {
							m_val = modCode.display + m_val;
							m_hasModifier = true;
						}
					}
					if (quantityValue[l].UNIT_CD != "") {
						m_uom = MP_Util.GetValueFromArray(quantityValue[l].UNIT_CD, codeArray);
					}
					for (var m = 0, ml = referenceRange.length; m < ml; m++) {
						m_refRange = new MP_Core.ReferenceRangeResult();
						m_refRange.init(referenceRange[m], codeArray);
					}
				}
			};

			this.getValue = function() {
				return m_val;
			};
			this.getRawValue = function() {
				return m_rawValue;
			};
			this.getUOM = function() {
				return m_uom;
			};
			this.getRefRange = function() {
				return m_refRange;
			};
			this.getPrecision = function() {
				return m_precision;
			};
			this.toString = function() {
				if (m_uom) {
					return (m_val + " " + m_uom.display);
				}
				return m_val;
			};
			this.hasModifier = function() {
				return m_hasModifier;
			};
		},
		//measurement.init(meas.EVENT_ID, meas.PERSON_ID, meas.ENCNTR_ID, eventCode, dateTime, MP_Util.Measurement.GetObject(meas.MEASUREMENTS[k], codeArray));
		Measurement: function() {
			var m_eventId = 0.0;
			var m_personId = 0.0;
			var m_encntrId = 0.0;
			var m_eventCode = null;
			var m_dateTime = null;
			var m_updateDateTime = null;
			var m_result = null;
			var m_normalcy = null;
			var m_status = null;
			var m_comment = "";

			this.init = function(eventId, personId, encntrId, eventCode, dateTime, resultObj, updateDateTime) {
				m_eventId = eventId;
				m_personId = personId;
				m_encntrId = encntrId;
				m_eventCode = eventCode;
				m_dateTime = dateTime;
				m_result = resultObj;
				m_updateDateTime = updateDateTime;
			};

			this.initFromRec = function(measObj, codeArray) {
				var effectiveDateTime = new Date();
				var updateDateTime = new Date();
				m_eventId = measObj.EVENT_ID;
				m_personId = measObj.PATIENT_ID;
				m_encntrId = measObj.ENCOUNTER_ID;
				m_eventCode = MP_Util.GetValueFromArray(measObj.EVENT_CD, codeArray);
				effectiveDateTime.setISO8601(measObj.EFFECTIVE_DATE);
				m_dateTime = effectiveDateTime;
				m_result = MP_Util.Measurement.GetObject(measObj, codeArray);
				updateDateTime.setISO8601(measObj.UPDATE_DATE);
				m_updateDateTime = updateDateTime;
				m_normalcy = MP_Util.GetValueFromArray(measObj.NORMALCY_CD, codeArray);
				m_status = MP_Util.GetValueFromArray(measObj.STATUS_CD, codeArray);
				m_comment = measObj.COMMENT;
			};

			this.getEventId = function() {
				return m_eventId;
			};
			this.getPersonId = function() {
				return m_personId;
			};
			this.getEncntrId = function() {
				return m_encntrId;
			};
			this.getEventCode = function() {
				return m_eventCode;
			};
			this.getDateTime = function() {
				return m_dateTime;
			};
			this.getUpdateDateTime = function() {
				return m_updateDateTime;
			};
			this.getResult = function() {
				return m_result;
			};
			this.setNormalcy = function(value) {
				m_normalcy = value;
			};
			this.getNormalcy = function() {
				return m_normalcy;
			};
			this.setStatus = function(value) {
				m_status = value;
			};
			this.getStatus = function() {
				return m_status;
			};
			this.isModified = function() {
				if (m_status) {
					var mean = m_status.meaning;
					if (mean === "MODIFIED" || mean === "ALTERED") {
						return true;
					}
				}
				return false;
			};
			this.getComment = function() {
				return m_comment;
			};
		},
		MenuItem: function() {
			var m_name = "";
			var m_desc = "";
			var m_id = 0.0;
			var m_meaning;
			var m_valSequence = 0;
			//This is used as the primary grouping value for IView bands
			var m_valTypeFlag = 0;
			//This is used to determine which is the band, section, or item

			this.setDescription = function(value) {
				m_desc = value;
			};
			this.getDescription = function() {
				return m_desc;
			};
			this.setName = function(value) {
				m_name = value;
			};
			this.getName = function() {
				return m_name;
			};
			this.setId = function(value) {
				m_id = value;
			};
			this.getId = function() {
				return m_id;
			};
			this.setMeaning = function(value) {
				m_meaning = value;
			};
			this.getMeaning = function() {
				return m_meaning;
			};
			this.setValSequence = function(value) {
				m_valSequence = value;
			};
			this.getValSequence = function() {
				return m_valSequence;
			};
			this.setValTypeFlag = function(value) {
				m_valTypeFlag = value;
			};
			this.getValTypeFlag = function() {
				return m_valTypeFlag;
			};
		},
		CriterionFilters: function(criterion) {
			var m_criterion = criterion;
			var m_evalAr = [];

			this.addFilter = function(type, value) {
				m_evalAr.push(new MP_Core.MapObject(type, value));
			};
			this.checkFilters = function() {
				var pass = false;
				var patInfo = m_criterion.getPatientInfo();
				for (var x = m_evalAr.length; x--; ) {
					var filter = m_evalAr[x];
					var dob = null;
					switch (filter.name) {
						case MP_Core.CriterionFilters.SEX_MEANING:
							var sex = patInfo.getSex();
							if (sex) {
								if (filter.value == sex.meaning) {
									continue;
								}
							}
							return false;
						case MP_Core.CriterionFilters.DOB_OLDER_THAN:
							dob = patInfo.getDOB();
							if (dob) {
								if (dob <= filter.value) {
									continue;
								}
							}
							return false;
						case MP_Core.CriterionFilters.DOB_YOUNGER_THAN:
							dob = patInfo.getDOB();
							if (dob) {
								if (dob >= filter.value) {
									continue;
								}
							}
							return false;
						default:
							alert("Unhandled criterion filter");
							return false;
					}
				}
				return true;
			};
		},
		CreateSimpleError: function(component, sMessage) {
			var errMsg = [];
			var i18nCore = i18n.discernabu;
			var countText = (component.isLineNumberIncluded() ? "(0)" : "");
			errMsg.push("<b>", i18nCore.DISCERN_ERROR, "</b><br /><ul><li>", sMessage, "</li></ul>");
			component.finalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(), errMsg.join("")), countText);
			//After the component has rendered call the postProcessing function to perform any additional actions
			component.postProcessing();
		}
	};
}();
//Constants for CriterionFilter items
MP_Core.CriterionFilters.SEX_MEANING = 1;
MP_Core.CriterionFilters.DOB_OLDER_THAN = 2;
MP_Core.CriterionFilters.DOB_YOUNGER_THAN = 3;

MP_Core.AppUserPreferenceManager = function() {
	var m_criterion = null;
	var m_prefIdent = "";
	var m_jsonObject = null;

	return {
		/**
		 * Allows for the initialization of the manager to store what criterion and preference identifier to
		 * utilize for retrieval of preferences
		 * @param {Object} criterion
		 * @param {Object} preferenceIdentifier
		 */
		Initialize: function(criterion, preferenceIdentifier) {
			m_criterion = criterion;
			m_prefIdent = preferenceIdentifier;
			m_jsonObject = null;
		},
		SetPreferences: function(prefString) {
			var jsonEval = JSON.parse(prefString);
			m_jsonObject = jsonEval;
		},
		LoadPreferences: function() {
			if (!m_criterion) {
				alert("Validation Failed: the AppUserPreferenceManager must be initialized prior to usage.");
				return null;
			}
			if (m_jsonObject) {
				return;
			}
			else {
				var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
				info.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						MP_Util.LogScriptCallInfo(null, this, "mp_core.js", "LoadPreferences");
						var jsonEval = JSON.parse(this.responseText);
						var recordData = jsonEval.RECORD_DATA;
						if (recordData.STATUS_DATA.STATUS == "S") {
							m_jsonObject = JSON.parse(recordData.PREF_STRING);
						}
						else if (recordData.STATUS_DATA.STATUS == "Z") {
							return;
						}
						else {
							MP_Util.LogScriptCallError(null, this, "mp_core.js", "LoadPreferences");
							var errAr = [];
							var statusData = recordData.STATUS_DATA;
							errAr.push("STATUS: " + statusData.STATUS);
							for (var x = 0, xl = statusData.SUBEVENTSTATUS.length; x < xl; x++) {
								var ss = statusData.SUBEVENTSTATUS[x];
								errAr.push(ss.OPERATIONNAME, ss.OPERATIONSTATUS, ss.TARGETOBJECTNAME, ss.TARGETOBJECTVALUE);
							}
							window.status = "Error retrieving user preferences " + errAr.join(",");
							return;
						}
					}
					if (this.readyState == 4) {
						MP_Util.ReleaseRequestReference(this);
					}

				};

				var ar = ["^mine^", m_criterion.provider_id + ".0", "^" + m_prefIdent + "^"];
				if (CERN_BrowserDevInd) {
					var url = "MP_GET_USER_PREFS?parameters=" + ar.join(",");
					info.open("GET", url, false);
					info.send(null);
				}
				else {
					info.open('GET', "MP_GET_USER_PREFS", false);
					info.send(ar.join(","));
				}

				return;
			}
		},
		/**
		 * GetPreferences will return the users preferences for the application currently logged into.
		 */
		GetPreferences: function() {
			if (!m_criterion) {
				alert("Validation Failed: the AppUserPreferenceManager must be initialized prior to usage.");
				return null;
			}
			if (!m_jsonObject) {
				this.LoadPreferences();
			}

			return m_jsonObject;
		},
		SavePreferences: function(reload) {
			var body = document.body;
			var groups = Util.Style.g("col-group", body, "div");
			var grpId = 0;
			var colId = 0;
			var rowId = 0;
			var compId = 0;

			var jsonObject = {};
			jsonObject.user_prefs = {};
			var userPrefs = jsonObject.user_prefs;
			userPrefs.page_prefs = {};
			var pagePrefs = userPrefs.page_prefs;
			pagePrefs.components = [];
			var components = pagePrefs.components;
			var cclParams = [];

			//alert("groups.length: " + groups.length)
			for (var x = 0, xl = groups.length; x < xl; x++) {
				//TODO: be aware that when the organizer level component can be moved, this x+1 will need to be modified
				grpId = x + 1;
				//get liquid layout
				var liqLay = Util.Style.g("col-outer1", groups[x], "div");
				if (liqLay.length > 0) {
					//get each child column
					var cols = Util.gcs(liqLay[0]);
					for (var y = 0, yl = cols.length; y < yl; y++) {
						colId = y + 1;
						var rows = Util.gcs(cols[y]);
						for (var z = 0, zl = rows.length; z < zl; z++) {
							var component = {};
							rowId = z + 1;
							compId = jQuery(rows[z]).attr('id');
							var compObj = MP_Util.GetCompObjByStyleId(compId);
							component.id = compObj.getComponentId();
							component.group_seq = grpId;
							component.col_seq = colId;
							component.row_seq = rowId;
							component.preferencesObj = compObj.getPreferencesObj();
							//Since we are updating the toggle status for all components we will need to make sure all required
							//components get marked as On(1) and not required(2).  Because if the bedrock preferences change from
							//Required to On for a component the existing user prefs toggle status of Required will override the bedrock preference
							//and not allow the user to toggle that component even though they should be able to.
							component.toggleStatus = (compObj.getToggleStatus() === 2) ? 1 : compObj.getToggleStatus();
							component.grouperFilterLabel = compObj.getGrouperFilterLabel();
							component.grouperFilterCatLabel = compObj.getGrouperFilterCatLabel();
							component.grouperFilterCriteria = compObj.getGrouperFilterCriteria();
							component.grouperFilterCatalogCodes = compObj.getGrouperFilterCatalogCodes();
							component.selectedTimeFrame = compObj.getSelectedTimeFrame();
							component.selectedDataGroup = compObj.getSelectedDataGroup();
							if (jQuery(rows[z]).hasClass('closed')) {
								component.expanded = false;
							}
							else {
								component.expanded = true;
							}
							components.push(component);
						}
					}
				}
			}
			WritePreferences(jsonObject);

			if (reload !== undefined && reload === false) {
				return;
			}

			if ( typeof m_viewpointJSON == "undefined") {
				cclParams.push("^MINE^", m_criterion.person_id + ".0", m_criterion.encntr_id + ".0", m_criterion.provider_id + ".0", m_criterion.position_cd + ".0", m_criterion.ppr_cd + ".0", "^" + m_criterion.executable + "^", "^^", "^" + m_criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + m_criterion.category_mean + "^", m_criterion.debug_ind);
				CCLLINK("MP_DRIVER", cclParams.join(","), 1);
			}
			else {
				var viewpointJSON = JSON.parse(m_viewpointJSON).VIEWPOINTINFO_REC;
				m_jsonObject = jsonObject;
				cclParams.push("^MINE^", m_criterion.person_id + ".0", m_criterion.encntr_id + ".0", m_criterion.provider_id + ".0", m_criterion.position_cd + ".0", m_criterion.ppr_cd + ".0", "^" + m_criterion.executable + "^", "^" + m_criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + viewpointJSON.VIEWPOINT_NAME_KEY + "^", m_criterion.debug_ind, "^^", 0, "^" + viewpointJSON.ACTIVE_VIEW_CAT_MEAN + "^");
				CCLLINK(CERN_driver_script, cclParams.join(","), 1);
			}
		},
		ClearCompPreferences: function(componentId) {
			var compObj = MP_Util.GetCompObjById(componentId);
			var style = compObj.getStyles();
			var ns = style.getNameSpace();
			var prefObj = m_jsonObject;
			var filterArr = null;

			if (prefObj != null) {
				var strEval = JSON.parse(JSON.stringify(prefObj));
				var strObj = strEval.user_prefs.page_prefs.components;
				for (var x = strObj.length; x--; ) {
					if (strEval && strObj[x].id === componentId) {
						strObj[x].grouperFilterLabel = "";
						strObj[x].grouperFilterCatLabel = "";
						strObj[x].grouperFilterCriteria = filterArr;
						strObj[x].grouperFilterCatalogCodes = filterArr;

						strObj[x].selectedTimeFrame = "";
						strObj[x].selectedDataGroup = "";
					}
				}
				compObj.setLookbackUnits(compObj.getBrLookbackUnits());
				compObj.setLookbackUnitTypeFlag(compObj.getBrLookbackUnitTypeFlag());
				compObj.setGrouperFilterLabel("");
				compObj.setGrouperFilterCatLabel("");
				compObj.setGrouperFilterCriteria(filterArr);
				compObj.setGrouperFilterCatalogCodes(filterArr);
				compObj.setSelectedTimeFrame("");
				compObj.setSelectedDataGroup("");
				compObj.setPreferencesObj(null);
				m_jsonObject = strEval;
				WritePreferences(m_jsonObject);
				
				//Use the component's render strategy to update the view after clearing settings
				var renderStrategy = compObj.getRenderStrategy();
				if(renderStrategy) {
					var uniqueComponentId = renderStrategy.getComponentId();
					var componentLookbackMenu = $("#lookbackContainer" + uniqueComponentId);
					if(componentLookbackMenu.length) {
						componentLookbackMenu.replaceWith(renderStrategy.createComponentLookback());
					}
					
					var componentFilterMenu = $("#filterDropDownMenu" + uniqueComponentId);
					if(componentFilterMenu.length) {
						componentFilterMenu.replaceWith(renderStrategy.createComponentFilter());
					}
				}
				
				$(compObj.getSectionContentNode()).empty();
				if (compObj.isResourceRequired()) {
					compObj.RetrieveRequiredResources();
				}
				else {
					compObj.InsertData();
				}
			}
		},
		UpdatePrefsIdentifier: function(prefIdentifier) {
			if (prefIdentifier && typeof prefIdentifier === "string") {
				m_prefIdent = prefIdentifier;
			}
		},
		//Updates the component preferences from the components array passed into the function
		UpdateAllCompPreferences: function(componentArr, changePos, saveAsync) {
			var compId = 0;
			var compPrefs = null;
			var compPrefsCnt = 0;
			var compPrefsMap = {};
			var component = null;
			var componentDiv = null;
			var namespace = "";
			var newPrefsInd = false;
			var prefObj = null;
			var prefIndx = 0;
			var tempObj = {};
			var x = 0;
			
			//If saveAsync is anything other then true set it to false
			if(!saveAsync){
			saveAsync = false;
			}
			
			//Check the componentArr and make sure is is populated
			if (!componentArr || !componentArr.length) {
				return;
			}

			//Create the prefs object if it doesnt already exist
			prefObj = m_jsonObject || {
				user_prefs: {
					page_prefs: {
						components: []
					}
				}
			};
			
			//Check to make sure the structure exists so we can populate it
			prefObj.user_prefs = prefObj.user_prefs || {
				page_prefs : {
					components: []
				}
			};
			
			prefObj.user_prefs.page_prefs = prefObj.user_prefs.page_prefs || {
				components: []
			};
			
			prefObj.user_prefs.page_prefs.components = prefObj.user_prefs.page_prefs.components || [];
			compPrefs = prefObj.user_prefs.page_prefs.components;

			//Create a component map so we do not have to loop through the array for each component
			compPrefsCnt = compPrefs.length;
			for ( x = compPrefsCnt; x--; ) {
				compPrefsMap[compPrefs[x].id] = x;
			}

			//Loop through all of the components and update their preferences in the preferences object.
			compPrefsCnt = componentArr.length;
			for ( x = compPrefsCnt; x--; ) {
				component = componentArr[x];
				//Check to see if there is an existing preferences object
				if ( typeof compPrefsMap[component.getComponentId()] != 'undefined') {
					//Update exiting component preferences
					prefIndx = compPrefsMap[component.getComponentId()];
					tempObj = compPrefs[prefIndx];
					newPrefsInd = false;
				}
				else {
					tempObj = {};
					newPrefsInd = true;
				}
				//Save the components basic settings
				tempObj.id = component.getComponentId();
				tempObj.group_seq = component.getPageGroupSequence();
				tempObj.col_seq = component.getColumn();
				tempObj.row_seq = component.getSequence();
				tempObj.preferencesObj = component.getPreferencesObj();
				//Since we are updating the toggle status for all components we will need to make sure all required
				//components get marked as On(1) and not required(2).  Because if the bedrock preferences change from
				//Required to On for a component the existing user prefs toggle status of Required will override the bedrock preference
				//and not allow the user to toggle that component even though they should be able to.
				tempObj.toggleStatus = (component.getToggleStatus() === 2) ? 1 : component.getToggleStatus();
				tempObj.expanded = component.isExpanded();
				//Update the infoButton information
				tempObj.IsInfoButtonEnabled = component.isInfoButtonEnabled();

				if (component.getGrouperFilterLabel()) {
					tempObj.grouperFilterLabel = component.getGrouperFilterLabel();
				}
				if (component.getGrouperFilterCriteria()) {
					tempObj.grouperFilterCriteria = component.getGrouperFilterCriteria();
				}
				if (component.getGrouperFilterCatLabel()) {
					tempObj.grouperFilterCatLabel = component.getGrouperFilterCatLabel();
				}
				if (component.getGrouperFilterCatalogCodes()) {
					tempObj.grouperFilterCatalogCodes = component.getGrouperFilterCatalogCodes();
				}

				if (component.getSelectedTimeFrame()) {
					tempObj.selectedTimeFrame = component.getSelectedTimeFrame();
				}
				if (component.getSelectedDataGroup()) {
					tempObj.selectedDataGroup = component.getSelectedDataGroup();
				}

				//Push the new preferences object into the array
				if (newPrefsInd) {
					compPrefs.push(tempObj);
					//Update the mapping with the new element info
					compPrefsMap[tempObj.id] = compPrefs.length - 1;
				}
			}

			//If the changePos flag has been set we will need to update the positions of all components without blowing away existing
			// preferences.
			if (changePos) {
				for ( x = compPrefsCnt; x--; ) {
					component = componentArr[x];
					namespace = component.getStyles().getNameSpace();
					compId = component.getComponentId();
					//Get component div
					componentDiv = $("#" + namespace + compId);
					if (componentDiv.length) {
						//Get the preferences object
						prefIndx = compPrefsMap[component.getComponentId()];
						tempObj = compPrefs[prefIndx];
						//Get the parent of that component container and find out which index it is located at and use that as the sequence.
						tempObj.row_seq = $(componentDiv).index();
						//Save the new sequence back into the component
						component.setSequence(tempObj.row_seq);
					}
				}
			}

			//Save the preferences back to the preferences object.
			m_jsonObject = prefObj;
			WritePreferences(m_jsonObject,null,saveAsync);
		},
		UpdateSingleCompPreferences: function(componentObject, saveAsync){
			MP_Core.AppUserPreferenceManager.UpdateAllCompPreferences([componentObject],false,saveAsync)
		},
		SaveCompPreferences: function(componentId, theme, expCol, changePos, infoButton) {
			var compObj = MP_Util.GetCompObjById(componentId);
			var prefObj = m_jsonObject;
			var noMatch = true;
			if (prefObj != null && !changePos) {
				var strEval = JSON.parse(JSON.stringify(prefObj));
				var strObj = strEval.user_prefs.page_prefs.components;

				for (var x = strObj.length; x--; ) {
					if (strEval && strObj[x].id === componentId) {
						noMatch = false;
						if (theme) {
							strObj[x].compThemeColor = theme;
						}
						if (expCol) {
							if (expCol == "1") {
								strObj[x].expanded = true;
							}
							else {
								strObj[x].expanded = false;
							}
						}
						
						if (infoButton) {
							if(infoButton == "1") {
								strObj[x].IsInfoButtonEnabled = 1;
							}
							else {
								strObj[x].IsInfoButtonEnabled = 0;			
							}
						}

						if (compObj.getGrouperFilterLabel()) {
							strObj[x].grouperFilterLabel = compObj.getGrouperFilterLabel();
						}
						if (compObj.getGrouperFilterCatLabel()) {
							strObj[x].grouperFilterCatLabel = compObj.getGrouperFilterCatLabel();
						}
						if (compObj.getGrouperFilterCriteria()) {
							strObj[x].grouperFilterCriteria = compObj.getGrouperFilterCriteria();
						}
						if (compObj.getGrouperFilterCatalogCodes() || compObj.getGrouperFilterCatalogCodes() === null) {
							strObj[x].grouperFilterCatalogCodes = compObj.getGrouperFilterCatalogCodes();
						}
						else {
							strObj[x].grouperFilterCatalogCodes = [];
						}

						if (compObj.getSelectedTimeFrame()) {
							strObj[x].selectedTimeFrame = compObj.getSelectedTimeFrame();
						}
						if (compObj.getSelectedDataGroup()) {
							strObj[x].selectedDataGroup = compObj.getSelectedDataGroup();
						}
						//Save the components toggle status and the column and sequence information
						//Since we are updating the toggle status for all components we will need to make sure all required
						//components get marked as On(1) and not required(2).  Because if the bedrock preferences change from
						//Required to On for a component the existing user prefs toggle status of Required will override the bedrock preference
						//and not allow the user to toggle that component even though they should be able to.
						strObj[x].toggleStatus = (compObj.getToggleStatus() === 2) ? 1 : compObj.getToggleStatus();
						strObj[x].col_seq = compObj.getColumn();
						strObj[x].row_seq = compObj.getSequence();
						strObj[x].preferencesObj = compObj.getPreferencesObj();
					}
				}

				if (noMatch) {//single comp change but comp doesn't have user prefs
					var tempObj = {};
					tempObj.id = componentId;
					tempObj.group_seq = compObj.getPageGroupSequence();
					tempObj.col_seq = compObj.getColumn();
					tempObj.row_seq = compObj.getSequence();
					tempObj.preferencesObj = compObj.getPreferencesObj();
					tempObj.compThemeColor = theme;

					if (compObj.getGrouperFilterLabel()) {
						tempObj.grouperFilterLabel = compObj.getGrouperFilterLabel();
					}
					if (compObj.getGrouperFilterCriteria()) {
						tempObj.grouperFilterCriteria = compObj.getGrouperFilterCriteria();
					}
					if (compObj.getGrouperFilterCatLabel()) {
						tempObj.grouperFilterCatLabel = compObj.getGrouperFilterCatLabel();
					}
					if (compObj.getGrouperFilterCatalogCodes()) {
						tempObj.grouperFilterCatalogCodes = compObj.getGrouperFilterCatalogCodes();
					}

					if (compObj.getSelectedTimeFrame()) {
						tempObj.selectedTimeFrame = compObj.getSelectedTimeFrame();
					}
					if (compObj.getSelectedDataGroup()) {
						tempObj.selectedDataGroup = compObj.getSelectedDataGroup();
					}
					//Save the components toggle status
					//Since we are updating the toggle status for all components we will need to make sure all required
					//components get marked as On(1) and not required(2).  Because if the bedrock preferences change from
					//Required to On for a component the existing user prefs toggle status of Required will override the bedrock preference
					//and not allow the user to toggle that component even though they should be able to.
					tempObj.toggleStatus = (compObj.getToggleStatus() === 2) ? 1 : compObj.getToggleStatus();

					tempObj.expanded = compObj.isExpanded();
					strObj.push(tempObj);
				}
				m_jsonObject = strEval;
				WritePreferences(m_jsonObject);
			}
			else {
				var body = document.body;
				var groups = Util.Style.g("col-group", body, "div");
				var grpId = 0;
				var colId = 0;
				var rowId = 0;
				var compId = 0;

				var jsonObject = {};
				jsonObject.user_prefs = {};
				var userPrefs = jsonObject.user_prefs;
				userPrefs.page_prefs = {};
				var pagePrefs = userPrefs.page_prefs;
				pagePrefs.components = [];
				var components = pagePrefs.components;
				var cclParams = [];

				//alert("groups.length: " + groups.length)
				for (var x = 0, xl = groups.length; x < xl; x++) {
					//TODO: be aware that when the organizer level component can be moved, this x+1 will need to be modified
					grpId = x + 1;
					//get liquid layout
					var liqLay = Util.Style.g("col-outer1", groups[x], "div");
					if (liqLay.length > 0) {
						//get each child column
						var cols = Util.gcs(liqLay[0]);
						for (var y = 0, yl = cols.length; y < yl; y++) {
							colId = y + 1;
							var rows = Util.gcs(cols[y]);
							for (var z = 0, zl = rows.length; z < zl; z++) {
								var component = {};
								rowId = z + 1;
								compId = jQuery(rows[z]).attr('id');
								compObj = MP_Util.GetCompObjByStyleId(compId);
								component.id = compObj.getComponentId();

								if (compObj.getColumn() !== 99) {
									component.group_seq = 1;
									component.col_seq = colId;
									component.row_seq = rowId;
								}
								else {
									component.group_seq = 0;
									component.col_seq = 99;
									component.row_seq = rowId;
								}
								if (compObj.getCompColor()) {
									component.compThemeColor = compObj.getCompColor();
								}
								//Save the components toggle status
								//Since we are updating the toggle status for all components we will need to make sure all required
								//components get marked as On(1) and not required(2).  Because if the bedrock preferences change from
								//Required to On for a component the existing user prefs toggle status of Required will override the bedrock preference
								//and not allow the user to toggle that component even though they should be able to.
								component.toggleStatus = (compObj.getToggleStatus() === 2) ? 1 : compObj.getToggleStatus();
								compObj.setColumn(component.col_seq);
								compObj.setSequence(component.row_seq);
								//added preferences to component
								component.preferencesObj = compObj.getPreferencesObj();
								component.grouperFilterLabel = compObj.getGrouperFilterLabel();
								component.grouperFilterCatLabel = compObj.getGrouperFilterCatLabel();
								component.grouperFilterCriteria = compObj.getGrouperFilterCriteria();

								component.grouperFilterCatalogCodes = compObj.getGrouperFilterCatalogCodes();

								component.selectedTimeFrame = compObj.getSelectedTimeFrame();
								component.selectedDataGroup = compObj.getSelectedDataGroup();
								if (jQuery(rows[z]).hasClass('closed')) {
									component.expanded = false;
								}
								else {
									component.expanded = true;
								}
								if(compObj.hasInfoButton()) {
									if(infoButton) {
										component.IsInfoButtonEnabled = 1;
									}
									else {
										component.IsInfoButtonEnabled = 0;
									}
								}
								components.push(component);
							}
						}
					}
				}
				// get the selected components' settings from above and compare with prefObj by parsing it.
				// matched components get updated and other components ignored.
				// copy the updated new prefs to m_jsonObject
				// save prefs JSON using WritePreferences(m_jsonObject)
				
				if(prefObj){	//check for preference object; if found go for update; else don'nt update
						strObj = prefObj.user_prefs.page_prefs.components; 
							for (x = strObj.length; x--;) { 
								for (y = components.length; y--;) {
									if (strObj[x].id === components[y].id) {
										strObj[x] = components[y]; //update only matched component's preferences 
										break;
									}
								}
							} 
							m_jsonObject = prefObj; 
							WritePreferences(m_jsonObject); //write new prefs to database.
					} 
					else { 
						 WritePreferences(jsonObject);
						 m_jsonObject = jsonObject; //update the m_jsonObject(global).
					}
			}
		},
		SaveQOCCompPreferences: function(componentId, theme, expCol, changePos, selectedViewId) {
			var QOCTabDiv = _g(selectedViewId);
			var groups = Util.Style.g("col-group", QOCTabDiv, "div");
			var grpId = 0;
			var colId = 0;
			var rowId = 0;
			var compId = 0;

			//there must be a last saved view in user prefs if they've got this far
			var jsonObj = MP_Core.AppUserPreferenceManager.GetQOCPreferences();
			var userPrefs;
			var pagePrefs;
			var views;
			var lastSavedView;
			var saveAsync=false;
			if (jsonObj) {
				userPrefs = jsonObj.user_prefs;
				pagePrefs = userPrefs.page_prefs;
				views = pagePrefs.views;
				lastSavedView = pagePrefs.last_saved_view;
				var viewIndex = -1;
				var viewsLength = views.length;
				for (var j = viewsLength; j--; ) {
					var currentViewName = views[j].label;
					if (currentViewName === lastSavedView) {
						viewIndex = j;
						break;
					}
				}
			}

			if (lastSavedView && viewIndex >= 0) {
				views[viewIndex].components = [];
				for (var x = 0, xl = groups.length; x < xl; x++) {
					//TODO: be aware that when the organizer level component can be moved, this x+1 will need to be modified
					grpId = x + 1;
					//get liquid layout
					var liqLay = Util.Style.g("col-outer1", groups[x], "div");
					if (liqLay.length > 0) {
						//get each child column
						var cols = Util.gcs(liqLay[0]);
						for (var y = 0, yl = cols.length; y < yl; y++) {
							colId = y + 1;
							var rows = Util.gcs(cols[y]);
							for (var z = 0, zl = rows.length; z < zl; z++) {
								var component = {};
								rowId = z + 1;
								compId = jQuery(rows[z]).attr('id');
								compObj = MP_Util.GetCompObjByStyleId(compId);
								component.id = compObj.getComponentId();
								component.reportId = compObj.getReportId();
								component.label = compObj.getLabel();
								if (compObj.getColumn() !== 99) {
									component.group_seq = 1;
									component.col_seq = colId;
									component.row_seq = rowId;
								}
								else {
									component.group_seq = 0;
									component.col_seq = 99;
									component.row_seq = rowId;
								}
								if (compObj.getCompColor()) {
									component.compThemeColor = compObj.getCompColor();
								}
								component.grouperFilterLabel = compObj.getGrouperFilterLabel();
								component.grouperFilterCatLabel = compObj.getGrouperFilterCatLabel();
								component.grouperFilterCriteria = compObj.getGrouperFilterCriteria();
								component.grouperFilterCatalogCodes = compObj.getGrouperFilterCatalogCodes();
								component.selectedTimeFrame = compObj.getSelectedTimeFrame();
								component.selectedDataGroup = compObj.getSelectedDataGroup();
								if (jQuery(rows[z]).hasClass('closed')) {
									component.expanded = false;
								}
								else {
									component.expanded = true;
								}
								if (compObj.getPreferencesObj()) {
									component.preferencesObj = compObj.getPreferencesObj();
									saveAsync = true;
								}

								views[viewIndex].components.push(component);
							}
						}
					}
				}
			}
			MP_Core.AppUserPreferenceManager.SaveQOCPreferences(jsonObj, saveAsync);
			m_jsonObject = jsonObj;
		},
		SaveViewpointPreferences: function(vpNameKey, vwpObj) {
			WriteViewpointPreferences(vwpObj.VIEWS, vpNameKey);
		},
		SaveQOCPreferences: function(jsonObj, saveAsync) {
			m_prefIdent = "MP_COMMON_ORDERS_V4";
			m_criterion.category_mean = "MP_COMMON_ORDERS_V4";
			WritePreferences(jsonObj, null, saveAsync);
		},
		GetQOCPreferences: function() {
			if (!m_criterion) {
				alert("Validation Failed: the AppUserPreferenceManager must be initialized prior to usage.");
				return null;
			}
			//if this jsonObject is defined but is for a different view
			if (m_jsonObject) {
				if (!m_jsonObject.user_prefs.page_prefs.views) {
					m_jsonObject = null;
				}
				else{
					//this is the correct jsonObject, but we need to make sure the correct category mean is set
					m_criterion.category_mean = "MP_COMMON_ORDERS_V4";
				}
			}
			if (!m_jsonObject) {
				m_prefIdent = "MP_COMMON_ORDERS_V4";
				m_criterion.category_mean = "MP_COMMON_ORDERS_V4";
				this.LoadPreferences();
			}

			return m_jsonObject;
		},
		ClearPreferences: function() {
			WritePreferences(null);
			var cclParams = [];
			if ( typeof m_viewpointJSON == "undefined") {
				cclParams = ["^MINE^", m_criterion.person_id + ".0", m_criterion.encntr_id + ".0", m_criterion.provider_id + ".0", m_criterion.position_cd + ".0", m_criterion.ppr_cd + ".0", "^" + m_criterion.executable + "^", "^^", "^" + m_criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + m_criterion.category_mean + "^", m_criterion.debug_ind];
				CCLLINK("MP_DRIVER", cclParams.join(","), 1);
			}
			else {
				var viewpointJSON = JSON.parse(m_viewpointJSON).VIEWPOINTINFO_REC;
				cclParams = ["^MINE^", m_criterion.person_id + ".0", m_criterion.encntr_id + ".0", m_criterion.provider_id + ".0", m_criterion.position_cd + ".0", m_criterion.ppr_cd + ".0", "^" + m_criterion.executable + "^", "^" + m_criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + viewpointJSON.VIEWPOINT_NAME_KEY + "^", m_criterion.debug_ind, "^^", 0, "^" + viewpointJSON.ACTIVE_VIEW_CAT_MEAN + "^"];
				CCLLINK(CERN_driver_script, cclParams.join(","), 1);
			}
		},
		RemoveFolder: function(thisId, activeDivId) {
			$("#" + thisId).remove();
			MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, activeDivId);
		},
		/**
		 * Returns the json object associated to the primary div id of the component.  It is assumed LoadPreferences has been called prior to
		 * execution
		 * @param {Object} id
		 */
		GetComponentById: function(id) {
			if (m_jsonObject) {
				var components = m_jsonObject.user_prefs.page_prefs.components;
				if(!components){
					//preferences have been passed by the driver script and loadPreferences was avoided, return null to avoid an error
					return null;
				}
				for (var x = components.length; x--; ) {
					var component = components[x];
					if (component.id == id) {
						return component;
					}
				}
			}
			return null;
		}
	};
	function WriteViewpointPreferences(jsonObject, viewpointNameKey, successMessage) {
		var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
		info.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				MP_Util.LogScriptCallInfo(null, this, "mp_core.js", "WriteViewpointPreferences");
				var jsonEval = JSON.parse(this.responseText);
				var recordData = jsonEval.RECORD_DATA;
				if (recordData.STATUS_DATA.STATUS == "Z") {
					m_jsonObject = null;
				}
				else if (recordData.STATUS_DATA.STATUS == "S") {
					m_jsonObject = jsonObject;
					if (successMessage && successMessage.length > 0) {
						alert(successMessage);
					}
				}
				else {
					MP_Util.LogScriptCallError(null, this, "mp_core.js", "WriteViewpointPreferences");
					var errAr = [];
					var statusData = recordData.STATUS_DATA;
					errAr.push("STATUS: " + statusData.STATUS);
					for (var x = 0, xl = statusData.SUBEVENTSTATUS.length; x < xl; x++) {
						var ss = statusData.SUBEVENTSTATUS[x];
						errAr.push(ss.OPERATIONNAME, ss.OPERATIONSTATUS, ss.TARGETOBJECTNAME, ss.TARGETOBJECTVALUE);
					}
					window.status = "Error saving viewpoint user preferences: " + errAr.join(",");
				}
			}
			if (this.readyState == 4) {
				MP_Util.ReleaseRequestReference(this);
			}
		};

		var sJson = (jsonObject != null) ? JSON.stringify(jsonObject) : "";
		var ar = ["^mine^", m_criterion.provider_id + ".0", "^" + viewpointNameKey + "^", "~" + sJson + "~"];
		if (CERN_BrowserDevInd) {
			var url = "MP_MAINTAIN_USER_PREFS?parameters=" + ar.join(",");
			info.open('GET', url, false);
			info.send(null);
		}
		else {
			info.open('GET', "MP_MAINTAIN_USER_PREFS", false);
			info.send(ar.join(","));
		}
	}

	function WritePreferences(jsonObject, successMessage, saveAsync) {
		var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
		//If SaveAync is anything but true, its set to false
		if(!saveAsync){
			saveAsync = false;
		}
		info.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				MP_Util.LogScriptCallInfo(null, this, "mp_core.js", "WritePreferences");
				var jsonEval = JSON.parse(this.responseText);
				var recordData = jsonEval.RECORD_DATA;
				if (recordData.STATUS_DATA.STATUS == "Z") {
					m_jsonObject = null;
				}
				else if (recordData.STATUS_DATA.STATUS == "S") {
					m_jsonObject = jsonObject;
					if (successMessage && successMessage.length > 0) {
						alert(successMessage);
					}
				}
				else {
					MP_Util.LogScriptCallError(null, this, "mp_core.js", "WritePreferences");
					var errAr = [];
					var statusData = recordData.STATUS_DATA;
					errAr.push("STATUS: " + statusData.STATUS);
					for (var x = 0, xl = statusData.SUBEVENTSTATUS.length; x < xl; x++) {
						var ss = statusData.SUBEVENTSTATUS[x];
						errAr.push(ss.OPERATIONNAME, ss.OPERATIONSTATUS, ss.TARGETOBJECTNAME, ss.TARGETOBJECTVALUE);
					}
					window.status = "Error saving user preferences: " + errAr.join(",");
				}
			}
			if (this.readyState == 4) {
				MP_Util.ReleaseRequestReference(this);
			}
		};

		var sJson = (jsonObject != null) ? JSON.stringify(jsonObject) : "";
		if(m_criterion.category_mean == "MP_COMMON_ORDERS_V4"){
			//ensure that the pref identity is the same as the category mean
			m_prefIdent = "MP_COMMON_ORDERS_V4";
		}
		var ar = ["^mine^", m_criterion.provider_id + ".0", "^" + m_prefIdent + "^", "~" + sJson + "~"];
		if (CERN_BrowserDevInd) {
			var url = "MP_MAINTAIN_USER_PREFS?parameters=" + ar.join(",");
			info.open('GET', url, saveAsync);
			info.send(null);
		}
		else {
			info.open('GET', "MP_MAINTAIN_USER_PREFS", saveAsync);
			info.send(ar.join(","));
		}
	}

}();

/**
 * @namespace
 */
var MP_Util = function() {
	var m_df = null;
	var m_nf = null;
	var m_codeSets = [];
	return {
		addComponentsToGlobalStorage: function(components) {
			//If you try to add nothing, just return
			if(!components || !components.length) {
				return;
			}
			//If for some reason the global component storage is null, new it up
			if(CERN_MPageComponents === null) {
				CERN_MPageComponents = [];
			}
			//Store this view's components in the global component list
			for(var x = 0, xl = components.length; x < xl; x++) {
				if(components[x]) {
					CERN_MPageComponents.push(components[x]);
				}
			}
		},
		GetComponentArray: function(components) {
			var grpAr = [];
			var colAr = [];
			var rowAr = [];
			var curCol = -1;
			var curGrp = -1;

			var sHTML = [];

			//first layout the group/columns/rows of components
			if (components != null) {
				components.sort(SortMPageComponents);

				for (var x = 0, xl = components.length; x < xl; x++) {
					var component = components[x];

					if (component.isDisplayable()) {//based on filter logic, only display if criteria is met
						var compGrp = component.getPageGroupSequence();
						var compCol = component.getColumn();

						if (compGrp != curGrp) {
							curCol = -1;
							colAr = [];
							grpAr.push(colAr);
							curGrp = compGrp;
						}

						if (compCol != curCol) {
							rowAr = [];
							colAr.push(rowAr);
							curCol = compCol;
						}
						rowAr.push(component);
					}
				}
			}
			return grpAr;
		},
		/**
		 * Helper utility to retrieve the <code>Criterion</code> Object generated from the provide JSON
		 * @param js_criterion [REQUIRED] The JSON associated to the criterion data that is to be loaded
		 * @param static_content [REQUIRED] The <code>String</code> location in which the static content resides
		 */
		GetCriterion: function(js_criterion, static_content) {
			MP_Util.LogDebug("Criterion: " + JSON.stringify(js_criterion));
			var jsCrit = js_criterion.CRITERION;
			var criterion = new MP_Core.Criterion(jsCrit, static_content);
			var codeArray = MP_Util.LoadCodeListJSON(jsCrit.CODES);
			var jsPatInfo = jsCrit.PATIENT_INFO;
			var patInfo = new MP_Core.PatientInformation();
			var jsPeriopCases = jsCrit.PERIOP_CASE;
			var oPeriopCases = new MP_Core.PeriopCases();
			patInfo.setSex(MP_Util.GetValueFromArray(jsPatInfo.SEX_CD, codeArray));
			if (jsPatInfo.DOB != "") {
				var dt = new Date();
				dt.setISO8601(jsPatInfo.DOB);
				patInfo.setDOB(dt);
			}
			criterion.setPatientInfo(patInfo);
			oPeriopCases.setCaseID(jsPeriopCases.CASE_ID);
			oPeriopCases.setDays(jsPeriopCases.DAYS);
			oPeriopCases.setHours(jsPeriopCases.HOURS);
			oPeriopCases.setMins(jsPeriopCases.MINS);
			oPeriopCases.setCntdwnDscFlg(jsPeriopCases.CNTDWN_DESC_FLAG);
			criterion.setPeriopCases(oPeriopCases);
			return criterion;
		},

		/**
		 * Calculates the lookback date based on the current date and time
		 * @param lookbackDays [REQUIRED] The number of days to look back in time
		 * @return <code>Date</code> Object representing the lookback date and time
		 */
		CalcLookbackDate: function(lookbackDays) {
			var retDate = new Date();
			var hrs = retDate.getHours();
			hrs -= (lookbackDays * 24);
			retDate.setHours(hrs);
			return retDate;
		},
		/**
		 * Calculates the within time from the provide date and time.
		 * @param dateTime [REQUIRED] The <code>Date</code> Object in which to calculate the within time
		 * @return <code>String</code> representing the time that has passed from the provided date and time
		 */
		CalcWithinTime: function(dateTime) {
			return (GetDateDiffString(dateTime, null, null, true));
		},
		/**
		 * Calculates the age of a patient from a given point in time.  If the point in time is not provided, the current date/time is
		 * utilized
		 * @param birthDt [REQUIRED] The <code>Date</code> Object in which to calculate the age of the patient
		 * @param fromDate [OPTIONAL] The <code>Date</code> Object in which to calculate the age of the patient from.  This is useful in
		 * cases
		 * where the patient is deceased and the date utilized is the deceased date.
		 * @return <code>String</code> representing the age of the patient
		 */
		CalcAge: function(birthDt, fromDate) {
			//If from Date is null (not passed in) then set to current Date
			fromDate = (fromDate) ? fromDate : new Date();
			return (GetDateDiffString(birthDt, fromDate, 1, false));
		},
		/**
		 * Display the date and time based on the configuration of the component
		 * @param component [REQUIRED] The component in which holds the configuration for the date formatting
		 * @param date [REQUIRED] The date in which to properly format
		 * @return <code>String</code> representing the date and time of the date provided
		 */
		DisplayDateByOption: function(component, date) {
			var df = MP_Util.GetDateFormatter();
			var dtFormatted = "";
			switch (component.getDateFormat()) {
				case 1:
					return (df.format(date, mp_formatter.DateTimeFormatter.FULL_DATE_2YEAR));
				case 2:
					return (df.format(date, mp_formatter.DateTimeFormatter.FULL_DATE_TIME_2YEAR));
				case 3:
					return (MP_Util.CalcWithinTime(date));
				case 4:
					//Display No Date.  Additional logic will need to be applied to hide column.
					return ("&nbsp");
				default:
					return df.format(date, mp_formatter.DateTimeFormatter.FULL_DATE_TIME_2YEAR);
			}
		},
		DisplaySelectedTab: function(showDiv, anchorId) {
			var i = 0;
			if (window.name == "a-tab0") {//first tab is default
				window.name = "";
			}
			else {
				window.name = showDiv + ',' + anchorId;
			}
			var body = document.body;
			var divs = Util.Style.g("div-tab-item", body);
			for ( i = divs.length; i--; ) {
				if (divs[i].id == showDiv) {
					divs[i].style.display = 'block';
				}
				else {
					divs[i].style.display = 'none';
				}
			}

			var anchors = Util.Style.g("anchor-tab-item", body);
			for ( i = anchors.length; i--; ) {
				if (anchors[i].id == anchorId) {
					anchors[i].className = "anchor-tab-item active";
				}
				else {
					anchors[i].className = "anchor-tab-item inactive";
				}
			}

			//remove initial Customize anchor href
			var custNode = _g("custView");
			if (custNode != null) {
				custNode.href = "";
				custNode.innerHTML = "";
			}

			for (var yl = CERN_TabManagers.length; yl--; ) {
				var tabManager = CERN_TabManagers[yl];
				var tabItem = tabManager.getTabItem();
				if (tabItem.key == showDiv) {
					tabManager.loadTab();
					tabManager.setSelectedTab(true);
					var components = tabItem.components;
					if (components != null && components.length > 0) {
						for (var xl = components.length; xl--; ) {
							var component = components[xl];
							MP_Util.Doc.AddCustomizeLink(component.getCriterion());
							break;
						}
					}
				}
				else {
					tabManager.setSelectedTab(false);
				}
			}
		},
		DisplaySelectedTabQOC: function(showDiv, anchorId, noViewSaved) {
			var i = 0;
			var firstTimeLoadingMPage = false;
			if (noViewSaved) {
				var dropDownList = _g("viewListSelectorID");
				if (dropDownList.options[dropDownList.options.length - 1].value == "Blank_Space") {
					dropDownList.remove(dropDownList.options.length - 1);
					firstTimeLoadingMPage = true;
					//sort of a quick fix, but desperate times call for desperate measures
					//on intitial load with no last saved view in user prefs, the noViewsSaved variable will always
					//be true until the user refreshes the page. The only time no view has been saved is the time we
					//delete the Blank_Space from the view selector.
				}

				var noSavedViewsStatement = _g("noSavedViews");
				if (!Util.Style.ccss(noSavedViewsStatement, "hidden")) {
					Util.Style.acss(noSavedViewsStatement, "hidden");
				}
			}

			if (window.name == "a-tab0")//first tab is default
			{
				window.name = "";
			}
			else {
				window.name = showDiv + ',' + anchorId;
			}
			var body = document.body;
			var divs = Util.Style.g("div-tab-item", body);
			for ( i = divs.length; i--; ) {
				if (divs[i].id == showDiv) {
					divs[i].style.display = 'block';
					if (Util.Style.ccss(divs[i], "div-tab-item-not-selected")) {
						Util.Style.rcss(divs[i], "div-tab-item-not-selected");
						Util.Style.acss(divs[i], "div-tab-item-selected");
					}
				}
				else {
					divs[i].style.display = 'none';
					if (Util.Style.ccss(divs[i], "div-tab-item-selected")) {
						Util.Style.rcss(divs[i], "div-tab-item-selected");
						Util.Style.acss(divs[i], "div-tab-item-not-selected");
					}
				}
			}

			var anchors = Util.Style.g("anchor-tab-item", body);
			for ( i = anchors.length; i--; ) {
				if (anchors[i].id == anchorId) {
					anchors[i].className = "anchor-tab-item active";
				}
				else {
					anchors[i].className = "anchor-tab-item inactive";
				}
			}

			//remove initial Customize anchor href
			var custNode = _g("custView");
			if (custNode) {
				custNode.href = "";
				custNode.innerHTML = "";
			}

			for (var yl = CERN_TabManagers.length; yl--; ) {
				var tabManager = CERN_TabManagers[yl];
				var tabItem = tabManager.getTabItem();
				if (tabItem.key == showDiv) {
					tabManager.loadTab();
					tabManager.setSelectedTab(true);

					//grab user preferences, and then save back preferences with updated last saved view
					var jsonObj = MP_Core.AppUserPreferenceManager.GetQOCPreferences();
					var userPrefs, pagePrefs, views, lastSavedView;
					if (jsonObj) {
						userPrefs = jsonObj.user_prefs;
						pagePrefs = userPrefs.page_prefs;
						views = pagePrefs.views;
						pagePrefs.last_saved_view = tabItem.name;
					}
					else {
						jsonObj = {};
						userPrefs = jsonObj.user_prefs = {};
						pagePrefs = userPrefs.page_prefs = {};
						views = pagePrefs.views = [];
						lastSavedView = pagePrefs.last_saved_view = tabItem.name;
					}
					var viewsLength = views.length;
					var newView = {};
					newView.label = tabItem.name;
					newView.components = [];
					if (viewsLength === 0) {
						views.push(newView);
					}
					else {
						var alreadyAddedView = false;
						for (var j = viewsLength; j--; ) {
							var currentViewName = views[j].label;
							if (currentViewName === newView.label) {
								alreadyAddedView = true;
								break;
							}
						}
						if (!alreadyAddedView) {
							views.push(newView);
						}
					}

					MP_Core.AppUserPreferenceManager.SaveQOCPreferences(jsonObj, true);
					var criterion;
					var components = tabItem.components;
					if (components != null && components.length > 0) {
						for (var xl = components.length; xl--; ) {
							var component = components[xl];
							criterion = component.getCriterion();
							MP_Util.Doc.AddCustomizeLink(criterion);
							break;
						}
					}
					MP_Util.Doc.InitQOCDragAndDrop(tabItem.key);
					var categoryMeaning = "MP_COMMON_ORDERS_V4";
					var tabItemKey = tabItem.key;
					//Update the menu shown when the page menu is clicked
					$("#pageMenu" + categoryMeaning).unbind("click").click(function(){
						MP_MenuManager.showMenu("pageMenu" + tabItemKey);
					});
				}
				else {
					tabManager.setSelectedTab(false);
				}
			}
		},
		OpenTab: function(compId) {
			for (var x = 0, xl = CERN_MPageComponents.length; x < xl; x++) {
				var comp = CERN_MPageComponents[x];
				var styles = comp.getStyles();
				if (styles.getId() == compId) {
					comp.openTab();
				}
			}
		},
		OpenIView: function(compId) {
			var comp = MP_Util.GetCompObjByStyleId(compId);
			comp.openIView();
		},
		LaunchMenuSelection: function(compId, menuItemId) {
			//get the exact component from global array
			for (var x = 0, xl = CERN_MPageComponents.length; x < xl; x++) {
				var comp = CERN_MPageComponents[x];
				var crit = comp.getCriterion();
				var styles = comp.getStyles();
				if (styles.getId() == compId) {
					//found
					comp.openDropDown(menuItemId);
					break;
				}
			}

		},
		LaunchIViewMenuSelection: function(compId, bandName, sectionName, itemName) {
			var rootId = parseInt(compId, 10);
			var component = MP_Util.GetCompObjById(rootId);
			var criterion = component.getCriterion();
			var launchIViewApp = window.external.DiscernObjectFactory("TASKDOC");
			launchIViewApp.LaunchIView(bandName, sectionName, itemName, criterion.person_id, criterion.encntr_id);
		},
		LaunchMenu: function(menuId, componentId) {
			var menu = _g(menuId);
			MP_Util.closeMenuInit(menu, componentId);
			if (menu != null) {
				if (Util.Style.ccss(menu, "menu-hide")) {
					_g(componentId).style.zIndex = 2;
					Util.Style.rcss(menu, "menu-hide");
				}
				else {
					_g(componentId).style.zIndex = 1;
					Util.Style.acss(menu, "menu-hide");
				}
			}
		},
		LaunchLookBackSelection: function(compId, lookBackUnits, lookBackType) {
			var i18nCore = i18n.discernabu;
			var rootId = parseInt(compId, 10);
			var component = MP_Util.GetCompObjById(rootId);
			var style = component.getStyles();
			var ns = style.getNameSpace();
			var scope = component.getScope();
			var displayText = "";
			var lbtVal = parseInt(lookBackType, 10);

			if (component.getLookbackUnits() !== lookBackUnits || component.getLookbackUnitTypeFlag() !== lbtVal) {
				component.setLookbackUnits(lookBackUnits);
				component.setLookbackUnitTypeFlag(lbtVal);

				if (scope > 0) {
					if (lookBackUnits > 0 && lbtVal > 0) {
						var newText = "";
						switch(lbtVal) {
							case 1:
								newText = i18nCore.LAST_N_HOURS.replace("{0}", lookBackUnits);
								break;
							case 2:
								newText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
								break;
							case 3:
								newText = i18nCore.LAST_N_WEEKS.replace("{0}", lookBackUnits);
								break;
							case 4:
								newText = i18nCore.LAST_N_MONTHS.replace("{0}", lookBackUnits);
								break;
							case 5:
								newText = i18nCore.LAST_N_YEARS.replace("{0}", lookBackUnits);
								break;
							default:
								newText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
								break;
						}
						switch(scope) {
							case 1:
								displayText = i18nCore.ALL_N_VISITS.replace("{0}", newText);
								break;
							case 2:
								displayText = i18nCore.SELECTED_N_VISIT.replace("{0}", newText);
								break;
						}
					}
					else {
						switch(scope) {
							case 1:
								displayText = i18nCore.All_VISITS;
								break;
							case 2:
								displayText = i18nCore.SELECTED_VISIT;
								break;
						}
					}
				}

				MP_Util.Doc.CreateLookBackMenu(component, 2, displayText);

				if (ns === "lab" || ns === "dg" || ns === "ohx" || ns === "ohx2") {
					component.getSectionContentNode().innerHTML = "";
				}
				if (component.isResourceRequired()) {
					component.RetrieveRequiredResources();
				}
				else {
					component.InsertData();
				}
			}
		},
				LaunchCompFilterSelection: function(compId, eventSetIndex, applyFilterInd) {
			var component = MP_Util.GetCompObjById(compId);
			var i18nCore = i18n.discernabu;
			var style = component.getStyles();
			var ns = style.getNameSpace();
			var mnuDisplay;
			if (eventSetIndex === -1)
			{
			 mnuDisplay = i18nCore.FACILITY_DEFINED_VIEW;
			}
			else 
			{
				if (ns === "ohx" || ns === "ohx2") {
					 mnuDisplay = component.getGrouperCatLabel(eventSetIndex).toString();		
				}
				else {
					mnuDisplay = component.getGrouperLabel(eventSetIndex).toString();
				}		
			}
			var dispVar = i18nCore.FACILITY_DEFINED_VIEW;
			var styleId = style.getId();
			var loc = component.getCriterion().static_content;
			var mnuId = styleId + "TypeMenu";
			var z = 0;

			if (ns === "ohx" || ns === "ohx2") {
				var catCodeList = component.getGrouperCatalogCodes(eventSetIndex);
			}
			else {
				var eventSetList = component.getGrouperCriteria(eventSetIndex);
			}

			//Set component prefs variables with filter settings
			if (ns === "ohx" || ns === "ohx2") {
				component.setGrouperFilterCatLabel(mnuDisplay);
			}
			else {
				component.setGrouperFilterLabel(mnuDisplay);
			}
			if (mnuDisplay !== dispVar) {

				if (ns === "ohx" || ns === "ohx2") {
					component.setGrouperFilterCatalogCodes(catCodeList);
				}
				else {
					component.setGrouperFilterCriteria(eventSetList);
				}

			}
			else {
				component.setGrouperFilterCriteria(null);
				component.setGrouperFilterCatalogCodes(null);
			}

			//Find Filter Applied msg span and replace it only if the Facility defined view is not selected
			var filterAppliedSpan = _g("cf" + compId + "msg");
			if (filterAppliedSpan) {
				// Remove the old span element
				Util.de(filterAppliedSpan);
			}
			if (mnuDisplay !== dispVar) {
				var newFilterAppliedSpan = Util.ce('span');
				var filterAppliedArr = ["<span id='cf", compId, "msg' class='filter-applied-msg' title='", mnuDisplay, "'>", i18nCore.FILTER_APPLIED, "</span>"];
				newFilterAppliedSpan.innerHTML = filterAppliedArr.join('');
				var lbDropDownDiv = _g("lbMnuDisplay" + compId);
				Util.ia(newFilterAppliedSpan, lbDropDownDiv);
			}
			else {
				var newFilterAppliedSpan = Util.ce('span');
				var filterAppliedArr = ["<span id='cf", compId, "msg' class='filter-applied-msg' title=''></span>"];
				newFilterAppliedSpan.innerHTML = filterAppliedArr.join('');
				var lbDropDownDiv = _g("lbMnuDisplay" + compId);
				Util.ia(newFilterAppliedSpan, lbDropDownDiv);
			}

			//Find the content div
			var contentDiv = _g("Accordion" + compId + "ContentDiv");
			contentDiv.innerHTML = "";

			//Create the new content div innerHTML with the select list
			var contentDivArr = [];
			contentDivArr.push("<div id='cf", mnuId, "' class='acc-mnu'>");
			contentDivArr.push("<span id='cflabel", compId, "' onclick='MP_Util.LaunchMenu(\"", mnuId, "\", \"", styleId, "\");'>", i18nCore.FILTER_LABEL, mnuDisplay, "<a id='compFilterDrop", compId, "'><img src='", loc, "/images/3943_16.gif'></a></span>");
			contentDivArr.push("<div class='cvClassFilterSpan lb-mnu-selectWindow lb-menu2 menu-hide' id='", mnuId, "'><div class='acc-mnu-contentbox'>");
			contentDivArr.push("<div><span id='cf", styleId, "' class='cf-mnu' onclick='MP_Util.LaunchCompFilterSelection(", compId, ",-1,1);'>", i18nCore.FACILITY_DEFINED_VIEW, "</span></div>");

			var groupLen = component.m_grouper_arr.length;
			for ( z = 0; z < groupLen; z++) {
				if (component.getGrouperLabel(z)) {
					var esIndex = z;
					contentDivArr.push("<div><span id='cf", styleId, z, "' class='cf-mnu' onclick='MP_Util.LaunchCompFilterSelection(", compId, ",", esIndex, ",1);'>", component.getGrouperLabel(z).toString(), "</span></div>");
				}
				if (component.getGrouperCatLabel(z)) {
					var esIndex = z;
					contentDivArr.push("<div><span id='cf", styleId, z, "' class='cf-mnu' onclick='MP_Util.LaunchCompFilterSelection(", compId, ",", esIndex, ",1);'>", component.getGrouperCatLabel(z).toString(), "</span></div>");
				}
			}
			contentDivArr.push("</div></div></div>");
			contentDiv.innerHTML = contentDivArr.join('');

			if (applyFilterInd === 1) {
				if (mnuDisplay === i18nCore.FACILITY_DEFINED_VIEW) {
					if (component.isResourceRequired()) {
						component.RetrieveRequiredResources();
					}
					else {
						component.InsertData();
					}
				}
				else {

					if (ns === "ohx" || ns === "ohx2") {
						component.FilterRefresh(mnuDisplay, catCodeList);
					}
					else {
						component.FilterRefresh(mnuDisplay, eventSetList);
					}

				}
			}
		},
		LaunchViewMenu: function(menuId) {
			var menu = _g(menuId);
			MP_Util.closeViewMenuInit(menu);
			if (menu) {
				if (Util.Style.ccss(menu, "menu-hide")) {
					_g(menu.id).style.zIndex = 2;
					Util.Style.rcss(menu, "menu-hide");
				}
				else {
					_g(menu.id).style.zIndex = 1;
					Util.Style.acss(menu, "menu-hide");
				}

				//change position of viewpoint menu if chart search enabled
				var js_viewpoint = JSON.parse(m_viewpointJSON);
				if (parseInt(js_viewpoint.VIEWPOINTINFO_REC.CS_ENABLED, 10)) {
					var sec = _g("viewDrop");
					var ofs = Util.goff(sec);
					menu.style.left = (ofs[0] - 5) + "px";
					menu.style.top = (ofs[1] + 24) + "px";
				}
			}
		},
		closeViewMenuInit: function(inMenu) {
			var menuId = inMenu.id;
			var e = window.event;

			var menuLeave = function(e) {
				if (!e) {
					var e = window.event;
				}
				var relTarg = e.relatedTarget || e.toElement;
				if (e.relatedTarget.id == inMenu.id) {
					Util.Style.acss(inMenu, "menu-hide");
				}
				e.stopPropagation();
				Util.cancelBubble(e);
			};

			if (window.attachEvent) {
				Util.addEvent(inMenu, "mouseleave", function() {
					Util.Style.acss(inMenu, "menu-hide");
				});
			}
			else {
				Util.addEvent(inMenu, "mouseout", menuLeave);
			}
		},
		closeMenuInit: function(inMenu, compId) {
			var menuId;
			var docMenuId = compId + "Menu";
			var lbMenuId = compId + "Mnu";
			var cfMenuId = compId + "TypeMenu";

			var menuLeave = function(e) {
				if (!e) {
					var e = window.event;
				}
				var relTarg = e.relatedTarget || e.toElement;
				if (e.relatedTarget.id == inMenu.id) {
					Util.Style.acss(inMenu, "menu-hide");
				}
				e.stopPropagation();
				Util.cancelBubble(e);
			}
			if (inMenu.id == docMenuId || inMenu.id == lbMenuId || inMenu.id == cfMenuId) {//m2 'docMenu'
				menuId = compId;
			}
			if (!e)
				var e = window.event;
			if (window.attachEvent) {
				Util.addEvent(inMenu, "mouseleave", function() {
					Util.Style.acss(inMenu, "menu-hide");
					_g(menuId).style.zIndex = 1;
				});
			}
			else {
				Util.addEvent(inMenu, "mouseout", menuLeave);
			}
		},
		/**
		 * Provides the ability to construct the text that is to be placed after the label of the Component.
		 * Each component defines whether or not the number of items within the component should be displayed
		 * in the title of the component.  This is a requirements decision and will have to be answered upon creation
		 * of the component.  In addition, the lookback units and scope have been moved to the
		 * subtitle text line and are no longer necessary in the title text.
		 *
		 * The requirement is for each component to define whether or not the contract exists to display a number of items
		 * within the component header.  The reason for this contract is when 'no results found' is displayed, the count of zero
		 * must be displayed to indicate to the user if there are items within the component.  As for components who do not display
		 * a count, the user will still have to manually open the component to determine whether or not data exists.
		 *
		 * TODO: The future thought is that in the case of 'no results found' or 'error retrieving data', an additional indicator
		 * will be added to the component in some manner to indicate the status.  This is important with components such as Laboratory
		 * and Vitals for examples where the count of items is not displayed within the title text.
		 *
		 * @param component The {@see MPageComponent} in which to add the title text within.
		 * @param nbr The count of the list items displayed within the component
		 * @param optionalText Optional text to allow each consumer to place text within the header of the component.
		 */
		CreateTitleText: function(component, nbr, optionalText) {
			var ar = [];
			if (component.isLineNumberIncluded()) {
				ar.push("(", nbr, ")");
			}
			if (optionalText && optionalText !== "") {
				ar.push(" ", optionalText)
			}
			return ar.join("");
		},
		/**
		 * A helper utility to determine if a content body should be considered scrollable
		 * @param component [REQUIRED] The component in which is being evaluated
		 * @param nbr [REQUIRED] The number of items in which to consider scrolling enabled
		 */
		GetContentClass: function(component, nbr) {
			if (component.isScrollingEnabled()) {
				var scrollNbr = component.getScrollNumber();
				if (nbr > scrollNbr && scrollNbr > 0) {
					return "content-body scrollable";
				}
			}
			return "content-body";
		},
		/**
		 * CreateTimer will create a SLA timer and start the timer prior to returning.
		 * @param {String} timerName The timer name to start
		 * @param {String} subTimerName The subtimer name to start
		 * @param {String} metaData1
		 * @param {String} metaData2
		 * @param {String} metaData3
		 */
		CreateTimer: function(timerName, subTimerName, metaData1, metaData2, metaData3) {
			try {
				var slaTimer = window.external.DiscernObjectFactory("SLATIMER");
				MP_Util.LogTimerInfo(timerName, subTimerName, "SLATIMER", "mp_core.js", "CreateTimer");
			}
			catch (err) {
				return null;
			}

			if (slaTimer) {
				slaTimer.TimerName = timerName;
				if (subTimerName)
					slaTimer.SubtimerName = subTimerName;
				if (metaData1)
					slaTimer.Metadata1 = String(metaData1);
				if (metaData2)
					slaTimer.Metadata2 = String(metaData2);
				if (metaData3)
					slaTimer.Metadata3 = String(metaData3);

				slaTimer.Start();
				return slaTimer;
			}
			else {
				return null;
			}
		},
		/**
		 * Retrieves the code values for a given code set
		 * @param codeSet [REQUIRED] The code set in which to retrieve
		 * @param async [REQUIRED] A <code>Boolean</code> value indicating to call async.  <code>TRUE</code> = yes, <code>FALSE</code> = no
		 * @return A list of code from the code set
		 */
		GetCodeSet: function(codeSet, async) {
			var codes = new Array();
			var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
			info.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					MP_Util.LogScriptCallInfo(null, this, "mp_core.js", "GetCodeSet");
					var jsonEval = JSON.parse(this.responseText);
					if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
						codes = MP_Util.LoadCodeListJSON(jsonEval.RECORD_DATA.CODES);
					}
					return codes;
				}
				if (this.readyState == 4) {
					MP_Util.ReleaseRequestReference(this);
				}

			}
			//  Call the ccl progam and send the parameter string
			var sendVal = "^MINE^, " + codeSet + ".0";
			if (CERN_BrowserDevInd) {
				var url = "MP_GET_CODESET?parameters=" + sendVal;
				info.open('GET', url, async);
				info.send(null);
			}
			else {
				info.open('GET', "MP_GET_CODESET", async);
				info.send(sendVal);
			}

			return codes;
		},
		/**
		 * Will return a code object from the mapped list by the cdf_meaning
		 * @param mapCodes [REQUIRED] The map of code values to search
		 * @param meaning [REQUIRED] The cdf_meaning of the code value to search
		 * @return The code object associated to the cdf_meaning provides.  Else null
		 */
		GetCodeByMeaning: function(mapCodes, meaning) {
			for (var x = mapCodes.length; x--; ) {
				var code = mapCodes[x].value;
				if (code.meaning == meaning)
					return code;
			}
			return null;
		},
		GetCodeValueByMeaning: function(meaning, codeSet) {
			var codeValue = 0;
			var list = m_codeSets[codeSet];
			if (!list) {
				list = m_codeSets[codeSet] = MP_Util.GetCodeSet(codeSet, false);
			}
			if (list && list.length > 0) {
				for (var x = list.length; x--; ) {
					var code = list[x].value;
					if (code.meaning === meaning) {
						return code;
					}
				}
			}
			return null;
		},
		/**
		 * Will search for a value within the provided mapped array and return the value associated to the name/value pair
		 * @param mapItems [REQUIRED] The mapped array of items to search through
		 * @param item [REQUIRED] The item in which to search
		 * @return The value from the name/value pair
		 */
		GetItemFromMapArray: function(mapItems, item) {
			for (var x = 0; x < mapItems.length; x++) {
				if (mapItems[x].name == item)
					return mapItems[x].value;
			}
		},
		/**
		 * Add an item to the array of items associated to the map key
		 * @param mapItems [REQUIRED] The map array to search within
		 * @param key [REQUIRED] The primary key that will be searching for within the map array
		 * @param value [REQUIRED] The object that is to be added to the map array
		 */
		AddItemToMapArray: function(mapItems, key, value) {
			var ar = MP_Util.GetItemFromMapArray(mapItems, key);
			if (!ar) {
				ar = []
				mapItems.push(new MP_Core.MapObject(key, ar));
			}
			ar.push(value);
		},
		LookBackTime: function(component) {
			var i18nCore = i18n.discernabu;
			var remainder = 0;
			var lookbackDays = component.getLookbackDays();
			if (lookbackDays == 0) {
				return (i18nCore.SELECTED_VISIT);
			}
			else if (lookbackDays == 1) {
				return (i18nCore.LAST_N_HOURS.replace("{0}", lookbackDays * 24));
			}
			else {
				return (i18nCore.LAST_N_DAYS.replace("{0}", lookbackDays));
			}
		},
		CreateClinNoteLink: function(patient_id, encntr_id, event_id, display, docViewerType, pevent_id) {
			var docType = (docViewerType && docViewerType > "") ? docViewerType : 'STANDARD';
			var doclink = ""
			if (event_id > 0) {
				var ar = [];
				ar.push(patient_id, encntr_id, event_id, "\"" + docType + "\"", pevent_id);
				doclink = "<a onclick='javascript:MP_Util.LaunchClinNoteViewer(" + ar.join(",") + "); return false;' href='#'>" + display + "</a>"
			}
			else {
				doclink = display
			}
			return (doclink);
		},
		/**
		 * Retrieves a document for viewing via the MPages RTF viewer
		 * @param {Object} eventId The parent or child event id for retrieval
		 * @param {Object} docViewerType
		 * 0: Parent Event Id retrieval of child event blobs
		 * 1: Event Id blob retrieval
		 * 2: Long text retrieval
		 * 3: Micro Detail retrieval
		 * 4: Anatomic Pathology retrieval
		 */
		LaunchClinNoteViewer: function(patient_id, encntr_id, event_id, docViewerType, pevent_id) {
			var x = 0;
			var m_dPersonId = parseFloat(patient_id);
			var m_dEncntrId = parseFloat(encntr_id);
			var m_dPeventId = parseFloat(pevent_id);
			var viewerObj = window.external.DiscernObjectFactory("PVVIEWERMPAGE");
			MP_Util.LogDiscernInfo(null, "PVVIEWERMPAGE", "mp_core.js", "LaunchClinNoteViewer");
			try {
				switch (docViewerType) {
					case 'AP':
						viewerObj.CreateAPViewer();
						viewerObj.AppendAPEvent(event_id, m_dPeventId);
						viewerObj.LaunchAPViewer();
						break;
					case 'DOC':
						viewerObj.CreateDocViewer(m_dPersonId);
						if (MP_Util.IsArray(event_id)) {
							for (var x = event_id.length; x--; ) {
								viewerObj.AppendDocEvent(event_id[x]);
							}
						}
						else {
							viewerObj.AppendDocEvent(event_id);
						}
						viewerObj.LaunchDocViewer();
						break;
					case 'EVENT':
						viewerObj.CreateEventViewer(m_dPersonId);
						if (MP_Util.IsArray(event_id)) {
							for (var x = event_id.length; x--; ) {
								viewerObj.AppendEvent(event_id[x]);
							}
						}
						else {
							viewerObj.AppendEvent(event_id);
						}
						viewerObj.LaunchEventViewer();
						break;
					case 'MICRO':
						viewerObj.CreateMicroViewer(m_dPersonId);
						if (MP_Util.IsArray(event_id)) {
							for (var x = event_id.length; x--; ) {
								viewerObj.AppendMicroEvent(event_id[x]);
							}
						}
						else {
							viewerObj.AppendMicroEvent(event_id);
						}
						viewerObj.LaunchMicroViewer();
						break;
					case 'GRP':
						viewerObj.CreateGroupViewer();
						if (MP_Util.IsArray(event_id)) {
							for (var x = event_id.length; x--; ) {
								viewerObj.AppendGroupEvent(event_id[x]);
							}
						}
						else {
							viewerObj.AppendGroupEvent(event_id);
						}
						viewerObj.LaunchGroupViewer();
						break;
					case 'PROC':
						viewerObj.CreateProcViewer(m_dPersonId);
						if (MP_Util.IsArray(event_id)) {
							for (var x = event_id.length; x--; ) {
								viewerObj.AppendProcEvent(event_id[x]);
							}
						}
						else {
							viewerObj.AppendProcEvent(event_id);
						}
						viewerObj.LaunchProcViewer();
						break;
					case 'HLA':
						viewerObj.CreateAndLaunchHLAViewer(m_dPersonId, event_id);
						break;
					case 'NR':
						viewerObj.LaunchRemindersViewer(event_id);
						break;
					case 'STANDARD':
						alert(i18n.discernabu.CAN_NOT_VIEW_RESULTS);
						break;
				}
			}
			catch (err) {
				MP_Util.LogJSError(err, null, "mp_core.js", "LaunchClinNoteViewer");
				alert(i18n.discernabu.CAN_NOT_VIEW_RESULTS + "  " + i18n.discernabu.CONTACT_ADMINISTRATOR);
			}

		},
		IsArray: function(input) {
			return ( typeof (input) == 'object' && ( input instanceof Array));
		},
		IsString: function(input) {
			return ( typeof (input) == 'string');
		},
		HandleNoDataResponse: function(nameSpace) {
			var i18nCore = i18n.discernabu;
			return ("<h3 class='info-hd'><span class='res-normal'>" + i18nCore.NO_RESULTS_FOUND + "</span></h3><span class='res-none'>" + i18nCore.NO_RESULTS_FOUND + "</span>");
		},
		HandleErrorResponse: function(nameSpace, errorMessage) {
			var ar = [];
			var i18nCore = i18n.discernabu;
			//Create the HTML that will be returned to the component
			var ns = (nameSpace && nameSpace.length > 0) ? nameSpace + "-" : "";
			ar.push("<h3 class='info-hd'><span class='res-normal'>", i18nCore.ERROR_RETREIVING_DATA, "</span></h3>");
			ar.push("<dl class='", ns, "info error-message error-text'><dd><span>", i18nCore.ERROR_RETREIVING_DATA, "</span></dd></dl>");
			//log the error out to the JSLogger
			if (errorMessage && errorMessage.length) {
				MP_Util.LogError(i18n.COMPONENTS + ": " + nameSpace + "<br />" + errorMessage);
			}
			return ar.join("");
		},
		GetValueFromArray: function(name, array) {
			if (array != null) {
				for (var x = 0, xi = array.length; x < xi; x++) {
					if (array[x].name == name) {
						return (array[x].value);
					}
				}
			}
			return (null);
		},
		GetPrsnlObjByIdAndDate: function(name, date, personnelArray) {
			var prsnlObj;
			var latestPrsnlObj;
			try {
				if (personnelArray && personnelArray.length) {
					for (var x = 0, xi = personnelArray.length; x < xi; x++) {
						if (personnelArray[x].name == name) {
							prsnlObj = personnelArray[x].value;
							//If no personnel object found return the first/latest prsnl name
							if (!latestPrsnlObj) {
								latestPrsnlObj = prsnlObj;
							}
							if ( typeof date == "string") {
								//Convert to the correct date format for comparison
								if (/^\/Date\(/.exec(date)) {
									date = /[0-9]+-[0-9]+-[0-9]+/.exec(date) + "T" + /[0-9]+:[0-9]+:[0-9]+/.exec(date) + "Z";
								}
								if ((date > prsnlObj.beg_dt_tm_string && date < prsnlObj.end_dt_tm_string) || date == prsnlObj.beg_dt_tm_string || date == prsnlObj.end_dt_tm_string) {
									return (prsnlObj);
								}
							}
							else {
								throw (new Error("Invalid date object passed into GetPrsnlObjByIdAndDate.  The date object must be a string."));
							}
						}
					}
					return (latestPrsnlObj);
				}
				return (null);
			}
			catch(err) {
				MP_Util.LogJSError(err, null, "mp_core.js", "GetPrsnlObjByIdAndDate");
				return (null);
			}
		},
		GetCompObjById: function(id) {
			var comps = CERN_MPageComponents;
			var cLen = comps.length;
			for (var i = cLen; i--; ) {
				var comp = comps[i];
				if (comp.m_componentId === id) {
					return comp;
				}
			}
			return (null);
		},
		GetCompObjByStyleId: function(id) {
			var cLen = CERN_MPageComponents.length;
			for (var i = cLen; i--; ) {
				var comp = CERN_MPageComponents[i];
				var styles = comp.getStyles();
				if (styles.getId() === id) {
					return comp;
				}
			}
			return (null);
		},
		LoadCodeListJSON: function(parentElement) {
			var codeArray = new Array();
			if (parentElement != null) {
				for (var x = 0; x < parentElement.length; x++) {
					var codeObject = new Object();
					codeElement = parentElement[x];
					codeObject.codeValue = codeElement.CODE;
					codeObject.display = codeElement.DISPLAY;
					codeObject.description = codeElement.DESCRIPTION;
					codeObject.codeSet = codeElement.CODE_SET;
					codeObject.sequence = codeElement.SEQUENCE;
					codeObject.meaning = codeElement.MEANING;
					var mapObj = new MP_Core.MapObject(codeObject.codeValue, codeObject);
					codeArray.push(mapObj);
				}
			}
			return (codeArray);
		},
		LoadPersonelListJSON: function(parentElement) {
			var personnelArray = [];
			var codeElement;
			if (parentElement != null) {
				for (var x = 0; x < parentElement.length; x++) {
					var prsnlObj = {};
					codeElement = parentElement[x];
					prsnlObj.id = codeElement.ID;
					//If available retrieve the beg and end date and time for a prsnl name
					if (codeElement.BEG_EFFECTIVE_DT_TM) {
						prsnlObj.beg_dt_tm = codeElement.BEG_EFFECTIVE_DT_TM;
						//create the string object for comparisons purposes
						prsnlObj.beg_dt_tm_string = /[0-9]+-[0-9]+-[0-9]+/.exec(codeElement.BEG_EFFECTIVE_DT_TM) + "T" + /[0-9]+:[0-9]+:[0-9]+/.exec(codeElement.BEG_EFFECTIVE_DT_TM) + "Z";
					}
					if (codeElement.END_EFFECTIVE_DT_TM) {
						prsnlObj.end_dt_tm = codeElement.END_EFFECTIVE_DT_TM;
						//create the string object for comparisons purposes
						prsnlObj.end_dt_tm_string = /[0-9]+-[0-9]+-[0-9]+/.exec(codeElement.END_EFFECTIVE_DT_TM) + "T" + /[0-9]+:[0-9]+:[0-9]+/.exec(codeElement.END_EFFECTIVE_DT_TM) + "Z";
					}
					prsnlObj.fullName = codeElement.PROVIDER_NAME.NAME_FULL;
					prsnlObj.firstName = codeElement.PROVIDER_NAME.NAME_FIRST;
					prsnlObj.middleName = codeElement.PROVIDER_NAME.NAME_MIDDLE;
					prsnlObj.lastName = codeElement.PROVIDER_NAME.NAME_LAST;
					prsnlObj.userName = codeElement.PROVIDER_NAME.USERNAME;
					prsnlObj.initials = codeElement.PROVIDER_NAME.INITIALS;
					prsnlObj.title = codeElement.PROVIDER_NAME.TITLE;
					var mapObj = new MP_Core.MapObject(prsnlObj.id, prsnlObj);
					personnelArray[x] = mapObj;
				}
			}
			return (personnelArray);
		},
		WriteToFile: function(sText) {
			try {
				var ForAppending = 8;
				var TriStateFalse = 0;
				var fso = new ActiveXObject("Scripting.FileSystemObject");
				var newFile = fso.OpenTextFile("c:\\temp\\test.txt", ForAppending, true, TriStateFalse);
				newFile.write(sText);
				newFile.close();
			}
			catch (err) {
				var strErr = 'Error:';
				strErr += '\nNumber:' + err.number;
				strErr += '\nDescription:' + err.description;
				document.write(strErr);
			}
		},
		CalculateAge: function(bdate) {
			var age;
			//typecasting string to date obj
			var bdate = new Date(bdate);
			var byear = bdate.getFullYear();
			var bmonth = bdate.getMonth();
			var bday = bdate.getDate();
			var bhours = bdate.getHours();
			today = new Date();
			year = today.getFullYear();
			month = today.getMonth();
			day = today.getDate();
			hours = today.getHours();

			if (year == byear && (day == bday)) {
				age = hours - bhours;
				age += " Hours";
				return age;
			}
			else if (year == byear && (month == bmonth)) {
				age = day - bday;
				age += " Days";
				return age;
			}
			if (year == byear) {
				age = month - bmonth;
				age += " Months";
				return age;
			}
			else {
				if (month < bmonth) {
					age = year - byear - 1;
				}
				else if (month > bmonth) {
					age = year - byear;
				}
				else if (month == bmonth) {
					if (day < bday) {
						age = year - byear - 1;
					}
					else if (day > bday) {
						age = year - byear;
					}
					else if (day == bday) {
						age = year - byear;
					}
				}
			}
			age += " Years"
			return age;
		},
		/**
		 *  Javascript string pad
		 *  @see http://www.webtoolkit.info/
		 **/
		pad: function(str, len, pad, dir) {
			if ( typeof (len) == "undefined") {
				var len = 0;
			}
			if ( typeof (pad) == "undefined") {
				var pad = ' ';
			}
			if ( typeof (dir) == "undefined") {
				var dir = STR_PAD_RIGHT;
			}

			if (len + 1 >= str.length) {

				switch (dir) {

					case STR_PAD_LEFT:
						str = Array(len + 1 - str.length).join(pad) + str;
						break;

					case STR_PAD_BOTH:
						var right = Math.ceil(( padlen = len - str.length) / 2);
						var left = padlen - right;
						str = Array(left + 1).join(pad) + str + Array(right + 1).join(pad);
						break;

					default:
						str = str + Array(len + 1 - str.length).join(pad);
						break;

				} // switch
			}
			return str;
		},

		/**
		 * Launches graph in a modal window viewable in the Powerchart framework
		 * @param patientId The person ID for the patient selected
		 * @param encntrId The encounter ID of the visit selected
		 * @param eventCode Used to plot simple results for a given patient/encounter I.e. weight,height,BMI,BUN,WBC.
		 * @param staticContent location of the static content directory that contains the core JS / CSS files needed for the graph
		 * @param groupId If item is a grouped item pass the BR_DATAMART_FILTER_ID to pull all associated results I.e. BP,Temp,or HR.
		 * @param providerId Personnel ID of the user logged into the application
		 * @param positionCd Position <code>Code</code> of the user
		 * @param pprCD Person Personnel Relationship code value
		 * @param lookBackUnits
		 * @param lookBackType 1 = Hours, 2 = Days, 3 = Weeks, 4 = Months , 5 = Years
		 */
		GraphResults: function(eventCd, compID, groupID) {
			var component = MP_Util.GetCompObjById(compID);
			var lookBackUnits = (component.getLookbackUnits() != null && component.getLookbackUnits() > 0) ? component.getLookbackUnits() : "365";
			var lookBackType = (component.getLookbackUnitTypeFlag() != null && component.getLookbackUnitTypeFlag() > 0) ? component.getLookbackUnitTypeFlag() : "2";
			var i18nCore = i18n.discernabu;
			var subTitleText = "";
			var scope = component.getScope();
			var lookBackText = "";
			var criterion = component.getCriterion();
			component.setLookbackUnits(lookBackUnits);
			component.setLookbackUnitTypeFlag(lookBackType);

			if (scope > 0) {
				switch(lookBackType) {
					case 1:
						var replaceText = i18nCore.LAST_N_HOURS.replace("{0}", lookBackUnits);
						break;

					case 2:
						var replaceText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
						break;

					case 3:
						var replaceText = i18nCore.LAST_N_WEEKS.replace("{0}", lookBackUnits);
						break;

					case 4:
						var replaceText = i18nCore.LAST_N_MONTHS.replace("{0}", lookBackUnits);
						break;

					case 5:
						var replaceText = i18nCore.LAST_N_YEARS.replace("{0}", lookBackUnits);
						break;

					default:
						var replaceText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
						break;
				}

				switch(scope) {
					case 1:
						lookBackText = i18nCore.ALL_N_VISITS.replace("{0}", replaceText);
						var encntrOption = "0.0";
						break;
					case 2:
						lookBackText = i18nCore.SELECTED_N_VISIT.replace("{0}", replaceText);
						var encntrOption = criterion.encntr_id;
						break;
				}
			}

			var wParams = "left=0,top=0,width=1200,height=700,toolbar=no";
			var sParams = "^MINE^," + criterion.person_id + ".0," + encntrOption + "," + eventCd + ".0,^" + criterion.static_content + "\\discrete-graphing^," + groupID + ".0," + criterion.provider_id + ".0," + criterion.position_cd + ".0," + criterion.ppr_cd + ".0," + lookBackUnits + "," + lookBackType + ",200,^" + lookBackText + "^";
			var graphCall = "javascript:CCLLINK('mp_retrieve_graph_results', '" + sParams + "',1)";
			MP_Util.LogCclNewSessionWindowInfo(null, graphCall, "mp_core.js", "GraphResults");
			javascript: CCLNEWSESSIONWINDOW(graphCall, "_self", wParams, 0, 1);
			Util.preventDefault();
		},
		ReleaseRequestReference: function(reqObj) {
			if (!CERN_BrowserDevInd && XMLCCLREQUESTOBJECTPOINTER) {
				for (var id in XMLCCLREQUESTOBJECTPOINTER) {
					if (XMLCCLREQUESTOBJECTPOINTER[id] == reqObj) {
						delete (XMLCCLREQUESTOBJECTPOINTER[id])
					}
				}
			}
		},
		/**
		 * Message box similar to alert or confirm with customizable options.
		 * @param msg {string} String message or html to display in message box
		 * @param title {string} [OPTIONAL] Title of the message box
		 * @param btnTrueText {string} [OPTIONAL] Text value of the true option button, will default to 'OK' if omitted.
		 * @param btnFalseText {string} [OPTIONAL] Text value of the false option button.  No false button will be created if omitted.
		 * @param falseBtnFocus {boolean} [OPTIONAL] Sets the default focus to the false button.
		 * @param cb {object} [OPTIONAL] Callback function to fire on true button click.
		 */
		AlertConfirm: function(msg, title, btnTrueText, btnFalseText, falseBtnFocus, cb) {
			var btnTrue = "<button id='acTrueButton' data-val='1'>" + ((btnTrueText) ? btnTrueText : i18n.discernabu.CONFIRM_OK) + "</button>";
			var btnFalse = "";
			if (btnFalseText) {
				btnFalse = "<button id='acFalseButton' data-val='0'>" + btnFalseText + "</button>";
			}
			if (!title) {
				title = "&nbsp;";
			}

			var closeBox = function() {
				var btnVal = parseInt(this.getAttribute('data-val'), 10);
				$(".modal-div").remove();
				$(".modal-dialog").remove();
				$("html").css("overflow", "auto");
				//reset overflow
				if (btnVal && typeof cb === "function") {
					cb();
				}
			}
			var modalDiv = Util.cep("div", {
				"className": "modal-div"
			});
			var dialog = Util.cep("div", {
				"className": "modal-dialog"
			});

			dialog.innerHTML = "<div class='modal-dialog-hd'>" + title + "</div>" + "<div class='modal-dialog-content'>" + msg + "</div>" + "<div class='modal-dialog-ft'><div class='modal-dialog-btns'>" + btnTrue + btnFalse + "</div></div>";

			var docBody = document.body;
			Util.ac(modalDiv, docBody);
			Util.ac(dialog, docBody);

			Util.addEvent(_g('acTrueButton'), "click", closeBox);
			if (btnFalseText) {
				Util.addEvent(_g('acFalseButton'), "click", closeBox);
			}

			if (falseBtnFocus && btnFalseText) {
				_g('acFalseButton').focus();
			}
			else {
				_g('acTrueButton').focus();
			}

			$("html").css("overflow", "hidden");
			//disable page scrolling when modal is enabled
			$(modalDiv).height($(document).height());
		},
		/**
		 * Message box similar to alert or confirm with customizable options.
		 * @param msg {string} String message or html to display in message box
		 * @param title {string} [OPTIONAL] Title of the message box
		 * @param btnFalseText {string} [OPTIONAL] Text value of the false option button.  No false button will be created if omitted.
		 * @param falseBtnFocus {boolean} [OPTIONAL] Sets the default focus to the false button.
		 * @param cb {object} [OPTIONAL] Callback function to fire on closing message box.
		 */
		ActionableAlertConfirm: function(msg, title, btnFalseText, falseBtnFocus, cb) {
			var btnFalse = "";
			if (btnFalseText) {
				btnFalse = "<button id='acFalseButton' data-val='0'>" + btnFalseText + "</button>";
			}
			if (!title) {
				title = "&nbsp;";
			}

			var closeBox = function() {
				var btnVal = parseInt(this.getAttribute('data-val'), 10);
				$(".modal-div").remove();
				$(".modal-dialog-actionable").remove();
				$("html").css("overflow", "auto");
				//reset overflow
				if (cb && typeof cb === "function") {
					cb();
				}
			}
			var modalDiv = Util.cep("div", {
				"className": "modal-div"
			});
			var dialog = Util.cep("div", {
				"className": "modal-dialog-actionable"
			});

			dialog.innerHTML = "<div class='modal-dialog-hd'>" + title + "</div><div class='modal-dialog-content'>" + msg + "</div><div id='acActionableContent' class='modal-dialog-actionable-content'></div><div class='modal-dialog-ft'><div class='modal-dialog-btns'>" + btnFalse + "</div></div>";

			var docBody = document.body;
			Util.ac(modalDiv, docBody);
			Util.ac(dialog, docBody);

			if (btnFalseText) {
				Util.addEvent(_g('acFalseButton'), "click", closeBox);
			}

			if (falseBtnFocus && btnFalseText) {
				_g('acFalseButton').focus();
			}

			$("html").css("overflow", "hidden");
			//disable page scrolling when modal is enabled
			$(modalDiv).height($(document).height());
		},
		CreateAutoSuggestBoxHtml: function(component, elementId) {
			var searchBoxHTML = [];
			var txtBoxId = "";
			var compNs = component.getStyles().getNameSpace();
			var compId = component.getComponentId();
			if (elementId) {
				txtBoxId = compNs + elementId + compId;
			}
			else {
				txtBoxId = compNs + "ContentCtrl" + compId;
			}

			searchBoxHTML.push("<div class='search-box-div'><form name='contentForm' onSubmit='return false'><input type='text' id='", txtBoxId, "'", " class='search-box'></form></div>");
			return searchBoxHTML.join("");
		},
		AddAutoSuggestControl: function(component, queryHandler, selectionHandler, selectDisplayHandler, itemId) {
			new AutoSuggestControl(component, queryHandler, selectionHandler, selectDisplayHandler, itemId);
		},
		RetrieveAutoSuggestSearchBox: function(component) {
			var componentNamespace = component.getStyles().getNameSpace();
			var componentId = component.getComponentId();
			return _g(componentNamespace + "ContentCtrl" + componentId);
		},
		CreateParamArray: function(ar, type) {
			var returnVal = (type === 1) ? "0.0" : "0";
			if (ar && ar.length > 0) {
				if (ar.length > 1) {
					if (type === 1) {
						returnVal = "value(" + ar.join(".0,") + ".0)"
					}
					else {
						returnVal = "value(" + ar.join(",") + ")"
					}
				}
				else {
					returnVal = (type === 1) ? ar[0] + ".0" : ar[0];
				}
			}
			return returnVal;
		},
		/**
		 * Will get the date formatter associate to the locale loaded by the driver
		 * @return The date formatter to utilize for the loaded locale
		 */
		GetDateFormatter: function() {
			if (!m_df) {
				m_df = new mp_formatter.DateTimeFormatter(MPAGE_LOCALE);
			}
			return m_df;
		},
		/**
		 * Will get the numeric formatter associate to the locale loaded by the driver
		 * @return The numeric formatter to utilize for the loaded locale
		 */
		GetNumericFormatter: function() {
			if (!m_nf) {
				m_nf = new mp_formatter.NumericFormatter(MPAGE_LOCALE);
			}
			return m_nf;
		},
		/**
		 * Replaces the current MPages view with the output of the reportName script
		 */
		PrintReport: function(reportName, person_id, encounter_id) {
			var paramString = "^MINE^,^" + reportName + "^," + person_id + "," + encounter_id;
			CCLLINK("pwx_rpt_driver_to_mpage", paramString, 1);
		},
		CalculatePrecision: function(valRes) {
			var precision = 0;
			var str = (MP_Util.IsString(valRes)) ? valRes : valRes.toString();
			var decLoc = str.search(/\.(\d)/);
			if (decLoc !== -1) {
				var strSize = str.length;
				precision = strSize - decLoc - 1;
			}
			return precision;
		},
		/**
		 * Will create a date/time in the format neccessary for passing as a prompt parameter
		 */
		CreateDateParameter: function(date) {
			var day = date.getDate();
			var month = ""
			var rest = date.format("yyyy HH:MM:ss");
			switch (date.getMonth()) {
				case (0):
					month = "JAN";
					break;
				case (1):
					month = "FEB";
					break;
				case (2):
					month = "MAR";
					break;
				case (3):
					month = "APR";
					break;
				case (4):
					month = "MAY";
					break;
				case (5):
					month = "JUN";
					break;
				case (6):
					month = "JUL";
					break;
				case (7):
					month = "AUG";
					break;
				case (8):
					month = "SEP";
					break;
				case (9):
					month = "OCT";
					break;
				case (10):
					month = "NOV";
					break;
				case (11):
					month = "DEC";
					break;
				default:
					alert("unknown month");
			}
			return (day + "-" + month + "-" + rest);
		},
		LogDebug: function(debugString) {
			if(!log.isBlackBirdActive()){ return; }
			if (debugString) {
				log.debug(debugString);
			}
		},
		LogWarn: function(warnString) {
			if(!log.isBlackBirdActive()){ return; }
			if (warnString) {
				log.warn(warnString);
			}
		},
		LogInfo: function(infoString) {
			if(!log.isBlackBirdActive()){ return; }
			if (infoString) {
				log.info(infoString);
			}
		},
		LogError: function(errorString) {
			if(!log.isBlackBirdActive()){ return; }
			if (errorString) {
				log.error(errorString);
			}
		},
		LogScriptCallInfo: function(component, request, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.debug(["Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />Script: ", request.url, "<br />Request: ", request.requestText, "<br />Reply: ", request.responseText].join(""));
		},
		LogScriptCallError: function(component, request, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.error(["Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />Script: ", request.url, "<br />Request: ", request.requestText, "<br />Reply: ", request.responseText, "<br />Status: ", request.status].join(""));
		},
		LogJSError: function(err, component, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.error(["Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />JS Error", "<br />Message: ", err.message, "<br />Name: ", err.name, "<br />Number: ", (err.number & 0xFFFF), "<br />Description: ", err.description].join(""));
		},
		LogDiscernInfo: function(component, objectName, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.debug(["Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />Discern Object: ", objectName].join(""));
		},
		LogMpagesEventInfo: function(component, eventName, params, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.debug(["Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />MPAGES_EVENT: ", eventName, "<br />Params: ", params].join(""));
		},
		LogCclNewSessionWindowInfo: function(component, params, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.debug(["CCLNEWSESSIONWINDOW Creation", "Component: ", ( component ? component.getLabel() : ""), "<br />ID: ", ( component ? component.getComponentId() : ""), "<br />File: ", file, "<br />Function: ", funcName, "<br />Params: ", params].join(""));
		},
		LogTimerInfo: function(timerName, subTimerName, timerType, file, funcName) {
			if(!log.isBlackBirdActive()){ return; }
			log.debug(["Timer Name: ", timerName, "<br />Subtime Name:  ", subTimerName, "<br />Timer Type: ", timerType, "<br />File: ", file, "<br />Function: ", funcName].join(""));
		},
		AddCookieProperty: function(compId, propName, propValue) {
			var cookie = CK_DATA[compId];
			if (!cookie) {
				cookie = {};
			}
			cookie[propName] = propValue;
			CK_DATA[compId] = cookie;
		},
		GetCookieProperty: function(compId, propName) {
			var cookie = CK_DATA[compId];
			if (cookie && cookie[propName]) {
				return cookie[propName];
			}
			else {
				return null;
			}
		},
		WriteCookie: function() {
			var cookieJarJSON = JSON.stringify(CK_DATA);
			document.cookie = 'CookieJar=' + cookieJarJSON + ';';
		},
		RetrieveCookie: function() {
			var cookies = document.cookie;
			var match = cookies.match(/CookieJar=({[^;]+})(;|\b|$)/);
			if (match && match[1]) {
				CK_DATA = JSON.parse(match[1]);
			}
		},
		generateModalDialogBody: function(IDName,Type,Line1,Line2){
			var currModal = MP_ModalDialog.retrieveModalDialogObject(IDName);
			var modal;
			if(!currModal){
				modal = new ModalDialog(IDName);
			}
			else{
				modal = currModal;
			}
			var modalHTML;
			var typeToString = Type.toString().toLowerCase();
			modal.setLeftMarginPercentage(35).setRightMarginPercentage(35).setTopMarginPercentage(20).setIsBodySizeFixed(false).setIsBodySizeFixed(false).setIsFooterAlwaysShown(true);
			//Determine which HTML string to use based on the type
			switch(typeToString){
				case "error":
					modalHTML = "<div class='modal-error-container'><span class='error-text'>"+Line1+"</span> "+Line2+"</div>";			
					break;
				case "warning":
					modalHTML = "<div class='modal-warning-container'><span class='modal-text'>"+Line1+"</span> "+Line2+"</div>";
					break;
				/*
				 * KE020126: Commented out the information and default sections.  We don't have a current use for these
				 * but can easily be uncommented in the future.
				 
				case "information":
					modalHTML = "<div class='modal-information-container'><span class='modal-text'>"+Line1+"</span> "+Line2+"</div>";
					break;
				*/
				case "busy":
					modalHTML = "<div class='modal-busy-container'><span class='modal-text'>"+Line1+"</span> "+Line2+"</div>";
					break;
				/*
				default:
					modalHTML = "<div class='modal-default-container'><span class='modal-text'>"+Line1+"</span> "+Line2+"</div>";
					break;
				*/
			}
			
			if(modal.isActive()){
				modal.setBodyHTML(modalHTML);
			}
			else{
				modal.setBodyDataFunction(function(modalObj){
				 modalObj.setBodyHTML(modalHTML);
				});
			}
			return modal;
		},
		/**
		 * Creates a mapping between a string identifier and an object definition.  The object definition is only mapped
		 * when the objectDefinition parameter is an actual object and an existing object does not exist for that
		 * identifier.
		 * @param {string} mappingId : An id associated to the specific object definition that will be mapped.  This id is case
		 * insensitive.
		 * @param {function} objectDefinition : A reference to the definition of the object being mapped
		 * @return {boolean} True if the object mapping was added successfully, false otherwise.
		 */
		setObjectDefinitionMapping : function(mappingId, objectDefinition) {
			//Make sure the mappingID is a string
			if(typeof mappingId !== "string"){
				return false;
			}			
			mappingId = mappingId.toUpperCase();
			
			//Check to see if there is an existing mapping for that ID
			if( typeof CERN_ObjectDefinitionMapping[mappingId] !== "undefined") {
				MP_Util.LogInfo("Object mapping already exists for " + mappingId + "\nPlease select a different id or use the MP_Util.updateObjectDefinitionMApping function");
				return false;
			}
			//Make sure we are mapping an object definition which would be a function
			if( typeof objectDefinition === "function" ) {
				CERN_ObjectDefinitionMapping[mappingId] = objectDefinition;
				return true;
			}
			return false;
		},
		/**
		 * Retrieves the object mapped to a specific mappingId if it is defined in the CERN_ObjectDefinitionMapping object
		 * @param {string} mappingId : The id mapped to a specific object in the CERN_ObjectDefintionMapping object.   This id is case
		 * insensitive.
		 * @return {function} The object definition mapped to the mappingId passed into the function.
		 */
		getObjectDefinitionMapping : function(mappingId) {
			//Make sure the mappingID is a string
			if(typeof mappingId !== "string"){
				return null;
			}
			mappingId = mappingId.toUpperCase();
			//Attempt to retrieve the object definition
			if( typeof CERN_ObjectDefinitionMapping[mappingId] === "undefined") {
				return null;
			}
			return CERN_ObjectDefinitionMapping[mappingId];
		},
		/**
		 * Updates the object definition mapped to the identifier passed into the function.  If no object is mapped to the
		 * identifier then no updates are made to the CERN_ObjectDefinitionMapping object.
		 * @param {string} mappingId : An id associated to the specific object definition that will be mapped.  This id is case
		 * insensitive.
		 * @param {function} objectDefinition : A reference to the definition of the object being mapped
		 * @return {boolean} True if the object mapping was updated successfully, false otherwise.
		 */
		updateObjectDefinitionMapping : function(mappingId, objectDefinition) {
			//Make sure the mappingID is a string
			if(typeof mappingId !== "string"){
				return null;
			}
			mappingId = mappingId.toUpperCase();
			//Make sure an object definition already exists for this mappingId
			if( typeof CERN_ObjectDefinitionMapping[mappingId] === "undefined") {
				MP_Util.LogInfo("Object mapping does not exists for " + mappingId);
				return false;
			}
			//Make sure we are mapping an object definition which would be a function
			if( typeof objectDefinition === "function" ) {
				CERN_ObjectDefinitionMapping[mappingId] = objectDefinition;
				return true;
			}
			return false;
		},
		/**
		 * Removes the object definition mapped to the identifier passed into the function.
		 * @param {string} mappingId : An id associated to the specific object definition that will be removed.  This id is case
		 * insensitive.
		 * @return {boolean} True if the object mapping was removed successfully, false otherwise.
		 */
		removeObjectDefinitionMapping : function(mappingId) {
			//Make sure the mappingID is a string
			if(typeof mappingId !== "string"){
				return null;
			}
			mappingId = mappingId.toUpperCase();
			//Make sure the object definition exists before we attempt to delete it 
			if( typeof CERN_ObjectDefinitionMapping[mappingId] === "undefined") {
				MP_Util.LogInfo("Object mapping does not exists for " + mappingId);
				return false;
			}
			return delete CERN_ObjectDefinitionMapping[mappingId];
		}
	};
	/**
	 * Calculates difference between two dates given and returns string with appropriate units
	 * If no endDate is given it is assumed the endDate is the current date/time
	 *
	 * @param beginDate [REQUIRED] Begin <code>Date</code> for Calculation
	 * @param endDate [OPTIONAL] End <code>Date</code> for Calculation
	 * @param mathFlag [OPTIONAL] <code>Integer</code> Flag to determine if Math.Ceil or Math.Floor is used defaults to Math.floor 1 =
	 * Floor, 0 = Ceil
	 * @param abbreviateFlag [REQUIRED] <code>Boolean</code> to determine if shortened versions of Month,Year,Weeks,Days should be used
	 * such as in the case of a within string
	 */
	function GetDateDiffString(beginDate, endDate, mathFlag, abbreviateFlag) {
		var i18nCore = i18n.discernabu;
		var timeDiff = 0;
		var returnVal = "";
		//Set endDate to current time if it's not passed in
		endDate = (!endDate) ? new Date() : endDate;
		mathFlag = (!mathFlag) ? 0 : mathFlag;
		var one_minute = 1000 * 60;
		var one_hour = one_minute * 60;
		var one_day = one_hour * 24;
		var one_week = one_day * 7;

		var valMinutes = 0;
		var valHours = 0;
		var valDays = 0;
		var valWeeks = 0;
		var valMonths = 0;
		var valYears = 0;
		//time diff in milliseconds
		timeDiff = (endDate.getTime() - beginDate.getTime());

		//Choose if ceiling or floor should be applied
		var mathFunc = null;
		var comparisonFunc = null;
		if (mathFlag == 0) {
			mathFunc = function(val) {
				return Math.ceil(val);
			}
			comparisonFunc = function(lowerVal, upperVal) {
				return (lowerVal <= upperVal);
			}
		}
		else {
			mathFunc = function(val) {
				return Math.floor(val);
			}
			comparisonFunc = function(lowerVal, upperVal) {
				return (lowerVal < upperVal);
			}
		}

		var calcMonths = function() {
			var removeCurYr = 0;
			var removeCurMon = 0;
			var yearDiff = 0;
			var monthDiff = 0;
			var dayDiff = endDate.getDate();
			if (endDate.getMonth() > beginDate.getMonth()) {
				monthDiff = endDate.getMonth() - beginDate.getMonth();
				if (endDate.getDate() < beginDate.getDate()) {
					removeCurMon = 1;
				}
			}
			else if (endDate.getMonth() < beginDate.getMonth()) {
				monthDiff = 12 - beginDate.getMonth() + endDate.getMonth();
				removeCurYr = 1;
				if (endDate.getDate() < beginDate.getDate()) {
					removeCurMon = 1;
				}
			}
			else if (endDate.getDate() < beginDate.getDate()) {
				removeCurYr = 1;
				monthDiff = 11;
			}

			if (endDate.getDate() >= beginDate.getDate()) {
				dayDiff = endDate.getDate() - beginDate.getDate();
			}

			yearDiff = (endDate.getFullYear() - beginDate.getFullYear()) - removeCurYr;
			//days are divided by 32 to ensure the number will always be less than zero
			monthDiff += (yearDiff * 12) + (dayDiff / 32) - removeCurMon;

			return monthDiff;
		};

		valMinutes = mathFunc(timeDiff / one_minute);
		valHours = mathFunc(timeDiff / one_hour);
		valDays = mathFunc(timeDiff / one_day);
		valWeeks = mathFunc(timeDiff / one_week);
		valMonths = calcMonths();
		valMonths = mathFunc(valMonths);
		valYears = mathFunc(valMonths / 12);

		if (comparisonFunc(valHours, 2))//Less than 2 hours, display number of minutes. Use abbreviation of "mins".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_MINS.replace("{0}", valMinutes)) : (i18nCore.X_MINUTES.replace("{0}", valMinutes));
		else if (comparisonFunc(valDays, 2))//Less than 2 days, display number of hours. Use abbreviation of "hrs".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_HOURS.replace("{0}", valHours)) : (i18nCore.X_HOURS.replace("{0}", valHours));
		else if (comparisonFunc(valWeeks, 2))//Less than 2 weeks, display number of days. Use "days".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_DAYS.replace("{0}", valDays)) : (i18nCore.X_DAYS.replace("{0}", valDays));
		else if (comparisonFunc(valMonths, 2))//Less than 2 months, display number of weeks. Use abbreviation of "wks".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_WEEKS.replace("{0}", valWeeks)) : (i18nCore.X_WEEKS.replace("{0}", valWeeks));
		else if (comparisonFunc(valYears, 2))//Less than 2 years, display number of months. Use abbreviation of "mos".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_MONTHS.replace("{0}", valMonths)) : (i18nCore.X_MONTHS.replace("{0}", valMonths));
		else//Over 2 years, display number of years.  Use abbreviation of "yrs".
			returnVal = abbreviateFlag ? (i18nCore.WITHIN_YEARS.replace("{0}", valYears)) : (i18nCore.X_YEARS.replace("{0}", valYears));

		return (returnVal);
	}

}();

/**
 * @namespace
 */
MP_Util.Doc = function() {
	var isExpandedAll = false;
	var openAccordion = '';

	return {
		SetupExpandCollapse: function(categoryMeaning) {
			var i18nCore = i18n.discernabu;
			//set up expand collapse for all components
			var body = null;
			var toggleArray = null;;
			if(categoryMeaning){
				body =_g(categoryMeaning);
				toggleArray = Util.Style.g("sec-hd-tgl", body, "span");
			}
			else{
				toggleArray = Util.Style.g("sec-hd-tgl");
			}
			for (var k = 0; k < toggleArray.length; k++) {
				Util.addEvent(toggleArray[k], "click", MP_Util.Doc.ExpandCollapse);
				var checkClosed = Util.gp(Util.gp(toggleArray[k]));
				if (Util.Style.ccss(checkClosed, "closed")) {
					toggleArray[k].innerHTML = "+";
					toggleArray[k].title = i18nCore.SHOW_SECTION;
				}
			}
		},

		SetupCompFilters: function(compArray) {
			var comp = null;
			var compArrayLen = compArray.length;
			var hasFilters = false;
			for (var x = 0; x < compArrayLen; x++) {
				comp = compArray[x];
				hasFilters = false;
				for (var y = 0; y < 10; y++) {
					if (comp.getGrouperLabel(y) || comp.getGrouperCatLabel(y)) {
						hasFilters = true;
						break;
					}
				}
				comp.setCompFilters(hasFilters);
				if (comp.hasCompFilters() && comp.isDisplayable()) {
					comp.renderAccordion(comp);
				}
			}
		},

		/**
		 * Initialized the page based on a configuration of multiple MPage objects
		 * @param {Array} arMapObjects Array of the MPages to initialize the tab layout.
		 * @param {String} title The title to be associated to the page.
		 * @param {int} displayType How multiple MPages will be displayed.  Default is tab layout.
		 * @param {String} criterionGroup If InitSelectorLayout is called this is a parent group for multiple MPage Views.
		 */
		InitMPageTabLayout: function(arMapObjects, title, displayType, criterionGroup) {
			var arItems = [];
			var sc = "", helpFile = "", helpURL = "", debugInd = false;
			var bDisplayBanner = false;
			var criterion = null;
			var custInd = true;
			var anchorArray = null;

			for (var x = 0, xl = arMapObjects.length; x < xl; x++) {
				var key = arMapObjects[x].name;
				var page = arMapObjects[x].value;
				criterion = page.getCriterion();
				arItems.push(new MP_Core.TabItem(key, page.getName(), page.getComponents(), criterion.category_mean))
				sc = criterion.static_content;
				debugInd = criterion.debug_ind;
				helpFile = page.getHelpFileName();
				helpURL = page.getHelpFileURL();
				custInd = page.getCustomizeEnabled();
				anchorArray = page.getTitleAnchors();
				if (page.isBannerEnabled())
					bDisplayBanner = page.isBannerEnabled();
			}
			if (displayType === 1) {//Select Box
				MP_Util.Doc.InitSelectorLayout(arItems, title, sc, helpFile, helpURL, bDisplayBanner, 0, criterionGroup, custInd, anchorArray);
			}
			else {
				MP_Util.Doc.InitTabLayout(arItems, title, sc, helpFile, helpURL, bDisplayBanner, 0, criterion, custInd, anchorArray);
			}

		},
		/**
		 * Initialized the page based on a configuration of multiple TabItem objects
		 * @param {Array} arTabItems Array of the tab Objects to initialize the tab layout.
		 * @param {String} title The title to be associated to the page.
		 * @param {String} sc The static content file location.
		 * @param {String} helpFile The string name of the help file to associate to the page.
		 * @param {String} HelpURL The String name of the help file URL to associate to the page.
		 * @param {Boolean} debugInd A boolean indicator denoting if the MPage should be run in debug mode
		 */
		InitTabLayout: function(arTabItems, title, sc, helpFile, helpURL, includeBanner, debugInd, criterion, custInd, anchorArray) {
			var body = document.body;
			var i18nCore = i18n.discernabu;
			//create page title
			MP_Util.Doc.AddPageTitle(title, body, debugInd, custInd, anchorArray, helpFile, helpURL, criterion);

			//check if banner should be created
			if (includeBanner) {
				body.innerHTML += "<div id='banner' class='demo-banner'></div>";
			}
			body.innerHTML += "<div id='disclaimer' class='disclaimer'><span>" + i18nCore.DISCLAIMER + "</span></div>";

			//create unordered list for page level tabs
			//  a) need the id of the tabs to identify, b) the name of the tab, c) the components to add
			AddPageTabs(arTabItems, body);

			//create component placeholders for each tab
			CERN_TabManagers = [];
			for (var x = 0, xl = arTabItems.length; x < xl; x++) {
				var tabItem = arTabItems[x];
				var tabManager = new MP_Core.TabManager(tabItem);
				if (x == 0) {
					//the first tab will be selected upon initial loading of page.
					tabManager.setSelectedTab(true);
				}
				CERN_TabManagers.push(tabManager);
				CreateLiquidLayout(tabItem.components, _g(arTabItems[x].key), true);
				SetupCompFilters(tabItem.components);
				MP_Util.Doc.CreateCompMenus(tabItem.components, true);
			}
			MP_Util.Doc.AddCustomizeLink(criterion);
			SetupExpandCollapse();
		},
		/**
		 * Initialized the page based on a configuration of multiple MPage objects viewable through a select box
		 * @param {Array} arTabItems Array of the tab Objects to initialize the tab layout.
		 * @param {String} title The title to be associated to the page.
		 * @param {String} sc The static content file location.
		 * @param {String} helpFile The string name of the help file to associate to the page.
		 * @param {String} HelpURL The String name of the help file URL to associate to the page.
		 * @param {Boolean} debugInd A boolean indicator denoting if the MPage should be run in debug mode
		 * @param {Object} A different div to insert the tabbed page into
		 */
		InitSelectorLayout: function(arTabItems, title, sc, helpFile, helpURL, includeBanner, debugInd, criterion, custInd, anchorArray, buildDiv, MPageObj) {
			var body = {};
			if (buildDiv) {
				body = buildDiv;
			}
			else {
				body = document.body;
			}
			var i18nCore = i18n.discernabu;

			//first, check to see if they have a last saved view saved to User Prefs
			var jsonObject = MP_Core.AppUserPreferenceManager.GetQOCPreferences();
			var userPrefs, pagePrefs, views, lastSavedView;
			if (jsonObject) {
				userPrefs = jsonObject.user_prefs;
				pagePrefs = userPrefs.page_prefs;
				views = pagePrefs.views;

				var view = jsonObject.user_prefs.page_prefs.last_saved_view;

				if (view) {
					lastSavedView = view;
				}
				else {
					//if for some reason the view hasn't been defined for this page, set the last saved view to a blank string
					lastSavedView = "";
				}
				if (!views) {//if "views" does not exist, then the user still has the old user prefs, which gurantees a last saved view
					pagePrefs = userPrefs.page_prefs = {};
					views = pagePrefs.views = [];
					//since we know there is a last saved view, add it back to the JSON
					jsonObject.user_prefs.page_prefs.last_saved_view = lastSavedView;
					//add a new view object for the last saved view for use with Drag and Drop
					var newView = {};
					newView.label = lastSavedView;
					newView.components = [];
					views.push(newView);
					////overwrite old user prefs
					MP_Core.AppUserPreferenceManager.SaveQOCPreferences(jsonObject, true);
				}
			}
			else {
				lastSavedView = "";
			}

			//create page title if this is a single MPage
			if (!buildDiv) {
				MP_Util.Doc.AddPageTitle(title, body, debugInd, custInd, anchorArray, helpFile, helpURL, criterion, null);
			}
			else {//only MP_COMMON_ORDERS in a viewpoint is passing in a category_meaning and needs a title bar for the selector
				//MP_Util.Doc.AddPageTitle(title,body,debugInd,custInd,anchorArray,helpFile,helpURL,criterion,buildDiv.getAttribute("id"));
				var i18nCore = i18n.discernabu;
				var ar = [];
				var imgSource = criterion.static_content + "/images/3865_16.gif";
				title = "";
				buildDiv.innerHTML = "";
				ar.push("<div class='pg-hd'>");
				ar.push("<h1><span class='pg-title'>", title, "</span></h1><span id='pageCtrl", criterion.category_mean, "' class='page-ctrl'>");
				//'as of' date is always to the far left of items
				var df = MP_Util.GetDateFormatter();
				ar.push("<span class='other-anchors'>", i18nCore.AS_OF_TIME.replace("{0}", df.format(new Date(), mp_formatter.DateTimeFormatter.TIME_24HOUR_NO_SECONDS)), "</span>");
				ar.push("</span></div>");
				buildDiv.innerHTML += ar.join("");
			}

			//check if banner should be created
			if (includeBanner) {
				body.innerHTML += "<div id='banner" + MPageObj.getCategoryMean() + "' class='demo-banner'>&nbsp;</div>";
			}
			else{
				//if the banner isn't included we need to add a placeholder that takes up space so the view layout will display
				body.innerHTML += "<div class='demo-banner'>&nbsp;</div>";
			}

			//create QOC selector
			LoadPageSelector(arTabItems, body, lastSavedView, criterion);

			var lastSavedTabKey = null;
			//create component placeholders for each tab
			CERN_TabManagers = [];
			for (var x = 0, xl = arTabItems.length; x < xl; x++) {
				var tabItem = arTabItems[x];
				var tabManager = new MP_Core.TabManager(tabItem);
				if (x == 0) {
					//the first tab will be selected upon initial loading of page.
					tabManager.setSelectedTab(true);
				}
				if (lastSavedView === tabItem.name) {
					lastSavedTabKey = tabItem.key;
				}
				CERN_TabManagers.push(tabManager);
				if (views) {
					var alreadyAddedView = false;
					var viewsLength = views.length;
					for (var j = viewsLength; j--; ) {
						var currentViewName = views[j].label;
						if (currentViewName === tabItem.name) {
							alreadyAddedView = true;
							if (views[j].components.length > 0) {
								var updatedQOCComponents = UpdateQOCComponentsWithUserPrefs(tabItem.components, views[j].components, criterion, MPageObj);
								//Must create dummy mpage in the case that MPageObj is null
								var dummyMpage = new CommonOrdersMPage();
								dummyMpage.renderComponents(updatedQOCComponents, $("#" + tabItem.key));
							}
							else {
								//Must create dummy mpage in the case that MPageObj is null
								var dummyMpage = new CommonOrdersMPage();
								dummyMpage.renderComponents(tabItem.components, $("#" + tabItem.key));
							}
							break;
						}
					}
					if (!alreadyAddedView) {
						//Must create dummy mpage in the case that MPageObj is null
						var dummyMpage = new CommonOrdersMPage();
						dummyMpage.renderComponents(tabItem.components, $("#" + tabItem.key));
					}
				}
				else {
					//Must create dummy mpage in the case that MPageObj is null
					var dummyMpage = new CommonOrdersMPage();
					dummyMpage.renderComponents(tabItem.components, $("#" + tabItem.key));
				}
				
				//Setup the categoryMean and the criterion info for future use
				dummyMpage.setCategoryMean(tabItem.key);
				dummyMpage.setCriterion(criterion);
				//Create the page menu for the specific CommonOrdersMPage
				dummyMpage.loadPageMenu();
				
				MP_Util.Doc.CreateQOCCompMenus(tabItem.components, false, tabItem.key);
			}
			MP_Util.Doc.SetupExpandCollapse(MPageObj.getCategoryMean());
			if (lastSavedTabKey) {
				MP_Util.Doc.InitQOCDragAndDrop(lastSavedTabKey);
			}
		},
		/**
		 * Initialize the mpage workflow view layout
		 * @param {object} navSubSecMPage object which holds the configuration for the components on the page.
		 * @param {String} helpFile The string name of the help file to associate to the page.
		 * @param {String} HelpURL The String name of the help file URL to associate to the page.
		 * @param {String} categoryMeaning The String name of the help file URL to associate to the page.
		 */
		InitWorkflowLayout: function(navSubSecMPage, helpFile, helpURL, categoryMeaning) {
			var i18nCore = i18n.discernabu;
			var criterion = navSubSecMPage.getCriterion();
			var mpComps = [];

			if (categoryMeaning) {
				var body = _g(categoryMeaning);
			}
			else {
				var body = document.body;
			}

			//GetComponentArray basically sorts the components into a 2-d array.  The first dimension is component groups and the second dimension is
			//columns within that group.  Since we are in a workflow view layout there is always one group and one column in that group.  That is why we
			//are using filteredComps[0][0] as our array of components in the view.
			var filteredComps = MP_Util.GetComponentArray(navSubSecMPage.getComponents());
			if (filteredComps[0] && filteredComps[0][0]) {
				mpComps = filteredComps[0][0];
			}

			var sHTML = [];
			sHTML.push("<div>");
			sHTML.push("<div class='col-group one-col'>");
			sHTML.push("<div class='col-outer2'><div class='col-outer1'>");
			var colClassName = "col1";
			sHTML.push("<div class='", colClassName, "'>");

			for (var x = 0; x < mpComps.length; x++) {
				sHTML.push(CreateCompDiv(mpComps[x]));
			}
			sHTML.push("</div>");
			sHTML.push("</div></div></div></div>");
			body.innerHTML += sHTML.join("");

			SetupExpandCollapse();
			SetupCompFilters(mpComps);
			MP_Util.Doc.CreateCompMenus(mpComps, false);
		},
		/**
		 * Initialize the mpage layout
		 * @param {mPage}  mPage object which holds the configuration for the components on the page.
		 * @param {String} helpFile The string name of the help file to associate to the page.
		 * @param {String} HelpURL The String name of the help file URL to associate to the page.
		 */
		InitLayout: function(mPage, helpFile, helpURL, categoryMeaning) {
			var i18nCore = i18n.discernabu;
			var criterion = mPage.getCriterion();
			if (categoryMeaning) {
				var body = _g(categoryMeaning);
			}
			else {
				var body = document.body;
			}

			//Ignore the page title since we are in a viewpoint
			if (!categoryMeaning) {
				MP_Util.Doc.AddPageTitle(mPage.getName(), body, criterion.debug_ind, mPage.getCustomizeEnabled(), mPage.getTitleAnchors(), helpFile, helpURL, criterion, categoryMeaning);
			}

			if (mPage.isBannerEnabled()) {
				body.innerHTML += "<div id='banner" + criterion.category_mean + "' class='demo-banner'></div>";
			}

			var mpComps = mPage.getComponents();
			CreateLiquidLayout(mpComps, body);
			MP_Util.Doc.AddCustomizeLink(criterion);
			SetupExpandCollapse();
			SetupCompFilters(mpComps);
			MP_Util.Doc.CreateCompMenus(mpComps, false);
			MP_Util.Doc.InitDragAndDrop(categoryMeaning);
			MP_Util.Doc.CreatePageMenu(categoryMeaning, criterion.category_mean);

		},

		InitDragAndDrop: function(categoryMeaning) {
			var parentElement = null;
			var self = this;
			var vpParent = "";
			if (categoryMeaning && typeof m_viewpointJSON == "string") {
				vpParent = "#" + categoryMeaning + " ";

			}
			$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3").sortable({
				connectWith: vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3 ",
				items: " .section",
				zIndex: 1005,
				appendTo: "body",
				handle: "h2",
				over: function(event, ui) {
					if ($(this).attr("class") !== ui.sender.attr("class")) {
						$(this).css("z-index", "1");
					}
				},
				start: function(event, ui) {
					$(this).css("z-index", "2");
					ui.item.css("z-index", "2");

					// get sortable containers, assuming connectWith is NOT optimized
					var containers = $(this).parent().children();

					var tallest = 0;
					// may not need height: auto
					$(containers).height('auto');
					$(containers).each(function() {
						if ($(this).height() > tallest) {
							tallest = $(this).height();
						}
					});

					$(containers).height(tallest + $(ui.item).height());

				},

				stop: function(event, ui) {
					ui.item.css("z-index", "1");
					$(this).css("z-index", "1");
					if (ui.sender) {
						ui.sender.css("z-index", "1");
					}
					CERN_EventListener.fireEvent(null, self, EventListener.EVENT_COMP_CUSTOMIZE, null);
					// get sortable containers, assuming connectWith is NOT optimized
					var containers = $(this).parent().children();
					// set height back to their natural height
					$(containers).height('auto');

				},
				update: function() {
					setTimeout(function() {
						MP_Core.AppUserPreferenceManager.SaveCompPreferences(null, "", null, true);
					}, 0);
				}
			});

			//Determine if the drag and drop should be active or not
			parentElement = (vpParent) ? $(vpParent) : $(document.body);
			if ($(parentElement).hasClass("dnd-enabled")) {
				$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3").sortable("enable");
				$(vpParent + " .col-outer1:last .sec-hd").css("cursor", "move");
			}
			else {
				$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3").sortable("disable");
				$(vpParent + " .col-outer1:last .sec-hd").css("cursor", "auto");
			}
		},
		InitQOCDragAndDrop: function(categoryMeaning) {
			var vpParent = "#" + categoryMeaning + " ";

			$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3," + vpParent + " .col-outer1:last .col4," + vpParent + " .col-outer1:last .col5").sortable({
				connectWith: vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3," + vpParent + " .col-outer1:last .col4," + vpParent + " .col-outer1:last .col5 ",
				items: " .section",
				zIndex: 1005,
				appendTo: "body",
				handle: "h2",
				over: function(event, ui) {
					if ($(this).attr("class") !== ui.sender.attr("class")) {
						$(this).css("z-index", "auto");
					}
				},
				start: function(event, ui) {
					$(this).css("z-index", "2");
					ui.item.css("z-index", "2");
				},
				stop: function(event, ui) {
					ui.item.css("z-index", "auto");
					$(this).css("z-index", "auto");
					if (ui.sender) {
						ui.sender.css("z-index", "auto");
					}
				},
				update: function() {
					setTimeout(function() {
						MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, categoryMeaning);
					}, 0);
				}
			});

			//Determine if the drag and drop should be active or not
			if ($(vpParent).hasClass("qoc-dnd-enabled")) {
				$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3," + vpParent + " .col-outer1:last .col4," + vpParent + " .col-outer1:last .col5").css("padding-bottom", "100px").sortable("enable");
				$(vpParent + " .col-outer1:last .sec-hd").css("cursor", "move");
			}
			else {
				$(vpParent + " .col-outer1:last .col1," + vpParent + " .col-outer1:last .col2," + vpParent + " .col-outer1:last .col3," + vpParent + " .col-outer1:last .col4," + vpParent + " .col-outer1:last .col5").css("padding-bottom", "100px").sortable("disable");
				$(vpParent + " .col-outer1:last .sec-hd").css("cursor", "auto");
			}
		},
		CreatePageMenu: function(categoryMeaning, critCatMean) {
			var pageMenuId = "pageMenu" + critCatMean;
			var setupPageMenu = function(menuId, initialColCnt) {
				if (_g(menuId)) {
					var optMenu = _g("moreOptMenu" + menuId);
					if (!optMenu) {
						optMenu = Util.cep("div", {
							className: "opts-menu-content menu-hide",
							id: "moreOptMenu" + menuId
						});

						var i18nCore = i18n.discernabu;
						optMenu.innerHTML += '<div class="opts-personalize-sec" id="optsMenupersonalize' + menuId + '"><div class="opts-menu-item opts-sub-menu" id="optsDefLayout' + menuId + '">' + i18nCore.VIEW_LAYOUT + '</div><div class="opts-menu-item" id="optsDefClearPrefs' + menuId + '">' + i18nCore.CLEAR_PREFERENCES + '</div></div>';
						Util.ac(optMenu, document.body);
					}
					InitPageOptMenu(optMenu, menuId, false);
					var layoutOut = function(e) {
						if (!e) {
							e = window.event;
						}
						var relTarg = e.relatedTarget || e.toElement;
						if (relTarg) {
							if (!Util.Style.ccss(relTarg, "opts-menu-content")) {
								if (_g("optMenuConfig" + menuId)) {
									Util.Style.acss(_g("optMenuConfig" + menuId), "menu-hide");
								}
							}
						}
						else {
							if (_g("optMenuConfig" + menuId)) {
								Util.Style.acss(_g("optMenuConfig" + menuId), "menu-hide");
							}
							return;
						}
					};
					var secId = menuId.replace("mainCompMenu", "");

					$("#" + pageMenuId).click(function() {
						if (Util.Style.ccss(this, "page-menu-open")) {
							Util.Style.rcss(this, "page-menu-open")
						}
						else {
							Util.Style.acss(this, "page-menu-open")
						}

						OpenCompOptMenu(optMenu, menuId);
					});

					Util.addEvent(_g("optsDefLayout" + menuId), "mouseover", function() {
						launchSelectLayout(menuId, this, initialColCnt);
					});
					Util.addEvent(_g("optsDefLayout" + menuId), "mouseout", layoutOut);

					Util.addEvent(_g("optsDefClearPrefs" + menuId), "click", function() {
						var confirmMsg = i18nCore.CLEAR_ALL_PREFS + "<br />" + i18nCore.CLEAR_ALL_PREFS_CANCEL;
						MP_Util.AlertConfirm(confirmMsg, i18nCore.CLEAR_PREFERENCES, i18nCore.CONFIRM_CLEAR, i18nCore.CONFIRM_CANCEL, true, MP_Core.AppUserPreferenceManager.ClearPreferences);
					});
				}
			};
			var vpParent = ( typeof m_viewpointJSON == "string") ? "#" + categoryMeaning + " " : "";
			var initialColCnt;
			var curColGroupClass = $(vpParent + '.col-group:last').attr('class').replace("col-group ", "");
			switch (curColGroupClass) {
				case "three-col":
					initialColCnt = 3;
					break;
				case "two-col":
					initialColCnt = 2;
					break;
				case "one-col":
					initialColCnt = 1;
					break;
			}
			setupPageMenu(pageMenuId, initialColCnt);
		},
		GetFavFolders: function(folderId, critPersonId, critEncntrId, critProviderId, critPositionCd, critPprCd, venueType) {
			var record = null;
			var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
			info.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					MP_Util.LogScriptCallInfo(null, this, "mp_core.js", "GetNOEFavFolders");
					var jsonEval = JSON.parse(this.responseText);
					var recordData = jsonEval.RECORD_DATA;
					if (recordData.STATUS_DATA.STATUS == "Z") {
						record = recordData;
					}
					else if (recordData.STATUS_DATA.STATUS == "S") {
						record = recordData;
					}
					else {
						MP_Util.LogScriptCallError(null, this, "mp_core.js", "GetNOEFavFolders");
						var errAr = [];
						var statusData = recordData.STATUS_DATA;
						errAr.push("STATUS: " + statusData.STATUS);
						for (var x = 0, xl = statusData.SUBEVENTSTATUS.length; x < xl; x++) {
							var ss = statusData.SUBEVENTSTATUS[x];
							errAr.push(ss.OPERATIONNAME, ss.OPERATIONSTATUS, ss.TARGETOBJECTNAME, ss.TARGETOBJECTVALUE);
						}
						window.status = "Error getting user favorite folder structure: " + errAr.join(",");
					}
				}
				if (this.readyState == 4) {
					MP_Util.ReleaseRequestReference(this);
				}
			};

			var sendAr = ["^MINE^", critPersonId + ".0", critEncntrId + ".0", critProviderId + ".0", folderId + ".0", "^FAVORITES^", critPositionCd + ".0", critPprCd + ".0", "11", venueType];
			if (CERN_BrowserDevInd) {
				var url = "mp_get_powerorder_favs_json?parameters=" + sendAr.join(",");
				info.open('GET', url, false);
				info.send(null);
			}
			else {
				info.open('GET', "mp_get_powerorder_favs_json", false);
				info.send(sendAr.join(","));
			}
			return record;
		},
		RenderFavFolder: function(recordData, criterion) {
			if (recordData.STATUS_DATA.STATUS != "F") {
				var noeFavArr = recordData.USER_FAV;
				var venueTypeList = recordData.VENUE_TYPE_LIST;
			}
			var noei18n = i18n.discernabu.noe_o1;
			var pageId = "pageMenuAddFavorite1234";

			var mnuDisplay = "";
			//currently selected menu option display
			var mnuVenueType = 0;
			//currently selected menu option venue type
			var mnuNextDisplay = "";
			//next menu option display
			var mnuNextVenueType = 0;
			//next menu option venue type
			var x;
			var xl;
			var newVenue;
			var favSec = ["<div>"];
			if (venueTypeList) {
				for ( x = 0, xl = venueTypeList.length; x < xl; x++) {
					newVenue = venueTypeList[x];
					if (newVenue.SOURCE_COMPONENT_LIST[0].VALUE === 2) {
						//set next menu options
						mnuNextDisplay = newVenue.DISPLAY;
						mnuNextVenueType = 2;
					}
					else {
						//set currently selected menu option
						mnuDisplay = newVenue.DISPLAY;
						mnuVenueType = 1;
					}
				}
				var arr = [];
				arr.push("<div id='pgMnuFavFolderVenueBtns'><div><input class='page-menu-add-fav-venue' venue-val='1' type='radio' checked='checked' onclick='MP_Util.Doc.SwitchFavFolderVenue(this, \"", pageId, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")' /><span>", mnuDisplay, "</span></div><div><input class='page-menu-add-fav-venue' venue-val='2' type='radio' onclick='MP_Util.Doc.SwitchFavFolderVenue(this, \"", pageId, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")' /><span>", mnuNextDisplay, "</span></div></div>");
				favSec = favSec.concat(arr);
			}

			var noeItem;
			var noeRow;
			var noeType;
			var noeItemArr;
			var venueType = mnuVenueType;

			if (noeFavArr) {
				var favLength = noeFavArr.length;
				if (favLength === 0) {
					favSec.push("<span class='res-none'>", noei18n.NO_FAVORITES_FOUND, "</span>");
				}
				else {
					var favCnt = 0;
					var favChildFavFolder = [];
					var favSecondaryFavFolder = [];
					for ( i = 0; i < favLength; i++) {
						var noeFavsObj = noeFavArr[i];
						//account for multiple favorite folders per venue
						if (i === 0) {
							favSec.push("<div id='pgMnuFavFolderPath", pageId, "' class='noe-fav-path hdr'><dl id='pgMnuFolderPath", pageId, "' class='noe-folder-info'><dt>0</dt><dd class='noe-fav-folder'><span id='pgMnuFolderPathRoot", pageId, "'>", noeFavsObj.SHORT_DESCRIPTION, "</span></dd></dl></div>", "<div id='pgMnuFavFolderContents", pageId, "' class='page-menu-add-favorite-contents'>");

							//Create the rest of the folders/orders/caresets/PowerPlans
							noeItemArr = noeFavsObj.CHILD_LIST;
							for ( j = 0, k = noeItemArr.length; j < k; j++) {
								noeItem = noeItemArr[j];
								noeRow = [];
								noeType = noeItem.LIST_TYPE;
								if (noeType === 1) {//Favorite Folder
									favCnt++;
									noeRow.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeItem.CHILD_ALT_SEL_CAT_ID, "\", \"", noeItem.SYNONYM, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeItem.CHILD_ALT_SEL_CAT_ID, "\", \"", pageId, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", venueType, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", noeItem.SYNONYM, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'>", noeItem.SENTENCE, "</dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>", noeItem.SYN_ID, "|", venueType, "|", noeItem.SENT_ID, "</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeItem.ORDERABLE_TYPE_FLAG, "</dd></dl>");
									favChildFavFolder = favChildFavFolder.concat(noeRow);
								}
							}
						}
						else {
							favCnt++;
							if (noeFavsObj.LONG_DESCRIPTION_KEY_CAP === "FAVORITES" && (noeFavsObj.SOURCE_COMPONENT_FLAG === 2 || noeFavsObj.SOURCE_COMPONENT_FLAG === 3)) {
								folderName = noei18n.FOLDER_FAV_AMBULATORY.replace("{0}", i);
								favSecondaryFavFolder.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", folderName, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", pageId, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", venueType, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", folderName, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'></dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>0|", venueType, "|0</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeFavsObj.ORDERABLE_TYPE_FLAG, "</dd></dl>");
							}
							else {
								favSecondaryFavFolder.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", noeFavsObj.SHORT_DESCRIPTION, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", pageId, "\", \"", criterion.person_id, "\", \"", criterion.encntr_id, "\", \"", criterion.provider_id, "\", \"", criterion.position_cd, "\", \"", criterion.ppr_cd, "\", \"", venueType, "\", \"", criterion.executable, "\", \"", criterion.static_content, "\", \"", criterion.debug_ind, "\", \"", criterion.help_file_local_ind, "\", \"", criterion.category_mean, "\", \"", criterion.locale_id, "\", \"", criterion.device_location, "\")'>", noeFavsObj.SHORT_DESCRIPTION, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'></dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>0|", venueType, "|0</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeFavsObj.ORDERABLE_TYPE_FLAG, "</dd></dl>");
							}
						}
					}
					if (!favCnt) {
						favSec.push("<span class='res-none'>", (noeFavArr) ? noei18n.NO_FAVORITES_FOUND : i18n.ERROR_RETREIVING_DATA, "</span>");
					}
					else {
						//add items in sorted order
						favSec = favSec.concat(favChildFavFolder, favSecondaryFavFolder);
					}
					favSec.push("</div>");
					//ends <div id='pgMnuFavFolderContents",pageId,"'>
				}
			}
			else if (!noeFavArr) {
				var i18nCore = i18n.discernabu;
				var errMsg = [];
				errMsg.push("<span class='res-none'>", i18n.ERROR_RETREIVING_DATA, "</span>");
				favSec = favSec.concat(errMsg);
			}
			favSec.push("</div>");
			var favSecHTML = favSec.join("");
			var actionableContDiv = _g("acActionableContent");
			if (actionableContDiv) {
				actionableContDiv.innerHTML = favSecHTML;
			}

			var folderPathId = 'pgMnuFolderPath' + pageId;
			var folderPath = _g(folderPathId);
			if (folderPath) {
				Util.addEvent(folderPath, "click", function(e) {
					var folder = e.target || e.srcElement;
					var folderId = Util.gps(Util.gp(folder));
					if (folderId.innerHTML != "-1") {
						var curVenueType = 1;
						//default to 1 just in case of an error with getting the buttons
						var inputButtons = Util.Style.g("page-menu-add-fav-venue", _g("pgMnuFavFolderVenueBtns"), "input");
						if (inputButtons) {
							for (var x = inputButtons.length; x--; ) {
								var curButton = inputButtons[x];
								if (curButton.checked) {
									curVenueType = curButton.getAttribute('venue-val');
									break;
								}
							}
						}
						MP_Util.Doc.DisplaySelectedFavFolder(folderId.innerHTML, pageId, criterion.person_id, criterion.encntr_id, criterion.provider_id, criterion.position_cd, criterion.ppr_cd, curVenueType, criterion.executable, criterion.static_content, criterion.debug_ind, criterion.help_file_local_ind, criterion.category_mean, criterion.locale_id, criterion.device_location);
					}
				});
			}
		},
		SwitchFavFolderVenue: function(button, pageId, personId, encntrId, providerId, positionCd, pprCd, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation) {
			//toggle which buttons are checked
			var inputButtons = Util.Style.g("page-menu-add-fav-venue", Util.gp(Util.gp(button)), "input");
			if (inputButtons) {
				for (var x = inputButtons.length; x--; ) {
					var curButton = inputButtons[x];
					if (curButton.checked) {
						curButton.checked = "";
					}
					else {
						curButton.checked = "checked";
					}
				}
			}

			//delete al items in the folder path and folder id path as we are starting at the beginning when switching venues
			var i;
			var l;
			var folderPathObj = _g("pgMnuFavFolderPath" + pageId);
			var folderPath = Util.Style.g("noe-folder-info", folderPathObj, "DL");
			var curList = folderPath[0];
			var curItem = _gbt("DT", curList);
			var curItemData = _gbt("DD", curList);
			var locatedIdIndex = 0;
			for ( i = curItem.length; i--; ) {
				if (i !== 0) {
					Util.de(curItem[i]);
				}
			}
			for ( i = curItemData.length; i--; ) {
				if (i !== 0) {
					Util.de(curItemData[i]);
				}
			}

			var venueType = button.getAttribute('venue-val');

			var recordData = MP_Util.Doc.GetFavFolders("0", personId, encntrId, providerId, positionCd, pprCd, venueType);
			MP_Util.Doc.LoadFavFolder(recordData, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation);
		},
		DisplayNextFavFolder: function(folder, folderId, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation) {
			var noei18n = i18n.discernabu.noe_o1;
			var curFolderData = _gbt("DD", Util.gp(folder));
			var curName = curFolderData[0];
			var curNameDisp = curName.innerHTML;

			//grab all folder names and ids in DOM of component
			var folderPathObj = _g("pgMnuFavFolderPath" + pageId);
			var folderPath = Util.Style.g("noe-folder-info", folderPathObj, "DL");
			var curList = folderPath[0];
			var curItem = _gbt("DT", curList);
			var curItemData = _gbt("DD", curList);
			var lastId = curItem[curItem.length - 1];
			var lastFolder = curItemData[curItemData.length - 1];

			var pathLength = curItemData.length;
			var separator = "...";

			if (pathLength !== 1) {
				separator = ">";
			}

			if (pathLength > 4) {
				for (var j = pathLength - 1; j--; ) {
					if (j > 1) {
						if (curItem[j].innerHTML == "-1") {
							Util.Style.acss(curItemData[j], "hidden");
							Util.Style.rcss(curItemData[j], "noe-fav-separator");
						}
						else {
							Util.Style.acss(curItemData[j], "hidden");
							Util.Style.rcss(curItemData[j], "noe-fav-folder");
						}
					}
				}
			}

			//create four new nodes for the folder id, folder name, separator id, and separator
			var newFolderId = Util.cep("DT", {
				"className": "hidden",
				"innerHTML": folderId
			});
			var newFolder = Util.cep("DD", {
				"className": "noe-fav-folder",
				"innerHTML": "<span>" + curNameDisp + "</span>"
			});
			var newSeparatorId = Util.cep("DT", {
				"className": "hidden",
				"innerHTML": "-1"
			});
			var newSeparator = Util.cep("DD", {
				"className": "noe-fav-separator",
				"innerHTML": "<span>" + separator + "</span>"
			});
			//add four new nodes to DOM
			Util.ia(newSeparatorId, lastFolder);
			Util.ia(newSeparator, newSeparatorId);
			Util.ia(newFolderId, newSeparator);
			Util.ia(newFolder, newFolderId);

			var prevFolderContent = _g("pgMnuFavFolderContents" + pageId);
			if (prevFolderContent) {
				prevFolderContent.innerHTML = "";
				prevFolderContent.style.overflowY = "auto";
				Util.Style.acss(prevFolderContent, "noe-preloader-icon");
			}

			var recordData = MP_Util.Doc.GetFavFolders(folderId, personId, encntrId, providerId, positionCd, pprCd, venueType);
			MP_Util.Doc.LoadFavFolder(recordData, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation);
		},
		LoadFavFolder: function(recordData, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation) {
			var noei18n = i18n.discernabu.noe_o1;
			var noeFavArr = null;
			if (recordData.STATUS_DATA.STATUS != "F") {
				noeFavArr = recordData.USER_FAV;
			}

			var prevFolderContent = _g("pgMnuFavFolderContents" + pageId);
			if (prevFolderContent && noeFavArr) {
				Util.Style.rcss(prevFolderContent, "noe-preloader-icon");
				var favSec = ["<div>"];
				var favCnt = 0;
				var favChildFavFolder = [];
				var favSecondaryFavFolder = [];
				//grab all folder names and ids in DOM of component
				var folderPathObj = _g("pgMnuFavFolderPath" + pageId);
				var folderPath = Util.Style.g("noe-folder-info", folderPathObj, "DL");
				var curList = folderPath[0];
				var curItem = _gbt("DT", curList);
				for (var i = 0, l = noeFavArr.length; i < l; i++) {
					var noeFavsObj = noeFavArr[i];
					if (i === 0) {
						var noeItemArr = noeFavsObj.CHILD_LIST;

						for (var j = 0, k = noeItemArr.length; j < k; j++) {
							var noeItem = noeItemArr[j];
							var noeRow = [];
							var noeType = noeItem.LIST_TYPE;
							if (noeType === 1) {//Favorite Folder
								favCnt++;
								noeRow.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeItem.CHILD_ALT_SEL_CAT_ID, "\", \"", noeItem.SYNONYM, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeItem.CHILD_ALT_SEL_CAT_ID, "\", \"", pageId, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", venueType, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", noeItem.SYNONYM, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'>", noeItem.SENTENCE, "</dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>", noeItem.SYN_ID, "|", venueType, "|", noeItem.SENT_ID, "</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeItem.ORDERABLE_TYPE_FLAG, "</dd></dl>");
								favChildFavFolder = favChildFavFolder.concat(noeRow);
							}
						}
					}
					else {
						favCnt++;
						if (noeFavsObj.LONG_DESCRIPTION_KEY_CAP === "FAVORITES" && (noeFavsObj.SOURCE_COMPONENT_FLAG === 2 || noeFavsObj.SOURCE_COMPONENT_FLAG === 3)) {
							folderName = noei18n.FOLDER_FAV_AMBULATORY.replace("{0}", i);
							favSecondaryFavFolder.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", folderName, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", pageId, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", venueType, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", folderName, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'></dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>0|", venueType, "|0</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeFavsObj.ORDERABLE_TYPE_FLAG, "</dd></dl>");
						}
						else {
							favSecondaryFavFolder.push("<h3 class='info-hd'>", noei18n.ORDER_FAVORITE, "</h3><dl class='noe-info page-menu-add-favorite-folder-dl'><button type='button' class='noe-fav-order-button' onmouseout='CERN_NEW_ORDER_ENTRY_O1.MouseOutButton(this)' onmouseover='CERN_NEW_ORDER_ENTRY_O1.MouseOverButton(this)' onclick='MP_Util.Doc.AddFavoriteComponent(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", noeFavsObj.SHORT_DESCRIPTION, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", i18n.SELECT, "</button><span class='noe-fav-folder-icon'>&nbsp;</span><dt>", noei18n.ORDER_NAME, ":</dt><dd class='noe-name page-menu-add-favorite-folder' onclick='MP_Util.Doc.DisplayNextFavFolder(this, \"", noeFavsObj.ALT_SEL_CATEGORY_ID, "\", \"", pageId, "\", \"", personId, "\", \"", encntrId, "\", \"", providerId, "\", \"", positionCd, "\", \"", pprCd, "\", \"", venueType, "\", \"", executable, "\", \"", staticContent, "\", \"", debugInd, "\", \"", helpFileLocalInd, "\", \"", categoryMean, "\", \"", localeId, "\", \"", deviceLocation, "\")'>", noeFavsObj.SHORT_DESCRIPTION, "</dd><dt>", noei18n.ORDER_DISPLAY_LINE, ":</dt><dd class='noe-disp'></dd><dt>", noei18n.ORDER_PARAMETERS, ":</dt><dd class='det-hd'>0|", venueType, "|0</dd><dt>", noei18n.ORDER_SET, ":</dt><dd class='det-hd'>", noeFavsObj.ORDERABLE_TYPE_FLAG, "</dd></dl>");
						}
					}
				}

				//add items in sorted order
				favSec = favSec.concat(favChildFavFolder, favSecondaryFavFolder);

				if (!favCnt) {
					favSec.push("<span class='res-none'>", noei18n.EMPTY_FOLDER, "</span>");
				}
				favSec.push("</div>");
				folderHTML = favSec.join("");
				prevFolderContent.innerHTML = folderHTML;
			}
			else if (prevFolderContent && !noeFavArr) {
				Util.Style.rcss(prevFolderContent, "noe-preloader-icon");
				var i18nCore = i18n.discernabu;
				var errMsg = [];
				errMsg.push("<span class='res-none'>", i18n.ERROR_RETREIVING_DATA, "</span>");
				folderHTML = errMsg.join("");
				prevFolderContent.innerHTML = folderHTML;
			}
		},
		DisplaySelectedFavFolder: function(folderId, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation) {
			var noei18n = i18n.discernabu.noe_o1;
			var i, l;
			var folderPathObj = _g("pgMnuFavFolderPath" + pageId);
			var folderPath = Util.Style.g("noe-folder-info", folderPathObj, "DL");
			var curList = folderPath[0];
			var curItem = _gbt("DT", curList);
			var curItemData = _gbt("DD", curList);

			//find index of folder id
			var locatedIdIndex = null;
			for ( i = 0, l = curItem.length; i < l; i++) {
				if (curItem[i].innerHTML == folderId) {
					locatedIdIndex = i;
				}
			}

			//delete all folder names and ids that are after selected folder
			if (locatedIdIndex !== null) {
				for ( i = curItem.length; i--; ) {
					var deleteId = curItem[i];
					if (locatedIdIndex < i) {
						Util.de(deleteId);
					}
				}
				for ( i = curItemData.length; i--; ) {
					var deleteFolder = curItemData[i];
					if (locatedIdIndex < i) {
						Util.de(deleteFolder);
					}
				}
				if (locatedIdIndex > 3) {

					Util.Style.acss(curItemData[locatedIdIndex - 1], "noe-fav-separator");
					Util.Style.rcss(curItemData[locatedIdIndex - 1], "hidden");
					Util.Style.acss(curItemData[locatedIdIndex - 2], "noe-fav-folder");
					Util.Style.rcss(curItemData[locatedIdIndex - 2], "hidden");
				}

				var prevFolderContent = _g("pgMnuFavFolderContents" + pageId);
				if (prevFolderContent) {
					prevFolderContent.innerHTML = "";
					prevFolderContent.style.overflowY = "auto";
					Util.Style.acss(prevFolderContent, "noe-preloader-icon");
				}

				var recordData = MP_Util.Doc.GetFavFolders(folderId, personId, encntrId, providerId, positionCd, pprCd, venueType);
				MP_Util.Doc.LoadFavFolder(recordData, pageId, personId, encntrId, providerId, positionCd, pprCd, venueType, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation);
			}
		},
		AddFavoriteComponent: function(button, folderId, folderName, personId, encntrId, providerId, positionCd, pprCd, executable, staticContent, debugInd, helpFileLocalInd, categoryMean, localeId, deviceLocation) {
			$(".modal-div").remove();
			$(".modal-dialog-actionable").remove();
			$("html").css("overflow", "auto");
			//reset overflow
			//Set the viewpoint indicator to true if this is a viewpoint, otherwise false
			var isViewpoint = ( typeof m_viewpointJSON == "undefined") ? false : true;
			var activeDiv = Util.Style.g("div-tab-item-selected", document.body, "DIV")[0];
			if (activeDiv) {
				//create criterion object to be used in component
				var criterion = {};
				criterion.person_id = personId;
				criterion.encntr_id = encntrId;
				criterion.provider_id = providerId;
				criterion.executable = executable;
				criterion.static_content = staticContent;
				criterion.position_cd = positionCd;
				criterion.ppr_cd = pprCd;
				criterion.debug_ind = debugInd;
				criterion.help_file_local_ind = helpFileLocalInd;
				criterion.category_mean = categoryMean;
				criterion.locale_id = localeId;
				criterion.device_location = deviceLocation;

				//create new order selection component
				var appendingComponentId = "-" + activeDiv.id;
				var componentId = folderId.concat(appendingComponentId);
				var component = new OrderSelectionComponent();
				component.setCriterion(criterion);
				component.setStyles(new OrderSelectionComponentStyle());
				component.setComponentId(componentId);
				component.setReportId(folderId);
				component.setFavFolderId(folderId);
				component.setCustomizeView(false);
				component.setExpanded(1);
				component.setColumn(1);
				component.setSequence(0);
				component.setPageGroupSequence(1);
				component.setLabel(folderName);
				if (isViewpoint) {
					component.setModalScratchPadEnabled(1);
				}

				var style = component.getStyles();
				style.setComponentId(componentId);

				var newCompNode = createDynCompDiv(component);

				//render component
				component.InsertData();
				//grab first column of components
				var columnOneNode = Util.Style.g("col1", activeDiv, "DIV")[0];
				//grab first component in column one
				var columnOneFirstComp = Util.Style.g("section", columnOneNode, "DIV")[0];
				//insert new order selection component in the first row on column one
				columnOneNode.insertBefore(newCompNode, columnOneFirstComp);

				//Update the cursor class of the newly created component based on the drag and drop toggle status
				if (!($(".div-tab-item-selected").hasClass("qoc-dnd-enabled"))) {
					//remove the cursor move class
					$("#" + style.getId() + " ." + style.getHeaderClass()).css("cursor", "auto");
				}

				//update CERN_MPageComponents so we can find component Id when saving preferences
				CERN_MPageComponents.push(component);

				//save user preferences immediately after adding component
				MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, activeDiv.id);

				//add expand/collapse functionality
				var componentToggle = Util.Style.g(style.getHeaderToggle(), newCompNode, "span")[0];
				Util.addEvent(componentToggle, "click", MP_Util.Doc.ExpandCollapse);

				//add component menu functionality
				var fullId = "mainCompMenu" + style.getNameSpace() + componentId;
				var optMenu = Util.cep("div", {
					className: "opts-menu-content menu-hide",
					id: "moreOptMenu" + componentId
				});
				var i18nCore = i18n.discernabu;
				var optMenuArr = ['<div class="opts-actions-sec" id="optsMenuActions', componentId, '"></div>', '<div class="opts-personalize-sec" id="optsMenupersonalize', componentId, '"><div class="opts-menu-item" id="optsDefTheme', componentId, '">', i18nCore.COLOR_THEME, '</div><div class="opts-menu-item" id="optsDefState', componentId, '">', i18nCore.DEFAULT_EXPANDED, '<span class="opts-menu-def-exp">&nbsp;</span></div><div class="opts-menu-item" id="optsRemoveFavComp', componentId, '">', i18nCore.REMOVE_FAVORITE, '</div></div>'];
				optMenu.innerHTML = optMenuArr.join("");
				Util.ac(optMenu, document.body);
				InitCompOptMenu(optMenu, componentId, false);

				var themeOut = function(e) {
					if (!e) {
						e = window.event;
					}
					var relTarg = e.relatedTarget || e.toElement;
					if (relTarg) {
						if (!Util.Style.ccss(relTarg, "opts-menu-content")) {
							if (_g("optMenuConfig" + componentId)) {
								Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
							}
						}
					}
					else {
						if (_g("optMenuConfig" + componentId)) {
							Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
						}
						return;
					}
				};

				var secId = fullId.replace("mainCompMenu", "");
				Util.addEvent(_g("mainCompMenu" + secId), "click", function() {
					OpenCompOptMenu(optMenu, secId);
				});
				Util.addEvent(_g("optsDefTheme" + componentId), "mouseover", function() {
					launchQOCThemeMenu(componentId, fullId, secId, this, activeDiv.id);
				});
				Util.addEvent(_g("optsDefTheme" + componentId), "mouseout", themeOut);

				Util.addEvent(_g("optsDefState" + componentId), "click", function() {
					launchQOCSetState(componentId, this, activeDiv.id);
				});
				Util.addEvent(_g("optsRemoveFavComp" + componentId), "click", function() {
					var thisId = style.getId();
					var confirmMsg = i18nCore.REMOVE_FAV_DIALOG + "<br />";
					MP_Util.AlertConfirm(confirmMsg, i18nCore.REMOVE_PERSONAL_FAV_COMP, i18nCore.CONFIRM_REMOVE, i18nCore.CONFIRM_CANCEL, true, function() {
						MP_Core.AppUserPreferenceManager.RemoveFolder(thisId, activeDiv.id)
					});
				});
			}

			function createDynCompDiv(component) {
				var i18nCore = i18n.discernabu;
				var i18nConfigMPage = i18n.discernabu.covc_o1;
				var ar = [];
				var style = component.getStyles();
				var ns = style.getNameSpace();
				var compId = component.getComponentId();
				var secClass = style.getClassName();
				var tabLink = component.getLink();
				var loc = component.getCriterion().static_content;
				var sAnchor = component.getLabel();

				var compNode = Util.cep("div", {
					className: style.getClassName(),
					id: style.getId()
				});

				ar.push("<h2 class='", style.getHeaderClass(), "' style='cursor: move;'><span class='", style.getHeaderToggle(), "' title='", i18nCore.HIDE_SECTION, "'>-</span><span class='opts-menu menu-hide' id='mainCompMenu", ns, compId, "'>&nbsp;</span><span class='", style.getTitle(), "'><span>", sAnchor, "</span><span class='sec-total'></span></span></h2><div id='", style.getContentId(), "' class='", style.getContentClass(), "'></div>");
				var footerText = component.getFooterText();
				if (footerText && footerText !== "") {
					ar.push("<div class=sec-footer>", footerText, "</div>");
				}
				var arHtml = ar.join("");
				compNode.innerHTML = arHtml;
				return compNode;
			}

		},
		/**
		 * Create Component Menus
		 * @param {mpComps} mpage components for current view
		 * @param {bool} disablePrsnl boolean to disable personalize section
		 * @param
		 */
		CreateCompMenus: function(mpComps, disablePrsnl) {
			var setupCompMenu = function(componentId, fullId, isExp, infoInd, infoState) {
				if (_g(fullId)) {
					var optMenu = _g("moreOptMenu" + componentId);
					if (!optMenu) {
						optMenu = Util.cep("div", {
							className: "opts-menu-content menu-hide",
							id: "moreOptMenu" + componentId
						});
						var i18nCore = i18n.discernabu;
						var defExpClass = "";
						var infoBtnMsg = i18nCore.INFO_BUTTON;
						var infoClass = "";
						
						if (isExp) {
							defExpClass = "opts-menu-def-exp";
						}
						
						if (infoState) {
							infoClass = "opts-menu-info-en";
						}
						

						optMenu.innerHTML = '<div class="opts-actions-sec" id="optsMenuActions' + componentId + '"></div>';
						if (!disablePrsnl) {
							if (infoInd) {
								optMenu.innerHTML += '<div class="opts-personalize-sec" id="optsMenupersonalize' + componentId + '"><div class="opts-menu-item" id="optsDefTheme' + componentId + '">' + i18nCore.COLOR_THEME + '</div><div class="opts-menu-item" id="optsDefState' + componentId + '">' + i18nCore.DEFAULT_EXPANDED + '<span class="' + defExpClass + '">&nbsp;</span></div><div class="opts-menu-item opts-personalize-sec-divider" id="optsInfoState' + componentId + '">' + infoBtnMsg + '<span class="' + infoClass + '">&nbsp;</span></div></div>';
							}
							else {
								optMenu.innerHTML += '<div class="opts-personalize-sec" id="optsMenupersonalize' + componentId + '"><div class="opts-menu-item" id="optsDefTheme' + componentId + '">' + i18nCore.COLOR_THEME + '</div><div class="opts-menu-item" id="optsDefState' + componentId + '">' + i18nCore.DEFAULT_EXPANDED + '<span class="' + defExpClass + '">&nbsp;</span></div></div>';
							}
						}
						Util.ac(optMenu, document.body);
					}
					InitCompOptMenu(optMenu, componentId, false);

					var themeOut = function(e) {
						if (!e) {
							e = window.event;
						}
						var relTarg = e.relatedTarget || e.toElement;
						if (relTarg) {
							if (!Util.Style.ccss(relTarg, "opts-menu-content")) {
								if (_g("optMenuConfig" + componentId)) {
									Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
								}
							}
						}
						else {
							if (_g("optMenuConfig" + componentId)) {
								Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
							}
							return;
						}
					};
					var secId = fullId.replace("mainCompMenu", "");
					Util.addEvent(_g("mainCompMenu" + secId), "click", function() {
						OpenCompOptMenu(optMenu, secId);
					});

					if (!disablePrsnl) {
						Util.addEvent(_g("optsDefTheme" + componentId), "mouseover", function() {
							launchThemeMenu(componentId, fullId, secId, this);
						});
						Util.addEvent(_g("optsDefTheme" + componentId), "mouseout", themeOut);
						Util.addEvent(_g("optsDefState" + componentId), "click", function() {
							launchSetState(componentId, this);
						});
						
						if (infoInd) {
							Util.addEvent(_g("optsInfoState" + componentId), "click", function() {
								launchInfoSetState(componentId, this);
							});
						}
					}
				}
			};
			var mns = mpComps;
			var mLen = mns.length
			for (var i = 0; i < mLen; i++) {
				var curComp = mns[i];
				var ns = curComp.m_styles.m_nameSpace;
				var compId = curComp.m_styles.m_componentId;
				var fullId = "mainCompMenu" + ns + compId;
				var isExp = curComp.isExpanded();
				var infoInd = curComp.hasInfoButton();
				var infoState = curComp.isInfoButtonEnabled();
				setupCompMenu(compId, fullId, isExp, infoInd, infoState);
			}
		},
		/**
		 * Create Quick Orders and Charges Component Menus
		 * @param {mpComps} mpage components for current view
		 * @param {bool} disablePrsnl boolean to disable personalize section
		 * @param {string} selectedViewId Id of view selected in QOC
		 * @param
		 */
		CreateQOCCompMenus: function(mpComps, disablePrsnl, selectedViewId) {
			var setupCompMenu = function(componentId, fullId, isExp) {
				if (_g(fullId)) {
					var optMenu = _g("moreOptMenu" + componentId);
					if (!optMenu) {
						optMenu = Util.cep("div", {
							className: "opts-menu-content menu-hide",
							id: "moreOptMenu" + componentId
						});
						var i18nCore = i18n.discernabu;
						var defExpClass = "";
						var isPersonalFav = false;
						var component = MP_Util.GetCompObjById(componentId);
						var style = component.getStyles();
						var thisId = style.getId();
						if (isExp) {
							defExpClass = "opts-menu-def-exp";
						}

						optMenu.innerHTML = '<div class="opts-actions-sec" id="optsMenuActions' + componentId + '"></div>';
						if (!disablePrsnl) {
							if (CERN_PersonalFav !== null && CERN_PersonalFav[prsnlCount] === thisId) {
								prsnlCount++;
								isPersonalFav = true;
								optMenu.innerHTML += '<div class="opts-personalize-sec" id="optsMenupersonalize' + componentId + '"><div class="opts-menu-item" id="optsDefTheme' + componentId + '">' + i18nCore.COLOR_THEME + '</div><div class="opts-menu-item" id="optsDefState' + componentId + '">' + i18nCore.DEFAULT_EXPANDED + '<span class="' + defExpClass + '">&nbsp;</span></div><div class="opts-menu-item" id="optsRemoveFavComp' + componentId + '">' + i18nCore.REMOVE_FAVORITE + '</div></div>';
							}
							else {
								isPersonalFav = false;
								optMenu.innerHTML += '<div class="opts-personalize-sec" id="optsMenupersonalize' + componentId + '"><div class="opts-menu-item" id="optsDefTheme' + componentId + '">' + i18nCore.COLOR_THEME + '</div><div class="opts-menu-item" id="optsDefState' + componentId + '">' + i18nCore.DEFAULT_EXPANDED + '<span class="' + defExpClass + '">&nbsp;</span></div></div>';
							}
						}
						Util.ac(optMenu, document.body);
					}
					InitCompOptMenu(optMenu, componentId, false);

					var themeOut = function(e) {
						if (!e) {
							e = window.event;
						}
						var relTarg = e.relatedTarget || e.toElement;
						if (relTarg) {
							if (!Util.Style.ccss(relTarg, "opts-menu-content")) {
								if (_g("optMenuConfig" + componentId)) {
									Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
								}
							}
						}
						else {
							if (_g("optMenuConfig" + componentId)) {
								Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
							}
							return;
						}
					};
					var secId = fullId.replace("mainCompMenu", "");
					Util.addEvent(_g("mainCompMenu" + secId), "click", function() {
						OpenCompOptMenu(optMenu, secId);
					});

					if (!disablePrsnl) {
						Util.addEvent(_g("optsDefTheme" + componentId), "mouseover", function() {
							launchQOCThemeMenu(componentId, fullId, secId, this, selectedViewId);
						});
						Util.addEvent(_g("optsDefTheme" + componentId), "mouseout", themeOut);
						Util.addEvent(_g("optsDefState" + componentId), "click", function() {
							launchQOCSetState(componentId, this, selectedViewId);
						});
						if (isPersonalFav) {
							Util.addEvent(_g("optsRemoveFavComp" + componentId), "click", function() {
								var activeDiv = $(".div-tab-item-selected", document.body, "DIV")[0];
								var confirmMsg = i18nCore.REMOVE_FAV_DIALOG + "<br />";
								MP_Util.AlertConfirm(confirmMsg, i18nCore.REMOVE_PERSONAL_FAV_COMP, i18nCore.CONFIRM_REMOVE, i18nCore.CONFIRM_CANCEL, true, function() {
									MP_Core.AppUserPreferenceManager.RemoveFolder(thisId, activeDiv.id)
								});
							});
						}
					}
				}
			};
			var mns = mpComps;
			var mLen = mns.length
			var prsnlCount = 0;
			for (var i = 0; i < mLen; i++) {
				var curComp = mns[i];
				var ns = curComp.m_styles.m_nameSpace;
				var compId = curComp.m_styles.m_componentId;
				var fullId = "mainCompMenu" + ns + compId;
				var isExp = curComp.isExpanded();
				setupCompMenu(compId, fullId, isExp);
			}
		},
		/**
		 * Hide all Component Menus
		 */
		HideAllCompMenus: function() {
			var mnus = Util.Style.g("opts-menu-content", null, "div");
			var mnLen = mnus.length;
			for (var m = mnLen; m--; ) {
				if (!Util.Style.ccss(mnus[m], "menu-hide")) {
					Util.Style.acss(mnus[m], "menu-hide");
				}
			}
		},
		/**
		 * Hide all Page Menus
		 */
		ResetPageMenus: function() {
			var pageMenuIcons = Util.Style.g('page-menu');
			var pl = pageMenuIcons.length;
			for (var i = pl; i--; ) {
				var pageMenu = pageMenuIcons[i];
				if (Util.Style.ccss(pageMenu, "page-menu-open")) {
					Util.Style.rcss(pageMenu, "page-menu-open")
				}
			}
		},
		/**
		 * Customize the mpage layout
		 * @param {String} title The title of the page to display
		 * @param {Object} components The list components to be associated.
		 */
		CustomizeLayout: function(title, components, criterion) {
			var body = document.body;
			var i18nCore = i18n.discernabu;
			MP_Util.Doc.AddPageTitle(title, body, 0, false, null, null, null, criterion);
			MP_Util.Doc.AddClearPreferences(body, criterion)
			MP_Util.Doc.AddSavePreferences(body, criterion)

			body.innerHTML += "<div id='disclaimer' class='disclaimer'><span>" + i18nCore.USER_CUST_DISCLAIMER + "</span></div>";

			var compAr = [];
			for (var x = components.length; x--; ) {
				var component = components[x];
				if (component.getColumn() != 99)
					compAr.push(component);
			}

			CreateCustomizeLiquidLayout(compAr, body)
			SetupExpandCollapse();
			SetupCompFilters(compAr);
		},
		GetComments: function(par, personnelArray) {
			var com = "", recDate = "";
			var df = new mp_formatter.DateTimeFormatter(MPAGE_LOCALE);
			for (var j = 0, m = par.COMMENTS.length; j < m; j++) {
				if (personnelArray.length != null) {
					if (par.COMMENTS[j].RECORDED_DT_TM != "") {
						recDate = df.formatISO8601(par.COMMENTS[j].RECORDED_DT_TM, mp_formatter.DateTimeFormatter.FULL_DATE_TIME_4YEAR)
					}
					if (j > 0) {
						com += "<br />";
					}
					if (par.COMMENTS[j].RECORDED_BY > 0) {
						com += recDate + " - " + MP_Util.GetValueFromArray(par.COMMENTS[j].RECORDED_BY, personnelArray).fullName + "<br />" + par.COMMENTS[j].COMMENT_TEXT;
					}
					else {
						com += recDate + "<br />" + par.COMMENTS[j].COMMENT_TEXT;
					}
				}
			}
			return com;
		},
		FinalizeComponent: function(contentHTML, component, countText) {
			var styles = component.getStyles();

			//replace count text
			var rootComponentNode = component.getRootComponentNode();
			//There are certain circumstances where a components DOM element will have been removed.
			//ie. selecting a view from the viewpoint drop down and then selecting another.
			if (rootComponentNode) {
				var totalCount = Util.Style.g("sec-total", rootComponentNode, "span");
				if(countText){
					//Make sure the count text is not hidden.
					$(totalCount).removeClass("hidden");
					totalCount[0].innerHTML = countText;
				}
				else{
					//If there is no count text to show then hide the element so it doesn't take up space.
					$(totalCount).addClass("hidden");
				}

				//replace content with HTML
				var node = component.getSectionContentNode();
				node.innerHTML = contentHTML;

				//init hovers
				MP_Util.Doc.InitHovers(styles.getInfo(), node, component);

				//init subsection toggles
				MP_Util.Doc.InitSubToggles(node, "sub-sec-hd-tgl");

				//init scrolling
				MP_Util.Doc.InitScrolling(Util.Style.g("scrollable", node, "div"), component.getScrollNumber(), "1.6")

				//Check to see if the component has an error message displayed
				var errorElement = $(rootComponentNode).find(".error-message");
				if (errorElement.length) {
					//Add an error icon to the component title
					$(rootComponentNode).find(".sec-title span:first-child").addClass("error-icon-component");
					//Ensure the bottom border on the error message is red and the padding is consistent
					$(errorElement).css("border", "1px solid #C00").css("padding", "2px 4px");
					//Fire and event to inform any listener that the component has errored
					CERN_EventListener.fireEvent(component, component, EventListener.EVENT_ERROR_UPDATE, {
								"error": true
							});
				}
				else{
					//Remove the error icon in the component title
					$(rootComponentNode).find(".sec-title span:first-child").removeClass("error-icon-component");
					//Fire and event to inform any listener that the component has not errored
					CERN_EventListener.fireEvent(component, component, EventListener.EVENT_ERROR_UPDATE, {
								"error": false
							});
				}
			}
		},
		/**
		 * Formats the content to the appropriate height and enables scrolling
		 * @param {node} content : The content to be formatted
		 * @param {int} num : The approximate number of items to display face up
		 * @param {float} ht : The total line height of an item
		 */
		InitScrolling: function(content, num, ht) {
			for (var k = 0; k < content.length; k++) {
				MP_Util.Doc.InitSectionScrolling(content[k], num, ht);
			}
		},
		/**
		 * Formats the section to the appropriate height and enables scrolling
		 * @param {node} sec : The section to be formatted
		 * @param {int} num : The approximate number of items to display face up
		 * @param {float} ht : The total line height of an item
		 */
		InitSectionScrolling: function(sec, num, ht) {
			var th = num * ht
			var totalHeight = th + "em";

			sec.style.maxHeight = totalHeight;
			sec.style.overflowY = 'auto';
			sec.style.overflowX = 'hidden';
		},
		InitHovers: function(trg, par, component) {
			gen = Util.Style.g(trg, par, "DL")

			for (var i = 0, l = gen.length; i < l; i++) {
				var m = gen[i];
				if (m) {
					var nm = Util.gns(Util.gns(m));
					if (nm) {
						if (Util.Style.ccss(nm, "hvr")) {
							hs(m, nm, component);
						}
					}
				}
			}
		},
		InitSubToggles: function(par, tog) {
			var i18nCore = i18n.discernabu;
			var toggleArray = Util.Style.g(tog, par, "span");
			for (var k = 0; k < toggleArray.length; k++) {
				Util.addEvent(toggleArray[k], "click", MP_Util.Doc.ExpandCollapse);
				var checkClosed = Util.gp(Util.gp(toggleArray[k]));
				if (Util.Style.ccss(checkClosed, "closed")) {
					toggleArray[k].innerHTML = "+";
					toggleArray[k].title = i18nCore.SHOW_SECTION;
				}
			}
		},
		/**
		 * Deprecated:  This function will not perform the correct expand all/collapse on the MPagesView.
		 *  This is now handled within the MPageView object definition and in the pageMenu
		 **/
		ExpandCollapseAll: function(ID) {
			var i18nCore = i18n.discernabu;
			var tabSection = _g(ID.replace("expAll", ""));
			var expNode = _g(ID);
			var allSections = Util.Style.g("section", tabSection);
			if (isExpandedAll) {
				for (var i = 0, asLen = allSections.length; i < asLen; i++) {
					var secHandle = Util.gc(Util.gc(allSections[i]));
					if (secHandle.innerHTML == "-" || secHandle.innerHTML == "+") {
						Util.Style.acss(allSections[i], "closed");
						secHandle.innerHTML = "+";
						secHandle.title = i18nCore.SHOW_SECTION;
					}
					else {
						var allSubSections = Util.Style.g("sub-sec", allSections[i], "div");
						for (var j = 0, aSubLen = allSubSections.length; j < aSubLen; j++) {
							var subSecTgl = Util.gc(Util.gc(allSubSections[j]));
							Util.Style.acss(allSubSections[j], "closed");
							subSecTgl.innerHTML = "+";
							subSecTgl.title = i18nCore.SHOW_SECTION;
						}
					}
				}
				expNode.innerHTML = i18nCore.EXPAND_ALL;
				isExpandedAll = false;
			}
			else {
				for (var i = 0, asLen = allSections.length; i < asLen; i++) {
					var secHandle = Util.gc(Util.gc(allSections[i]));
					if (secHandle.innerHTML == "-" || secHandle.innerHTML == "+") {
						Util.Style.rcss(allSections[i], "closed");
						secHandle.innerHTML = "-";
						secHandle.title = i18nCore.HIDE_SECTION;
					}
					else {
						var allSubSections = Util.Style.g("sub-sec", allSections[i], "div");
						for (var j = 0, aSubLen = allSubSections.length; j < aSubLen; j++) {
							var subSecTgl = Util.gc(Util.gc(allSubSections[j]));
							Util.Style.rcss(allSubSections[j], "closed");
							subSecTgl.innerHTML = "-";
							subSecTgl.title = i18nCore.HIDE_SECTION;
						}
					}
				}
				expNode.innerHTML = i18nCore.COLLAPSE_ALL;
				isExpandedAll = true;
			}
		},
		/**
		 * Adds chart search to the page.
		 * @param {Object} criterion The criterion object
		 * @param {Boolean} inViewPoint Indicator denoting if chart search is to be added in Viewpoint Framework.
		 */
		AddChartSearch: function(criterion, inViewPoint) {
			var csCallback = function(url) {
				try {
					if (url) {
						var fwObj = window.external.DiscernObjectFactory("PVFRAMEWORKLINK");
						fwObj.SetPopupStringProp("REPORT_NAME", "<url>" + url);
						fwObj.SetPopupDoubleProp("WIDTH", 1200);
						fwObj.SetPopupDoubleProp("HEIGHT", 700);
						fwObj.SetPopupBoolProp("SHOW_BUTTONS", 0);
						fwObj.LaunchPopup();
					}
					else {
						MP_Util.LogError("Error retriving URL from search");
					}
				}
				catch (err) {
					alert(i18n.discernabu.CODE_LEVEL);
					MP_Util.LogError("Error creating PVFRAMEWORKLINK window <br />Message: " + err.description + "<br />Name: " + err.name + "<br />Number: " + (err.number & 65535) + "<br />Description: " + err.description);
				}
			}
			//Check to see if the viewpoint already has a chart search available
			var csEle = _g("chrtSearchBox");
			if (!csEle) {
				//Add to viewpoint framework or single page
				var csDiv = Util.cep("div", {
					id: "chrtSearchBox"
				});
				csDiv.innerHTML = "<div id='chart-search-input-box'></div>";

				if (inViewPoint) {
					var vpTl = _g("vwpTabList");
					Util.ac(csDiv, vpTl);
				}
				else {
					var pgCtrl = _g("pageCtrl" + criterion.category_mean);
					pgCtrl.parentNode.insertBefore(csDiv, pgCtrl);
				}

				var csParams = {
					patientId: criterion.person_id,
					userId: criterion.provider_id,
					callback: csCallback
				};
				try {
					ChartSearchInput.embed('chart-search-input-box', csParams);
				}
				catch (err) {
					MP_Util.LogError("Error calling Chart Search embed <br />Message: " + err.description + "<br />Name: " + err.name + "<br />Number: " + (err.number & 65535) + "<br />Description: " + err.description);
				}
			}
		},
		/**
		 * Adds the title to the page.
		 * @param {String} title The title of the page to display
		 * @param {Object} bodyTag The body tag associated to the HTML document
		 * @param {Boolean} debugInd Indicator denoting if the mpage should run in debug mode.
		 * @param {Boolean} custInd Indicator denoting if the 'customize' option should be made available to the user for the given layout
		 * @param {String} helpFile The string name of the help file to associate to the page.
		 * @param {String} helpURL The String name of the help file URL to associate to the page.
		 * @param {Object} criterion The object associated to the criterion data
		 * @param {String} categoryMeaning The String name of the MPages View
		 */
		AddPageTitle: function(title, bodyTag, debugInd, custInd, anchorArray, helpFile, helpURL, criterion, categoryMeaning) {
			var i18nCore = i18n.discernabu;
			var ar = [];
			var imgSource = criterion.static_content + "/images/3865_16.gif";
			if (categoryMeaning) {
				title = "";
				bodyTag = _g(categoryMeaning);
				bodyTag.innerHTML = "";
			}
			else {
				if (bodyTag) {
					bodyTag = document.body;
				}
			}
			ar.push("<div class='pg-hd'>");
			ar.push("<h1><span class='pg-title'>", title, "</span></h1><span id='pageCtrl", criterion.category_mean, "' class='page-ctrl'>");

			//'as of' date is always to the far left of items
			if (categoryMeaning) {
				var df = MP_Util.GetDateFormatter();
				ar.push("<span class='other-anchors'>", i18nCore.AS_OF_TIME.replace("{0}", df.format(new Date(), mp_formatter.DateTimeFormatter.TIME_24HOUR_NO_SECONDS)), "</span>");
			}
			if (anchorArray) {
				for (var x = 0, xl = anchorArray.length; x < xl; x++) {
					ar.push("<span class='other-anchors'>" + anchorArray[x] + "</span>");
				}
			}

			if (custInd || categoryMeaning) {//customizable single view or in a view point
				var pageMenuId = "pageMenu" + criterion.category_mean;
				ar.push("<span id='", pageMenuId, "' class='page-menu'>&nbsp;</span>");
			}
			ar.push("</span></div>");
			bodyTag.innerHTML += ar.join("");
			return;
		},
		/**
		 * Launches the help file in a new modal window
		 * @param {String} HelpURL The String name of the help file  to associate to the page.
		 */
		LaunchHelpWindow: function(helpURL) {
			var wParams = "left=0,top=0,width=1200,height=700,toolbar=no";
			MP_Util.LogCclNewSessionWindowInfo(null, helpURL, "mp_core.js", "LaunchHelpWindow");
			CCLNEWSESSIONWINDOW(helpURL, "_self", wParams, 0, 1);
			Util.preventDefault();
		},
		AddClearPreferences: function(body, criterion) {
			var i18nCore = i18n.discernabu;
			var pageCtrl = _g("pageCtrl" + criterion.category_mean);
			var clearPrefNode = Util.cep("A", {
				"id": "clearPrefs",
				"onclick": "javascript:MP_Core.AppUserPreferenceManager.ClearPreferences();"
			});
			clearPrefNode.innerHTML = i18nCore.CLEAR_PREFERENCES;
			Util.ac(clearPrefNode, pageCtrl)
		},
		AddSavePreferences: function(body, criterion) {
			var i18nCore = i18n.discernabu;
			var pageCtrl = _g("pageCtrl" + criterion.category_mean);
			var savePrefNode = Util.cep("A", {
				"id": "savePrefs",
				"onclick": "javascript:MP_Core.AppUserPreferenceManager.SavePreferences();"
			});
			savePrefNode.innerHTML = i18nCore.SAVE_PREFERENCES;
			Util.ac(savePrefNode, pageCtrl)
		},
		AddCustomizeLink: function(criterion) {
			var i18nCore = i18n.discernabu;
			var custNode = _g("custView" + criterion.category_mean);
			if (custNode) {
				custNode.innerHTML = i18nCore.CUSTOMIZE;
				var compReportIds = GetPageReportIds();
				if ( typeof m_viewpointJSON == "undefined") {
					var cclParams = ["^MINE^", criterion.person_id + ".0", criterion.encntr_id + ".0", criterion.provider_id + ".0", criterion.position_cd + ".0", criterion.ppr_cd + ".0", "^" + criterion.executable + "^", "^^", "^" + criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + criterion.category_mean + "^", criterion.debug_ind, "value(" + compReportIds.join(".0,") + ")", "1"];
					custNode.onclick = function() {
						CCLLINK("MP_DRIVER", cclParams.join(","), 1);
						Util.preventDefault();
					};
				}
				else {
					var js_viewpoint = JSON.parse(m_viewpointJSON).VIEWPOINTINFO_REC;
					var cclParams = ["^MINE^", criterion.person_id + ".0", criterion.encntr_id + ".0", criterion.provider_id + ".0", criterion.position_cd + ".0", criterion.ppr_cd + ".0", "^" + criterion.executable + "^", "^" + criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + js_viewpoint.VIEWPOINT_NAME_KEY + "^", criterion.debug_ind, "value(" + compReportIds.join(".0,") + ")", "1", "^" + criterion.category_mean + "^"];
					custNode.onclick = function() {
						CCLLINK(CERN_driver_script, cclParams.join(","), 1);
						Util.preventDefault();
					};
				}
			}
		},
		/**
		 * Allows the consumer of the architecture to render the components that exist either on the tab layout
		 * or the single driving MPage.  For tab based pages, the first tab is loaded by default.
		 */
		RenderLayout: function() {
			//determine if QOC is loading in a viewpoint
			var QOCFlag = 0;
			var CommonDiv = _g("MP_COMMON_ORDERS_V4");
			if (CommonDiv) {
				QOCFlag = ($(CommonDiv).css('display') === 'none') ? 1 : 0;
			}

			// Return to tab being viewed upon refresh
			if (CERN_TabManagers != null && QOCFlag === 0) {
				var tabManager = null;
				if (window.name.length > 0) {
					var paramList = window.name.split(",");
					MP_Util.DisplaySelectedTab(paramList[0], paramList[1]);
				}
				else {
					tabManager = CERN_TabManagers[0];
					tabManager.setSelectedTab(true);
					tabManager.loadTab();
				}
			}
			else if (CERN_MPageComponents != null) {
				for (var x = 0; x < CERN_MPageComponents.length; x++) {
					var comp = CERN_MPageComponents[x];
					if (comp.isDisplayable() && comp.isExpanded() && !comp.isLoaded()) {
						comp.setLoaded(true);
						if (comp.isResourceRequired()) {
							comp.RetrieveRequiredResources();
						}
						else {
							comp.InsertData();
						}
					}
				}
				for (var x = 0; x < CERN_MPageComponents.length; x++) {
					var comp = CERN_MPageComponents[x];
					if (comp.isDisplayable() && !comp.isExpanded() && !comp.isLoaded()) {
						comp.setLoaded(true);
						if (comp.isResourceRequired()) {
							comp.RetrieveRequiredResources();
						}
						else {
							comp.InsertData();
						}
					}
				}
			}
		},
		ExpandCollapse: function() {
			var i18nCore = i18n.discernabu;
			var gpp = Util.gp(Util.gp(this));
			if (Util.Style.ccss(gpp, "closed")) {
				Util.Style.rcss(gpp, "closed");
				this.innerHTML = "-";
				this.title = i18nCore.HIDE_SECTION;
			}
			else {
				Util.Style.acss(gpp, "closed");
				this.innerHTML = "+";
				this.title = i18nCore.SHOW_SECTION;
			}
		},
		HideHovers: function() {
			var hovers = Util.Style.g("hover", document.body, "DIV");
			for (var i = hovers.length; i--; ) {
				if (Util.gp(hovers[i]).nodeName == "BODY") {
					hovers[i].style.display = 'none';
					Util.de(hovers[i]);
				}
			}
		},
		ReplaceSubTitleText: function(component, text) {
			var lookbackDisplay = $("#lookbackDisplay" + component.getStyles().getId());
			if(lookbackDisplay.length) {
				lookbackDisplay.html(text);
			}
		},
		ReInitSubTitleText: function(component) {
			if (component.getScope() > 0) {
				var lookbackDisplay = $("#lookbackDisplay" + component.getStyles().getId());
				if(lookbackDisplay.length) {
					lookbackDisplay.html(CreateSubTitleText(component));
				}
			}
		},
		/*Copyright (c) 2006-2010 Paranoid Ferret Productions.  All rights reserved.

		 Developed by: Paranoid Ferret Productions
		 http://www.paranoidferret.com

		 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
		 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
		 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
		 CONTRIBUTORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
		 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
		 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
		 WITH THE SOFTWARE.*/

		RunAccordion: function(index) {
			var titleAr = [];
			var nID = "Accordion" + index + "Content";
			var TimeToSlide = 100.0;
			var titleDiv = _g("Accordion" + index + "Title");
			var containerDiv = _g("AccordionContainer" + index);
			var component = MP_Util.GetCompObjById(index);
			var location = component.getCriterion().static_content;

			//Adjust the pull tab image
			if (Util.Style.ccss(titleDiv, "Expanded")) {
				Util.Style.rcss(titleDiv, "Expanded");
				Util.Style.rcss(containerDiv, "Expanded");
			}
			else {
				Util.Style.acss(titleDiv, "Expanded");
				Util.Style.acss(containerDiv, "Expanded");
			}

			if (openAccordion == nID) {
				nID = '';
			}

			setTimeout("MP_Util.Doc.Animate(" + new Date().getTime() + "," + TimeToSlide + ",'" + openAccordion + "','" + nID + "'," + index + ")", 33);
			openAccordion = nID;
		},
		Animate: function(lastTick, timeLeft, closingId, openingId, compID) {
			var TimeToSlide = timeLeft;
			var curTick = new Date().getTime();
			var elapsedTicks = curTick - lastTick;
			var ContentHeight = 275.0;

			var opening = (openingId == '') ? null : _g(openingId);
			var closing = (closingId == '') ? null : _g(closingId);

			if (timeLeft <= elapsedTicks) {
				if (opening) {
					opening.style.display = 'block';
					opening.style.height = ContentHeight + 'px';
				}

				if (closing) {
					closing.style.display = 'none';
					closing.style.height = '0px';
					var filterListAr = Util.Style.g("acc-filter-list-item" + compID);
					var filtersSelected = MP_Util.Doc.GetSelected(filterListAr);
					//Loop through and get all the values, which are the event sets, and then refresh the component
				}
				return;
			}

			timeLeft -= elapsedTicks;
			var newClosedHeight = Math.round((timeLeft / TimeToSlide) * ContentHeight);

			if (opening) {
				if (opening.style.display != 'block') {
					opening.style.display = 'block';
					opening.style.height = (ContentHeight - newClosedHeight) + 'px';
				}
			}
			if (closing) {
				closing.style.height = newClosedHeight + 'px';
			}

			setTimeout("MP_Util.Doc.Animate(" + curTick + "," + timeLeft + ",'" + closingId + "','" + openingId + "'," + compID + ")", 33);
		},
		GetSelected: function(opt) {
			var selected = [];
			var index = 0;
			var optLen = opt.length;
			for (var intLoop = 0; intLoop < optLen; intLoop++) {
				if (opt[intLoop].selected) {
					index = selected.length;
					selected[index] = {};
					selected[index].value = opt[intLoop].value;
					selected[index].index = intLoop;
				}
			}
			return selected;
		},
		CreateLookBackMenu: function(component, loadInd, text) {
			var i18nCore = i18n.discernabu;
			var ar = [];
			var style = component.getStyles();
			var ns = style.getNameSpace();
			var compId = style.getId();
			var mnuCompId = component.getComponentId();
			var loc = component.getCriterion().static_content;
			var mnuItems = [];
			var mnuId = compId + "Mnu";
			var scope = component.getScope();
			var lookBackText = "";
			var lookBackUnits = "";
			var lookBackType = 0;
			var filterMsg = "";
			var filterMsgElementTitle = "";
			var hasFilters = false;

			if (component.m_grouper_arr.length === 0) {
				component.setCompFilters(false);
			}
			else {
				component.setCompFilters(true);
			}

			if (loadInd === 2) {
				var lbMenu = _g("lb" + mnuId);
				if (component.hasCompFilters()) {
					if (!text) {
						MP_Util.LaunchCompFilterSelection(mnuCompId, -1, 2);
					}
					else {
						var filterMsgElement = _g("cf" + mnuCompId + "msg");
						filterMsgElementTitle = filterMsgElement.title;
						filterMsg = filterMsgElement.innerHTML;
					}
				}

				if (lbMenu) {
					//Clear contents of the menu
					lbMenu.innerHTML = "";
				}
			}

			if (!text) {
				var mnuDisplay = CreateSubTitleText(component);
			}
			else {
				var mnuDisplay = text;
			}

			var menuItems = component.getLookbackMenuItems();
			if (menuItems) {
				for (var x = 0; x < menuItems.length; x++) {
					mnuItems[x] = new Array();
					lookBackUnits = parseInt(menuItems[x].getDescription(), 10);
					var tempTypeId = menuItems[x].getId();
					switch(tempTypeId) {
						case 1:
							lookBackType = 1;
							break;
						case 2:
							lookBackType = 2;
							break;
						case 3:
							lookBackType = 3;
							break;
						case 4:
							lookBackType = 4;
							break;
						case 5:
							lookBackType = 5;
							break;
						default:
							lookBackType = tempTypeId;
							break;
					}
					if (scope > 0) {
						if (lookBackUnits > 0 && lookBackType > 0) {
							var replaceText = "";
							switch(lookBackType) {
								case 1:
									replaceText = i18nCore.LAST_N_HOURS.replace("{0}", lookBackUnits);
									break;
								case 2:
									replaceText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
									break;
								case 3:
									replaceText = i18nCore.LAST_N_WEEKS.replace("{0}", lookBackUnits);
									break;
								case 4:
									replaceText = i18nCore.LAST_N_MONTHS.replace("{0}", lookBackUnits);
									break;
								case 5:
									replaceText = i18nCore.LAST_N_YEARS.replace("{0}", lookBackUnits);
									break;
								default:
									replaceText = i18nCore.LAST_N_DAYS.replace("{0}", lookBackUnits);
									break;
							}
							switch(scope) {
								case 1:
									lookBackText = i18nCore.ALL_N_VISITS.replace("{0}", replaceText);
									break;
								case 2:
									lookBackText = i18nCore.SELECTED_N_VISIT.replace("{0}", replaceText);
									break;
							}
						}
						else {
							switch(scope) {
								case 1:
									lookBackText = i18nCore.All_VISITS;
									break;
								case 2:
									lookBackText = i18nCore.SELECTED_VISIT;
									break;
							}
						}
					}
					mnuItems[x][0] = lookBackText;
					mnuItems[x][1] = lookBackUnits;
					mnuItems[x][2] = lookBackType;
				}

				ar.push("<div id='lb", mnuId, "'><div id='stt", compId, "' class='sub-title-disp lb-drop-down'>");
				ar.push("<span id='lbMnuDisplay", mnuCompId, "' onclick='MP_Util.LaunchMenu(\"", mnuId, '", "', compId, "\");'>", mnuDisplay, "<a id='", ns, "Drop'><img src='", loc, "/images/3943_16.gif'></a></span><span id='cf", mnuCompId, "msg' class='filter-applied-msg' title='", filterMsgElementTitle, "'>", filterMsg, "</span></div>");
				ar.push("<div class='cvClassFilterSpan lb-mnu-selectWindow lb-menu2 menu-hide' id='", mnuId, "'><div class='mnu-labelbox'>", mnuDisplay, "</div><div class='mnu-contentbox'>");
				for (var x = 0, xl = mnuItems.length; x < xl; x++) {
					var item = mnuItems[x];
					ar.push("<div><span class='lb-mnu' id='lb", compId, x, "' onclick='MP_Util.LaunchLookBackSelection(\"", mnuCompId, '\",', item[1], ',\"', item[2], "\");'>", item[0], "</span></div>");
				}
				ar.push("</div></div></div>")
			}
			else {
				ar.push("<div id='lb", mnuId, "'><div id='stt", compId, "' class='sub-title-disp lb-drop-down'>");
				ar.push("<span id='lbMnuDisplay", mnuCompId, "'>", mnuDisplay, "</span><span id='cf", mnuCompId, "msg' class='filter-applied-msg' title='", filterMsgElementTitle, "'>", filterMsg, "</span></div></div>")
			}
			for (var y = 0; y < 10; y++) {
				if (component.getGrouperLabel(y) || component.getGrouperCatLabel(y)) {
					hasFilters = true;
					break;
				}
			}
			if (hasFilters === true && loadInd === 1) {
				ar.push("<div id='AccordionContainer", mnuCompId, "' class='accordion-container'>");
				ar.push("<div id='Accordion", mnuCompId, "Content' class='accordion-content'><div id='Accordion", mnuCompId, "ContentDiv' class='acc-content-div'></div><div class='lb-pg-hd lb-page-ctrl'><a class='setDefault' href='#' onclick='MP_Core.AppUserPreferenceManager.SaveCompPreferences(", mnuCompId, "); return false;'>", i18nCore.SET_AS_DEFAULT, "</a><a class='resetAll' href='#' onclick='MP_Core.AppUserPreferenceManager.ClearCompPreferences(", mnuCompId, "); return false;'>", i18nCore.RESET_ALL, "</a></div></div>");
				ar.push("<div id='Accordion", mnuCompId, "Title' class='accordion-title' onclick='MP_Util.Doc.RunAccordion(", mnuCompId, ");' onselectstart='return false;'></div></div>");
			}

			switch(loadInd) {
				case 2:
					lbMenu.innerHTML = ar.join('');
					break;

				default:
					var arHtml = ar.join("");
					return arHtml;
			}
		},
		/**
		 * This function is a passthrough to make the changeLayout function available outside of the MP_Util.Doc namespace since the layout menu items is now created
		 * at the MPagesView level.
		 */
		changeLayoutPassthrough : function(newColCnt, catMean){
			changeLayout(newColCnt, catMean)
		},
		
		/* Reset Layout functionality*/
		ResetLayoutSettings: function(mPageObj) {
				var componentSettings = mPageObj.getPageSettings().COMPONENT;
				var components = mPageObj.getComponents();
				var tempComp = null;
				var tempCompSettings = {};
				//Create a map so we dont have to search the componentSettings more than once
				var componentMap = {};
				for(x = componentSettings.length; x--; ){
					componentMap[componentSettings[x].REPORT_MEAN] = componentSettings[x];
				}
				
				//Grab the settings from the componentMap and reset the sequence and row to what is originally defined in bedrock
				for(x = components.length; x--; ){
					 tempComp = components[x];
					 tempCompSettings  = componentMap[tempComp.getReportMean()];
					 components[x].setSequence(tempCompSettings.ROW_SEQ);
					 components[x].setColumn(tempCompSettings.COL_SEQ);
				}
				
				var criterion = mPageObj.getCriterion();
				//Show the cursor as busy
				$('body').css('cursor', 'wait');
				//This call is used to update all of the component's settings before refreshing the page.
				MP_Core.AppUserPreferenceManager.UpdateAllCompPreferences(components);
				
				//Refresh the Page or viewpoint
				if( typeof m_viewpointJSON == "undefined") {
					cclParams = ["^MINE^", criterion.person_id + ".0", criterion.encntr_id + ".0", criterion.provider_id + ".0", criterion.position_cd + ".0", criterion.ppr_cd + ".0", "^" + criterion.executable + "^", "^^", "^" + criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + criterion.category_mean + "^", criterion.debug_ind];
					CCLLINK("MP_DRIVER", cclParams.join(","), 1);
				}
				else {
					var viewpointJSON = JSON.parse(m_viewpointJSON).VIEWPOINTINFO_REC;
					cclParams = ["^MINE^", criterion.person_id + ".0", criterion.encntr_id + ".0", criterion.provider_id + ".0", criterion.position_cd + ".0", criterion.ppr_cd + ".0", "^" + criterion.executable + "^", "^" + criterion.static_content.replace(/\\/g, "\\\\") + "^", "^" + viewpointJSON.VIEWPOINT_NAME_KEY + "^", criterion.debug_ind, "^^", 0, "^" + viewpointJSON.ACTIVE_VIEW_CAT_MEAN + "^"];
					CCLLINK(CERN_driver_script, cclParams.join(","), 1);
				}
		},
		
		/**
		 * This function is a passthrough to make the changeQocLayout function available outside of the MP_Util.Doc namespace since the layout menu items is now created
		 * at the MPagesView level.
		 */
		changeQOCLayoutPassthrough : function(newColCnt, catMean){
			changeQOCLayout(newColCnt, catMean);
		},
		ReloadAllComponents : function(mPage){
	        var components = mPage.getComponents();
			var rows = [];
			MP_Util.addComponentsToGlobalStorage(components);
			for (var idx = 0, lmt = components.length; idx < lmt; idx++) {
				var tmpComponent = components[idx];
                tmpComponent.InsertData();
	        }
	   },
	    CreateComponent : function(tmpComponent, disableMenu){
			return CreateCompDiv(tmpComponent, disableMenu)
		}
	};

	function launchSelectLayout(menuId, that, initialColCnt) {
		var i18nCore = i18n.discernabu;
		var optMenu = _g("optMenuConfig" + menuId);
		if (!optMenu) {
			optMenu = Util.cep("div", {
				className: "opts-menu-layout-content menu-hide",
				id: "optMenuConfig" + menuId
			});
			var optMenuJsHTML = [];
			var layoutClasses = ['view-layout1', 'view-layout2', 'view-layout3'];
			var i18nCore = i18n.discernabu;
			layoutClasses[initialColCnt - 1] += " view-layout-selected";
			optMenuJsHTML.push("<div class='" + layoutClasses[0] + "' data-cols='1'>" + i18nCore.COLUMN_ONE + "</div><div class='" + layoutClasses[1] + "' data-cols='2'>" + i18nCore.COLUMN_TWO + "</div><div class='" + layoutClasses[2] + "' data-cols='3'>" + i18nCore.COLUMN_THREE + "</div>");
			optMenu.innerHTML = optMenuJsHTML.join("");
			Util.ac(optMenu, document.body);

			Util.addEvent(_g("optMenuConfig" + menuId), "click", function(e) {
				var target = e.target || e.srcElement;
				var cols = target.getAttribute("data-cols");
				$("#optMenuConfig" + menuId + " div").removeClass("view-layout-selected");
				Util.Style.acss(target, "view-layout-selected");

				var catMean;
				if ( typeof m_viewpointJSON == "string") {
					MP_Util.RetrieveCookie();
					var vpCookieVal = MP_Util.GetCookieProperty("viewpoint", "viewCatMean")
					catMean = (vpCookieVal) ? vpCookieVal : $(".vwp-cached:first").attr("id");
				}
				changeLayout(parseInt(cols, 10), catMean);
			});
			InitPageOptMenu(optMenu, menuId, true);
		}
		OpenCompOptMenu(optMenu, menuId, that);
	}

	function launchQOCSelectLayout(menuId, that, initialColCnt) {
		var i18nCore = i18n.discernabu;
		var optMenu = _g("optMenuConfig" + menuId);
		if (!optMenu) {
			optMenu = Util.cep("div", {
				className: "opts-menu-layout-content menu-hide",
				id: "optMenuConfig" + menuId
			});
			var optMenuJsHTML = [];
			var layoutClasses = ['view-layout1', 'view-layout2', 'view-layout3', 'view-layout4', 'view-layout5'];
			var i18nCore = i18n.discernabu;
			layoutClasses[initialColCnt - 1] += " view-layout-selected";
			optMenuJsHTML.push("<div class='" + layoutClasses[0] + "' data-cols='1'>" + i18nCore.COLUMN_ONE + "</div><div class='" + layoutClasses[1] + "' data-cols='2'>" + i18nCore.COLUMN_TWO + "</div><div class='" + layoutClasses[2] + "' data-cols='3'>" + i18nCore.COLUMN_THREE + "</div><div class='" + layoutClasses[3] + "' data-cols='4'>" + i18nCore.COLUMN_FOUR + "</div><div class='" + layoutClasses[4] + "' data-cols='5'>" + i18nCore.COLUMN_FIVE + "</div>");
			optMenu.innerHTML = optMenuJsHTML.join("");
			Util.ac(optMenu, document.body);

			Util.addEvent(_g("optMenuConfig" + menuId), "click", function(e) {
				var target = e.target || e.srcElement;
				var cols = target.getAttribute("data-cols");
				$("#optMenuConfig" + menuId + " div").removeClass("view-layout-selected");
				Util.Style.acss(target, "view-layout-selected");
				var activeViewDiv = Util.Style.g("div-tab-item-selected", document.body, "DIV")[0];
				if (activeViewDiv) {
					var catMean = activeViewDiv.id;
					changeQOCLayout(parseInt(cols, 10), catMean);
				}
			});
			InitPageOptMenu(optMenu, menuId, true);
		}
		OpenCompOptMenu(optMenu, menuId, that);
	}

	function changeLayout(newColCnt, catMean) {
		var viewpointState = (catMean) ? "#" + catMean + " " : "";
		var colClasses = ["one-col", "two-col", "three-col"]
		var curColCnt;
		var curColGroupClass = $(viewpointState + '.col-group:last').attr('class').replace("col-group ", "");

		switch (curColGroupClass) {
			case "three-col":
				curColCnt = 3;
				break;
			case "two-col":
				curColCnt = 2;
				break;
			case "one-col":
				curColCnt = 1;
				break;
		}

		if (newColCnt < curColCnt) {//removing columns
			if (newColCnt === 1) {
				var comps = $(viewpointState + '.col-group:last .section').not(viewpointState + '.col1 .section');
				$(viewpointState + '.col-group:last .col1').append(comps);
				$(viewpointState + '.col-group:last .col2').remove();
				$(viewpointState + '.col-group:last .col3').remove();
			}
			else if (newColCnt === 2) {
				var comps = $(viewpointState + '.col-group:last .col3 .section');
				$(viewpointState + '.col-group:last .col2').append(comps);
				$(viewpointState + '.col-group:last .col3').remove();
			}
			//save new layout
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(null, "", null, true);
			}, 0);

			$(viewpointState + '.col-group:last').attr('class', 'col-group ' + colClasses[newColCnt - 1])
		}
		else if (newColCnt > curColCnt) {//adding columns
			if ((newColCnt - curColCnt) === 1) {
				var colHTML = (curColCnt == 1) ? '<div class="col2"></div>' : '<div class="col3"></div>';
				$(viewpointState + '.col-outer1:last').append(colHTML);
			}
			else if ((newColCnt - curColCnt) === 2) {
				$(viewpointState + '.col-outer1:last').append('<div class="col2"></div><div class="col3"></div>');
			}

			$(viewpointState + '.col-group:last').attr('class', 'col-group ' + colClasses[newColCnt - 1])
			MP_Util.Doc.InitDragAndDrop(catMean);
		}
	}

	function changeQOCLayout(newColCnt, catMean) {
		var viewpointState = (catMean) ? "#" + catMean + " " : "";
		var colClasses = ["one-col", "two-col", "three-col", "four-col", "five-col"]
		var curColCnt;
		var curColGroupClass = $(viewpointState + '.col-group:last').attr('class').replace("col-group ", "");

		switch (curColGroupClass) {
			case "five-col":
				curColCnt = 5;
				break;
			case "four-col":
				curColCnt = 4;
				break;
			case "three-col":
				curColCnt = 3;
				break;
			case "two-col":
				curColCnt = 2;
				break;
			case "one-col":
				curColCnt = 1;
				break;
		}

		if (newColCnt < curColCnt) {//removing columns
			if (newColCnt === 1) {
				var comps = $(viewpointState + '.col-group:last .section').not(viewpointState + '.col1 .section');
				$(viewpointState + '.col-group:last .col1').append(comps);
				$(viewpointState + '.col-group:last .col2').remove();
				$(viewpointState + '.col-group:last .col3').remove();
				$(viewpointState + '.col-group:last .col4').remove();
				$(viewpointState + '.col-group:last .col5').remove();
			}
			else if (newColCnt === 2) {
				var comps = $(viewpointState + '.col-group:last .section').not(viewpointState + '.col1 .section').not(viewpointState + '.col2 .section');
				$(viewpointState + '.col-group:last .col2').append(comps);
				$(viewpointState + '.col-group:last .col3').remove();
				$(viewpointState + '.col-group:last .col4').remove();
				$(viewpointState + '.col-group:last .col5').remove();
			}
			else if (newColCnt === 3) {
				var comps = $(viewpointState + '.col-group:last .section').not(viewpointState + '.col1 .section').not(viewpointState + '.col2 .section').not(viewpointState + '.col3 .section');
				$(viewpointState + '.col-group:last .col3').append(comps);
				$(viewpointState + '.col-group:last .col4').remove();
				$(viewpointState + '.col-group:last .col5').remove();
			}
			else if (newColCnt === 4) {
				var comps = $(viewpointState + '.col-group:last .col5 .section');
				$(viewpointState + '.col-group:last .col4').append(comps);
				$(viewpointState + '.col-group:last .col5').remove();
			}
			//save new layout
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, catMean);
			}, 0);

			$(viewpointState + '.col-group:last').attr('class', 'col-group ' + colClasses[newColCnt - 1])
		}
		else if (newColCnt > curColCnt) {//adding columns
			if ((newColCnt - curColCnt) === 1) {
				if (newColCnt === 2) {
					$(viewpointState + '.col-outer1:last').append('<div class="col2"></div>');
				}
				else if (newColCnt === 3) {
					$(viewpointState + '.col-outer1:last').append('<div class="col3"></div>');
				}
				else if (newColCnt === 4) {
					$(viewpointState + '.col-outer1:last').append('<div class="col4"></div>');
				}
				else if (newColCnt === 5) {
					$(viewpointState + '.col-outer1:last').append('<div class="col5"></div>');
				}
			}
			else if ((newColCnt - curColCnt) === 2) {
				if (newColCnt === 3) {
					$(viewpointState + '.col-outer1:last').append('<div class="col2"></div><div class="col3"></div>');
				}
				else if (newColCnt === 4) {
					$(viewpointState + '.col-outer1:last').append('<div class="col3"></div><div class="col4"></div>');
				}
				else if (newColCnt === 5) {
					$(viewpointState + '.col-outer1:last').append('<div class="col4"></div><div class="col5"></div>');
				}
			}
			else if ((newColCnt - curColCnt) === 3) {
				if (newColCnt === 4) {
					$(viewpointState + '.col-outer1:last').append('<div class="col2"></div><div class="col3"></div><div class="col4"></div>');
				}
				else if (newColCnt === 5) {
					$(viewpointState + '.col-outer1:last').append('<div class="col3"></div><div class="col4"></div><div class="col5"></div>');
				}
			}
			else if ((newColCnt - curColCnt) === 4) {
				$(viewpointState + '.col-outer1:last').append('<div class="col2"></div><div class="col3"></div><div class="col4"></div><div class="col5"></div>');
			}

			$(viewpointState + '.col-group:last').attr('class', 'col-group ' + colClasses[newColCnt - 1])
			MP_Util.Doc.InitQOCDragAndDrop(catMean);
		}
	}

	function launchThemeMenu(componentId, fullId, secId, that) {
		var i18nCore = i18n.discernabu;
		var optMenu = _g("optMenuConfig" + componentId);
		if (!optMenu) {
			optMenu = Util.cep("div", {
				"className": "opts-menu-config-content menu-hide",
				"id": "optMenuConfig" + componentId
			});
			var optMenuJsHTML = [];
			optMenuJsHTML.push("<div title = '", i18nCore.COLOR_STANDARD, "' class='opts-menu-config-item opt-config-mnu-lightgrey' data-color='lightgrey' id='optConfigMnuLightGrey", componentId, "'></div>", "<div title = '", i18nCore.COLOR_BROWN, "' class='opts-menu-config-item opt-config-mnu-brown' data-color='brown' id='optConfigMnuBrown", componentId, "'></div>", "<div title = '", i18nCore.COLOR_CERNER_BLUE, "' class='opts-menu-config-item opt-config-mnu-cernerblue' data-color='cernerblue' id='optConfigMnuCernerBlue", componentId, "'></div>", "<div title = '", i18nCore.COLOR_DARK_GREEN, "' class='opts-menu-config-item opt-config-mnu-darkgreen' data-color='darkgreen' id='optConfigMnuDarkGreen", componentId, "'></div>", "<div title = '", i18nCore.COLOR_GREEN, "' class='opts-menu-config-item opt-config-mnu-green' data-color='green' id='optConfigMnuGreen", componentId, "'></div>", "<div title = '", i18nCore.COLOR_GREY, "' class='opts-menu-config-item opt-config-mnu-grey' data-color='grey' id='optConfigMnuGrey", componentId, "'></div>", "<div title = '", i18nCore.COLOR_LIGHT_BLUE, "' class='opts-menu-config-item opt-config-mnu-lightblue' data-color='lightblue' id='optConfigMnuLightBlue", componentId, "'></div>", "<div title = '", i18nCore.COLOR_NAVY, "' class='opts-menu-config-item opt-config-mnu-navy' data-color='navy' id='optConfigMnuNavy", componentId, "'></div>", "<div title = '", i18nCore.COLOR_ORANGE, "' class='opts-menu-config-item opt-config-mnu-orange' data-color='orange' id='optConfigMnuOrange", componentId, "'></div>", "<div title = '", i18nCore.COLOR_PINK, "' class='opts-menu-config-item opt-config-mnu-pink' data-color='pink' id='optConfigMnuPink", componentId, "'></div>", "<div title = '", i18nCore.COLOR_PURPLE, "' class='opts-menu-config-item opt-config-mnu-purple' data-color='purple' id='optConfigMnuPurple", componentId, "'></div>", "<div title = '", i18nCore.COLOR_YELLOW, "' class='opts-menu-config-item opt-config-mnu-yellow' data-color='yellow' id='optConfigMnuYellow", componentId, "'></div>");

			optMenu.innerHTML = optMenuJsHTML.join("");

			Util.ac(optMenu, document.body);
			//actual contents of the menu are appended to body and positioned in launchOptMenu

			Util.addEvent(_g("optMenuConfig" + componentId), "click", function(e) {
				var target = e.target || e.srcElement;
				var color = target.getAttribute('data-color');
				changeThemeColor(componentId, color, secId);
			});

			InitCompOptMenu(optMenu, componentId, true);
		}

		OpenCompOptMenu(optMenu, fullId, that);
	}

	function launchQOCThemeMenu(componentId, fullId, secId, that, selectedViewId) {
		var i18nCore = i18n.discernabu;
		var optMenu = _g("optMenuConfig" + componentId);
		if (!optMenu) {
			optMenu = Util.cep("div", {
				"className": "opts-menu-config-content menu-hide",
				"id": "optMenuConfig" + componentId
			});
			var optMenuJsHTML = [];
			optMenuJsHTML.push("<div title = '", i18nCore.COLOR_STANDARD, "' class='opts-menu-config-item opt-config-mnu-lightgrey' data-color='lightgrey' id='optConfigMnuLightGrey", componentId, "'></div>", "<div title = '", i18nCore.COLOR_BROWN, "' class='opts-menu-config-item opt-config-mnu-brown' data-color='brown' id='optConfigMnuBrown", componentId, "'></div>", "<div title = '", i18nCore.COLOR_CERNER_BLUE, "' class='opts-menu-config-item opt-config-mnu-cernerblue' data-color='cernerblue' id='optConfigMnuCernerBlue", componentId, "'></div>", "<div title = '", i18nCore.COLOR_DARK_GREEN, "' class='opts-menu-config-item opt-config-mnu-darkgreen' data-color='darkgreen' id='optConfigMnuDarkGreen", componentId, "'></div>", "<div title = '", i18nCore.COLOR_GREEN, "' class='opts-menu-config-item opt-config-mnu-green' data-color='green' id='optConfigMnuGreen", componentId, "'></div>", "<div title = '", i18nCore.COLOR_GREY, "' class='opts-menu-config-item opt-config-mnu-grey' data-color='grey' id='optConfigMnuGrey", componentId, "'></div>", "<div title = '", i18nCore.COLOR_LIGHT_BLUE, "' class='opts-menu-config-item opt-config-mnu-lightblue' data-color='lightblue' id='optConfigMnuLightBlue", componentId, "'></div>", "<div title = '", i18nCore.COLOR_NAVY, "' class='opts-menu-config-item opt-config-mnu-navy' data-color='navy' id='optConfigMnuNavy", componentId, "'></div>", "<div title = '", i18nCore.COLOR_ORANGE, "' class='opts-menu-config-item opt-config-mnu-orange' data-color='orange' id='optConfigMnuOrange", componentId, "'></div>", "<div title = '", i18nCore.COLOR_PINK, "' class='opts-menu-config-item opt-config-mnu-pink' data-color='pink' id='optConfigMnuPink", componentId, "'></div>", "<div title = '", i18nCore.COLOR_PURPLE, "' class='opts-menu-config-item opt-config-mnu-purple' data-color='purple' id='optConfigMnuPurple", componentId, "'></div>", "<div title = '", i18nCore.COLOR_YELLOW, "' class='opts-menu-config-item opt-config-mnu-yellow' data-color='yellow' id='optConfigMnuYellow", componentId, "'></div>");

			optMenu.innerHTML = optMenuJsHTML.join("");

			Util.ac(optMenu, document.body);
			//actual contents of the menu are appended to body and positioned in launchOptMenu

			Util.addEvent(_g("optMenuConfig" + componentId), "click", function(e) {
				var target = e.target || e.srcElement;
				var color = target.getAttribute('data-color');
				changeQOCThemeColor(componentId, color, secId, selectedViewId);
			});

			InitCompOptMenu(optMenu, componentId, true);
		}

		OpenCompOptMenu(optMenu, fullId, that);
	}

	function changeThemeColor(componentId, color, styleId) {
		var section = _g(styleId);
		if (section) {
			var colorString = "brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow";
			//a color is found in the class name so replace it with ""
			if (colorString.indexOf(color) >= 0) {
				var colorRegExp = /brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow/;
				section.className = section.className.replace(colorRegExp, "");
			}

			//add the new color so it changes for the user
			Util.Style.acss(section, color);
			var component = MP_Util.GetCompObjById(componentId);
			component.setCompColor(color);
			//add the color to the component properties
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(componentId, color, null, false);
			}, 0);
		}
	}

	function changeQOCThemeColor(componentId, color, styleId, selectedViewId) {
		var section = _g(styleId);
		if (section) {
			var colorString = "brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow";
			//a color is found in the class name so replace it with ""
			if (colorString.indexOf(color) >= 0) {
				var colorRegExp = /brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow/;
				section.className = section.className.replace(colorRegExp, "");
			}

			//add the new color so it changes for the user
			Util.Style.acss(section, color);
			var component = MP_Util.GetCompObjById(componentId);
			component.setCompColor(color);
			//add the color to the component properties
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, selectedViewId);
			}, 0);
		}
	}

	function launchSetState(componentId, defStateEl) {
		var component = MP_Util.GetCompObjById(componentId);
		var curExpColState = component.isExpanded();
		component.setExpandCollapseState(!curExpColState);
		var checkSpan = _gbt("span", defStateEl)[0];

		if (!curExpColState) {
			if (checkSpan) {
				Util.Style.acss(checkSpan, "opts-menu-def-exp");
			}
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(componentId, "", "1", false);
			}, 0);
		}
		else {
			if (checkSpan) {
				Util.Style.rcss(checkSpan, "opts-menu-def-exp");
			}
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(componentId, "", "0", false);
			}, 0);
		}
	}

	function launchInfoSetState(componentId, infoStateEl) {
		//false = Disabled, true = Enabled
		var i18nCore = i18n.discernabu;
		var component = MP_Util.GetCompObjById(componentId);
		var curInfoState = component.isInfoButtonEnabled();
		var checkSpan = _gbt("span", infoStateEl)[0];
		//component.setIsInfoButtonEnabled(!curInfoState);
		if (curInfoState) {
			component.setIsInfoButtonEnabled(0);
		}
		else {
			component.setIsInfoButtonEnabled(1);
		}
		
		if (!curInfoState) { //Currently disabled, turning to enabled
			if (checkSpan) {
				Util.Style.acss(checkSpan, "opts-menu-info-en");
				//Call the component function to show info button and allow click event
				component.showInfoButton(component,true);
				setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(componentId, "", "", false,"1");
			}, 0);
			}
		}
		else {
			if (checkSpan) {
				Util.Style.rcss(checkSpan, "opts-menu-info-en");
				//Call the component function to remove info button
				component.showInfoButton(component,false);
				setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveCompPreferences(componentId, "", "", false,"0");
			}, 0);
			}
		}
	}
	
	function launchQOCSetState(componentId, defStateEl, selectedViewId) {
		var component = MP_Util.GetCompObjById(componentId);
		var curExpColState = component.isExpanded();
		component.setExpandCollapseState(!curExpColState);
		var checkSpan = _gbt("span", defStateEl)[0];

		if (!curExpColState) {
			if (checkSpan) {
				Util.Style.acss(checkSpan, "opts-menu-def-exp");
			}
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, selectedViewId);
			}, 0);
		}
		else {
			if (checkSpan) {
				Util.Style.rcss(checkSpan, "opts-menu-def-exp");
			}
			setTimeout(function() {
				MP_Core.AppUserPreferenceManager.SaveQOCCompPreferences(null, "", null, true, selectedViewId);
			}, 0);
		}
	}

	function InitPageOptMenu(inMenu, componentId, isSubMenu) {
		var closeMenu = function(e) {
			if (!e) {
				e = window.event;
			}

			var resetPageMenu = function() {
				var pageMenu = _g(componentId);
				if (Util.Style.ccss(pageMenu, "page-menu-open")) {
					Util.Style.rcss(pageMenu, "page-menu-open")
				}
			}
			var relTarg = e.relatedTarget || e.toElement;
			var mainMenu = _g("moreOptMenu" + componentId);

			if (isSubMenu) {
				var target = e.target || e.srcElement;
			}
			if (relTarg) {
				if (!Util.Style.ccss(relTarg, "opts-menu-layout-content")) {
					if (mainMenu) {
						Util.Style.acss(mainMenu, "menu-hide");
						resetPageMenu();
					}
					if (isSubMenu) {
						if (Util.Style.ccss(target, "opts-menu-layout-content") && !Util.Style.ccss(relTarg, "opts-menu-content")) {
							if (_g("moreOptMenu" + componentId)) {
								Util.Style.acss(_g("moreOptMenu" + componentId), "menu-hide");
							}
						}
					}
					if (_g("optMenuConfig" + componentId)) {
						Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
					}
				}
			}
			else {
				if (mainMenu) {
					Util.Style.acss(mainMenu, "menu-hide");
					resetPageMenu();
				}
			}
			Util.cancelBubble(e);
		};
		$(inMenu).mouseleave(closeMenu);
	}

	function InitCompOptMenu(inMenu, componentId, isSubMenu) {
		var closeMenu = function(e) {
			if (!e) {
				e = window.event;
			}
			var relTarg = e.relatedTarget || e.toElement;
			var mainMenu = _g("moreOptMenu" + componentId);
			if (isSubMenu) {
				var target = e.target || e.srcElement;
			}
			if (relTarg) {
				if (!Util.Style.ccss(relTarg, "opts-menu-config-content")) {
					if (mainMenu) {
						Util.Style.acss(mainMenu, "menu-hide");
					}
					if (isSubMenu) {
						Util.Style.acss(inMenu, "menu-hide");
						if (Util.Style.ccss(target, "opts-menu-config-content") && !Util.Style.ccss(relTarg, "opts-menu-content")) {
							if (_g("moreOptMenu" + componentId)) {
								Util.Style.acss(_g("moreOptMenu" + componentId), "menu-hide");
							}
						}
					}
					if (_g("optMenuConfig" + componentId)) {
						Util.Style.acss(_g("optMenuConfig" + componentId), "menu-hide");
					}

				}
			}
			else {
				if (mainMenu) {
					Util.Style.acss(mainMenu, "menu-hide");
				}
			}
			Util.cancelBubble(e);
		};
		$(inMenu).mouseleave(closeMenu);
	}

	/**
	 * Open the options menu within the new order entry component
	 * @param {node} menu : The menu node
	 * @param {string} sectionId : The html id of the section containing the menu
	 */
	function OpenCompOptMenu(menu, sectionId, that) {
		var verticalOffset = 30;
		if (Util.Style.ccss(menu, "menu-hide")) {
			Util.preventDefault();
			Util.Style.rcss(menu, "menu-hide");

			if (that) {
				var ofs = Util.goff(that);
				var moreMenu = Util.gns(that);
				var thisWidth = that.offsetWidth;
				var divOfs = menu.offsetWidth;

				var vpOfs = ofs[0] - divOfs;
				if (vpOfs > 0) {
					menu.style.left = (vpOfs - 2) + 'px';
					//  Util.Style.acss(mpDiv, 'hml-mpd-lt');
				}
				else {
					menu.style.left = (ofs[0] + thisWidth + 6) + 'px';
					//  Util.Style.acss(mpDiv, 'hml-mpd-rt');

				}
				menu.style.top = (ofs[1] - 5) + 'px';
			}
			else {
				var menuId = "#mainCompMenu" + sectionId;
				var menuElement = $(menuId);
				if (menuElement.length) {
					//Component menu logic
					menu.style.left = ($(menuElement).offset().left - 125) + "px";
					menu.style.top = ($(menuElement).offset().top + 18) + "px";
				}
				else {
					//Page level menu logic
					var vp = gvs();
					var sec = _g(sectionId);
					var ofs = Util.goff(sec);
					menu.style.left = (ofs[0] + sec.offsetWidth - menu.offsetWidth) + 'px';
					menu.style.top = (ofs[1] + verticalOffset) + 'px';
				}
			}
		}
		else {
			Util.Style.acss(menu, "menu-hide");
		}
	}

	function GetPreferenceIdentifier() {
		var prefIdentifier = "";
		if (CERN_TabManagers != null) {
			for (var x = CERN_TabManagers.length; x--; ) {
				var tabManager = CERN_TabManagers[x];
				if (tabManager.getSelectedTab()) {
					var tabItem = tabManager.getTabItem();
					return tabItem.prefIdentifier;
				}
			}
		}
		else if (CERN_MPageComponents != null) {
			for (var x = CERN_MPageComponents.length; x--; ) {
				var criterion = CERN_MPageComponents[x].getCriterion();
				return criterion.category_mean;
			}
		}
		return prefIdentifier;
	}

	function GetPageReportIds() {
		var ar = [];
		if (CERN_TabManagers != null) {
			for (var x = CERN_TabManagers.length; x--; ) {
				var tabManager = CERN_TabManagers[x];
				if (tabManager.getSelectedTab()) {
					var tabItem = tabManager.getTabItem();
					var components = tabItem.components;
					if (components != null && components.length > 0) {
						for (var y = components.length; y--; ) {
							ar.push(components[y].getReportId())
						}
					}
					break;
				}
			}
		}
		else if (CERN_MPageComponents != null) {
			for (var x = CERN_MPageComponents.length; x--; ) {
				ar.push(CERN_MPageComponents[x].getReportId());
			}
		}
		return ar;
	}

	function GetComponentArray(components) {
		var grpAr = [];
		var colAr = [];
		var rowAr = [];
		var curCol = -1;
		var curGrp = -1;

		var sHTML = [];

		//first layout the group/columns/rows of components
		if (components != null) {
			components.sort(SortMPageComponents);

			for (var x = 0, xl = components.length; x < xl; x++) {
				var component = components[x];
				if (CERN_MPageComponents == null)
					CERN_MPageComponents = [];
				CERN_MPageComponents.push(component);

				if (component.isDisplayable()) {//based on filter logic, only display if criteria is met
					var compGrp = component.getPageGroupSequence();
					var compCol = component.getColumn();

					if (compGrp != curGrp) {
						curCol = -1;
						colAr = [];
						grpAr.push(colAr);
						curGrp = compGrp;
					}

					if (compCol != curCol) {
						rowAr = [];
						colAr.push(rowAr);
						curCol = compCol;
					}
					rowAr.push(component);
				}
			}
		}
		return grpAr;
	}

	function CreateCustomizeLiquidLayout(components, parentNode) {
		var sHTML = [];
		var grpAr = MP_Util.GetComponentArray(components);
		sHTML.push("<div class=pref-columns>");
		for (var x = 0, xl = grpAr.length; x < xl; x++) {
			colAr = grpAr[x];
			sHTML.push("<div>");
			var colLen = colAr.length;
			//always allow for a 3 column custimization
			sHTML.push("<div class='col-group three-col'>");
			sHTML.push("<div class='col-outer2'><div class='col-outer1'>");

			for (var y = 0; y < colLen; y++) {
				var comps = colAr[y];
				var colClassName = "col" + (y + 1) + " cust-col";
				sHTML.push("<div class='", colClassName, "'>")
				for (var z = 0, zl = comps.length; z < zl; z++) {
					sHTML.push(CreateCompDiv(comps[z]));
				}
				sHTML.push("</div>");
			}
			for (var y = colLen + 1; y <= 3; y++) {
				var colClassName = "col" + (y) + " cust-col";
				sHTML.push("<div class='", colClassName, "'></div>")
			}
			sHTML.push("</div></div></div></div>");
		}
		sHTML.push("</div>");
		parentNode.innerHTML += sHTML.join("");
	}

	function CreateLiquidLayout(components, parentNode, disableMenu) {
		var grpAr = MP_Util.GetComponentArray(components);
		//Put the components in the global object
		MP_Util.addComponentsToGlobalStorage(components);
		var sHTML = [];
		for (var x = 0, xl = grpAr.length; x < xl; x++) {
			colAr = grpAr[x];
			sHTML.push("<div>");
			var colLen = colAr.length;
			switch(colLen) {
				case 1:
					sHTML.push("<div class='col-group one-col'>");
					break;
				case 2:
					sHTML.push("<div class='col-group two-col'>");
					break;
				case 3:
					sHTML.push("<div class='col-group three-col'>");
					break;
				case 4:
					sHTML.push("<div class='col-group four-col'>");
					break;
				default:
					sHTML.push("<div class='col-group five-col'>");
			}
			sHTML.push("<div class='col-outer2'><div class='col-outer1'>");
			for (var y = 0; y < colLen; y++) {
				var colClassName = "col" + (y + 1);
				var comps = colAr[y];
				sHTML.push("<div class='", colClassName, "'>");
				for (var z = 0, zl = comps.length; z < zl; z++) {
					sHTML.push(CreateCompDiv(comps[z], disableMenu));
				}
				sHTML.push("</div>");
			}
			sHTML.push("</div></div></div></div>");
		}
		parentNode.innerHTML += sHTML.join("");
	}

	function UpdateQOCComponentsWithUserPrefs(bedrockComponentArr, userPrefComponentArr, criterion, MPageObj) {
		var isViewPoint = null
		var colorString = "brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow";
        var colorRegExp = /brown|cernerblue|darkgreen|grey|green|lightblue|lightgrey|lowlight|navy|orange|pink|purple|yellow/;
        var style = null;
        var compClassName = null;
		if (MPageObj) {
			isViewPoint = MPageObj.getViewpointIndicator();
		}
		for (var x = 0, xl = userPrefComponentArr.length; x < xl; x++) {
			var userPrefComp = userPrefComponentArr[x];
			var isUserPrefPrsnlFavComp = true;
			for (var y = 0, yl = bedrockComponentArr.length; y < yl; y++) {
				var bedrockComp = bedrockComponentArr[y];
				var mnuCompId = bedrockComp.getComponentId();
				if (mnuCompId === userPrefComp.id) {
					isUserPrefPrsnlFavComp = false;
					bedrockComp.setColumn(userPrefComp.col_seq);
					bedrockComp.setSequence(userPrefComp.row_seq);
					bedrockComp.setPageGroupSequence(1);
					style = bedrockComp.getStyles();
                    compClassName = style.getClassName();
					if (userPrefComp.compThemeColor) {
						//If there is a userdefined color for QOC clear the organization defined color first.
                        style.setClassName(compClassName.replace(colorRegExp, ""));
                        //Add the userdefined color
						bedrockComp.setCompColor(userPrefComp.compThemeColor);
					}
					bedrockComp.setExpanded(userPrefComp.expanded);
					if (userPrefComp.preferencesObj) {
						bedrockComp.setPreferencesObj(userPrefComp.preferencesObj);
					}

				}
			}
			//if user preferences component does not exist in "bedrock" list, then it is a personal fav
			//component and a whole new component needs to be created
			if (isUserPrefPrsnlFavComp) {
				var component = new OrderSelectionComponent();
				component.setCriterion(criterion);
				component.setStyles(new OrderSelectionComponentStyle());
				component.setCustomizeView(false);
				component.setComponentId(userPrefComp.id);
				component.setReportId(userPrefComp.reportId);
				component.setFavFolderId(userPrefComp.reportId);
				component.setLabel(userPrefComp.label);
				component.setExpanded(userPrefComp.expanded);
				component.setColumn(userPrefComp.col_seq);
				component.setSequence(userPrefComp.row_seq);
				component.setPageGroupSequence(userPrefComp.group_seq);
				component.setDisplayEnabled(true);
				component.setPreferencesObj(userPrefComp.preferencesObj);
				if (isViewPoint) {
					component.setModalScratchPadEnabled(1);
				}
				var style = component.getStyles();
				style.setComponentId(userPrefComp.id);
				if (userPrefComp.compThemeColor) {
					component.setCompColor(userPrefComp.compThemeColor);
					style.setColor(userPrefComp.compThemeColor);
				}
				if (userPrefComp.lookbackunits) {
					component.setLookbackUnits(userPrefComp.lookbackunits);
				}
				if (userPrefComp.lookbacktypeflag) {
					component.setLookbackUnitTypeFlag(userPrefComp.lookbacktypeflag);
				}
				if (userPrefComp.grouperFilterLabel) {
					component.setGrouperFilterLabel(userPrefComp.grouperFilterLabel);
				}
				else {
					component.setGrouperFilterLabel("");
				}
				if (userPrefComp.grouperFilterCatLabel) {
					component.setGrouperFilterCatLabel(userPrefComp.grouperFilterCatLabel);
				}
				else {
					component.setGrouperFilterCatLabel("");
				}
				if (userPrefComp.grouperFilterCriteria) {
					component.setGrouperFilterCriteria(userPrefComp.grouperFilterCriteria);
				}
				else {
					component.setGrouperFilterCriteria(null);
				}

				if (userPrefComp.grouperFilterCatalogCodes) {
					component.setGrouperFilterCatalogCodes(userPrefComp.grouperFilterCatalogCodes);
				}
				else {
					component.setGrouperFilterCatalogCodes(null);
				}

				if (userPrefComp.selectedTimeFrame) {
					component.setSelectedTimeFrame(userPrefComp.selectedTimeFrame);
				}
				else {
					component.setSelectedTimeFrame(null);
				}
				if (userPrefComp.selectedDataGroup) {
					component.setSelectedDataGroup(userPrefComp.selectedDataGroup);
				}
				else {
					component.setSelectedDataGroup(null);
				}
				if (userPrefComp.preferencesObj) {
					bedrockComp.setPreferencesObj(userPrefComp.preferencesObj);
				}
				else {
					bedrockComp.setPreferencesObj(null);
				}


				//add comp id to "personal favorites" list
				if (CERN_PersonalFav === null) {
					CERN_PersonalFav = [];
				}
				CERN_PersonalFav.push(style.getId());
				//add component to updated "bedrock" list
				bedrockComponentArr.push(component);
			}
		}
		return bedrockComponentArr;
	}

	function SetupExpandCollapse() {
		var i18nCore = i18n.discernabu;
		//set up expand collapse for all components
		var toggleArray = Util.Style.g("sec-hd-tgl");
		for (var k = 0; k < toggleArray.length; k++) {
			Util.addEvent(toggleArray[k], "click", MP_Util.Doc.ExpandCollapse);
			var checkClosed = Util.gp(Util.gp(toggleArray[k]));
			if (Util.Style.ccss(checkClosed, "closed")) {
				toggleArray[k].innerHTML = "+";
				toggleArray[k].title = i18nCore.SHOW_SECTION;
			}
		}
	}

	function SetupCompFilters(compArray) {
		var compArrayLen = compArray.length;
		var hasFilters = false;
		for (var x = 0; x < compArrayLen; x++) {
			hasFilters = false;
			for (var y = 0; y < 10; y++) {
				if (compArray[x].getGrouperLabel(y) || compArray[x].getGrouperCatLabel(y)) {
					hasFilters = true;
					break;
				}
			}
			compArray[x].setCompFilters(hasFilters);
			if (compArray[x].hasCompFilters() && compArray[x].isDisplayable()) {
				compArray[x].renderAccordion(compArray[x]);
			}
		}
	}

	function CreateCompDiv(component, disableMenu) {
		var i18nCore = i18n.discernabu;
		var ar = [];
		var style = component.getStyles();
		var ns = style.getNameSpace();
		var compId = style.getId();
		var mnuCompId = component.getComponentId();
		var secClass = style.getClassName();
		var tabLink = component.getLink();
		var loc = component.getCriterion().static_content;
		var tglCode = (!component.isAlwaysExpanded()) ? ["<span class='", style.getHeaderToggle(), "' title='", i18nCore.HIDE_SECTION, "'>-</span>"].join("") : "";
		var menuHTML = "";
		var sDisplayName = "";
		var sSectionName = "";
		var sBandName = "";
		var sItemName = "";

		if (!component.isExpanded() && !component.isAlwaysExpanded())
			secClass += " closed";

		if (disableMenu) {
			if (component.getHasActionsMenu()) {
				menuHTML = ["<span class='opts-menu menu-hide' id='mainCompMenu", compId, "'>&nbsp;</span>"].join("");
			}
		}
		else {
			menuHTML = ["<span class='opts-menu menu-hide' id='mainCompMenu", compId, "'>&nbsp;</span>"].join("");
		}

		var sAnchor = (tabLink != "" && component.getCustomizeView() == false) ? CreateComponentAnchor(component) : component.getLabel();
		ar.push("<div id='", style.getId(), "' class='", secClass, "'>", "<h2 class='", style.getHeaderClass(), "'>", tglCode, menuHTML, "<span class='", style.getTitle(), "'><span>", sAnchor, "</span>");

		if (component.getCustomizeView() == false) {
			ar.push("<span class='", style.getTotal(), "'>", i18nCore.LOADING_DATA + "...", "</span></span>");
			if (component.isPlusAddEnabled()) {
				if (component.isIViewAdd() === false) {
					ar.push("<a id='", ns, "Add' class='add-plus' onclick='MP_Util.OpenIView(\"", compId, "\"); return false;' href='#'><span class='add-icon'>&nbsp;</span><span class='add-text'>", i18nCore.ADD, "</span></a>");
				}
				else {
					ar.push("<a id='", ns, "Add' class='add-plus' onclick='MP_Util.OpenTab(\"", compId, "\"); return false;' href='#'><span class='add-icon'>&nbsp;</span><span class='add-text'>", i18nCore.ADD, "</span></a>");
				}
				var menuItems = component.getMenuItems();
				var iViewItems = component.getIViewMenuItems();
				if (menuItems != null || menuItems > 0) {
					var menuId = compId + "Menu";
					ar.push("<a id='", ns, "Drop' class='drop-Down'><img src='", loc, "/images/3943_16.gif' onclick='javascript:MP_Util.LaunchMenu(\"", menuId, "\", \"", compId, "\");'></a>");
					ar.push("<div class='form-menu menu-hide' id='", menuId, "'><span>");
					for (var x = 0, xl = menuItems.length; x < xl; x++) {
						var item = menuItems[x];
						ar.push("<div>")
						ar.push("<a id='lnkID", x, "' href='#' onclick='javascript:MP_Util.LaunchMenuSelection(\"", compId, '\",', item.getId(), ");'>", item.getDescription(), "</a>")
						ar.push("</div>")
					}
					if (iViewItems) {
						ar.push("<hr class='opts-iview-sec-divider'></>");
						for (var x = 0, xl = iViewItems.length; x < xl; x++) {
							var item = iViewItems[x];
							//Check for value_type_flag of 1 to set band name
							var itemValTypeFlag = item.getValTypeFlag();
							if (itemValTypeFlag === 1) {
								sDisplayName = item.getDescription();
								sBandName = sDisplayName.toLowerCase();
								sDisplayName = sDisplayName.replace(/'/g, "");
								sSectionName = "";
								sItemName = "";
								//loop through again for match on value_seq
								for (var y = 0, yl = iViewItems.length; y < yl; y++) {
									var secItem = iViewItems[y];
									if (secItem.getValSequence() === item.getValSequence()) {
										//Check for value_type_flag of 2 to set section name
										if (secItem.getValTypeFlag() === 2) {
											sSectionName = secItem.getDescription();
											//Check for value_type_flag of 3 to set item name
										}
										else if (secItem.getValTypeFlag() === 3) {
											sItemName = secItem.getDescription();
										}
									}
								}
								ar.push("<div><a id='lnkID", x, "' href='#' onclick='MP_Util.LaunchIViewMenuSelection(\"", mnuCompId, '\",\"', sBandName, '\",\"', sSectionName, '\",\"', sItemName, "\");  return false;'>", sDisplayName, "</a></div>");
							}
						}
					}
					ar.push("</span></div>");
				}
				else if (iViewItems) {
					var menuId = compId + "Menu";
					ar.push("<a id='", ns, "Drop' class='drop-Down'><img src='", loc, "/images/3943_16.gif' onclick='javascript:MP_Util.LaunchMenu(\"", menuId, "\", \"", compId, "\");'></a>");
					ar.push("<div class='form-menu menu-hide' id='", menuId, "'><span>");
					for (var x = 0, xl = iViewItems.length; x < xl; x++) {
						var item = iViewItems[x];
						//Check for value_type_flag of 1 to set band name
						var itemValTypeFlag = item.getValTypeFlag();
						if (itemValTypeFlag === 1) {
							sDisplayName = item.getDescription();
							sBandName = sDisplayName.toLowerCase();
							sDisplayName = sDisplayName.replace(/'/g, "");
							sSectionName = "";
							sItemName = "";
							//loop through again for match on value_seq
							for (var y = 0, yl = iViewItems.length; y < yl; y++) {
								var secItem = iViewItems[y];
								if (secItem.getValSequence() === item.getValSequence()) {
									//Check for value_type_flag of 2 to set section name
									if (secItem.getValTypeFlag() === 2) {
										sSectionName = secItem.getDescription();
										//Check for value_type_flag of 3 to set item name
									}
									else if (secItem.getValTypeFlag() === 3) {
										sItemName = secItem.getDescription();
									}
								}
							}
							ar.push("<div><a id='lnkID", x, "' href='#' onclick='MP_Util.LaunchIViewMenuSelection(\"", mnuCompId, '\",\"', sBandName, '\",\"', sSectionName, '\",\"', sItemName, "\");  return false;'>", sDisplayName, "</a></div>");
						}
					}
					ar.push("</span></div>");
				}
			}
		}
		else {
			ar.push("</span>");
		}
		ar.push("</h2>")
		if (component.getCustomizeView() == false) {
			var scope = component.getScope();
			if (scope === 3) {//specifically to display a custom subheader
				ar.push(component.getScopeHTML());
			}
			else if (scope > 0) {
				var lbMenuItems = component.getLookbackMenuItems();
				if (lbMenuItems) {
					component.setLookBackDropDown(true);
				}
				else {
					component.setLookBackDropDown(false);
				}

				if (component.m_grouper_arr.length === 0) {
					component.setCompFilters(false);
				}
				else {
					component.setCompFilters(true);
				}

				ar.push(MP_Util.Doc.CreateLookBackMenu(component, 1, ""));
			}
		}
		ar.push("<div id='", style.getContentId(), "' class='", style.getContentClass(), "'></div>");
		var footerText = component.getFooterText();
		if (footerText && footerText !== "") {
			ar.push("<div class=sec-footer>", footerText, "</div>");
		}
		ar.push("</div>");
		var arHtml = ar.join("");
		return arHtml;
	}

	function CreateSubTitleText(component) {
		var i18nCore = i18n.discernabu;
		var subTitleText = "";
		var scope = component.getScope();
		var lookbackDays = component.getLookbackDays();
		var lookbackUnits = (lookbackDays > 0) ? lookbackDays : component.getLookbackUnits();
		var lookbackFlag = (lookbackDays > 0) ? 2 : component.getLookbackUnitTypeFlag();

		if (scope > 0) {
			if (lookbackFlag > 0 && lookbackUnits > 0) {
				var replaceText = "";
				switch(lookbackFlag) {
					case 1:
						replaceText = i18nCore.LAST_N_HOURS.replace("{0}", lookbackUnits);
						break;
					case 2:
						replaceText = i18nCore.LAST_N_DAYS.replace("{0}", lookbackUnits);
						break;
					case 3:
						replaceText = i18nCore.LAST_N_WEEKS.replace("{0}", lookbackUnits);
						break;
					case 4:
						replaceText = i18nCore.LAST_N_MONTHS.replace("{0}", lookbackUnits);
						break;
					case 5:
						replaceText = i18nCore.LAST_N_YEARS.replace("{0}", lookbackUnits);
						break;
				}

				switch(scope) {
					case 1:
						subTitleText = i18nCore.ALL_N_VISITS.replace("{0}", replaceText);
						break;
					case 2:
						subTitleText = i18nCore.SELECTED_N_VISIT.replace("{0}", replaceText);
						break;
				}

			}
			else {
				switch(scope) {
					case 1:
						subTitleText = i18nCore.All_VISITS;
						break;
					case 2:
						subTitleText = i18nCore.SELECTED_VISIT;
						break;
				}
			}
		}
		return subTitleText;
	}

	function CreateComponentAnchor(component) {
		var i18nCore = i18n.discernabu;
		var style = component.getStyles();
		var criterion = component.getCriterion();
		var sParms = 'javascript:APPLINK(0,"' + criterion.executable + '","/PERSONID=' + criterion.person_id + ' /ENCNTRID=' + criterion.encntr_id + ' /FIRSTTAB=^' + component.getLink() + '^"); return false;';
		var sAnchor = "<a id=" + style.getLink() + " title='" + i18nCore.GO_TO_TAB.replace("{0}", component.getLink()) + "' href='#' onclick='" + sParms + "'>" + component.getLabel() + "</a>";
		return sAnchor;
	}

	function LoadPageSelector(items, bodyTag, lastSavedView, criterion) {
		var i18nCore = i18n.discernabu;
		var activeInd;
		var ar = [];
		var divAr = [];
		var pageKey = "-1";
		var pageCtrl = _g('pageCtrl' + criterion.category_mean);
		var isViewpoint = ( typeof m_viewpointJSON == "undefined") ? false : true;
		var selectorClass = "qoc-view-selector";
		if (lastSavedView) {
			var lastSavedViewFound = false;
			var i = items.length;
			while (i--) {
				if (items[i].name == lastSavedView) {
					window.name = items[i].key + ",'a-tab'" + i;
					pageKey = items[i].key;
					lastSavedViewFound = true;
					break;
				}
			}

			if (lastSavedViewFound) {
				if (!isViewpoint) {
					selectorClass = selectorClass + " no-viewpoint";
				}
					ar.push("<span class='", selectorClass, "'><span class='qoc-view-list-label'>", i18nCore.VIEW_SELECTOR, ":</span><select id='viewListSelectorID' class='qoc-view-list' onchange=MP_Util.DisplaySelectedTabQOC(this.options[this.selectedIndex].value,'a-tab'+this.selectedIndex,false)>");
				for (var x = 0, xl = items.length; x < xl; x++) {
					var item = items[x];
					if (item.key == pageKey) {
						activeInd = 1;
					}
					else {
						activeInd = 0;
					}
					ar.push("<option value='", item.key, "'", (activeInd == 1) ? " selected='selected'" : "", ">", item.name, "</option>");
					divAr.push("<div id='", item.key, "' class='div-tab-item", (activeInd == 1) ? " div-tab-item-selected" : " div-tab-item-not-selected", "'></div>");
				}
				ar.push("</select></span>");

				pageCtrl.innerHTML = ar.join("") + pageCtrl.innerHTML;
				bodyTag.innerHTML += divAr.join("");
			}
			else {
				if(!isViewpoint){
					selectorClass = selectorClass + " no-viewpoint";
				}
				ar.push("<span id='noSavedViews' class='qoc-no-saved-view'>", i18nCore.VIEW_NOT_SELECTED, "</span>");
				ar.push("<span class='", selectorClass, "'><span class='qoc-view-list-label'>", i18nCore.VIEW_SELECTOR, ":</span><select id='viewListSelectorID' class='qoc-view-list' onchange=MP_Util.DisplaySelectedTabQOC(this.options[this.selectedIndex].value,'a-tab'+this.selectedIndex,true)>");
				for (var x = 0, xl = items.length; x < xl; x++) {
					var item = items[x];
					ar.push("<option value='", item.key, "'>", item.name, "</option>");
					divAr.push("<div id='", item.key, "' class='div-tab-item div-tab-item-not-selected'></div>");
				}
				ar.push("<option value='Blank_Space' selected='selected'></option>");
				divAr.push("<div id='Blank_Space' class='div-tab-item div-tab-item-selected'></div>");
				ar.push("</select></span>");

				pageCtrl.innerHTML = ar.join("") + pageCtrl.innerHTML;
				bodyTag.innerHTML += divAr.join("");
				window.name = "QOC_PAGE_TAB_" + items.length + ",'a-tab'" + items.length;
			}
		}
		else {
			if(!isViewpoint){
				selectorClass = selectorClass + " no-viewpoint";
			}
			ar.push("<span id='noSavedViews' class='qoc-no-saved-view'>", i18nCore.VIEW_NOT_SELECTED, "</span>");
			ar.push("<span class='", selectorClass, "'><span class='qoc-view-list-label'>", i18nCore.VIEW_SELECTOR, ":</span><select id='viewListSelectorID' class='qoc-view-list' onchange=MP_Util.DisplaySelectedTabQOC(this.options[this.selectedIndex].value,'a-tab'+this.selectedIndex,true)>");
			for (var x = 0, xl = items.length; x < xl; x++) {
				var item = items[x];
				ar.push("<option value='", item.key, "'>", item.name, "</option>");
				divAr.push("<div id='", item.key, "' class='div-tab-item div-tab-item-not-selected'></div>");
			}
			ar.push("<option value='Blank_Space' selected='selected'></option>");
			divAr.push("<div id='Blank_Space' class='div-tab-item div-tab-item-selected'></div>");
			ar.push("</select></span>");

			pageCtrl.innerHTML = ar.join("") + pageCtrl.innerHTML;
			bodyTag.innerHTML += divAr.join("");
			window.name = "QOC_PAGE_TAB_" + items.length + ",'a-tab'" + items.length;
		}
	}

	function AddPageTabs(items, bodyTag) {
		var ar = [];
		var divAr = [];
		if (bodyTag == null)
			bodyTag = document.body;
		//first create unordered list for page level tabs
		ar.push("<ul class=tabmenu>")
		for (var x = 0, xl = items.length; x < xl; x++) {
			var item = items[x];
			var activeInd = (x == 0) ? 1 : 0;
			ar.push(CreateTabLi(item, activeInd, x))
			divAr.push("<div id='", item.key, "' class='div-tab-item'></div>");
		}
		ar.push("</ul>")
		bodyTag.innerHTML += (ar.join("") + divAr.join(""));
	}

	function CreateTabLi(item, activeInd, sequence) {
		var ar = [];
		var tabName = "";
		tabName = item.name;
		ar.push("<li>")
		var seqClass = "a-tab" + sequence;
		if (activeInd)
			ar.push("<a id='", seqClass, "' class='anchor-tab-item active' href='#' onclick='javascript:MP_Util.DisplaySelectedTab(\"", item.key, "\",\"", seqClass, "\");return false;'>", tabName, "</a>");
		else
			ar.push("<a id='", seqClass, "' class='anchor-tab-item inactive' href='#' onclick='javascript:MP_Util.DisplaySelectedTab(\"", item.key, "\",\"", seqClass, "\");return false;'>", tabName, "</a>");
		ar.push("</li>")
		return (ar.join(""));
	}

}();

/**
 * @namespace
 */
MP_Util.Measurement = function() {
	var m_nf = null;
	return {
		GetString: function(result, codeArray, dateMask, excludeUOM) {
			var obj = ( result instanceof MP_Core.Measurement) ? result.getResult() : MP_Util.Measurement.GetObject(result, codeArray);
			if ( obj instanceof MP_Core.QuantityValue) {
				if (excludeUOM) {
					return obj.getValue();
				}
				return obj.toString();
			}
			else if ( obj instanceof Date) {
				return obj.format(dateMask);
			}
			return obj;
		},
		GetObject: function(result, codeArray) {
			switch (result.CLASSIFICATION.toUpperCase()) {
				case "QUANTITY_VALUE":
					return GetQuantityValue(result, codeArray);
				case "STRING_VALUE":
					return (GetStringValue(result));
				case "DATE_VALUE":
					//we are currently not returning any date_value results. a common method shall be implemented if/when necessary
					return (GetDateValue(result));
				case "CODIFIED_VALUES":
				case "CODE_VALUE":
					return (GetCodedResult(result));
				case "ENCAPSULATED_VALUE":
					return (GetEncapsulatedValue(result));
			}
		},
		/**
		 * @param {Object} num Numeric to format
		 * @param {Object} dec Number of decimal places to retain.
		 * @deprecated Use mp_formatter.NumericFormatter.
		 */
		SetPrecision: function(num, dec) {
			var nf = MP_Util.GetNumericFormatter();
			//'^' to not comma seperate values, and '.' for defining the precision
			return nf.format(num, "^." + dec);
		},
		GetModifiedIcon: function(result) {
			return (result.isModified()) ? "<span class='res-modified'>&nbsp;</span>" : "";
		},
		GetNormalcyClass: function(oMeasurement) {
			var normalcy = "res-normal";
			var nc = oMeasurement.getNormalcy()
			if (nc != null) {
				var normalcyMeaning = nc.meaning;
				if (normalcyMeaning != null) {
					if (normalcyMeaning === "LOW") {
						normalcy = "res-low";
					}
					else if (normalcyMeaning === "HIGH") {
						normalcy = "res-high";
					}
					else if (normalcyMeaning === "CRITICAL" || normalcyMeaning === "EXTREMEHIGH" || normalcyMeaning === "PANICHIGH" || normalcyMeaning === "EXTREMELOW" || normalcyMeaning === "PANICLOW" || normalcyMeaning === "VABNORMAL" || normalcyMeaning === "POSITIVE") {
						normalcy = "res-severe";
					}
					else if (normalcyMeaning === "ABNORMAL") {
						normalcy = "res-abnormal";
					}
				}
			}
			return normalcy;
		},
		GetNormalcyResultDisplay: function(oMeasurement, excludeUOM) {
			var ar = ["<span class='", MP_Util.Measurement.GetNormalcyClass(oMeasurement), "'><span class='res-ind'>&nbsp;</span><span class='res-value'>", GetEventViewerLink(oMeasurement, MP_Util.Measurement.GetString(oMeasurement, null, "longDateTime2", excludeUOM)), "</span>", MP_Util.Measurement.GetModifiedIcon(oMeasurement), "</span>"];
			return ar.join("");
		}
	};
	function GetEventViewerLink(oMeasurement, sResultDisplay) {
		var params = [oMeasurement.getPersonId(), oMeasurement.getEncntrId(), oMeasurement.getEventId(), "\"EVENT\""];
		var ar = ["<a onclick='MP_Util.LaunchClinNoteViewer(", params.join(","), "); return false;' href='#'>", sResultDisplay, "</a>"];
		return ar.join("");
	}

	function GetEncapsulatedValue(result) {
		var ar = [];
		var encap = result.ENCAPSULATED_VALUE;
		if (encap && encap.length > 0) {
			for (var n = 0, nl = encap.length; n < nl; n++) {
				var txt = encap[n].TEXT_PLAIN;
				if (txt != null && txt.length > 0)
					ar.push(txt);
			}
		}
		return ar.join("");
	}

	function GetQuantityValue(result, codeArray) {
		var qv = new MP_Core.QuantityValue();
		qv.init(result, codeArray);
		return qv;
	}

	function GetDateValue(result) {
		for (var x = 0, xl = result.DATE_VALUE.length; x < xl; x++) {
			var date = result.DATE_VALUE[x];
			if (date.DATE != "") {
				var dateTime = new Date();
				dateTime.setISO8601(date.DATE);
				return dateTime;
			}
		}
		return null;
	}

	function GetCodedResult(result) {
		var cdValue = result.CODE_VALUE;
		var ar = [];
		for (var n = 0, nl = cdValue.length; n < nl; n++) {
			var values = cdValue[n].VALUES;
			for (var p = 0, pl = values.length; p < pl; p++) {
				ar.push(values[p].SOURCE_STRING)
			}
			var sOther = cdValue[n].OTHER_RESPONSE;
			if (sOther != "")
				ar.push(sOther)
		}
		return ar.join(", ");
	}

	function GetStringValue(result) {
		var strValue = result.STRING_VALUE;
		var ar = [];
		for (var n = 0, nl = strValue.length; n < nl; n++) {
			ar.push(strValue[n].VALUE);
		}
		return ar.join(", ");
	}

}();
/**
 * Returns an array of elements with the designated classname.
 * @param {Object} cl The CSS classname.
 * @param {Object} e The parent element to search within, defaults to document.
 * @return {Array} Returns an array of elements with the designated classname.
 * @deprecated
 */
document.getElementsByClassName = function(cl, e) {
	var retnode = [];
	var clssnm = new RegExp('\\b' + cl + '\\b');
	var elem = this.getElementsByTagName('*', e);
	for (var u = 0; u < elem.length; u++) {
		var classes = elem[u].className;
		if (clssnm.test(classes)) {
			retnode.push(elem[u]);
		}
	}
	return retnode;
};

/* Listener Event Class */
/*
* Copyright (c) 2007 	Josh Davis ( http://joshdavis.wordpress.com )
*
* Licensed under the MIT License ( http://www.opensource.org/licenses/mit-license.php ) as follows:
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in
* all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
* THE SOFTWARE.
*
*/
/**
 * Binds a function to the given object's scope
 *
 * @param {Object} object The object to bind the function to.
 * @return {Function}	Returns the function bound to the object's scope.
 */
Function.prototype.bind = function(object) {
	var method = this;
	return function() {
		return method.apply(object, arguments);
	};
};

/**
 * Create a new instance of Event.
 *
 * @classDescription	This class creates a new Event.
 * @return {Object}	Returns a new Event object.
 * @constructor
 */
function EventListener() {
	this.events = [];
	this.builtinEvts = [];
}

/**
 * Gets the index of the given action for the element
 *
 * @memberOf Event
 * @param {Object} obj The element attached to the action.
 * @param {String} evt The name of the event.
 * @param {Function} action The action to execute upon the event firing.
 * @param {Object} binding The object to scope the action to.
 * @return {Number} Returns an integer.
 */
EventListener.prototype.getActionIdx = function(obj, evt, action, binding) {
	if (obj && evt) {

		var curel = this.events[obj][evt];
		if (curel) {
			var len = curel.length;
			for (var i = len - 1; i >= 0; i--) {
				if (curel[i].action == action && curel[i].binding == binding) {
					return i;
				}
			}
		}
		else {
			return -1;
		}
	}
	return -1;
};

/**
 * Adds a listener
 *
 * @memberOf Event
 * @param {Object} obj The element attached to the action.
 * @param {String} evt The name of the event.
 * @param {Function} action The action to execute upon the event firing.
 * @param {Object} binding The object to scope the action to.
 * @return {null} Returns null.
 */
EventListener.prototype.addListener = function(obj, evt, action, binding) {
	if (this.events[obj]) {
		if (this.events[obj][evt]) {
			if (this.getActionIdx(obj, evt, action, binding) == -1) {
				var curevt = this.events[obj][evt];
				curevt[curevt.length] = {
					action: action,
					binding: binding
				};
			}
		}
		else {
			this.events[obj][evt] = [];
			this.events[obj][evt][0] = {
				action: action,
				binding: binding
			};
		}
	}
	else {
		this.events[obj] = [];
		this.events[obj][evt] = [];
		this.events[obj][evt][0] = {
			action: action,
			binding: binding
		};
	}
};

/**
 * Removes a listener
 *
 * @memberOf Event
 * @param {Object} obj The element attached to the action.
 * @param {String} evt The name of the event.
 * @param {Function} action The action to execute upon the event firing.
 * @param {Object} binding The object to scope the action to.
 * @return {null} Returns null.
 */
EventListener.prototype.removeListener = function(obj, evt, action, binding) {
	if (this.events[obj]) {
		if (this.events[obj][evt]) {
			var idx = this.getActionIdx(obj, evt, action, binding);
			if (idx >= 0) {
				this.events[obj][evt].splice(idx, 1);
			}
		}
	}
};
/**
 * Removes all listeners for a given object with given binding
 *
 * @memberOf Event
 * @param {Object} obj The element attached to the action.
 * @param {Object} binding The object to scope the action to.
 * @return {null} Returns null.
 */
EventListener.prototype.removeAllListeners = function(obj, binding) {
	if (this.events[obj]) {
		for (var el = this.events[obj].length; el--; ) {
			if (this.events[obj][el]) {
				for (var ev = this.events[obj][el].length; ev--; ) {
					if (this.events[obj][el][ev].binding == binding) {
						this.events[obj][el].splice(ev, 1);
					}
				}
			}
		}
	}
};

/**
 * Fires an event
 *
 * @memberOf Event
 * @param e [(event)] A builtin event passthrough
 * @param {Object} obj The element attached to the action.
 * @param {String} evt The name of the event.
 * @param {Object} args The argument attached to the event.
 * @return {null} Returns null.
 */
EventListener.prototype.fireEvent = function(e, obj, evt, args) {
	if (!e) {
		e = window.event;
	}

	if (obj && this.events) {
		var evtel = this.events[obj];
		if (evtel) {
			var curel = evtel[evt];
			if (curel) {
				for (var act = curel.length; act--; ) {
					var action = curel[act].action;
					if (curel[act].binding) {
						action = action.bind(curel[act].binding);
					}
					action(e, args);
				}
			}
		}
	}
};
CERN_EventListener = new EventListener();

//Constants for event Listener
EventListener.EVENT_CLINICAL_EVENT = 1;
EventListener.EVENT_ORDER_ACTION = 2;
EventListener.EVENT_ADD_DOC = 3;
EventListener.EVENT_PREGNANCY_EVENT = 4;
EventListener.EVENT_COMP_CUSTOMIZE = 5;
EventListener.EVENT_COUNT_UPDATE = 6;
EventListener.EVENT_CRITICAL_UPDATE = 7;
EventListener.EVENT_ERROR_UPDATE = 8;
EventListener.EVENT_SCRATCHPAD_COUNT_UPDATE = 9;
EventListener.EVENT_SCRATCHPAD_UPDATES_COMPONENT = 10; 
if (typeof MPage == "undefined") {
    MPage = {
        _Components: [],
        Properties: {
            mine: "mine",
            personId: 0.0,
            encounter: 0.0,
            userId: 0.0,
            pprCd: 0.0,
            posCd: 0.0
        },
        Event: { //Not defined in the standard thus far, so not implemented
            registerEvent: function(event, listener, component){
                return null;
            },
            triggerEvent: function(event){
                return null;
            },
            removeEvent: function(event, listener){
                return null;
            }
        },
        namespace: function(name){
            var parts = name.split(".");
            var result = window;
            while (parts.length) {
                var part = parts.shift();
                result = result[part] = result[part] || {};
            }
            return result;
        },
		/**
		 *registerUnloadEvent function
		 * deprecated as of January 2013
		 */        
		registerUnloadEvent: function(){
			Util.addEvent(window,"beforeunload",MPage.fireUnload);
		},
		/**
		 *registerResizeEvent function
		 * deprecated as of January 2013
		 */
		registerResizeEvent: function(){
			Util.addEvent(window,"resize", MPage.fireResize);
		},
		/**
		 *fireResize function
		 *deprecated as of January 2013
		 */
        fireResize: function(){
            var tempComp;
            var x;
           
            for (x = MPage._Components.length; x--;) {
                tempComp = MPage._Components[x];
                compContainer = tempComp.getTarget();
                tempComp.resize($(compContainer).width(), $(compContainer).height());
            }
        },
		/**
		 *fireUnload function
		 *deprecated as of January 2013
		 */
        fireUnload: function(){
            var x;
            for (x = MPage._Components.length; x--;) {
                MPage._Components[x].unload();
            }
        },
        addCustomComp: function(compObj){
            MPage._Components.push(compObj);
        },
		getCustomComp: function(compId){
			var tempComp;
            var x;
			
			for (x = MPage._Components.length; x--;) {
            	tempComp = MPage._Components[x];
				if(tempComp.getOption('id') === compId) {
					return tempComp;
				}
            }
			return null;
		}
    };
}

MPage.Component = function(){
    this.baseclassSpecVersion = 1.1;
	this.componentMinimumSpecVersion = 1.0;
};

/* Initialize the component internal variables prior to loading data or rendering.  
 * The component should NOT attempt to render during the init() subroutine as the DOM element may not exist.
 */
MPage.Component.prototype.init = function(){
    //Leave empty so component developers can override if necessary
};

MPage.Component.prototype.refresh = function(){
	var parentComp = null;
	var target = null;
	//Clear the existing DOM (including the target element, header sub-titles, etc.)
	target = this.getTarget();
	if(target){
		$(target).html("");
	}

	//Get the parent component and refresh from the MPageComponent
	parentComp = this.getOption("parentComp");
	if(parentComp){
		CERN_CUSTOM_COMP_O1.ReloadCustomComp(parentComp, this);
	}
};

MPage.Component.prototype.generate = function(target, callback, options){
    var combined;
    var funcCallback;
    
	//Get the target if it is not already defined. (Should already be set)
    if (!target) {
        target = this.getTarget();
    }
    
	//Create a callback if not already defined.  (Should already be set)
    if (!callback) {
        funcCallback = function(component){
            component.render();
        };
    }
    else {
        funcCallback = function(component){
            component.render();
            callback(component);
        };
    }
    
	//If options are available, combine them with the existing options
    if (options) {
        combined = {};
        combined = this.options;
        for (attr in options) {
            combined[attr] = options[attr];
        }
        this.options = combined;
    }
    
	//Initialize the component
    this.init();
	//Load the data for the component
    this.loadData(funcCallback);
    return this;
};

MPage.Component.prototype.loadData = function(callback){
    //Prepare the callback for the loadCcl call
    var component = this;
    var funcCallback;
    funcCallback = function(response){
        component.data = response;
        callback(component);
    };
    
    //Check dataType
    if (this.cclDataType === "undefined") {
        this.cclDataType = "JSON";
    }
    
    //Call the cclProgram and run it with cclParams
    if (this.cclProgram && this.cclParams && (this.cclParams.length > 0)) {
        this.loadCCL(this.cclProgram, this.cclParams, funcCallback, this.cclDataType);
    }
    else {
        callback(component);
    }
};

MPage.Component.prototype.loadCCL = function(cclProgram, cclParams, callback, dataType){
    var that = this;
    var info = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
    var tempData = null;
    var paramString = "";
    var x;
	var paramStringArr = [];
    info.onreadystatechange = function(){
        if (this.readyState == 4 && this.status == 200) {
            try {
                MP_Util.LogScriptCallInfo(null, this, "mp_custom_component_core.js", "loadCCL");
                //Need to interpret the data here and set into this.data
                switch (dataType) {
                    case "XML":
						//MP_Util.WriteToFile(this.responseText);
                         if (window.ActiveXObject) {
							//for IE
							xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
							xmlDoc.async="false";
							xmlDoc.loadXML(this.responseText);
						}
						else if(document.implementation && document.implementation.createDocument) {
						//for Mozila
							parser=new DOMParser();
							xmlDoc=parser.parseFromString(this.responseText,"text/xml");
						}
						callback.call(that, xmlDoc);
                        break;
                    case "TEXT":
                        callback.call(that, this.responseText);
                        break;
                    case "JSON":
                    default:
                        callback.call(that, JSON.parse(this.responseText));
                        break;
                }
            } 
            catch (err) {
                MP_Util.LogJSError(err, null, "mp_custom_component_core.js", "loadCCL");
            }
        }
		else if(this.readyState == 4 && this.status != 200) {
                MP_Util.LogScriptCallError(null, this, "mp_custom_component_core.js", "loadCCL");
            }
        if (this.readyState == 4) {
            MP_Util.ReleaseRequestReference(this);
        }
    };
    
    //Ensure all strings are encapsulated in '', "", or ^^
	for( x = 0; x < cclParams.length; x++) {
        if (typeof cclParams[x] == "string") {
            if (!/^'.*'$/.test(cclParams[x]) && !/^".*"$/.test(cclParams[x]) && !/^\^.*\^$/.test(cclParams[x])) {
				paramStringArr.push("^" + cclParams[x] + "^");
            }
			else{
				paramStringArr.push(cclParams[x]);
        }
                }
		else if( typeof cclParams[x] == "number") {
				paramStringArr.push(cclParams[x] + ".0");
            }
    }
    
     if(CERN_BrowserDevInd){
		var url = cclProgram + "?parameters=" + paramStringArr.join(",");
		info.open("GET", url, true);
		info.send(null); 
    }	
    else{
	    info.open('GET', cclProgram, true);
		info.send(paramStringArr.join(","));
	}
};

/*default implementation of this which is only responsible for TEXT data*/
MPage.Component.prototype.render = function(){
    var target;
    if (typeof this.data === "string") {
        target = this.getTarget();
        target.innerHTML = this.data;
    }
};

MPage.Component.prototype.getOption = function(name){
    if (this.options && typeof this.options[name] != "undefined") {
        return this.options[name];
    }
    else {
        return "undefined";
    }
};


MPage.Component.prototype.setOption = function(name, value){
    if (!this.options) {
        this.options = {};
    }
    this.options[name] = value;
};

MPage.Component.prototype.getProperty = function(name){
    if (this.properties && typeof this.properties[name] != "undefined") {
        return this.properties[name];
    }
    else {
        return 'undefined';
    }
};


MPage.Component.prototype.setProperty = function(name, value){
    if (this.properties) {
        this.properties[name] = value;
    }
    else {
        this.properties = {};
        this.properties[name] = value;
    }
	
	//Take special action depending on the property
	if("headerTitle|headerSubTitle|headerShowHideState".indexOf(name)  >= 0){
		var parentComp = this.getOption('parentComp');
		switch(name){
			case "headerTitle":
				parentComp.updateLabel(value);
				break;
			case "headerSubTitle":
				parentComp.updateSubLabel(value);
				break;
			case "headerShowHideState":
				parentComp.setExpandCollapseState(value);
				break;
		}
	}
	
    return this;
};

MPage.Component.prototype.getTarget = function(){
    var target = undefined;
    if (this.options && this.options['target']) {
        target = this.options['target'];
    }
    return target;
};

MPage.Component.prototype.setTarget = function(target){
    if (this.options) {
        this.options['target'] = target;
    }
    else {
        this.options = {};
        this.options['target'] = target;
    }
};

MPage.Component.prototype.resize = function(width, height){
	return null;
};

MPage.Component.prototype.unload = function(){
    return null;
};

MPage.Component.prototype.getComponentUid = function(){
    return this.getOption('id');
};

MPage.Component.prototype.throwNewError = function(description, err){
    var error = err || new Error(description);
    MP_Util.LogError("Error occurred in a custom component: " + description);
    MP_Util.LogJSError(error, null, "mp_custom_component_core.js", "MPage.Component.prototype.throwNewError");
    throw (error);
};/**
 * @author JS026207
 */
var browserDevInd = null;
var MP_DASH_CORE = function () {

	function createDashboardLayout(mPage, parentNode) {
		var components = mPage.getComponents();
		MP_Util.addComponentsToGlobalStorage(components);

		createFilterSection(mPage, parentNode);
		createDashComponentSection(mPage, parentNode);
	}

	function createCarouselLayout(mPage, parentNode) {
		var components = mPage.getComponents();		
		MP_Util.addComponentsToGlobalStorage(components);
		
		createFilterSection(mPage, parentNode);
		createCarouselComponentSection(mPage, parentNode, components);
	}

	function createFerrisLayout(mPage, parentNode) {
		var components = mPage.getComponents();
		MP_Util.addComponentsToGlobalStorage(components);
		
		createFilterSection(mPage, parentNode);
        createFerrisComponentSection(mPage, parentNode, components);
	}
      
	function createFilterSection(mPage, parentNode) {
		var dashboardConfig = MP_Resources.getSharedResource("dashConfig") || {};
		var filterConfig = dashboardConfig.pageFilters || {};

		var filterRow = $("<div></div>").addClass('dash-filter-row').appendTo(parentNode);

		try {
			// This needs to be reversed so we only build if we have content to put in it.
			var fcLen = filterConfig.length;
			var filterContainer = null;
			for (var f1Idx = 0, filter1Lmt = fcLen; f1Idx < filter1Lmt; f1Idx++) {
				var filterLvl1Config = filterConfig[f1Idx];				
				var filterLabel = null;
				var filterField = null;
				if (filterLvl1Config.filterGroup) {
					var filterGroupConfig = filterLvl1Config.filterGroup || {};

					if (filterGroupConfig.visible) {
						var filterGroup = $("<div></div>").addClass('dash-filter-group').appendTo(filterRow);
						var filterGroupLabel = $("<div>" + filterGroupConfig.label + "</div>").addClass('dash-filter-group-label');
						filterGroupLabel.appendTo(filterGroup);

						var filterGroupFiltersConfig = filterGroupConfig.filters || [];
						for (var f2Idx = 0, filter2Lmt = filterGroupFiltersConfig.length; f2Idx < filter2Lmt; f2Idx++) {
							var filterLvl2Config = filterGroupFiltersConfig[f2Idx];
							if (filterLvl2Config.visible !== filterGroupConfig.visible) {
								var value = filterLvl2Config.value || filterLvl2Config.filterDef.defaultVal;
								var inputID = 'dash-filter-' + f1Idx + '-' + f2Idx;
								var filterDef = filterLvl2Config.filterDef;
								var filterType = filterDef.type;

								filterContainer = $("<div></div>").addClass('dash-filter-container').appendTo(filterGroup);
								filterLabel = $("<div>" + filterLvl2Config.label + "</div>").addClass('dash-filter-label');
								filterLabel.appendTo(filterContainer);

								switch (filterType) {
								case 'Select':
									var isParent = filterDef.isParent;
									var filterOptions = filterDef.options;
									filterField = $('<select id="' + inputID + '"></select>').addClass('dash-filter-control');
									filterField.appendTo(filterContainer);

									filterField.addClass(filterDef.name);
									//Add the options to the select element if provided.
									if (filterOptions) {
										$.each(filterOptions, function (id, display) {
											filterField.append($("<option></option>").attr("value", id).text(display));
										});
										filterField.val(value);
									} else {
										dashLoadSelectData(filterGroup, filterField, filterDef, value); //Run the select list data query
									}
									break;
								case 'CustomLocation':
									createCustomLocationControl(filterGroup, filterDef, value, filterContainer, inputID);
									break;
								case 'DatePicker':
									filterField = $('<input type="text" id="' + inputID + '">').addClass('dash-filter-control');
									filterField.appendTo(filterContainer);
									filterField.addClass(filterDef.name);
									var tmpDate;
									// If the config has a date set, use it, othewise use TODAY.
									if (value) {
										tmpDate = new Date(value);
									} else {
										tmpDate = new Date();
									}
									filterField.datepicker({
										showButtonPanel : true
									});
									filterField.datepicker("setDate", tmpDate);
									filterField.datepicker("option", {
										idx1 : f1Idx,
										idx2 : f2Idx
									});
									filterField.datepicker("option", "onSelect",
										function (dateText, inst) {
										var idx1 = inst.settings.idx1;
										var idx2 = inst.settings.idx2;
										dashConfig = MP_Resources.getSharedResource("dashConfig");
										dashConfig.pageFilters[idx1].filterGroup.filters[idx2].filterDef.defaultVal = dateText;
									});

									//TODO: Add Internationalization here
									//$.datepicker.setDefaults( $.datepicker.regional[ "fr" ] );

									break;
								}
							}
						}
					}
				} else {
					if (filterLvl1Config.visible) {
						filterContainer = $("<div></div>").addClass("dash-filter-container").appendTo(filterRow);
						filterLabel = $("<div>" + filterLvl1Config.label + "</div>").addClass("dash-filter-label").appendTo(filterContainer);
						filterField = $("<input type='text' id='" + filterLvl1Config.label + "'>").addClass("dash-filter-control");
						filterField.appendTo(filterContainer);
						filterField.val(filterLvl1Config.value);
					}
				}
			}

			if (fcLen) {
				filterContainer = $("<div></div>").appendTo(filterRow);
				var filterRefreshButton = $("<button id='refreshButton'>Refresh</button>").addClass("dash-filter-refresh-button");
				filterRefreshButton.appendTo(filterContainer);
				filterRefreshButton.button().click(function (event) {
					// TODO: This needs to have a more generic implimentation.
					getCustomLocationValues();
					$(".dash-target").empty();
                    $(".error-message").remove();
                    $(".chart-details-dialog").find("tr").remove();
					MP_Util.Doc.ReloadAllComponents(mPage);
				});
			}

		} catch (err) {
			var message = 'Failure occured loading Filters.';
			filterRow.html(message);
			MP_Util.LogError(message);
			MP_Util.LogJSError(err, null, "mp_core.js", "CreateDashFilterSection");
		}

		filterRow = $("<div></div>").addClass('dash-filter-divider').appendTo(parentNode);
	}

	function dashLoadSelectData(filterGroup, filterField, filterDef, value) {
		var codes = [];
		var requestObj = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
		requestObj.onreadystatechange = function () {
			if (this.readyState == 4 && this.status == 200) {
				MP_Util.LogScriptCallInfo(null, this, "mp_dash_core.js", filterDef.dataCall);
				var jsonEval = JSON.parse(this.responseText);
				if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
					codes = jsonEval.RECORD_DATA.VALUES;
					$.each(codes, function () {
						filterField.append($("<option></option>").attr("value", this.ID).text(this.DISPLAY));
					});
					filterField.val(value);
				}
			}
			if (this.readyState == 4) {
				MP_Util.ReleaseRequestReference(this);
			}
		};
		//  Call the ccl progam and send the parameter string
		var params = [];
		params.push(filterDef.dataCallParams);
		if (filterDef && filterDef.parentControl) {
			// Get the selected text of the parent Select element
			params.push($(filterGroup).find("." + filterDef.parentControl).val());
		}
		if (CERN_BrowserDevInd) {
			var url = filterDef.dataCall + "?parameters=" + params.join(',');
			requestObj.open('GET', url, false);
			requestObj.send(null);
		} else {
			requestObj.open('GET', filterDef.dataCall, false);
			requestObj.send(params.join(','));
		}
	}

    // Create an alpha sort
    function SortByName(a, b) {
        var aName = a.DISPLAY.toLowerCase();
        var bName = b.DISPLAY.toLowerCase();
        return ((aName < bName) ? -1 : ((aName > bName) ? 1 : 0));
    }
                    
	function dashLoadCustLocSelectData(filterField, filterDef, parentID, value, type, async) {
		var codes = [];
		var requestObj = (CERN_BrowserDevInd) ? new XMLHttpRequest() : new XMLCclRequest();
		requestObj.onreadystatechange = function () {
			if (this.readyState == 4 && this.status == 200) {
				// Empty the Select control
				$(filterField).find("option").remove();
				MP_Util.LogScriptCallInfo(null, this, "mp_dash_core.js", filterDef.dataCall);
				var jsonEval = JSON.parse(this.responseText);
				if (jsonEval.RECORD_DATA.STATUS_DATA.STATUS == "S") {
					codes = jsonEval.RECORD_DATA.VALUES;
										
					// Sort the items
					codes.sort(SortByName);
					// Load the items into the Select control
					$.each(codes, function () {
						filterField.append($("<option></option>").attr("value", this.ID).text(this.DISPLAY));
					});
					// Select the default value, if able.
					$(filterField).val(value);
					// Trigger the change event of the control.
					$(filterField).change();
				}
			}
			if (this.readyState == 4) {
				MP_Util.ReleaseRequestReference(this);
			}
		};
		//  Call the ccl progam and send the parameter string
		var params = [];
        params.push("^MINE^");
		params.push("0.0");
		params.push(type);
		params.push(parentID);
		if (CERN_BrowserDevInd) {
			var url = filterDef.dataCall + "?parameters=" + params.join(',');
			requestObj.open('GET', url, async);
			requestObj.send(null);
		} else {
			requestObj.open('GET', filterDef.dataCall, async);
			requestObj.send(params.join(','));
		}
	}

	function createCustomLocationControl(filterGroup, filterDef, value, filterContainer, inputID) {
		// Create hidden controls to hold the id and type
		var hiddenIDControl = $("<input></input>").attr("value", 0).addClass('dashHiddenID hidden').appendTo(filterContainer);
		var hiddenTypeControl = $("<input></input>").attr("value", "^FACILITY^").addClass('dashHiddenType hidden').appendTo(filterContainer);

		// Create the Facility mini-control
		var facilityContainer = $("<div></div>").addClass("dash-loc-ctrl-group").appendTo(filterContainer);
		var facilityAnchorControl = $("<a></a>").addClass('dash-loc-ctrl facilityControl hidden').click(function (event) {
			$(facilityAnchorControl).text($(".facilitySelectControl option:selected").text());
			$(facilityAnchorControl).addClass("hidden");
			$(facilitySelectControl).removeClass("hidden");
			$(areaAnchorControl).text("select area");
			$(areaAnchorControl).removeClass("hidden");
			$(areaSelectControl).addClass("hidden");
			$(roomContainer).addClass("hidden");
			$(roomAnchorControl).addClass("hidden");
			$(roomSelectControl).addClass("hidden");
		}).appendTo(facilityContainer);
		var facilitySelectControl = $("<select></select>").addClass('dash-loc-ctrl facilityControl facilitySelectControl');
			facilitySelectControl.change(function (event) {
				$(facilityAnchorControl).text($(this).text());
				$(areaSelectControl).find('option').remove().end().append('<option value="loading">Loading...</option>').val('loading');
				var filterDefaults = filterDef.defaultVals || [];
				dashLoadCustLocSelectData(areaSelectControl, filterDef, $(".facilitySelectControl").val(), filterDefaults[1], "^AREA^", true);
			}).appendTo(facilityContainer);

		// Create the Area mini control
		var areaContainer = $("<div></div>").addClass("dash-loc-ctrl-group").appendTo(filterContainer);
		var areaAnchorControl = $("<a></a>").addClass('dash-loc-ctrl areaControl').click(function (event) {
		    var selectedAreaID = $(".areaSelectControl").val();
			$(facilityAnchorControl).text($(".facilitySelectControl option:selected").text());
			$(facilityAnchorControl).removeClass("hidden");
			$(facilitySelectControl).addClass("hidden");
			$(roomAnchorControl).text("select room");
			$(areaAnchorControl).addClass("hidden");
			$(areaSelectControl).removeClass("hidden");
			$(roomContainer).removeClass("hidden");
			$(roomAnchorControl).removeClass("hidden");
			$(roomSelectControl).addClass("hidden");
		}).appendTo(areaContainer);
		var areaSelectControl = $("<select></select>").addClass('dash-loc-ctrl areaControl areaSelectControl hidden').change(function (event) {
				$(roomSelectControl).find('option').remove().end().append('<option value="loading">Loading...</option>').val('loading');
				var filterDefaults = filterDef.defaultVals || [];
				dashLoadCustLocSelectData(roomSelectControl, filterDef, $(".areaSelectControl").val(), filterDefaults[2], "^ROOM^", true);
				if ($(areaSelectControl).hasClass("hidden") === false) {
					$(areaAnchorControl).text($(this).text());
				}
			}).appendTo(areaContainer);
		$(areaAnchorControl).text("select area");

		// Create the Room mini control
		var roomContainer = $("<div></div>").addClass("dash-loc-ctrl-group hidden").appendTo(filterContainer);
		var roomAnchorControl = $("<a></a>").addClass('dash-loc-ctrl roomControl roomAnchorControl hidden').click(function (event) {
			$(areaAnchorControl).text($(".areaSelectControl option:selected").text());
			$(facilityAnchorControl).removeClass("hidden");
			$(facilitySelectControl).addClass("hidden");
			$(areaAnchorControl).removeClass("hidden");
			$(areaSelectControl).addClass("hidden");
			$(roomAnchorControl).addClass("hidden");
			$(roomSelectControl).removeClass("hidden");
		}).appendTo(roomContainer);
		var roomSelectControl = $("<select></select>").addClass('dash-loc-ctrl roomControl roomSelectControl hidden').appendTo(roomContainer);

		// On first load of the page, process defaults.
		// Load the Facility drop down.
		var filterDefaults = filterDef.defaultVals || [];
		dashLoadCustLocSelectData(facilitySelectControl, filterDef, 0, filterDefaults[0], "^FACILITY^", false);
		// Set the currently selected item into the hidden fields.
		var selectedFacilityID = $(".facilitySelectControl").val();
		// If the currently selected item in the drop down is the default value, go on to the Area control.
		if (selectedFacilityID == filterDefaults[0]) {
			// Load the Area drop down.
			dashLoadCustLocSelectData(areaSelectControl, filterDef, selectedFacilityID, filterDefaults[1], "^AREA^", false);
			// If the Area default value was set, continue setting the Area as the 'active' filter level.
			if (filterDefaults[1] !== "0") {
				$(facilityAnchorControl).text($(".facilitySelectControl option:selected").text());
				areaAnchorControl.trigger("click");
				// Set the currently selected item into the hidden fields.
				var selectedAreaID = $(".areaSelectControl").val();
				// If the currently selected item in the drop down is the default value, go on to the Room control.
				if (selectedAreaID == filterDefaults[1]) {
					// Load the Room drop down.
					dashLoadCustLocSelectData(roomSelectControl, filterDef, selectedAreaID, filterDefaults[2], "^ROOM^", false);
					// If the Room default value was set, continue setting the Room as the 'active' filter level.
					if (filterDefaults[2] !== "0") {
						$(areaAnchorControl).text($(".areaSelectControl option:selected").text());
						roomAnchorControl.trigger("click");
						// Set the currently selected item into the hidden fields.
						var selectedRoomID = $(".roomSelectControl").val();
					}
				}
			}
		}
		$("#refreshButton").trigger("click");
	}

	function getCustomLocationValues() {
		if ($(".roomSelectControl").hasClass("hidden") === false) {
			id = $(".roomSelectControl").val();
			type = "^ROOM^";
		} else if ($(".areaSelectControl").hasClass("hidden") === false) {
			id = $(".areaSelectControl").val();
			type = "^AREA^";
		} else {
			id = $(".facilitySelectControl").val();
			type = "^FACILITY^";
		}
		$(".dashHiddenID").val(id);
		$(".dashHiddenType").val(type);
	}

	function moveToFerrisPosition(comp, newPos, components, XRadius, YRadius, ferrisTrayCenterX, ferrisTrayCenterY) {
		var maxPos = components.length;
		var curPos = parseInt($(comp).attr("carouselPos"), 10);
		var compSizeModDefault = 0.40;
		var compSizeModifier;
		if (newPos <= 0) {
			newPos = maxPos + newPos;
		}
		while (curPos != newPos) {
			curPos--;

			if (curPos === 0) {
				curPos = maxPos;
			} else {
				curPos = newPos;
			}

			var angle = angleIncrement * Math.round(curPos - 1) - 1.65;
			var ferrisTrayPositionRelativeX = XRadius * Math.cos(angle);
			var ferrisTrayPositionRelativeY = YRadius * Math.sin(angle);
			var ferrisTrayPositionAbsoluteX = ferrisTrayCenterX + ferrisTrayPositionRelativeX;
            var ferrisTrayPositionAbsoluteY = ferrisTrayCenterY + ferrisTrayPositionRelativeY - YRadius;
            // TODO: ferrisTrayWidth isn't properly in scope here.    
			var diminishValue = 1 - (ferrisTrayPositionAbsoluteX / ferrisTrayWidth);
			var componentSizePercentage = compSizeModifier * diminishValue;
			var componentHeight = ferrisTrayHeight * componentSizePercentage;
			var componentWidth = componentHeight;
			var componentPositionOffsetX = componentWidth / 2;
			var componentPositionOffsetY = componentHeight / 2;

			$(comp).stop().animate({
				width : componentWidth,
				height : componentHeight,
				top : ferrisTrayPositionAbsoluteY,
				left : ferrisTrayPositionAbsoluteX - componentPositionOffsetX
				// Setting z-index here would be good.
				//,	'font-size' : diminishValue+'%'
			}, 800, function () {
				$(comp).css('opacity', diminishValue).css('postition', 'absolute').css('z-index', ferrisTrayPositionAbsoluteY);
			});
			$(comp).css('postition', 'absolute').css('z-index', -ferrisTrayPositionAbsoluteY);
		}
		$(comp).attr('carouselPos', curPos);
	}
    
	function moveToCarouselPosition(comp, newPos, components, XRadius, YRadius, DashboardCenterX, dashboardCenterY) {
		var maxPos = components.length;
		var curPos = parseInt($(comp).attr("carouselPos"), 10);
		var compSizeModDefault = 0.40;
		var compSizeModifier;
		if (newPos <= 0) {
			newPos = maxPos + newPos;
		}
		while (curPos != newPos) {
			curPos--;
			if (curPos === 1) {
				compSizeModifier = compSizeModDefault * 2;
			} else {
				compSizeModifier = compSizeModDefault;
			}

			if (curPos === 0) {
				curPos = maxPos;
			} else {
				curPos = newPos;
			}

			var angle = angleIncrement * Math.round(curPos - 1) - 1.65;
			var carouselPositionRelativeX = XRadius * Math.cos(angle);
			var carouselPositionRelativeY = YRadius * Math.sin(angle);
			var carouselPositionAbsoluteX = dashboardCenterX + carouselPositionRelativeX;
            var carouselPositionAbsoluteY = dashboardCenterY + carouselPositionRelativeY - YRadius;
            // TODO: dashboardWidth isn't properly in scope here.    
			var diminishValue = 1 - (carouselPositionAbsoluteX / dashboardWidth);
			var componentSizePercentage = compSizeModifier * diminishValue;
			var componentHeight = dashboardHeight * componentSizePercentage;
			var componentWidth = componentHeight;
			var componentPositionOffsetX = componentWidth / 2;
			var componentPositionOffsetY = componentHeight / 2;

			$(comp).stop().animate({
				width : componentWidth,
				height : componentHeight,
				top : carouselPositionAbsoluteY,
				left : carouselPositionAbsoluteX - componentPositionOffsetX
				// Setting z-index here would be good.
				//,	'font-size' : diminishValue+'%'
			}, 800, function () {
				$(comp).css('opacity', diminishValue).css('postition', 'absolute').css('z-index', carouselPositionAbsoluteY);
			});
			$(comp).css('postition', 'absolute').css('z-index', -carouselPositionAbsoluteY);
		}
		$(comp).attr('carouselPos', curPos);
	}

	function moveToSidebar(comp, components) {
		$(comp).stop().animate({
			top : 0,
			left : 0
		});
		$(comp).removeAttr('carouselPos').click(function () {
			$(comp).attr('carouselPos', -1);
			moveToCarouselPosition(this, 1, components);
		});
	}

	function createDashComponentSection(mPage, parentNode) {
		var dashboardConfig = MP_Resources.getSharedResource("dashConfig");
		var numColumns = "12";
		var numRows = "12";
		var components = mPage.getComponents();
		var parentHeight = $("body").height() - 25;
		var parentWidth = $("body").width();
		var sibsHeight = $('dash-filter-row').height();
		var defaultHeightPercent = (1 / numRows);
		var defaultWidthPercent = 1 / numColumns;
		var defaultHeight = Math.floor((parentHeight - sibsHeight) * defaultHeightPercent);
		var defaultWidth = Math.floor(parentWidth * defaultWidthPercent);

		var content = $("<div></div>").addClass("col-group dash-row").appendTo(parentNode);

		$(components).each(function () {
			var tmpComponent = $(this)[0];
			var style = tmpComponent.getStyles();
			style.m_className += " dash-sec";
			style.m_contentClass += " dash-sec-content";
			style.m_headerClass += " dash-sec-hd";
			style.m_secTitle += " dash-sec-title";

			var tmpWidth = defaultWidth * (tmpComponent.m_gridPosRight - tmpComponent.m_gridPosLeft + 1);
			var tmpHeight = defaultHeight * (tmpComponent.m_gridPosBottom - tmpComponent.m_gridPosTop + 1) - (numRows * 2);
			var tmpPosLeft = tmpComponent.m_gridPosLeft - 1;
			var tmpPosTop = tmpComponent.m_gridPosTop - 1;
			var dividerLineLength = 0.6;
			var dividerLineMarginLength = (1 - dividerLineLength) / 2;

			var component = $(MP_Util.Doc.CreateComponent(tmpComponent, null)).width(tmpWidth).height(tmpHeight);
            component.attr('gridPosRight', tmpComponent.m_gridPosRight).attr('gridPosLeft', tmpComponent.m_gridPosLeft);
            component.attr('gridPosTop', tmpComponent.m_gridPosTop).attr('gridPosBottom', tmpComponent.m_gridPosBottom);
			component.appendTo(content);

			$(component).stop().animate({
				left : (tmpPosLeft * defaultWidth),
				top : (tmpPosTop * defaultHeight)
			});
		});
        
        $(window).resize(function() {
            $(".section").each(function () {
                var parentHeight = $("body").height() - 25;
                var parentWidth = $("body").width();
                var sibsHeight = $('dash-filter-row').height();
                var defaultHeightPercent = (1 / numRows);
                var defaultWidthPercent = 1 / numColumns;
                var defaultHeight = Math.floor((parentHeight - sibsHeight) * defaultHeightPercent);
                var defaultWidth = Math.floor(parentWidth * defaultWidthPercent);
                var tmpWidth = defaultWidth * ($(this).attr("gridPosRight") - $(this).attr("gridPosLeft") + 1);
                var tmpHeight = defaultHeight * ($(this).attr("gridPosBottom") - $(this).attr("gridPosTop") + 1) - (numRows * 2);
                var tmpPosLeft = $(this).attr("gridPosLeft") - 1;
                var tmpPosTop = $(this).attr("gridPosTop") - 1;
                $(this).width(tmpWidth).height(tmpHeight);

                $(this).stop().animate({
                    left : (tmpPosLeft * defaultWidth),
                    top : (tmpPosTop * defaultHeight)
                });
            });
        });
	}

	function createCarouselComponentSection(mPage, parentNode, components) {
		$(parentNode).css('background', '#000');
		var row = $("<div></div>").addClass("col-group one-col dash-row").appendTo(parentNode);

		for (var idx = 0, lmt = components.length; idx < lmt; idx++) {
			var tmpComponent = components[idx];
			tmpComponent.setAlwaysExpanded(true);
			var style = tmpComponent.getStyles();
			style.m_className += " dash-sec dash-carousal-sec";
			style.m_contentClass += " dash-sec-content dash-carousal-sec-content";
			style.m_headerClass += " dash-sec-hd dash-carousal-sec-hd";
			style.m_secTitle += " dash-sec-title dash-carousal-sec-title";
			$(MP_Util.Doc.CreateComponent(tmpComponent, null)).attr('carouselPos', -1).appendTo(row);
		}

		numOfCharts = components.length;
		angleIncrement = (Math.PI * 2) / numOfCharts;
		dashboardWidth = $(parentNode).width();
		dashboardHeight = $(parentNode).innerHeight();
		dashboardCenterX = dashboardWidth * 0.5;
		dashboardCenterY = dashboardHeight * 0.5;
		carouselXRadius = dashboardCenterX * 0.5;
		carouselYRadius = dashboardCenterY * 0.5;
		chartCnt = 0;

		$('.section').each(function () {
			//$(this).css('dash-carousal-sec');
			chartCnt++;
			var tmpID = 'container' + chartCnt;

			moveToCarouselPosition(this, chartCnt, components, carouselXRadius, carouselYRadius, dashboardCenterX, dashboardCenterY);

			$(this).click(function () {
				//Make this recursive.
				var thisCaroPos = $(this).attr("carouselPos");
				if (thisCaroPos) {
					var caroPosInt = parseInt(thisCaroPos, 10);
					if (caroPosInt !== 1) {
						moveToCarouselPosition(this, 1, components, carouselXRadius, carouselYRadius, dashboardCenterX, dashboardCenterY);

						$(this).siblings().each(function () {
							var sibCaroPos = $(this).attr("carouselPos");
							if (sibCaroPos) {
								moveToCarouselPosition(this, parseInt(sibCaroPos, 10) - (thisCaroPos - 1), components, carouselXRadius,
								        carouselYRadius, dashboardCenterX, dashboardCenterY);
							}
						});
					} else {
						moveToSidebar(this, components);
					}
				} else {
					$(this).attr('carouselPos', -1);
				}
			});
		});
	}
	
	function createFerrisComponentSection(mPage, parentNode, components){
		// Create the tray to hold the Ferris Wheel of charts
		var ferrisSect = $("<div></div>").addClass("one-col dash-ferris-row dash-ferris-parent-sec").appendTo(parentNode);
            
        // Create a Pin button for sliding the tray in and out.
        //TODO: This needs to be styled better.
        var ferrisTrayPin = $("<button id='ferrisTrayPin'>F</button>").appendTo(parentNode).addClass("ferris-tray-pin");
        ferrisTrayPin.button().click(function (event) {
            ferrisSect.toggle("slide");
		});
                
        // Create the Dashboard Section.
		var dashboardSect = $("<div></div>").addClass("one-col dash-ferris-row dash-parent-sec").appendTo(parentNode);
            
        // Add the Components to the Ferriswheel Section
		for (var idx = 0, lmt = components.length; idx < lmt; idx++) {
			var tmpComponent = components[idx];
			tmpComponent.setAlwaysExpanded(true);
			var style = tmpComponent.getStyles();
			style.m_className += " dash-sec dash-ferris-sec";
			style.m_contentClass += " dash-sec-content dash-ferris-sec-content";
			style.m_headerClass += " dash-sec-hd dash-ferris-sec-hd";
			style.m_secTitle += " dash-sec-title dash-ferris-sec-title";
			var comp = $(MP_Util.Doc.CreateComponent(tmpComponent, null));
			comp.attr('carouselPos', idx).attr('widthMulti', tmpComponent.m_widthMultiplier).appendTo(ferrisSect);
		}
        
        
        $(".section").draggable({
            grid:[40,40]
        }).resizable();
        
        $( ".dash-ferris-row" ).sortable({
            connectWith: ".dash-ferris-row"
        });
        
        $( ".dash-parent-sec" ).sortable({
            over: function( event, ui ) {
                ui.item.removeClass("dash-ferris-sec");
                ui.item.addClass("dash-chart-sec");
                ui.item.unbind("click");
            }
        });
        
        $( ".dash-ferris-parent-sec" ).sortable({
            over: function( event, ui ) {
                ui.item.removeClass("dash-chart-sec");
                ui.item.addClass("dash-ferris-sec");
                ui.item.click(function () {
				$('.section').each(function () {
                    var thisCaroPos = $(this).attr("carouselPos");
                    if (thisCaroPos) {
                        var caroPosInt = parseInt(thisCaroPos, 10);
                        moveToFerrisPosition(this, caroPosInt-1, components, ferrisXRadius, ferrisYRadius, dashboardCenterX, dashboardCenterY);
                    }
                });
			});
          }
        });
        
		numOfCharts = components.length;
		angleIncrement = (Math.PI * 2) / numOfCharts;
		ferrisTrayWidth = $(ferrisSect).width();
		ferrisTrayHeight = $(ferrisSect).innerHeight();
		ferrisTrayCenterX = ferrisTrayWidth * 0.5;
		ferrisTrayCenterY = ferrisTrayHeight * 0.5;
		ferrisXRadius = ferrisTrayCenterX * 0.5;
		ferrisYRadius = ferrisTrayCenterY * 0.5;
		chartCnt = 0;

		$('.section').each(function () {
			chartCnt++;
			var tmpID = 'container' + chartCnt;

			moveToFerrisPosition(this, chartCnt, components, ferrisXRadius, ferrisYRadius, ferrisTrayCenterX, ferrisTrayCenterY);

			$(this).click(function () {
				$('.section').each(function () {
                    var thisCaroPos = $(this).attr("carouselPos");
                    if (thisCaroPos) {
                        var caroPosInt = parseInt(thisCaroPos, 10);
                        moveToFerrisPosition(this, caroPosInt-1, components, ferrisXRadius, ferrisYRadius, ferrisTrayCenterX, ferrisTrayCenterY);
                    }
                });
			});
		});
	} 
	
	return {
        /**
         *
         */
        InitDashboardLayout : function(mPage, helpFile, helpURL, categoryMeaning) {
            var i18nCore = i18n.discernabu;
            var criterion = mPage.getCriterion();
            browserDevInd = (parseInt(criterion.debug_ind, 10) & 0x01 === 1) ? true : false;
            var body = document.body;

            var mpComps = mPage.getComponents();
            var dashboardConfig = MP_Resources.getSharedResource("dashConfig");
            var layoutType = dashboardConfig.layoutType || "";

            switch (layoutType.toUpperCase()) {
            case "DASHBOARD":
                createDashboardLayout(mPage, body);
                break;
            case "CAROUSEL":
                createCarouselLayout(mPage, body);
                break;
            case "FERRISWHEEL":
                createFerrisLayout(mPage, body);
                break;
            default:
                createDashboardLayout(mPage, body);
            }

            //TODO: What of this needs to stay?
            MP_Util.Doc.AddCustomizeLink(criterion);
            MP_Util.Doc.CreatePageMenu(categoryMeaning, criterion.category_mean);
        },

        /**
         * Starting with the Component Filters collection, extract the Filters (regardless of visibility or editability),
         * and add to a new collection.
         * This new collection will allow for altering of the filter values for each individual Component, independent
         * of the main page, like when drilling down.
         * TODO: Params
         */
        CombineCmptAndPageFilters : function(cmptFilters, component) {
            var processedFilters = [];
            var processedFilter = {};
            var criterion = component.getCriterion();
            var dashConfig = MP_Resources.getSharedResource("dashConfig");
            var pageFilters = dashConfig.pageFilters || {};
            var lmt = cmptFilters.length;
            // For each filter
            for (var idx = 0;idx < lmt;idx++) {
                filter = cmptFilters[idx];
                var filterDefinition;
                // If it's a Filter Group, call this method recursively on that subgroup
                if (filter.filterGroup) {
                    var group = filter.filterGroup;
                    var groupFilters = group.filters;
                    var processedFilterGroup = {
                        id : group.id,
                        label : group.label,
                        visible : group.visible,
                        editable : group.editable
                    };
                    processedFilterGroup.filters = MP_DASH_CORE.CombineCmptAndPageFilters(groupFilters, component);
                    processedFilter = processedFilterGroup;
                } else {
                    filterDefinition = filter.filterDef || {};
                    // Set the Filter properties
                    var id = filter.id || filterDefinition.id || idx;
                    var label = filter.label || filterDefinition.label || "";
                    var type = filter.type || filterDefinition.type || "";
                    var visible = filter.visible || filterDefinition.visible || false;
                    var editable = filter.editable || filterDefinition.editable || false;
                    // Set the value to the default defined in the Filter or Filter Definition.
                    var value = filter.value || filterDefinition.defaultVal;
                    // Ignore non-parameter Filters
                    if (filterDefinition.nonParam) {
                        continue;
                    } else {
                        var predefinedType = filterDefinition.type;                    
                        switch (predefinedType){
                        // If the Filter is of Type Criterion, look up the value in the Criterion object.
                        case "Criterion" :
                            var predefinedProperty = filterDefinition.property;
                            if (typeof predefinedProperty === "string") {
                                if (filterDefinition.property.toUpperCase() == "PROVIDERID") {
                                   value = criterion.provider_id;
                                }
                            }
                            break;
                        // If the Filter is of Type DatePicker, pull the value from the control then add the timeStamp
                        case "DatePicker" :
                            value = $("." + filterDefinition.name).val();                        
                            if (value){
                                value = value + " " + filterDefinition.timeStamp;
                            }
                            break;
                        // Default behavior is to pull the value from the filter control or use the default if it is empty.
                        default :
                            value = $("." + filterDefinition.name).val() || value;
                        }
                        // Create the Filter Object
                        processedFilter = {
                            id : id,
                            label : label,
                            type : type,
                            visible : visible,
                            editable : editable,
                            value : value
                        };
                    }
                }
                processedFilters.push(processedFilter);
            }
            return processedFilters;
        },
        
        /**
         * 
         * @param {Object} filters
         */
        GetParamsFromFilters : function(filters) {
            var params = [];
            var idx = 0;
            var lmt = filters.length;
            for (;
                idx < lmt;
                idx++) {
                var filter = filters[idx];
                var filterVal = filter.value;
                // If it's a grouper, call again recursively
                if (filter.filters) {
                    params.push(MP_DASH_CORE.GetParamsFromFilters(filter.filters));
                } else {
                    if (filter.type == "DatePicker") {
                        var filterDate = new Date(filterVal);
                        filterVal = "^" + MP_Util.CreateDateParameter(filterDate) + "^";
                    }
                    params.push(filterVal);
                }
            }
            return params;
        }
    };
}
();
	
	/*
    http://www.JSON.org/json2.js
    2010-03-20

    Public Domain.

    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

    See http://www.JSON.org/js.html


    This code should be minified before deployment.
    See http://javascript.crockford.com/jsmin.html

    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
    NOT CONTROL.


    This file creates a global JSON object containing two methods: stringify
    and parse.

        JSON.stringify(value, replacer, space)
            value       any JavaScript value, usually an object or array.

            replacer    an optional parameter that determines how object
                        values are stringified for objects. It can be a
                        function or an array of strings.

            space       an optional parameter that specifies the indentation
                        of nested structures. If it is omitted, the text will
                        be packed without extra whitespace. If it is a number,
                        it will specify the number of spaces to indent at each
                        level. If it is a string (such as '\t' or '&nbsp;'),
                        it contains the characters used to indent at each level.

            This method produces a JSON text from a JavaScript value.

            When an object value is found, if the object contains a toJSON
            method, its toJSON method will be called and the result will be
            stringified. A toJSON method does not serialize: it returns the
            value represented by the name/value pair that should be serialized,
            or undefined if nothing should be serialized. The toJSON method
            will be passed the key associated with the value, and this will be
            bound to the value

            For example, this would serialize Dates as ISO strings.

                Date.prototype.toJSON = function (key) {
                    function f(n) {
                        // Format integers to have at least two digits.
                        return n < 10 ? '0' + n : n;
                    }

                    return this.getUTCFullYear()   + '-' +
                         f(this.getUTCMonth() + 1) + '-' +
                         f(this.getUTCDate())      + 'T' +
                         f(this.getUTCHours())     + ':' +
                         f(this.getUTCMinutes())   + ':' +
                         f(this.getUTCSeconds())   + 'Z';
                };

            You can provide an optional replacer method. It will be passed the
            key and value of each member, with this bound to the containing
            object. The value that is returned from your method will be
            serialized. If your method returns undefined, then the member will
            be excluded from the serialization.

            If the replacer parameter is an array of strings, then it will be
            used to select the members to be serialized. It filters the results
            such that only members with keys listed in the replacer array are
            stringified.

            Values that do not have JSON representations, such as undefined or
            functions, will not be serialized. Such values in objects will be
            dropped; in arrays they will be replaced with null. You can use
            a replacer function to replace those with JSON values.
            JSON.stringify(undefined) returns undefined.

            The optional space parameter produces a stringification of the
            value that is filled with line breaks and indentation to make it
            easier to read.

            If the space parameter is a non-empty string, then that string will
            be used for indentation. If the space parameter is a number, then
            the indentation will be that many spaces.

            Example:

            text = JSON.stringify(['e', {pluribus: 'unum'}]);
            // text is '["e",{"pluribus":"unum"}]'


            text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\t');
            // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

            text = JSON.stringify([new Date()], function (key, value) {
                return this[key] instanceof Date ?
                    'Date(' + this[key] + ')' : value;
            });
            // text is '["Date(---current time---)"]'


        JSON.parse(text, reviver)
            This method parses a JSON text to produce an object or array.
            It can throw a SyntaxError exception.

            The optional reviver parameter is a function that can filter and
            transform the results. It receives each of the keys and values,
            and its return value is used instead of the original value.
            If it returns what it received, then the structure is not modified.
            If it returns undefined then the member is deleted.

            Example:

            // Parse the text. Values that look like ISO date strings will
            // be converted to Date objects.

            myData = JSON.parse(text, function (key, value) {
                var a;
                if (typeof value === 'string') {
                    a =
/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
                    if (a) {
                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
                            +a[5], +a[6]));
                    }
                }
                return value;
            });

            myData = JSON.parse('["Date(09/09/2001)"]', function (key, value) {
                var d;
                if (typeof value === 'string' &&
                        value.slice(0, 5) === 'Date(' &&
                        value.slice(-1) === ')') {
                    d = new Date(value.slice(5, -1));
                    if (d) {
                        return d;
                    }
                }
                return value;
            });


    This is a reference implementation. You are free to copy, modify, or
    redistribute.
*/

/*jslint evil: true, strict: false */

/*members "", "\b", "\t", "\n", "\f", "\r", "\"", JSON, "\\", apply,
    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,
    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,
    lastIndex, length, parse, prototype, push, replace, slice, stringify,
    test, toJSON, toString, valueOf
*/


// Create a JSON object only if one does not already exist. We create the
// methods in a closure to avoid creating global variables.

if (!this.JSON) {
    this.JSON = {};
}

(function () {

    function f(n) {
        // Format integers to have at least two digits.
        return n < 10 ? '0' + n : n;
    }

    if (typeof Date.prototype.toJSON !== 'function') {

        Date.prototype.toJSON = function (key) {

            return isFinite(this.valueOf()) ?
                   this.getUTCFullYear()   + '-' +
                 f(this.getUTCMonth() + 1) + '-' +
                 f(this.getUTCDate())      + 'T' +
                 f(this.getUTCHours())     + ':' +
                 f(this.getUTCMinutes())   + ':' +
                 f(this.getUTCSeconds())   + 'Z' : null;
        };

        String.prototype.toJSON =
        Number.prototype.toJSON =
        Boolean.prototype.toJSON = function (key) {
            return this.valueOf();
        };
    }

    var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
        gap,
        indent,
        meta = {    // table of character substitutions
            '\b': '\\b',
            '\t': '\\t',
            '\n': '\\n',
            '\f': '\\f',
            '\r': '\\r',
            '"' : '\\"',
            '\\': '\\\\'
        },
        rep;


    function quote(string) {

// If the string contains no control characters, no quote characters, and no
// backslash characters, then we can safely slap some quotes around it.
// Otherwise we must also replace the offending characters with safe escape
// sequences.

        escapable.lastIndex = 0;
        return escapable.test(string) ?
            '"' + string.replace(escapable, function (a) {
                var c = meta[a];
                return typeof c === 'string' ? c :
                    '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
            }) + '"' :
            '"' + string + '"';
    }


    function str(key, holder) {

// Produce a string from holder[key].

        var i,          // The loop counter.
            k,          // The member key.
            v,          // The member value.
            length,
            mind = gap,
            partial,
            value = holder[key];

// If the value has a toJSON method, call it to obtain a replacement value.

        if (value && typeof value === 'object' &&
                typeof value.toJSON === 'function') {
            value = value.toJSON(key);
        }

// If we were called with a replacer function, then call the replacer to
// obtain a replacement value.

        if (typeof rep === 'function') {
            value = rep.call(holder, key, value);
        }

// What happens next depends on the value's type.

        switch (typeof value) {
        case 'string':
            return quote(value);

        case 'number':

// JSON numbers must be finite. Encode non-finite numbers as null.

            return isFinite(value) ? String(value) : 'null';

        case 'boolean':
        case 'null':

// If the value is a boolean or null, convert it to a string. Note:
// typeof null does not produce 'null'. The case is included here in
// the remote chance that this gets fixed someday.

            return String(value);

// If the type is 'object', we might be dealing with an object or an array or
// null.

        case 'object':

// Due to a specification blunder in ECMAScript, typeof null is 'object',
// so watch out for that case.

            if (!value) {
                return 'null';
            }

// Make an array to hold the partial results of stringifying this object value.

            gap += indent;
            partial = [];

// Is the value an array?

            if (Object.prototype.toString.apply(value) === '[object Array]') {

// The value is an array. Stringify every element. Use null as a placeholder
// for non-JSON values.

                length = value.length;
                for (i = 0; i < length; i += 1) {
                    partial[i] = str(i, value) || 'null';
                }

// Join all of the elements together, separated with commas, and wrap them in
// brackets.

                v = partial.length === 0 ? '[]' :
                    gap ? '[\n' + gap +
                            partial.join(',\n' + gap) + '\n' +
                                mind + ']' :
                          '[' + partial.join(',') + ']';
                gap = mind;
                return v;
            }

// If the replacer is an array, use it to select the members to be stringified.

            if (rep && typeof rep === 'object') {
                length = rep.length;
                for (i = 0; i < length; i += 1) {
                    k = rep[i];
                    if (typeof k === 'string') {
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            } else {

// Otherwise, iterate through all of the keys in the object.

                for (k in value) {
                    if (Object.hasOwnProperty.call(value, k)) {
                        v = str(k, value);
                        if (v) {
                            partial.push(quote(k) + (gap ? ': ' : ':') + v);
                        }
                    }
                }
            }

// Join all of the member texts together, separated with commas,
// and wrap them in braces.

            v = partial.length === 0 ? '{}' :
                gap ? '{\n' + gap + partial.join(',\n' + gap) + '\n' +
                        mind + '}' : '{' + partial.join(',') + '}';
            gap = mind;
            return v;
        }
    }

// If the JSON object does not yet have a stringify method, give it one.

    if (typeof JSON.stringify !== 'function') {
        JSON.stringify = function (value, replacer, space) {

// The stringify method takes a value and an optional replacer, and an optional
// space parameter, and returns a JSON text. The replacer can be a function
// that can replace values, or an array of strings that will select the keys.
// A default replacer method can be provided. Use of the space parameter can
// produce text that is more easily readable.

            var i;
            gap = '';
            indent = '';

// If the space parameter is a number, make an indent string containing that
// many spaces.

            if (typeof space === 'number') {
                for (i = 0; i < space; i += 1) {
                    indent += ' ';
                }

// If the space parameter is a string, it will be used as the indent string.

            } else if (typeof space === 'string') {
                indent = space;
            }

// If there is a replacer, it must be a function or an array.
// Otherwise, throw an error.

            rep = replacer;
            if (replacer && typeof replacer !== 'function' &&
                    (typeof replacer !== 'object' ||
                     typeof replacer.length !== 'number')) {
                throw new Error('JSON.stringify');
            }

// Make a fake root object containing our value under the key of ''.
// Return the result of stringifying the value.

            return str('', {'': value});
        };
    }


// If the JSON object does not yet have a parse method, give it one.

    if (typeof JSON.parse !== 'function') {
        JSON.parse = function (text, reviver) {

// The parse method takes a text and an optional reviver function, and returns
// a JavaScript value if the text is a valid JSON text.

            var j;

            function walk(holder, key) {

// The walk method is used to recursively walk the resulting structure so
// that modifications can be made.

                var k, v, value = holder[key];
                if (value && typeof value === 'object') {
                    for (k in value) {
                        if (Object.hasOwnProperty.call(value, k)) {
                            v = walk(value, k);
                            if (v !== undefined) {
                                value[k] = v;
                            } else {
                                delete value[k];
                            }
                        }
                    }
                }
                return reviver.call(holder, key, value);
            }


// Parsing happens in four stages. In the first stage, we replace certain
// Unicode characters with escape sequences. JavaScript handles many characters
// incorrectly, either silently deleting them, or treating them as line endings.

            text = String(text);
            cx.lastIndex = 0;
            if (cx.test(text)) {
                text = text.replace(cx, function (a) {
                    return '\\u' +
                        ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
                });
            }

// In the second stage, we run the text against regular expressions that look
// for non-JSON patterns. We are especially concerned with '()' and 'new'
// because they can cause invocation, and '=' because it can cause mutation.
// But just to be safe, we want to reject all unexpected forms.

// We split the second stage into 4 regexp operations in order to work around
// crippling inefficiencies in IE's and Safari's regexp engines. First we
// replace the JSON backslash pairs with '@' (a non-JSON character). Second, we
// replace all simple value tokens with ']' characters. Third, we delete all
// open brackets that follow a colon or comma or that begin the text. Finally,
// we look to see that the remaining characters are only whitespace or ']' or
// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.

            if (/^[\],:{}\s]*$/.
test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').
replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').
replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

// In the third stage we use the eval function to compile the text into a
// JavaScript structure. The '{' operator is subject to a syntactic ambiguity
// in JavaScript: it can begin a block or an object literal. We wrap the text
// in parens to eliminate the ambiguity.

                j = eval('(' + text + ')');

// In the optional fourth stage, we recursively walk the new structure, passing
// each name/value pair to a reviver function for possible transformation.

                return typeof reviver === 'function' ?
                    walk({'': j}, '') : j;
            }

// If the text is not JSON parseable, then a SyntaxError is thrown.

            throw new SyntaxError('JSON.parse');
        };
    }
}());
/*
 * mp_shared_resources.js
 * @author Steven Lewis
 * 
 * A collection of functions and objects used to manage shared resources between multiple MPages and Components.
 */

/**
 * Creates an instance of SharedResource object
 * @constructor
 * @this {SharedResource}
 * @param {String} resourceName The desired name of this instance of SharedResource.  Will be used to reference this SharedResource object.
 */
function SharedResource(resourceName) {
	/** @private */ var name = resourceName;
	/** @private */ var cclProgram = null;
	/** @private */ var cclParams = [];
	/** @private */ var isAvailable = false;
	/** @private */ var isBeingRetrieved = false;
	/** @private */ var resourceData = null;
	/** @private */ var eventListenerFlag = null;
	/** @private */ var eventListenerObject = null;

	/**
	 * Get the name of the SharedResource
	 * @return {String} The name of the SharedResource
	 */
	this.getName = function(){
		return name;
	};
	
	/**
	 * Set the name of the SharedResource
	 * @param {String} resourceName The name to be given to the SharedResource
	 */
	this.setName = function(resourceName){
		name = resourceName;
	};
	
	/**
	 * Get the ccl program of the SharedResource
	 * @return {String} The name of the ccl program which retrieves the data for this SharedResouce
	 */
	this.getCclProgram = function(){
		return cclProgram;
	};
	
	/**
	 * Set the ccl program of the SharedResource
	 * @param {string} cclProgram The name of the ccl program used to retrieve the data for the SharedResource 
	 */
	this.setCclProgram = function(cclProgramName){
		cclProgram = cclProgramName;
	};
	
	/**
	 * Get the ccl parameters for the script used to retrieve the data for the SharedResource
	 * @return {Array} The parameter array used when call the cclProgram
	 */
	this.getCclParams = function(){
		return cclParams;
	};
	
	/**
	 * Set the ccl parameters for the script used to retrieve the data for the SharedResource
	 * @param {Array} paramArray An array of mixed type parameters which will be sent to the cclProgram
	 */
	this.setCclParams = function(paramArray){
		cclParams = paramArray;
	};
	
	/**
	 * Get the isAvailable indicator of the SharedResource
	 * @return {Boolean} A boolean which tells if the shared resource is available or not
	 */
	this.isResourceAvailable = function(){
		return isAvailable;
	};
	
	/**
	 * Set the isAvailable indicator of the SharedResource
	 * @param {Boolean} isAvailableInd An indicator which tells if the shared resource data is available for consumption
	 */
	this.setIsAvailable = function(isAvailableInd){
		isAvailable = (isAvailableInd)? true : false;
	};
	
	/**
	 * Get the isBeingRetrieved indicator of the SharedResource
	 * @return {Boolean} A boolean indicating whether the shared resource is currently being retrieved
	 */
	this.isBeingRetrieved = function(){
		return isBeingRetrieved;
	};
	
	/**
	 * Set the isBeingRetrieved indicator of the SharedResource
	 * @param {Boolean} retrieving An indicator which tells if the shared resource is currently being retrieved
	 */
	this.setIsBeingRetrieved = function(retrieving){
		isBeingRetrieved = (retrieving)? true : false;
	};
	
	/**
	 * Get the  of the SharedResource
	 * @return {Object} An object which is the actual shared resource.  The type of object is dependent upon what set the resourceData element and should be 
	 * known to all consumers of that particular SharedResource.
	 */
	this.getResourceData = function(){
		return resourceData;
	};
	
	/**
	 * Set the resourceData of the SharedResource
	 * @param {Object} data The data object which is the resource being shared.
	 */
	this.setResourceData = function(data){
		resourceData = data;
	};
	
	/**
	 * Get the eventListenerFlag of the SharedResource
	 * @return {Number} An integer which represents the type of event to fire when the shared resource data is available.
	 */
	this.getEventListenerFlag = function(){
		return eventListenerFlag;
	};
	
	/**
	 * Set the eventListenerFlag of the SharedResource
	 * @param {Number} event An integer which represents the type of event to fire when the shared resource data is available.
	 */
	this.setEventListenerFlag = function(event){
		eventListenerFlag = event;
	};
	
	/**
	 * Get the eventListenerObject of the SharedResource
	 * @return {Object} An integer which represents the type of event to fire when the shared resource data is available.
	 */
	this.getEventListenerObject = function(){
		return eventListenerObject;
	};
	
	/**
	 * Set the eventListenerObject of the SharedResource
	 * @param {Object} object An integer which represents the type of event to fire when the shared resource data is available.
	 */
	this.setEventListenerObject = function(object){
		eventListenerObject = object;
	};	
	
}

/* Additional helper functions */

/**
 * Fire the event associated to this SharedResource to notify all of the consumers that the data is available.
 * @return {Boolean} An indicator telling if the event was fired successfully
 */
SharedResource.prototype.notifyResourceConsumers = function(){
	try{
		//Get the parameters to fire the event
		var eventFlag = this.getEventListenerFlag();
		var eventObj = this.getEventListenerObject();
		var resourceData = this.getResourceData();

		//Fire the event based on the eventListenerObject and eventListenerFlag
		CERN_EventListener.fireEvent(null, eventObj, eventFlag, resourceData);
		//Log debugging data
		if (log.isBlackBirdActive()) {
			MP_Util.LogInfo("Firing Shared Resource Event<br />"+
							"Resource Name: " + this.getName() + "<br />"+
							"Resource Data: " + JSON.stringify(resourceData) + "<br />");
		};
		return true;
	}	
	catch(err){
		//Log error information and return
		MP_Util.LogJSError(err, null, "mp_shared_resources.js", "notifyResourceConsumers");
		return false;
	}
};

/**
 * Retrieves the shared resource data from the script specified in the SharedResource and notifies consumers when the data is available.
 */
SharedResource.prototype.retrieveSharedResourceData = function(){
	try{
		//If the resource is already being retrieved just return.
		if(this.isBeingRetrieved()){
			return;
		}
		
		//Set the isBeingRetrieved flag
		this.setIsBeingRetrieved(true);
		
		//Get the parameter needed to make the script call
		var cclProgram = this.getCclProgram();
		var cclParamArray = this.getCclParams();
		var info = (CERN_BrowserDevInd)? new XMLHttpRequest() : new XMLCclRequest();
		var sharedResource = this;
		var url = "";
		
		info.onreadystatechange = function() {
			if (info.readyState == 4 && info.status == 200) {
				MP_Util.LogScriptCallInfo(null, this, "mp_shared_resources.js", "retrieveSharedResource");
				sharedResource.setResourceData(info.responseText);
				sharedResource.setIsAvailable(true);
				sharedResource.setIsBeingRetrieved(false);
				sharedResource.notifyResourceConsumers();
			}
		};
		
		if(CERN_BrowserDevInd){
			url = cclProgram + "?parameters=" + cclParamArray.join(",");
			info.open("GET", url, true);
			info.send(null);
		}else{
			info.open("GET", cclProgram, true);
			info.send(cclParamArray.join(","));
		}
	}
	catch(err){
		this.setIsBeingRetrieved(false);
		MP_Util.LogJSError(err, null, "mp_shared_resources.js", "retrieveSharedResource");
	}
	finally{
		return;
	}
};

/**
 * A global object that contains all of the shared resources for MPages.  Also contains helper functions that can be used when dealing with SharedResource Objects.  
 * @namespace
 */
var MP_Resources = function(){
	/** @private */ var sharedResources = {};
	
	return{
		/**
		 * Retrieves the SharedResource object if it is available.
		 * @param {String} resourceName The name of the SharedResource to retrieve
		 * @returns {SharedResource} If the shared resource is available it will be returned, otherwise null.
		 */
		getSharedResource: function(resourceName){
			return (sharedResources[resourceName]) ? sharedResources[resourceName] : null;
		},
		/**
		 * Sets the data currently stored in the SharedResource.  There are no checks on the resourceData parameter other than  a check for 'undefined'
		 * @param {String} resourceName The name of the SharedResource to update
		 * @param {Object} resourceData The data object to update into the SharedResource object.
		 * @return {Boolean} True if the SharedResource was updated successfully, false otherwise.
		 */
		setSharedResourceData: function(resourceName, resourceData){
			var resource = null;
			
			//Make sure the data passed in isn't undefined.  Undefined is the only unacceptable data.
			if(typeof resourceData == "undefined"){
				MP_Util.LogInfo("SharedResource update data is undefined.  " + resourceName + "  will not be updated.");
				return false;
			}
			
			//Retrieve and update the resource if it is available and not being retrieved.
			resource = MP_Resources.getSharedResource(resourceName);
			if(resource){
				if(!resource.isBeingRetrieved()){
					resource.setResourceData(resourceData);
					return true;
				}
				else{
					MP_Util.LogInfo("SharedResource " + resourceName + " is currently being retrieved and cannot be updated.");
					return false;
				}
			}
			else{
				MP_Util.LogInfo("SharedResource " + resourceName + " does not currently exist");
				return false;
			}
		},
		/**
		 * Add a shared resource to the available resources if it hadnt already been added.  If wanting to update a SharedResource object use the 
		 * MP_Resources.setSharedResourceData() function.
		 * @param {String} resourceName The name of the SharedResource to to add
		 * @param {SharedResource} sharedResourceObj The SharedResource object to store for future use
		 * @return {Boolean} True if the resource was added, false otherwise.
		 */
		addSharedResource: function(resourceName, sharedResourceObj){
			if(!sharedResources[resourceName]){
				sharedResources[resourceName] = sharedResourceObj;
				return true;
			}
			else{
				//Log an error because we are trying to overwrite an existing shared resource
				MP_Util.LogError("Attempting to overwrite an existing shared resource: " + resourceName);
				return false;
			}
		},
		/**
		 * Creates a new SharedResource object for use by components and mpages and adds it to the collection
		 * @param {String} resourceName The name to give to the SharedResource
		 * @param {Object} consumerObj The object which is creating the SharedResource.  This is used when notifying resource consumers which have to have the same Object definition.
		 * @param {String} cclProgram The name of the script used to retrieve the shared resource data
		 * @param {Array} cclParams An array of parameters to send to the cclProgram script
		 * @param {Number} notifyEventFlag The Event flag to fire when the data is available for consumers 
		 */
		createSharedResourceObj: function(resourceName, consumerObj, cclProgram, cclParams, notifyEventFlag){
			
			//If no shared resource name is given there will be no way to reference it later on.
			if(!resourceName){
				MP_Util.LogError("Cannot create a SharedResource object without a name.");
				return null;
			}
			
			//Create the object with the parameters passed in.  Null parameters are acceptable because not all fields of the Shared Resource are required.
			var sharedResource = new SharedResource(resourceName);
			sharedResource.setEventListenerObject(consumerObj);
			sharedResource.setEventListenerFlag(notifyEventFlag);
			sharedResource.setCclProgram(cclProgram);
			sharedResource.setCclParams(cclParams);
			
			//Add the SharedResource object to the collection
			sharedResources[resourceName] = sharedResource;
			
			return sharedResource;
		}
	};
}();
if (/MSIE (\d+\.\d+);/.test(navigator.userAgent)){ //test for MSIE x.x;
    var ieVersion=new Number(RegExp.$1); // capture x.x portion and store as a number
}
else {
    var ieVersion=0;
}

/**
 * Create a new instance of an MPageView or WorkflowView object based on a category mean.
 * @param {String} mPageCategoryMean The category mean of the MPageView to initialize
 * @return {MPageView|WorkfowView} An object which is either an MPageView/WorkflowView object or an extension of that.
 */
function createViewObject(categoryMean, layoutType) {
    var viewObj;

    try{
        if (!categoryMean || typeof categoryMean != "string") {
            MP_Util.LogError("categoryMean parameter must be a string and not null");
            return null;
        }
        if (/^MP_DASH_.*/.test(categoryMean)) {
            return new DashboardMPage();
        } else {
            MP_Util.LogError("Invalid categoryMean parameter.  Must be in the form MP_DASH_*");
            return null;
        }
        viewObj.setCategoryMean(categoryMean);
        return viewObj;
    }
    catch(err){
        if(err.type == "not_defined"){
            MP_Util.LogError("No object type defined for " + categoryMean + ": " + err.message);
        }
        else{
            MP_Util.LogJSError(err, null, "mpage-driver.js", "createViewObject");
        }
        return null;
    }
}

/**
 * A function which loads MPages generically regardless of the page construct.  This function calls standard functions which are implemented
 * in the MPageView base object, but can be overwritten by an object which uses the MPageView prototype.
 * @param {String} mPageCategoryMean The category mean of the MPageView to render
 * @return {MPageView} An object which is either an MPageView object or an extension of that.
 */
function renderMPagesView(mPageCategoryMean) {
    var newMPage = null;
    newMPage = createViewObject(mPageCategoryMean);
    if(MPageView.prototype.isPrototypeOf(newMPage)){
        newMPage.initializeMPageView();
        newMPage.loadPageSettings();
        newMPage.initializeComponents();
        newMPage.renderMPage();
        newMPage.postProcessing();
        return newMPage;
    }
    return null;
}

function createPageCriterion(categoryMean) {
    var js_criterion = JSON.parse(m_criterionJSON);
    var criterion = MP_Util.GetCriterion(js_criterion, CERN_static_content);
    criterion.category_mean = categoryMean;
    return criterion;
}
/**
 * The Component Table class
 * @author Will Reynolds
 * @constructor
 */
function ComponentTable() {
    this.activeRows = null;
    this.columns = null;
    this.columnMap = null;
    this.currentlySortedBy = null;
    this.currentlySortedColumn = null;
    this.customClass = "";
    this.extensions = null;
    this.groupedBy = "";
    this.groupMap = null;
    this.groupSequence = null;
    this.groupTemplate = null;
    this.headerEnabled = true;
    this.namespace = "";
    this.rows = null;
    this.rowMap = null;
    this.sequence = null;
    this.showGroupCount = false;
    this.sortable = false;
    this.zebraStripe = true;
}

/**
 * Get the active rows from the table (i.e. the rows that qualify for all filters applied to the table)
 * @return {Array} the active rows in the table
 */
ComponentTable.prototype.getActiveRows = function () {
    if (!this.activeRows) {
        this.activeRows = [];
    }
    return  this.activeRows;
};

/**
 * Sets the rows that are active on the table (used when filtering)
 * @param activeRows the rows that are active in the table (i.e. rows that pass through filtering)
 */
ComponentTable.prototype.setActiveRows = function (activeRows) {
    if (!(activeRows instanceof Array)) {
        throw new Error("Called setActiveRows on ComponentTable with non Array type for activeRows parameter");
    }
    this.activeRows = activeRows;
    return this;
};

/**
 * Adds a column to the table
 * @param column The column you wish to add to the table
 */
ComponentTable.prototype.addColumn = function (column) {
    //If an attempt is made to add something other than a TableColumn
    if (!TableColumn.prototype.isPrototypeOf(column)) {
        throw new Error("Called addColumn on ComponentTable with non TableColumn type for column parameter");
    }
    //If a column already exists with this id
    if (this.hasColumn(column.getColumnId())) {
        throw new Error("Column with id: " + column.getColumnId() + " already exists in the ComponentTable with namespace: " + this.namespace);
    }
    if (column.getIsSortable()) {
        this.sortable = true;
    }
    this.getColumnSequence().push(column.getColumnId());
    this.getColumns().push(column);
    this.getColumnMap()[column.getColumnId()] = column;
};

/**
 * Gets a list of all columns from the table
 * @return {Array<TableColumn>} the list of columns
 */
ComponentTable.prototype.getColumns = function () {
    if (!this.columns) {
        this.columns = [];
    }
    return this.columns;
};

ComponentTable.prototype.getColumnMap = function () {
    if (!this.columnMap) {
        this.columnMap = {};
    }
    return this.columnMap;
};

/**
 * Gets a column at the specified index
 * @param index the index of the column
 * @return {TableColumn} the column at index
 */
ComponentTable.prototype.getColumnAtIndex = function (index) {
    if (index < 0 || index >= this.getColumns().length) {
        throw new Error("Index out of bounds when calling getColumnAtIndex on ComponentTable. Used index: " + index);
    }
    return this.getColumns()[index];
};

/**
 * Gets a column from the table by Id
 * @param columnId the Id of the column you wish to obtain
 * @return {TableColumn} the column as obtained by the Id, an exception is thrown if the column
 * does not exist
 */
ComponentTable.prototype.getColumnById = function (columnId) {
    if (!this.hasColumn(columnId)) {
        throw new Error("In ComponentTable method getColumnById, TableColumn with columnId: " + columnId + " does not exist");
    }
    return this.getColumnMap()[columnId];
};

/**
 * Checks to see if a column exists
 * @param columnId the column you're checking for
 */
ComponentTable.prototype.hasColumn = function (columnId) {
    return (typeof this.getColumnMap()[columnId] !== "undefined" && this.getColumnMap()[columnId] !== null);
};

/**
 * Allows sorting a column in a specified direction
 * @param columnId the column to be sorted
 * @param direction the direction to sort
 */
ComponentTable.prototype.sortByColumnInDirection = function (columnId, direction) {
    if (!this.hasColumn(columnId)) {
        throw new Error("In ComponentTable method toggleColumnSort, TableColumn with columnId: " + columnId + " does not exist" +
            "\nOptions are: " + this.getColumnSequence().join(","));
    }
    if (!TableColumn.isValidSortDirection(direction)) {
        throw new Error("Called sortByColumnInDirection on ComponentTable with invalid sort direction. " +
            "Use enumeration TableColumn.SORT.ASCENDING or TableColumn.SORT.DESCENDING");
    }
    var column = this.getColumnMap()[columnId];
    if (!column.getIsSortable()) {
        return;
    }
    //Get a sort function based on the data type, column, and sort direction
    var sortFunction = ColumnSortFactory.getSortFunction(column, direction);
    this.currentlySortedBy = sortFunction;
    //Update the columns and their indicators
    this.updateSortIndicators(column, direction);

    //Perform the sort on the table rows
    this.getRows().sort(sortFunction);
    this.getActiveRows().sort(sortFunction);
    this.sortGroups(sortFunction);

    //Refresh the table body
    this.refresh();
};

/**
 * Toggles the sorting of the column specified by columnId. I.e. if the column is sorted ascending, it will
 * sort descending and vice versa.
 * @param columnId the column to be sorted. If columnId is not valid, an exception is thrown.
 */
ComponentTable.prototype.toggleColumnSort = function (columnId) {
    if (!this.hasColumn(columnId)) {
        throw new Error("In ComponentTable method toggleColumnSort, TableColumn with columnId: " + columnId + " does not exist." +
            "\nOptions are: " + this.getColumnSequence().join(","));
    }
    //Get the column by id
    var column = this.getColumnMap()[columnId];
    if (!column.getIsSortable()) {
        return;
    }
    //Get and invert the sort direction, otherwise default to ascending
    var sortDirection = (column.getColumnSortDirection() !== TableColumn.SORT.NONE ? (-1 * column.getColumnSortDirection()) : TableColumn.SORT.ASCENDING);
    this.sortByColumnInDirection(columnId, sortDirection);
};

/**
 * Updates the sort indicators for a column.
 * @param column the column we're updating.
 * @param direction the direction the column is now sorted in.
 */
ComponentTable.prototype.updateSortIndicators = function (column, direction) {
    var ns = this.namespace;
    var sortedColumn = this.getCurrentlySortedColumn();
    //Update the previous column
    if (sortedColumn) {
        $("#" + ns + "columnHeader" + sortedColumn.getColumnId()).removeClass(this.getSortClass(sortedColumn.getColumnSortDirection()));
        sortedColumn.setColumnSortDirection(TableColumn.SORT.NONE);
    }
    $("#" + ns + "columnHeader" + column.getColumnId()).addClass(this.getSortClass(direction));
    column.setColumnSortDirection(direction);
    this.currentlySortedColumn = column;
};

/**
 * Gets a css class based on the passed in sort direction (ascending or descending)
 * @param sortDirection the direction for which we are obtaining a css class
 * @return {string} a css class string based on the sort direction
 * sortDirection = -1 (TableColumn.SORT.ASCENDING) returns sort-asc
 * sortDirection = 1 (TableColumn.SORT.DESCENDING) returns sort-desc
 */
ComponentTable.prototype.getSortClass = function (sortDirection) {
    switch (sortDirection) {
        case TableColumn.SORT.ASCENDING:
            return "sort-asc";
        case TableColumn.SORT.DESCENDING:
            return "sort-desc";
        default:
            return "";
    }
};

/**
 * Gets the function that is currently sorting the table. Null if no sorting is applied.
 * @return {Function} the function that is currently sorting the table.
 */
ComponentTable.prototype.getCurrentlySortedBy = function () {
    return this.currentlySortedBy;
};

/**
 * Sets the function that is currently sorting the table.
 * @param currentlySortedBy the function currently being used to sort the table.
 */
ComponentTable.prototype.setCurrentlySortedBy = function (currentlySortedBy) {
    if (typeof currentlySortedBy !== "function") {
        throw new Error("Called setCurrentlySortedBy on ComponentTable with non function type for currentlySortedBy parameter");
    }
    this.currentlySortedBy = currentlySortedBy;
    return this;
};

/**
 * Gets which column the table is currently sorted by
 * @return {TableColumn} the column the table is currently sorted by
 */
ComponentTable.prototype.getCurrentlySortedColumn = function () {
    return this.currentlySortedColumn;
};

/**
 * Sets which column the table is currently sorted by
 * @param currentlySortedColumn the column that the table is currently sorted by
 * @return {ComponentTable} returns self
 */
ComponentTable.prototype.setCurrentlySortedColumn = function (currentlySortedColumn) {
    if (!TableColumn.prototype.isPrototypeOf(currentlySortedColumn)) {
        throw new Error("Called setCurrentlySortedColumn on ComponentTable with non TableColumn type for currentlySortedColumn parameter");
    }
    this.currentlySortedColumn = currentlySortedColumn;
    return this;
};

/**
 * Gets the custom class that is applied to the table (used for customized styling)
 * @return {string} the name of the custom class to be applied to the root of the table
 */
ComponentTable.prototype.getCustomClass = function () {
    return this.customClass;
};

/**
 * Applies a css class to the root of the table for customized styling options
 * @param customClass
 * @return {ComponentTable} returns self
 */
ComponentTable.prototype.setCustomClass = function (customClass) {
    if (typeof customClass !== "string") {
        throw new Error("Called setCustomClass on ComponentTable with non string type for customClass parameter");
    }
    this.customClass = customClass;
    return this;
};

/**
 * Adds an extension for the component table. They act as smaller modules that can help the table perform additional
 * operations
 * @param extension the extension that is to be added to the table
 * @return {ComponentTable} returns self
 */
ComponentTable.prototype.addExtension = function (extension) {
    if (!TableExtension.prototype.isPrototypeOf(extension)) {
        throw new Error("Called addExtension on ComponentTable with non TableExtension type for extension parameter");
    }
    this.getExtensions().push(extension);
    return this;
};

/**
 * Gets a list of table extensions
 * @return {Array} the list of table extensions
 */
ComponentTable.prototype.getExtensions = function () {
    if (!this.extensions) {
        this.extensions = [];
    }
    return this.extensions;
};

/**
 * Groups the table by a key. The key should be a field in the results JSON.
 * @param key the field used to determine grouping. This key should be a field in the results JSON.
 * @param template the template used to render the grouping. This template determines what is shown
 * @param showCount whether the groups should show the counts
 * in the group subsection.
 */
ComponentTable.prototype.quickGroup = function (key, template, showCount) {
    this.groupedBy = key;
    this.groupTemplate = TemplateBuilder.buildTemplate(template);
    this.showGroupCount = showCount;
    var tableRows = this.getRows();
    var numberOfRows = tableRows.length;
    //If the data hasn't been bound, we stop here
    if (!numberOfRows) {
        return;
    }
    this.groupSequence = [];
    this.groupMap = {};
    //Iterate through the rows and add them to their respective groups
    for (var i = 0; i < numberOfRows; i++) {
        this.addRowToGroup(key, tableRows[i], showCount);
    }
};

/**
 *
 * @param groupKey the key we're qualifying the group on
 * @param row the row to be added to a group
 * @param showCount whether or not to show the counts for groups
 */
ComponentTable.prototype.addRowToGroup = function (groupKey, row, showCount) {
    var rowData = row.getResultData();
    var rowKey = (rowData[groupKey] || "UNKNOWN").replace(/[\s]/gi, "_").replace(/[\W]/gi, "").toUpperCase();
    var gMap = this.getGroupMap();
    var gSequence = this.getGroupSequence();
    if (!gMap[rowKey]) {
        gMap[rowKey] = new TableGroup().setKey(groupKey).setValue(rowKey).setDisplay(this.groupTemplate.render(rowData)).setGroupId(rowKey).setShowCount(showCount);
        gSequence.push(rowKey);
    }
    gMap[rowKey].addRow(row);
};

/**
 * Checks if grouping is applied
 * @return {boolean}
 */
ComponentTable.prototype.isGroupingApplied = function () {
    return (this.getGroupSequence().length > 0);
};

/**
 * Adds a single group to the table
 * @param group the group to be added
 * @return {ComponentTable} returns self
 */
ComponentTable.prototype.addGroup = function (group) {
    if (!TableGroup.prototype.isPrototypeOf(group)) {
        throw new Error("Called addGroup on ComponentTable with non TableGroup type for group parameter");
    }
    if (this.hasGroup(group.getGroupId())) {
        throw new Error("In addGroup on ComponentTable, TableGroup with id: " + group.getGroupId() + " already exists");
    }
    var gMap = this.getGroupMap();
    var gSequence = this.getGroupSequence();
    //If sorting is applied when we add the group, honor that sorting
    if (this.currentlySortedBy) {
        group.getRows().sort(this.currentlySortedBy);
    }
    gSequence.push(group.getGroupId());
    gMap[group.getGroupId()] = group;
    return this;
};

/**
 * Applies a set of groups to the table
 * @param groups a set of groups to be added to the table
 */
ComponentTable.prototype.applyGroups = function (groups) {
    if (!(groups instanceof Array)) {
        throw new Error("Called applyGroups on ComponentTable with non Array type for groups parameter");
    }
    this.clearGroups();
    //Iterate over the provided groups and add them to the table
    for (var i = 0; i < groups.length; i++) {
        this.addGroup(groups[i]);
    }
};

/**
 * Sorts the table groups (if there are any) by the provided sort function
 * @param sortFunction the function to use to sort the groups
 */
ComponentTable.prototype.sortGroups = function (sortFunction) {
    var gMap = this.getGroupMap();
    var gSequence = this.getGroupSequence();
    var numberOfGroups = gSequence.length;
    for (var i = 0; i < numberOfGroups; i++) {
        gMap[gSequence[i]].getRows().sort(sortFunction);
    }
};

/**
 * Checks to see if a group with groupId exists in the Component Table
 * @param groupId the id of the TableGroup we're checking for
 * @return {boolean}
 */
ComponentTable.prototype.hasGroup = function (groupId) {
    return (typeof this.getGroupMap()[groupId] !== "undefined" && this.getGroupMap()[groupId] !== null);
};

/**
 * Obtains a table group based on the groupId
 * @param groupId the id of the group to be obtained
 * @return {TableGroup} a TableGroup based on the groupId passed in
 */
ComponentTable.prototype.getGroupById = function (groupId) {
    if (!this.hasGroup(groupId)) {
        throw new Error("In ComponentTable method getGroupById, TableGroup with groupId: " + groupId + " does not exist");
    }
    return this.getGroupMap()[groupId];
};

/**
 * Gets the group map for the ComponentTable
 * @return {Map<String, TableGroup>} the groupMap that maps group ids to their TableGroup object
 */
ComponentTable.prototype.getGroupMap = function () {
    if (!this.groupMap) {
        this.groupMap = {};
    }
    return this.groupMap;
};

/**
 * Gets the group sequence for the ComponentTable
 * @return {Array<String>} a list of group ids that forms the sequence of groups for the table
 */
ComponentTable.prototype.getGroupSequence = function () {
    if (!this.groupSequence) {
        this.groupSequence = [];
    }
    return this.groupSequence;
};

/**
 * Opens a TableGroup with the specified groupId
 * @param groupId the id of the group to be opened
 */
ComponentTable.prototype.openGroup = function (groupId) {
    if (!this.hasGroup(groupId)) {
        throw new Error("In ComponentTable method toggleGroup, TableGroup with groupId: " + groupId + " does not exist");
    }
    var tableGroup = this.getGroupMap()[groupId];
    var groupContainer = $("#" + this.namespace + "\\:" + tableGroup.getGroupId());
    //If it's already expanded, just return
    if (tableGroup.isExpanded()) {
        return;
    }
    tableGroup.setIsExpanded(true);
    groupContainer.removeClass("closed");
    groupContainer.find(".sub-sec-hd-tgl").attr("title", i18n.discernabu.HIDE_SECTION).html("-");
};

/**
 *
 * @param groupIds
 */
ComponentTable.prototype.openGroups = function (groupIds) {
    if (!(groupIds instanceof Array)) {
        throw new Error("Called openGroups on ComponentTable with non Array type for groups parameter");
    }
    //Iterate over the provided group ids and open the groups
    for (var i = 0; i < groupIds.length; i++) {
        this.openGroup(groupIds[i]);
    }
};

/**
 * Closes a group based on a group id
 * @param groupId
 */
ComponentTable.prototype.collapseGroup = function (groupId) {
    if (!this.hasGroup(groupId)) {
        throw new Error("In ComponentTable method toggleGroup, TableGroup with groupId: " + groupId + " does not exist");
    }
    var tableGroup = this.getGroupMap()[groupId];
    var groupContainer = $("#" + this.namespace + "\\:" + tableGroup.getGroupId());
    //If it's already collapsed, just return
    if (!tableGroup.isExpanded()) {
        return;
    }
    tableGroup.setIsExpanded(false);
    groupContainer.addClass("closed");
    groupContainer.find(".sub-sec-hd-tgl").attr("title", i18n.discernabu.SHOW_SECTION).html("+");
};

/**
 * Collapses a set of groups.
 * @param groupIds the ids of the groups to be collapsed.
 */
ComponentTable.prototype.collapseGroups = function (groupIds) {
    if (!(groupIds instanceof Array)) {
        throw new Error("Called closeGroups on ComponentTable with non Array type for groups parameter");
    }
    //Iterate over the group ids, attempting to close them
    for (var i = 0; i < groupIds.length; i++) {
        this.collapseGroup(groupIds[i]);
    }
};

/**
 * Toggles a table group with the specified groupId
 * @param groupId the id of the group to be toggled
 */
ComponentTable.prototype.toggleGroup = function (groupId) {
    var group = this.getGroupById(groupId);
    if (group.isExpanded()) {
        this.collapseGroup(groupId);
    } else {
        this.openGroup(groupId);
    }
};

/**
 * Clears the grouping information on the table
 */
ComponentTable.prototype.clearGroups = function () {
    this.groupSequence = [];
    this.groupMap = {};
    this.groupedBy = "";
};

/**
 * Handles rendering a group
 * @param group the group being rendered
 * @return {string} an html string built from the group
 */
ComponentTable.prototype.renderGroup = function (group) {
    var headId = this.namespace + ":" + group.getGroupId();
    var headToggleTitle = group.isExpanded() ? i18n.discernabu.HIDE_SECTION : i18n.discernabu.SHOW_SECTION;
    var headToggleContent = group.isExpanded() ? "-" : "+";
    var headToggleClass = group.isExpanded() ? "" : "closed";
    var countHtml = group.getShowCount() ? "<span class='sub-sec-total'>&nbsp;(" + group.getRows().length + ")</span>" : "";
    var toggleHtml = group.getCanCollapse() ? ("<span class='sub-sec-hd-tgl' title='"+headToggleTitle + "'>"+ headToggleContent +"</span>") : "";
    return "<div id='" + headId + "' class='" + headToggleClass + "'><h3 id='" + headId + ":header" + "' class='sub-sec-hd'>" + toggleHtml + "<span class='sub-sec-title'><dl><dd><span class='sub-sec-display'>" + group.getDisplay() + "</span>" + countHtml + "</dd></dl></span></h3>" +
        "<div id='" + headId + ":content' class='sub-sec-content'>" +
        (group.getRows().length ? this.renderRows(group.getRows(), group.getGroupId()) : this.renderNoResults()) +
        "</div>" +
        "</div>";
};

/**
 * Check to see if the header is enabled.
 * @return {boolean} flag determining if the table header is enabled.
 */
ComponentTable.prototype.isHeaderEnabled = function() {
    return this.headerEnabled;
};

/**
 * Sets whether the table header is enabled (will be rendered)
 * @param headerEnabled boolean flag determining if the table header is enabled.
 */
ComponentTable.prototype.setIsHeaderEnabled = function(headerEnabled) {
    if(typeof headerEnabled !== "boolean") {
        throw new Error("Called setIsHeaderEnabled on ComponentTable with non boolean type for headerEnabled parameter");
    }
    this.headerEnabled = headerEnabled;
    return this;
};

/**
 * Returns the namespace of the table
 * @return {string} the namespace of the table
 */
ComponentTable.prototype.getNamespace = function () {
    return this.namespace;
};

/**
 * Initialize the namespace of the component. This is necessary to distinguish tables in the DOM
 * @param namespace the namespace of the table. It is recommended to use component.getStyles().getId()
 */
ComponentTable.prototype.setNamespace = function (namespace) {
    if (typeof namespace !== "string") {
        throw new Error("Called setNamespace on ComponentTable with non string type for namespace parameter");
    }
    this.namespace = namespace;
    return this;
};

/**
 * Adds a row to the table
 * @param row the row to add to the table
 */
ComponentTable.prototype.addRow = function (row) {
    if (TableRow.prototype.isPrototypeOf(row)) {
        throw new Error("Called addRow on ComponentTable with non TableRow type for row parameter");
    }
    this.getRows().push(row);
    return this;
};

/**
 * Gets the rows from the table
 * @return {Array} the rows in the table
 */
ComponentTable.prototype.getRows = function () {
    if (!this.rows) {
        this.rows = [];
    }
    return this.rows;
};

/**
 * Gets the row by id
 * @param rowId the id of the row to be obtained
 * @return {TableRow} the row with the specified id
 */
ComponentTable.prototype.getRowById = function (rowId) {
    if (!this.hasRow(rowId)) {
        throw new Error("In ComponentTable method getRowById, TableRow with rowId: " + rowId + " does not exist");
    }
    return this.getRowMap()[rowId];
};

/**
 * Gets the mapping of rowIds to TableRow objects.
 * @return {Map<String, TableRow>} the mapping of string rowIds to TableRow objects.
 */
ComponentTable.prototype.getRowMap = function() {
    if(!this.rowMap) {
        this.rowMap = {};
    }
    return this.rowMap;
};

/**
 * Checks to see if a row exists
 * @param rowId the id of the row you are checking for
 * @return {boolean} true if the row exists, false otherwise
 */
ComponentTable.prototype.hasRow = function (rowId) {
    return (typeof this.getRowMap()[rowId] !== "undefined" && this.getRowMap()[rowId] !== null);
};

/**
 * Gets the column sequence
 * @return {Array} an array of IDs telling the order in which columns are to be rendered
 */
ComponentTable.prototype.getColumnSequence = function () {
    if(!this.sequence) {
        this.sequence = [];
    }
    return this.sequence;
};

/**
 * Gets whether the table should zebra stripe
 * @return {boolean} true if the table should zebra-stripe, false otherwise
 */
ComponentTable.prototype.getZebraStripe = function () {
    return this.zebraStripe;
};

/**
 * Set whether the table should use zebra-striping
 * @param zebraStripe true if the table should zebra stripe, false otherwise
 */
ComponentTable.prototype.setZebraStripe = function (zebraStripe) {
    if (typeof zebraStripe === "boolean") {
        this.zebraStripe = zebraStripe;
    }
    return this;
};

/**
 * Gets the zebra stripe class based on the index
 * @param index the index for a row
 * @return {string} "even" if the index is even, "odd" if the index is odd
 */
ComponentTable.prototype.getStripeClass = function (index) {
    return (index % 2 === 0) ? "odd" : "even";
};

/**
 * Creates an html string for the table
 * @return {string} the html string for the table body
 */
ComponentTable.prototype.render = function () {
    var groupingClass = this.isGroupingApplied() ? " grouping-applied" : "";
    var customClass = this.getCustomClass() ? " " + this.getCustomClass() : "";
    var bodyHTML = "<div id='" + this.namespace + "table' class='component-table list-as-table" + customClass + groupingClass + "'>" +
        (this.isHeaderEnabled() ? this.renderHeader() : "") +
        "<div  id='" + this.namespace + "tableBody" + "' class='content-body'>" +
        this.renderBody() +
        "</div></div>";
    return bodyHTML;
};

/**
 * Refreshes the table body (usually done after sorting). If there are groups it will handle re-rendering each individual
 * group, otherwise it will just render the rows.
 */
ComponentTable.prototype.refresh = function () {
    var tableRoot = $("#" + this.namespace + "table");
    if(!tableRoot || !tableRoot.length) {
        return;
    }
    //If grouping is applied, add the grouping applied class to the root, otherwise remove it
    if(this.isGroupingApplied()) {
        tableRoot.addClass("grouping-applied");
    } else {
        tableRoot.removeClass("grouping-applied");
    }
    var tableBody = $("#" + this.namespace + "tableBody");
    //If the table body isn't found, we can't refresh
    if (!tableBody || !tableBody.length) {
        return;
    }
    tableBody[0].innerHTML = this.renderBody();
    //There is a chance that sizings have changed, so we call the update method
    this.updateAfterResize();
};

/**
 * Renders the table header
 * @return {string} an html string representing the table's header
 */
ComponentTable.prototype.renderHeader = function () {
    var ns = this.namespace;
    var headerWrapper = "<div id='" + ns + "headerWrapper" + "' class='content-hdr'>";
    var headerHTML = "<dl id='" + ns + "header" + "' class='" + (this.sortable ? "sort-control" : "") + " hdr'>";
    var columnSequence = this.getColumnSequence();
    var numberColumns =columnSequence.length;
    var headerItemClass = "";
    var column = null;
    var style = "";
    for (var i = 0; i < numberColumns; i++) {
        headerItemClass = "header-item";
        column = this.getColumnMap()[columnSequence[i]];
        style = column.getWidth() ? " style='width:" + column.getWidth() + "px;'" : "";
        headerItemClass += (column.getCustomClass() ? (" " + column.getCustomClass()) : "");
        headerItemClass += (column.getIsSortable() ? " sort-option" : "");
        if (column.getColumnSortDirection() !== TableColumn.SORT.NONE) {
            headerItemClass += (" " + this.getSortClass(column.getColumnSortDirection()));
        }
        headerHTML += ("<dd id='" + ns + "columnHeader" + column.getColumnId() + "' class='" + headerItemClass + "'" + style + ">" +
            "<span id='" + ns + "headerItemDisplay" + column.getColumnId() + "' class='header-item-display'>" + column.getColumnDisplay() + "</span>" +
            "</dd>");
    }
    return headerWrapper + headerHTML + "</dl></div>";
};

/**
 * Builds up an html string for the table body. If no grouping is applied, it just renders the active rows. Otherwise
 * it will render each group
 * @return {string} the html string for the table body
 */
ComponentTable.prototype.renderBody = function () {
    var tableBodyHTML = "";		//open table
    //If no grouping is applied, simply render the table rows
    var gMap = this.getGroupMap();
    var gSequence = this.getGroupSequence();
    var numberOfGroups = gSequence.length;
    if (!gSequence.length) {
        return this.renderRows(this.getActiveRows(), null);
    } else {
        for (var i = 0; i < numberOfGroups; i++) {
            tableBodyHTML += this.renderGroup(gMap[gSequence[i]]);
        }
    }
    return tableBodyHTML;		//close table
};

/**
 *
 * @param rows
 * @param groupId
 * @return {string}
 */
ComponentTable.prototype.renderRows = function (rows, groupId) {
    var rowsHtml = "";
    var columnSequence = this.getColumnSequence();
    var numberColumns = columnSequence.length;
    var style = "";
    groupId = groupId ? (":" + groupId) : "";
    var cellId = "";
    for (var i = 0; i < rows.length; i++) {
        var row = rows[i];
        var rowClass = "result-info " + this.getStripeClass(i);
        var rowId = this.namespace + groupId  + ":" + row.getId();
        rowsHtml += "<dl id='" + rowId + "' class='" + rowClass + "'>";		//open table-row
        for (var j = 0; j < numberColumns; j++) {
            var column = this.getColumnMap()[columnSequence[j]];
            var tableCellClass = "table-cell " + column.getCustomClass();
            var columnID = column.getColumnId();
            style = column.getWidth() ? " style='width:" + column.getWidth() + "px;'" : "";
            cellId = this.namespace + groupId + ":" + row.getId() + ":" + columnID;
            rowsHtml += "<dd id='" + cellId + "' class='" + tableCellClass + "'" + style + ">";		//open table-cell
            rowsHtml += (column.getRenderTemplate().render(row.getResultData()) || "<span>&nbsp;</span>");
            rowsHtml += "</dd>";		//close table-cell
        }
        rowsHtml += "</dl>";
    }
    return rowsHtml;
};

/**
 * Helper function to render the standard no results found html
 * @return {string} html string for no results found
 */
ComponentTable.prototype.renderNoResults = function () {
    return "<span class='res-none'>" + i18n.NO_RESULTS_FOUND + "</span>";
};

/**
 * Finalizes the table (i.e., must be called after it has rendered). It attaches the click delegate
 * for the table header for sorting. It also finalizes any extensions for the table.
 */
ComponentTable.prototype.finalize = function () {
    var self = this;
    var extensionsList = this.getExtensions();
    var numberOfExtensions = extensionsList.length;

    //Initialize click events for the sort options
    var header = $("#" + this.namespace + "header").on("click", ".sort-option", function (event) {
        var id = $(this).attr("id");
        var prefixLength = (self.namespace + "columnHeader").length;
        var columnID = id.substring(prefixLength, id.length);
        self.toggleColumnSort(columnID);
    });

    //Remove the current click events
    $("#" + this.namespace + "tableBody").find(".sub-sec-hd-tgl").each(function () {
        Util.removeEvent(this, "click", MP_Util.Doc.ExpandCollapse);
    });

    //Attach a delegate for the group toggle
    $("#" + this.namespace + "tableBody").on("click", ".sub-sec-hd-tgl", function (event) {
        self.toggleGroup(TableGroup.parseGroupId($(this).parent().attr("id")));
        self.updateAfterResize();
    });

    //Finalize all extensions
    for (var i = 0; i < numberOfExtensions; i++) {
        extensionsList[i].finalize(this);
    }
};

/**
 * Function to update the table after a resize event. It checks to see if scrolling is applied, and if so
 * it shifts the header over to compensate for the scrollbar in the table body.
 */
ComponentTable.prototype.updateAfterResize = function () {
    var tableBody = $("#" + this.namespace + "tableBody");
    if (!tableBody || !tableBody.length) {
        return;
    }
    //Scrolling is applied
    if (tableBody[0].scrollHeight > tableBody.outerHeight()) {
        $("#" + this.namespace + "header").addClass("shifted");
    } else {
        $("#" + this.namespace + "header").removeClass("shifted");
    }
};

/**
 * Binds JSON data to the table, setting up all necessary objects for render
 * @param data the data being bound to the table
 */
ComponentTable.prototype.bindData = function (data) {
    //Attempting to bind result data with no columns defined. This does not make sense.
    if (!this.getColumnSequence().length) {
        throw new Error("Called bindData on ComponentTable with no columns defined.");
    }
    if (typeof data !== "object" || !(data instanceof Array)) {
        throw new Error("Called bindData on ComponentTable with non object Array type for data parameter. Please pass an Array of json results");
    }
    this.clearData();
    var dataLength = data.length;
    var tableRows = this.getRows();
    var rMap = this.getRowMap();
    for (var i = 0; i < dataLength; i++) {
        var dataItem = data[i];
        var tableRow = new TableRow().setId("row" + i).setResultData(dataItem);
        tableRows.push(tableRow);
        //Store the row in a map by id, so we can access it later via a DOM id
        rMap[tableRow.getId()] = tableRow;

        //If grouping has been applied (prior to binding), push the rows into groups
        if (this.groupedBy) {
            this.addRowToGroup(this.groupedBy, tableRow, this.showGroupCount);
        }
    }
    this.activeRows = tableRows;
    //If for some reason the user called a sort function before binding any data
    if (this.currentlySortedBy) {
        this.getActiveRows().sort(this.currentlySortedBy);
        tableRows.sort(this.currentlySortedBy);
        this.sortGroups(this.currentlySortedBy);
    }
    return this;
};

/**
 * Clears out the table-level data (not groups)
 */
ComponentTable.prototype.clearData = function () {
    this.rows = [];
    this.rowMap = {};
    this.activeRows = [];
};

/**
 * A factory class that produces row sorting functions
 * @constructor
 */
function ColumnSortFactory() {
}

/**
 * Gets a sort function based on a column and the specified sort direction
 * @param column the column we're sorting
 * @param sortDirection the direction to sort (ascending or descending)
 * @return {Function} a sorting function
 */
ColumnSortFactory.getSortFunction = function (column, sortDirection) {
    if (!TableColumn.isValidSortDirection(sortDirection)) {
        throw new Error("Called ColumnSortFactory.getSortFunction with invalid sort direction. " +
            "Use enumeration TableColumn.SORT.ASCENDING or TableColumn.SORT.DESCENDING");
    }
    return function (rowA, rowB) {
        var resultDataA = rowA.getResultData();
        var resultDataB = rowB.getResultData();
        var rowAVal = resultDataA[column.getPrimarySortField()];
        var rowBVal = resultDataB[column.getPrimarySortField()];
        var comparison = ColumnSortFactory.compare(rowAVal, rowBVal);
        //If the comparison on the primary sort fields isn't 0 (not equal), return this value
        if (comparison !== 0) {
            return sortDirection * comparison;
        }
        //If the primary sort fields are equal, attempt to use any secondary sort fields
        var secondarySortFields = column.getSecondarySortFields();
        for (var i = 0; i < secondarySortFields.length; i++) {
            rowAVal = resultDataA[secondarySortFields[i].FIELD];
            rowBVal = resultDataB[secondarySortFields[i].FIELD];
            comparison = ColumnSortFactory.compare(rowAVal, rowBVal);
            if (comparison !== 0) {
                return secondarySortFields[i].DIRECTION * comparison;
            }
        }
        //If we've made it this far, all fields are equal, so return 0
        return 0;
    };
};

/**
 * Helper function to compare two values.
 * @param a the first value to compare
 * @param b the second value to compare
 * @return {number} a comparison value 1, -1, or 0, where 0 means equality
 */
ColumnSortFactory.compare = function (a, b) {
    try {
        //Perform special logic for setting up sort values for comparison
        if (typeof a === "number" || typeof b === "number") {
            a = a || 0;
            b = b || 0;
        } else if (typeof a === "string" || typeof b === "string") {
            a = (a || "").toUpperCase();
            b = (b || "").toUpperCase();
        }
        return ((a > b) ? -1 : (a < b ? 1 : 0));
    } catch (exe) {
        MP_Util.LogError("Called ColumnSortFactory.compare(a,b) with an invalid value for a or b");
        return 0;
    }
};
/**
 * Utility class for retrieving data from a table
 * @constructor
 */
function ComponentTableDataRetriever(){}

/**
 * Retrieves a result json object based on an element.
 * @param table the table we're getting the data from.
 * @param element the element for which we're obtaining the associated result json.
 * @return {JSON Object} the result obtained from the table.
 */
ComponentTableDataRetriever.getResultFromTable = function(table, element) {
    var identifiers = $(element).attr("id").split(":");
    //If grouping is applied, we go through the group to find the row data
    if(table.isGroupingApplied()) {
        return table.getGroupById(identifiers[1]).getRowById(identifiers[2]).getResultData();
    } else {
        return table.getRowById(identifiers[1]).getResultData();
    }
};

/**
 * Retrieves the column id from an element in a component table.
 * @param table the table object.
 * @param element the element we're grabbing the column id from.
 * @return {string} the id of the column as obtained from the element
 */
ComponentTableDataRetriever.getColumnIdFromElement = function(table, element) {
    if(!ComponentTable.prototype.isPrototypeOf(table)) {
        throw new Error("Called getColumnIdFromElement on ComponentTableDataRetriever with non ComponentTable type for table parameter");
    }
    var identifiers = $(element).attr("id").split(":");
    if(table.isGroupingApplied()) {
        return (identifiers.length > 4) ? (identifiers.slice(3).join(':')) : (identifiers[3]);
    } else {
        return (identifiers.length > 3) ? (identifiers.slice(2).join(':')) : identifiers[2];
    }
};
/**
 * The MPageTooltip class. This is used for dynamic hovers.
 * @return {MPageTooltip} returns self
 * @constructor
 * @author Will Reynolds
 */
function MPageTooltip() {
    this.anchor = null;                 //The element the tooltip is anchored to
    this.content = null;                //The content of the tooltip
    this.flipfit = true;                //Whether the tooltip should flip fit (fit on screen)
    this.height = 0;                    //The height of the tooltip content in the DOM
    this.offsetX = 20;                  //The X offset from the mouse position
    this.offsetY = 20;                  //The Y offset from the mouse position
    this.showDelay = 500;               //How long the tooltip should wait to show (in milliseconds)
    this.tolerance = 5;                 //How much extra space around the edge of the window before we flip
    this.stillHovered = false;          //Whether the mouse is still hovered over the anchor for this tooltip
    this.width = 0;                     //The width of the tooltip content in the DOM
    this.x = 0;                         //The x position of the tooltip content in the DOM (coincides with css 'left')
    this.y = 0;                         //The y position of the tooltip content in the DOM (coincides with css 'top')
    return this;
}

/**
 * Get the anchor that the tooltip is tied to
 * @return {Html Element}
 */
MPageTooltip.prototype.getAnchor = function () {
    return this.anchor;
};

/**
 * Set the anchor that the tooltip is tied to
 * @param anchor the DOM anchor that this tooltip is tied to
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setAnchor = function (anchor) {
    this.anchor = anchor;
    return this;
};

/**
 * Gets the content of the tooltip (the actual tooltip in the DOM)
 * @return {jQuery DOM Element} the jQuery DOM element of the tooltip
 */
MPageTooltip.prototype.getContent = function () {
    return this.content;
};

/**
 * Sets the content of the tooltip.
 * @param content the content to be placed inside the tooltip
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setContent = function (content) {
    this.content = $("<div class='mpage-tooltip'>").html(content).hide();
    return this;
};

/**
 * Gets whether the tooltip should flip to fit inside the screen space
 * @return {boolean} whether the tooltip should flip to fit inside the screen space
 */
MPageTooltip.prototype.shouldFlipfit = function () {
    return this.flipfit;
};

/**
 * Sets whether the tooltip should flip to fit inside the screen space
 * @param flipfit a boolean flag for whether the tooltip should flipfit
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setShouldFlipfit = function (flipfit) {
    if (typeof flipfit !== "boolean") {
        throw new Error("Called setShouldFlipfit on DiscernTooltip with non boolean type for flipfit parameter");
    }
    this.flipfit = flipfit;
    return this;
};

/**
 * Gets the height of the tooltip content in the DOM
 * @return {number} the height of the tooltip content in the DOM
 */
MPageTooltip.prototype.getHeight = function() {
    return this.height;
};

/**
 * Sets the height of the tooltip content in the DOM (this does not change the height of the tooltip, it is simply a means
 * of storing off the height of the tooltip content once it has been appended to the DOM).
 * @param height the height of the tooltip content in the DOM.
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setHeight = function(height) {
    if(typeof height !== "number") {
        throw new Error("Called setHeight on MPageTooltip with non number type for height parameter");
    }
    this.height = height;
    return this;
};

/**
 * Gets the x offset value for the tooltip. This is how far in the x direction the tooltip should be shown from the mouse
 * when hovering.
 * @return {number} the x offset value for the tooltip
 */
MPageTooltip.prototype.getOffsetX = function() {
    return this.offsetX;
};

/**
 * Sets the x offset value for the tooltip. This is how far in the x direction the tooltip should be shown from the mouse
 * when hovering.
 * @param offsetX the x offset value for the tooltip
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setOffsetX = function(offsetX) {
    if(typeof offsetX !== "number") {
        throw new Error("Called setOffsetX on MPageTooltip with non number type for offsetX parameter");
    }
    this.offsetX = offsetX;
    return this;
};

/**
 * Gets the y offset value for the tooltip. This is how far in the y direction the tooltip should be shown from the mouse
 * when hovering.
 * @return {number} the y offset value for the tooltip
 */
MPageTooltip.prototype.getOffsetY = function() {
    return this.offsetY;
};

/**
 * Sets the y offset value for the tooltip. This is how far in the y direction the tooltip should be shown from the mouse
 * when hovering.
 * @param offsetY the y offset value for the tooltip
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setOffsetY = function(offsetY) {
    if(typeof offsetY !== "number") {
        throw new Error("Called setOffsetY on MPageTooltip with non number type for offsetY parameter");
    }
    this.offsetY = offsetY;
    return this;
};

/**
 * Gets the delay value for the tooltip. This is how long the tooltip waits before appearing after the show
 * method has been called
 * @return {number} the delay for the tooltip in milliseconds.
 */
MPageTooltip.prototype.getShowDelay = function () {
    return this.showDelay;
};

/**
 * Sets the delay value for the tooltip. This is how long the tooltip waits before appearing after the show
 * method has been called
 * @param showDelay how long the tooltip should wait before appearing after the show method is called (in milliseconds)
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setShowDelay = function (showDelay) {
    if (typeof showDelay !== "number") {
        throw new Error("Called setShowDelay on DiscernTooltip with non number type for showDelay parameter");
    }
    if (showDelay < 0) {
        throw new Error("Called setShowDelay on DiscernTooltip with negative value, showDelay must be > 0");
    }
    this.showDelay = showDelay;
    return this;
};

/**
 * Gets a boolean flag determining whether the mouse is still hovered over the anchor.
 * @return {boolean} whether the mouse is still hovered over the tooltip's anchor.
 */
MPageTooltip.prototype.isStillHovered = function () {
    return this.stillHovered;
};

/**
 * Sets a boolean flag determining whether the mouse is still hovered over the anchor.
 * @param stillHovered the boolean flag for whether the mouse is still hovered over the anchor
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setIsStillHovered = function (stillHovered) {
    if (typeof stillHovered !== "boolean") {
        throw new Error("Called setIsStillHovered on DiscernTooltip with non boolean type for stillHovered parameter");
    }
    this.stillHovered = stillHovered;
    return this;
};


/**
 * Gets the tolerance for the tooltip (how much space around the window before flipping)
 * @return {number} contract the window size by this amount in pixels when determining tooltip flipping
 */
MPageTooltip.prototype.getTolerance = function() {
    return this.tolerance;
};

/**
 * Sets the tolerance of the tooltip (how much space to contract around the window before flipping)
 * @param tolerance how many pixels we contract the window size when determining tooltip flipping
 */
MPageTooltip.prototype.setTolerance = function(tolerance) {
    if(typeof tolerance !== "number") {
        throw new Error("Called setTolerance on MPageTooltip with non number type for tolerance parameter");
    }
    this.tolerance = tolerance;
};

/**
 * Gets the width of the tooltip content in the DOM
 * @return {number} the width of the tooltip content in the DOM
 */
MPageTooltip.prototype.getWidth = function () {
    return this.width;
};

/**
 * Sets the width of the tooltip content in the DOM (this does not change the width of the tooltip, it is simply a means
 * of storing off the width of the tooltip content once it has been appended to the DOM).
 * @param width the width of the tooltip content in the DOM.
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setWidth = function (width) {
    if(typeof width !== "number") {
        throw new Error("Called setWidth on MPageTooltip with non number type for width parameter");
    }
    this.width = width;
    return this;
};

/**
 * Gets the x position of the tooltip in the DOM.
 * @return {number} the x position of the tooltip in the DOM.
 */
MPageTooltip.prototype.getX = function () {
    return this.x;
};

/**
 * Sets the x position of the tooltip in the DOM (this does not change the x position of the tooltip, it is simply a means
 * of storing off the x position for internal use).
 * @param x the x position of the tooltip in the DOM.
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setX = function (x) {
    if(typeof x !== "number") {
        throw new Error("Called setX on MPageTooltip with non number type for x parameter");
    }
    this.x = x;
    return this;
};

/**
 * Gets the y position of the tooltip in the DOM.
 * @return {number} the y position of the tooltip in the DOM.
 */
MPageTooltip.prototype.getY = function () {
    return this.y;
};

/**
 * Sets the y position of the tooltip in the DOM (this does not change the y position of the tooltip, it is simply a means
 * of storing off the y position for internal use).
 * @param y the y position of the tooltip in the DOM.
 * @return {MPageTooltip} returns self
 */
MPageTooltip.prototype.setY = function (y) {
    if(typeof y !== "number") {
        throw new Error("Called setY on MPageTooltip with non number type for y parameter");
    }
    this.y = y;
    return this;
};

/**
 * Actually shows the MPageTooltip after it has been set up. It will wait the allotted delay time, then if the
 * mouse is still hovered, will append the tooltip content to the DOM. When the mouse leaves the anchor, the tooltip
 * is removed from the DOM.
 */
MPageTooltip.prototype.show = function () {
    var self = this;
    this.stillHovered = true;

    //Bind the mouseleave event to the anchor
    $(this.getAnchor()).on("mouseleave.discernTooltip", function (event) {
        self.setIsStillHovered(false);
        //If there is content, remove it from the DOM
        if (self.getContent()) {
            self.getContent().remove();
        }
        //Unbind any events with the tooltip namespace (so we don't clutter the dom with events)
        $(self.getAnchor()).unbind(".discernTooltip");
    });

    //Wait the allotted time before showing the tooltip
    setTimeout(function () {
        //At this point, the hover will be shown, so we'll poll to see if the anchor ever disappears
        self.checkAnchorStillExists();
        //If we have moused out, we quit here
        if (!self.isStillHovered()) {
            return;
        }
        //Append the tooltip content to the DOM
        $(document.body).append(self.getContent());
        //Store of the dimensions of the tooltip
        self.setHeight(self.getContent().height());
        self.setWidth(self.getContent().width());
        //Initialize the position
        self.getContent().css({
            "left": self.calculatePosition(self.x, $(window).width()-self.getTolerance(), self.width, self.getOffsetX()),
            "top": self.calculatePosition(self.y, $(window).height()-self.getTolerance(), self.height, self.getOffsetY())
        });
        self.content.show();
        //Bind the mouse move event with the discernTooltip namespace
        $(self.getAnchor()).on("mousemove.discernTooltip", function (event) {
            //If no longer hovered, just returned
            if (!self.isStillHovered()) {
                return;
            }
            //Store off the position values
            self.setX(event.pageX).setY(event.pageY);
            //Calculate the position for the tooltip
            self.content.css("left", self.calculatePosition(event.pageX, $(window).width()-self.getTolerance(), self.width, self.getOffsetX()));
            self.content.css("top", self.calculatePosition(event.pageY, $(window).height()-self.getTolerance(), self.height, self.getOffsetY()));
        });
    }, this.getShowDelay());
};

/**
 * Calculates the position for the tooltip
 * @param mouseValue the position of the mouse (x or y)
 * @param windowValue the width or height of the window
 * @param tooltipValue the width or height of the tooltip
 * @param paramOffset the x or y offset of the tooltip
 * @return {number} the calculated position for the tooltip (an x or y value)
 */
MPageTooltip.prototype.calculatePosition = function (mouseValue, windowValue, tooltipValue, paramOffset) {
    //If we're using the flipfit functionality
    if (this.shouldFlipfit() && mouseValue + paramOffset > (windowValue - tooltipValue)) {
        var positionVal = mouseValue - tooltipValue - paramOffset;
        if (positionVal < 0) {
            positionVal = ((windowValue) / 2) - (tooltipValue / 2);
        }
        return positionVal;
    }
    //Otherwise, just return the mouse position + offset
    return mouseValue + paramOffset;
};

/**
 * Helper function to check that the hover's anchor still exists on the DOM. If at any point the anchor ceases to
 * exist, the tooltip will be removed.
 */
MPageTooltip.prototype.checkAnchorStillExists = function () {
    var self = this;
    function checkHoverAnchor(){
        try {
            //If the anchor has been removed from the DOM, remove the tooltip and return
            if (!$(document.body).find(self.getAnchor()).length) {
                self.getContent().remove();
                self.setIsStillHovered(false);
                return;
            }
            //If no longer hovered, return
            if (!self.isStillHovered()) {
                return;
            }
            //At this point, we are still hovering, so continue polling
            setTimeout(checkHoverAnchor, 5000);
        } catch (exe) {
            return;
        }
    }
    checkHoverAnchor();
};
/**
 * Simple request manager object to handle interaction of script requests
 * @constructor
 * @author Will Reynolds
 */
function RequestManager() {
    this.maxPool = 0;
    this.requestCount = 0;
    this.requestQueue = null;
}

RequestManager.SOURCE = "MP_RequestManager";

/**
 * Performs a ScriptRequest object. If there is no available slots for running a request, the request is pushed onto
 * a queue and will run when space is available.
 * @param request the request to be performed.
 */
RequestManager.prototype.performRequest = function (request) {
    if (this.requestCount < this.maxPool) {
        request.setSource(RequestManager.SOURCE);
        this.requestCount++;
        request.start();
    } else {
        this.getRequestQueue().push(request);
    }
};

/**
 * Notification that a request has completed. If there are requests on the queue, the next available request will
 * be run.
 */
RequestManager.prototype.notify = function () {
    this.requestCount--;
    if(this.requestCount < 0) {
        throw new Error("Request count fell below 0.");
    }
    //If there are no pending requests, just return
    if (!this.getRequestQueue().length) {
        return;
    }
    //There are requests at this point, grab the next one
    var request = this.requestQueue.shift();
    if (!request) {
        return;
    }
    //Perform the request
    this.performRequest(request);
};

/**
 * Gets the max thread pool of the manager.
 * @return {number} the max thread pool.
 */
RequestManager.prototype.getMaxPool = function () {
    return this.maxPool;
};

/**
 * Sets the max thread pool for the request manager. It must be a number greater than 0.
 * @param maxPool the max request pool. Must be a number greater than 0.
 * @return {RequestManager} returns self.
 */
RequestManager.prototype.setMaxPool = function (maxPool) {
    if (typeof maxPool !== "number") {
        throw new Error("Called setMaxPool on RequestManager with non number type for maxPool parameter");
    }
    if (maxPool <= 0) {
        throw new Error("Called setMaxPool on RequestManager with an invalid max pool. Must be > 0");
    }
    this.maxPool = maxPool;
    return this;
};

/**
 * Gets the request queue for the RequestManager.
 * @return {Queue<ScriptRequest>} a queue of ScriptRequest objects.
 */
RequestManager.prototype.getRequestQueue = function () {
    if (!this.requestQueue) {
        this.requestQueue = [];
    }
    return this.requestQueue;
};

/**
 * Sets the request queue for the RequestManager.
 * @param requestQueue the queue to hold ScriptRequest objects.
 * @return {RequestManager} returns self.
 */
RequestManager.prototype.setRequestQueue = function (requestQueue) {
    if (!(requestQueue instanceof Array)) {
        throw new Error("Called setRequestQueue on RequestManager with non array type for requestQueue parameter");
    }
    this.requestQueue = requestQueue;
    return this;
};

/**
 * Create a global instance of the request manager and set the max thread pool to 6
 * @type {RequestManager}
 */
var MP_RequestManager = new RequestManager();
MP_RequestManager.setMaxPool(6);

/**
 * Response handler interface
 * @constructor
 * @author Will Reynolds
 */
function ResponseHandler() {
}

/**
 * Handles a request response. It will determine if the response should be handled as a success or failure depending
 * on the response code. It filters out responses that are not a completed request (status 4).
 * @param response the response.
 */
ResponseHandler.prototype.handleResponse = function (response) {
    //If the request response is not completed, ignore it
    if (response.readyState !== 4) {
        return;
    }
    //Determine if the request was successful or not
    if (response.status === 200) {
        this.handleSuccess(response);
    } else {
        this.handleError(response);
        throw new Error(response.responseText);
    }
};

/**
 * Interface method for handling a successful request
 * @param response the response returned
 */
ResponseHandler.prototype.handleSuccess = function (response) {
    throw new Error("handleSuccess not implemented in a ResponseHandler");
};

/**
 * Interface method for handling a failed request
 * @param response the response returned
 */
ResponseHandler.prototype.handleError = function (response) {
    throw new Error("handleError not implemented in a ResponseHandler");
};

/**
 * A customizable response handler that utilizes callbacks for processing success and failure.
 * @constructor
 * @author Will Reynolds
 */
function CustomResponseHandler() {
    this.successHandler = null;
    this.errorHandler = null;
}

CustomResponseHandler.prototype = new ResponseHandler();
CustomResponseHandler.prototype.constructor = ResponseHandler;

/**
 * Called upon a successful request. If there is a success callback, it is used.
 * @param response the response returned by the request.
 */
CustomResponseHandler.prototype.handleSuccess = function (response) {
    if (this.successHandler) {
        this.successHandler(response);
    }
};

/**
 * Called upon a failed request. If there is a failure callback, it is used.
 * @param response the response returned by the request.
 */
CustomResponseHandler.prototype.handleError = function (response) {
    if (this.errorHandler) {
        this.errorHandler(response);
    }
};

/**
 * Sets the success callback handler.
 * @param handler the callback handler.
 */
CustomResponseHandler.prototype.setSuccessHandler = function (handler) {
    if (typeof handler !== "function") {
        throw new Error("Called setSuccessHandler on ResponseHandler with non function type for handler parameter");
    }
    this.successHandler = handler;
};

/**
 * Sets the error callback handler.
 * @param handler the callback handler.
 */
CustomResponseHandler.prototype.setErrorHandler = function (handler) {
    if (typeof handler !== "function") {
        throw new Error("Called setFailureHandler on ResponseHandler with non function type for handler parameter");
    }
    this.errorHandler = handler;
};

/**
 * A RequestTimer object to wrap the slatimer logic.
 * @return {RequestTimer} returns self.
 * @constructor
 * @author Will Reynolds
 */
function RequestTimer() {
    this.timerName = null;
    this.subTimerName = null;
    this.metaData1 = null;
    this.metaData2 = null;
    this.metaData3 = null;
    this.slaTimer = null;
    return this;
}

/**
 * Set the primary name of the timer.
 * @param timerName the name of the timer.
 * @return {RequestTimer} returns self.
 */
RequestTimer.prototype.setTimerName = function(timerName) {
    this.timerName = timerName;
    return this;
};

/**
 * Set the sub name of the timer.
 * @param subTimerName the timer sub-name.
 * @return {RequestTimer} returns self.
 */
RequestTimer.prototype.setSubTimerName = function(subTimerName) {
    this.subTimerName = subTimerName;
    return this;
};

/**
 * Sets the first metadata for the timer.
 * @param metaData1 the first metadata for the timer.
 * @return {RequestTimer} returns self.
 */
RequestTimer.prototype.setMetaData1 = function(metaData1) {
    this.metaData1 = metaData1;
    return this;
};

/**
 * Sets the second metadata for the timer.
 * @param metaData2 the second metadata for the timer.
 * @return {RequestTimer} returns self.
 */
RequestTimer.prototype.setMetaData2 = function(metaData2) {
    this.metaData2 = metaData2;
    return this;
};

/**
 * Sets the third metadata for the timer.
 * @param metaData3 the third metadata for the timer.
 * @return {RequestTimer} returns self.
 */
RequestTimer.prototype.setMetaData3 = function(metaData3) {
    this.metaData3 = metaData3;
    return this;
};

/**
 * Starts the timer running. This calls the MP_Util method to create the timer object, which also
 * starts the timer.
 */
RequestTimer.prototype.start = function() {
    MP_Util.LogInfo("<b>Timer Started</b><br /><ul>" +
        "<li>timer_name: " + this.timerName +"</li></ul>");
    this.slaTimer = MP_Util.CreateTimer(this.timerName, this.subTimerName, this.metaData1, this.metaData2, this.metaData3);
};

/**
 * Attempts to stop the slatimer (if it exists), otherwise it will simply return.
 */
RequestTimer.prototype.stop = function() {
    if(!this.slaTimer) {
        return;
    }
    MP_Util.LogInfo("<b>Timer Stopped</b><br /><ul>" +
        "<li>timer_name: " + this.timerName +"</li></ul>");
    this.slaTimer.Stop();
};

/**
 * Attempts to abort the slatimer (if it exists), otherwise it will simply return.
 */
RequestTimer.prototype.abort = function() {
    if(!this.slaTimer) {
        return;
    }
    MP_Util.LogInfo("<b>Timer Aborted</b><br /><ul>" +
        "<li>timer_name: " + this.timerName +"</li></ul>");
    this.slaTimer.Abort();
    this.slaTimer = null;
};StandardTemplates = {};
StandardTemplates["CLINICAL_LINK"] = [
    '<span>${ ((EVENT_CD_DISP) ? MP_Util.CreateClinNoteLink(PERSON_ID+".0",ENCNTR_ID+".0",EVENT_ID+".0",EVENT_CD_DISP,VIEWER_TYPE,PARENT_EVENT_ID+".0") : "--") }</span>'
].join('');

/**
 * The TableCellCallbackExtension class
 * This extension is meant to be used to provide a callback to the component
 * when the user clicks on a cell within the component table
 * @return {TableCellClickCallbackExtension} returns self
 * @constructor
 */
function TableCellClickCallbackExtension() {
    this.callback = function(event,data){ return; };
    return this;
}

TableCellClickCallbackExtension.prototype = new TableExtension();
TableCellClickCallbackExtension.prototype.constructor = TableExtension;


/**
 * Sets the callback that is triggered when the user clicks a cell within the component table
 * @param callback the callback function
 * @return {TableCellClickCallbackExtension} return self
 */
TableCellClickCallbackExtension.prototype.setCellClickCallback = function(callback) {
    if(typeof callback !== "function") {
        throw new Error("In TableCellCallbackExtension, attempted to setCallback() with non function type");
    }
    this.callback = callback;
    return this;
};

/**
 * Overrides the finalize method (this is called in the ComponentTable finalize method)
 * and attaches it to the table correctly
 * @param table the ComponentTable this extension belongs to
 */
TableCellClickCallbackExtension.prototype.finalize = function(table) {
    var self = this;
    var namespace = table.getNamespace();
    var resultData = null;
    var columnId = "";
    var data = {};
    $("#" + namespace + "tableBody").on("mouseup", ".table-cell", function(event){
        resultData = ComponentTableDataRetriever.getResultFromTable(table, this);
        columnId = ComponentTableDataRetriever.getColumnIdFromElement(table, this);
        //Set up the data to return via callback
        data = {
            "COLUMN_ID" : columnId,
            "RESULT_DATA" : resultData,
            "SOURCE" : "TableCellClickCallbackExtension:CELL_CLICK"
        };
        self.callback(event, data);
    });
};
/**
 * Defines the TableColumn class
 * This class is simply a column description that tells how a column should behave
 * @constructor
 */
function TableColumn() {
    this.columnDisplay = "&nbsp;";
    this.columnId = "";
    this.customClass = "";
    this.primarySortField = "";
    this.secondarySortFields = [];
    this.isSortable = false;
    this.sortDirection = TableColumn.SORT.NONE;
    this.template = TemplateBuilder.buildTemplate("<span>[Template Not Specified]</span>");       //Initialize with a default template
    this.width = null;
}

/**
 * Gets the display value for the column
 * @return {string} the display for the column (as appears in the header)
 */
TableColumn.prototype.getColumnDisplay = function () {
    return this.columnDisplay;
};

/**
 * Sets the column display (what is shown in the header of the column)
 * @param columnDisplay the string that is to be displayed for the column header
 * @return {TableColumn} returns self
 */
TableColumn.prototype.setColumnDisplay = function (columnDisplay) {
    if (typeof columnDisplay !== "string") {
        throw new Error("Called setColumnDisplay on TableColumn with non string type for columnDisplay parameter");
    }
    this.columnDisplay = columnDisplay;
    return this;
};

/**
 * Gets the ID of the column
 * @return {string} the column ID
 */
TableColumn.prototype.getColumnId = function () {
    return this.columnId;
};

/**
 * Sets the id of the column
 * @param columnId the id of the column
 */
TableColumn.prototype.setColumnId = function (columnId) {
    if(typeof columnId !== "string") {
        throw new Error("Called setColumnId on TableColumn with non string type for columnId parameter");
    }
    this.columnId = columnId;
    return this;
};

/**
 * Gets the custom column class
 * @return {string} the custom column class
 */
TableColumn.prototype.getCustomClass = function () {
    return this.customClass;
};

/**
 * Sets the custom class for the column
 * @param customClass set the column custom class
 */
TableColumn.prototype.setCustomClass = function (customClass) {
    if(typeof customClass !== "string") {
        throw new Error("Called setCustomClass on TableColumn with non string type for customClass parameter");
    }
    this.customClass = customClass;
    return this;
};

/**
 * Gets the value ID used for sorting
 * @return {string} the field in the JSON that we use for sorting
 */
TableColumn.prototype.getPrimarySortField = function () {
    return this.primarySortField;
};

/**
 * Sets the field ID used for sorting
 * @param primarySortField the field ID used for sorting
 */
TableColumn.prototype.setPrimarySortField = function (primarySortField) {
    if (typeof primarySortField !== "string") {
        throw new Error("Invalid data field parameter for column, must be a string");
    }
    this.primarySortField = primarySortField;
    return this;
};

/**
 * Adds a secondary sort field to the table column
 * @param field the field on which the secondary sort will be performed
 * @param direction the direction that the secondary sort should be applied (ascending or descending)
 */
TableColumn.prototype.addSecondarySortField = function (field, direction) {
    if(typeof direction !== "number") {
        throw new Error("Called addSecondarySortField on TableColumn with non number type for direction parameter");
    }
    if (!TableColumn.isValidSortDirection(direction)) {
        throw new Error("Called addSecondarySortField on TableColumn with invalid direction. Please use TableColumn.SORT.ASCENDING or TableColumn.SORT.DESCENDING");
    }
    if (typeof field !== "string") {
        throw new Error("Called addSecondarySortField on TableColumn with non string type for field parameter.");
    }
    this.secondarySortFields.push({"FIELD": field, "DIRECTION": direction});
};

TableColumn.prototype.getSecondarySortFields = function () {
    return this.secondarySortFields;
};

/**
 * Gets whether the column is sortable
 * @return {boolean} true if sortable, false otherwise
 */
TableColumn.prototype.getIsSortable = function () {
    return this.isSortable;
};

/**
 * Sets whether or not the column sortable or not
 * @param isSortable true if sortable, false otherwise
 */
TableColumn.prototype.setIsSortable = function (isSortable) {
    if (typeof isSortable !== "boolean") {
        throw new Error("Called setIsSortable on TableColumn with non boolean type for isSortable parameter");
    }
    this.isSortable = isSortable;
    return this;
};

/**
 * Sets how the column is currently sorted (ascending/descending/none)
 * @param sortDirection how the column is sorted
 */
TableColumn.prototype.setColumnSortDirection = function (sortDirection) {
    //If user attempts to use a non-number value
    if (typeof sortDirection !== "number") {
        throw new Error("Called setColumnSortDirection on TableColumn with non number type for sortDirection parameter");
    }
    //If user attempts to set an invalid value. Valid values are defined in the TableColumn.SORT object
    if (sortDirection < -1 || sortDirection > 1) {
        throw new Error("Called setColumnSortDirection on TableColumn with invalid sortDirection: " + sortDirection + " the value must be 0, -1, or 1. It " +
            "is recommended that you use TableColumn.SORT.NONE, TableColumn.SORT.ASCENDING, or TableColumn.SORT.DESCENDING");
    }
    this.sortDirection = sortDirection;
    return this;
};

/**
 * Gets how the column is currently sorted
 * @return {number} -1 = ascending, 1 = descending, 0 = none
 */
TableColumn.prototype.getColumnSortDirection = function () {
    return this.sortDirection;
};

/**
 * Gets the render template for the column
 * @return {Template} the render template for the column
 */
TableColumn.prototype.getRenderTemplate = function () {
    return this.template;
};

/**
 * Sets the render template for the column
 * @param template the render template for the column
 * @return {TableColumn} returns self
 */
TableColumn.prototype.setRenderTemplate = function (template) {
    this.template = TemplateBuilder.buildTemplate(template);
    return this;
};

/**
 * Gets the explicit width of the column.
 * @return {number} the width of the column.
 */
TableColumn.prototype.getWidth = function() {
    return this.width;
};

/**
 * Sets the explicit width of the column (in pixels).
 * @param width the width of the column in pixels.
 * @return {TableColumn} returns self.
 */
TableColumn.prototype.setWidth = function(width) {
    if(typeof width !== "number") {
        throw new Error("Called setWidth on TableColumn with non number type for width parameter");
    }
    if(width < 0) {
        throw new Error("Cannot call setWidth on TableColumn with a negative number");
    }
    this.width = width;
    return this;
};

/**
 * Helper function to determine if a sort direction is valid
 * @param sortDirection the direction of the sort
 * @return {boolean} true if the sort direction is valid
 */
TableColumn.isValidSortDirection = function(sortDirection) {
    if(typeof sortDirection !== "number") {
        throw new Error("Called isValidSortDirection on TableColumn with non number type for sortDirection parameter");
    }
    return (Math.abs(sortDirection) === 1);
};

/**
 * Just defines some sorting values so you can do things like ColumnDefinition.SORT.ASCENDING, etc.
 * @type {{ASCENDING: number, DESCENDING: number, NONE: number}}
 */
TableColumn.SORT = {
    "ASCENDING": -1,
    "DESCENDING": 1,
    "NONE": 0
};
/**
 * A table extension class that will serve to create addons for the component table
 * @constructor
 */
function TableExtension(){
    return this;
}

/**
 * The finalize method for a TableExtension.
 * @return {boolean}
 */
TableExtension.prototype.finalize = function(table) {
    throw new Error("Error, finalize method not implemented in a base TableExtension class");
};
/**
 * The TableGroup class. Serves as a container
 * for grouping functionality for the ComponentTable
 * @constructor
 */
function TableGroup() {
    this.canCollapse = true;
    this.display = "";
    this.expanded = true;
    this.groupId = "";
    this.key = "";
    this.rows = [];
    this.rowMap = {};
    this.showCount = false;
    this.groupValue = "";
}

/**
 * Binds a set of data to the group
 * @param data the set of data being bound to the group
 */
TableGroup.prototype.bindData = function(data) {
    for(var i = 0; i < data.length; i++) {
        var tableRow = new TableRow().setResultData(data[i]).setId("row" + i);
        this.rows.push(tableRow);
        this.rowMap[tableRow.getId()] = tableRow;
    }
    return this;
};

/**
 * Clears the data from the group
 */
TableGroup.prototype.clearData = function() {
    this.rows = [];
    this.rowMap = {};
};

/**
 * Gets whether the group can expand/collapse
 * @return {boolean} whether the group is collapsible
 */
TableGroup.prototype.getCanCollapse = function() {
    return this.canCollapse;
};

/**
 * Sets whether the group can expand/collapse
 * @param canCollapse if the group can be collapsed
 * @return {TableGroup} returns self
 */
TableGroup.prototype.setCanCollapse = function(canCollapse) {
    if(typeof canCollapse !== "boolean") {
        throw new Error("Called setCanCollapse on TableGroup with non boolean type for parameter canCollapse");
    }
    this.canCollapse = canCollapse;
    return this;
};

/**
 * Gets the display of the group
 * @return {string} the display of the group
 */
TableGroup.prototype.getDisplay = function(){
    return this.display;
};

/**
 * Sets the display of the group
 * @param display the value to be displayed in the group section
 * @return {*}
 */
TableGroup.prototype.setDisplay = function(display) {
    if(typeof display !== "string") {
        throw new Error("Called setDisplay on TableGroup with non string type for parameter display");
    }
    this.display = display;
    return this;
};

/**
 * Determines if the group is expanded or collapsed
 * @return {boolean} whether the group is expanded
 */
TableGroup.prototype.isExpanded = function() {
    return this.expanded;
};

/**
 * Sets whether the group is expanded or not
 * @param expanded
 */
TableGroup.prototype.setIsExpanded = function(expanded) {
    if(typeof expanded !== "boolean") {
        throw new Error("Called setIsExpanded on TableGroup with non boolean type for isExpanded parameter");
    }
    this.expanded = expanded;
    return this;
};

/**
 * Gets the id of the group
 * @return {string} the id of the group
 */
TableGroup.prototype.getGroupId = function() {
    return this.groupId;
};

/**
 * Sets the id of the group
 * @param groupId the id of the group
 * @return {TableGroup} returns self
 */
TableGroup.prototype.setGroupId = function(groupId) {
    if(typeof groupId !== "string" && typeof groupId !== "number") {
        throw new Error("Called setGroupId on TableGroup with non string type for groupId parameter");
    }
    this.groupId = groupId;
    return this;
};

/**
 * Gets the key of the group. The key is the field on which results are grouped, such as
 * ENCNTR_ID, etc.
 * @return {string} the key of the group
 */
TableGroup.prototype.getKey = function() {
    return this.key;
};

/**
 * Sets the key of the group
 * @param key the key of the group
 * @return {TableGroup} returns self
 */
TableGroup.prototype.setKey = function(key) {
    if(typeof key !== "string" && typeof key !== "number") {
        throw new Error("Called setKey on TableGroup with non string/number type for parameter key");
    }
    this.key = key;
    return this;
};

/**
 * Adds a row to the group
 * @param row the row being added
 * @return {TableGroup} returns self
 */
TableGroup.prototype.addRow = function(row) {
    if(!TableRow.prototype.isPrototypeOf(row)) {
        throw new Error("Called addRow on TableGroup with non TableRow type for row parameter");
    }
    this.rows.push(row);
    this.rowMap[row.getId()] = row;
    return this;
};

/**
 * Gets the rows belonging to the group
 * @return {Array} the list of rows belonging to the group
 */
TableGroup.prototype.getRows = function() {
    return this.rows;
};

/**
 * Returns the row with the specified id. If the row does not exist, an exception is thrown
 * @param rowId the id of the row being obtained
 * @return {TableRow}
 */
TableGroup.prototype.getRowById = function(rowId) {
    if(!this.hasRow(rowId)) {
        throw new Error("In getRowById on TableGroup, TableRow with id: " + rowId + " does not exist");
    }
    return this.rowMap[rowId];
};

/**
 * Checks if the group has the row with the specified id
 * @param rowId the id of the row we're checking for
 * @return {boolean} whether the row exists or not.
 */
TableGroup.prototype.hasRow = function(rowId) {
    return ((typeof this.rowMap[rowId] !== "undefined") && this.rowMap[rowId] !== null);
};

/**
 * Sets the list of rows belonging to the group
 * @param rows the list of rows to be set for the group
 * @return {TableGroup
 */
TableGroup.prototype.setRows = function(rows) {
    if(!(rows instanceof Array)) {
        throw new Error("Called setRows on TableGroup with non Array type for rows parameter");
    }
    this.rows = rows;
    return this;
};

/**
 * Gets whether the group is to show the count in the subsection
 * @return {boolean} whether the group is to show the count in the
 */
TableGroup.prototype.getShowCount = function() {
    return this.showCount;
};

/**
 * Sets whether the group should show the count in the subsection
 * @param showCount whether the group should show the count in the subsection (true/false)
 * @return {TableGroup} return self
 */
TableGroup.prototype.setShowCount = function(showCount) {
    if(typeof showCount !== "boolean") {
        throw new Error("Called setShowCount on TableGroup with non boolean type for showCount parameter");
    }
    this.showCount = showCount;
    return this;
};

/**
 * Gets the value of the group. The value is what the key is equal to. For example, if we want to group on
 * ENCNTR_ID (group key), we may have a group whose value is, say, 125434.0.
 * @return {string} the value of the group
 */
TableGroup.prototype.getValue = function() {
    return this.groupValue;
};

/**
 * Sets the value of the group. The value is what the key is equal to. For example, if we want to group on
 * ENCNTR_ID (group key), we may have a group whose value is, say, 125434.0.
 * @param groupValue the value of the group. (what the key is equal to).
 * @return {TableGroup} returns self.
 */
TableGroup.prototype.setValue = function(groupValue) {
    if(typeof groupValue !== "string" && typeof groupValue !== "number") {
        throw new Error("Called setValue on TableGroup with non string type for parameter value");
    }
    this.groupValue = groupValue;
    return this;
};

/**
 * Parses a group id from an element
 * @param elementId the id of the element we're parsing
 * @return {string} the id of the group parsed from the element id
 */
TableGroup.parseGroupId = function(elementId) {
    return elementId.split(":")[1];
};
/**
 * The TableGroupToggleCallbackExtension class
 * This extension is meant to be used to provide a callback to the component
 * when the user toggles a group within the component table
 * @return {TableGroupToggleCallbackExtension} returns self
 * @constructor
 */
function TableGroupToggleCallbackExtension(){
    this.callback = function(event,data){ return; };
    return this;
}

TableGroupToggleCallbackExtension.prototype = new TableExtension();
TableGroupToggleCallbackExtension.prototype.constructor = TableExtension;

/**
 * Sets the callback that is triggered when the user toggles a table group
 * @param callback the callback function
 */
TableGroupToggleCallbackExtension.prototype.setGroupToggleCallback = function(callback) {
    if(typeof callback !== "function") {
        throw new Error("Called setGroupToggleCallback on TableGroupToggleCallbackExtension with non function type for callback parameter");
    }
    this.callback = callback;
    return this;
};

/**
 * Overrides the finalize method (this is called in the ComponentTable finalize method)
 * and attaches it to the table correctly
 * @param table the ComponentTable this extension belongs to
 */
TableGroupToggleCallbackExtension.prototype.finalize = function(table) {
    var self = this;
    var namespace = table.getNamespace();
    var data = {};
    $("#" + namespace + "tableBody").on("click", ".sub-sec-hd-tgl", function(event){
        var group = table.getGroupById(TableGroup.parseGroupId($(this).parent().attr("id")));
        data = {
            "GROUP_DATA" : {
                "KEY" : group.getKey(),
                "VALUE": group.getValue(),
                "EXPANDED" : group.isExpanded(),
                "GROUP_ID" : group.getGroupId()
            }
            , "SOURCE" : "TableGroupToggleCallbackExtension:GROUP_CLICK"
        };
        self.callback(event, data);
    });
};


/**
 * The HoverExtension class. It extends the TableExtension class. This class
 * provides functionality for hovers, integrating with the ComponentTable.
 * @return {HoverExtension} returns self.
 * @constructor
 */
function HoverExtension() {
    this.hoverClass = "mpage-tooltip-hover";
    this.onHover = function () {
        return;
    };
    this.onLeave = function () {
        return;
    };
    this.target = "";
    this.tooltip = new MPageTooltip().setShowDelay(0);
    return this;
}

HoverExtension.prototype = new TableExtension();
HoverExtension.prototype.constructor = TableExtension;

HoverExtension.prototype.getHoverClass = function () {
    return this.hoverClass;
};

HoverExtension.prototype.setHoverClass = function (hoverClass) {
    if (typeof hoverClass !== "string") {
        throw new Error("Called setHoverClass on HoverExtension with non string type for hoverClass parameter");
    }
    this.hoverClass = hoverClass;
    return this;
};

/**
 * Sets the callback for a hover event.
 * @param onHover the function to be triggered on the mouse enter.
 */
HoverExtension.prototype.setOnHoverCallback = function (onHover) {
    if (typeof onHover !== "function") {
        throw new Error("Called setOnHoverCallback on HoverExtension with non function type for onHover parameter");
    }
    this.onHover = onHover;
    return this;
};

/**
 * Sets the callback for a hover event.
 * @param onLeave the function to be triggered on the mouse leave.
 */
HoverExtension.prototype.setOnLeaveCallback = function (onLeave) {
    if (typeof onLeave !== "function") {
        throw new Error("Called setOnLeaveCallback on HoverExtension with non function type for onLeave parameter");
    }
    this.onLeave = onLeave;
    return this;
};

/**
 * Gets the target for the hover extension.
 * @return {string} the target for the extension.
 */
HoverExtension.prototype.getTarget = function () {
    return this.target;
};

/**
 * Sets the target for the hover extension. This ensures the delegate is attached to the correct elements.
 * @param target the identifier, telling the extension on what to attach the delegate.
 * @return {HoverExtension} returns self
 */
HoverExtension.prototype.setTarget = function (target) {
    if (typeof target !== "string") {
        throw new Error("Called setTarget on HoverExtension with non string type for target parameter");
    }
    this.target = target;
    return this;
};

/**
 * Gets the tooltip for the extension.
 * @return {MPageTooltip} the tooltip object for the extension.
 */
HoverExtension.prototype.getTooltip = function() {
    return this.tooltip;
};

/**
 * Sets the tooltip for the extension.
 * @param tooltip the tooltip object.
 * @return {HoverExtension} returns self.
 */
HoverExtension.prototype.setTooltip = function(tooltip) {
    if(!(MPageTooltip.prototype.isPrototypeOf(tooltip))) {
        throw new Error("Called setTooltip on HoverExtension with non MPageTooltip type for tooltip parameter");
    }
    this.tooltip = tooltip;
    return this;
};

/**
 * The finalize method for the HoverExtension. It overrides the finalize method in the TableExtension class.
 * This method attaches a mouseenter and mouseleave delegate for the table body. When a mouseenter occurs,
 * the target is highlighted and a hover is shown.
 * @param table the table to which this extension belongs.
 */
HoverExtension.prototype.finalize = function (table) {
    var thiz = this;
    var tableBodyTag = "#" + table.getNamespace() + "tableBody";
    var elementMap = {};
    //Bind the mouseenter event so we know when a user has hovered into an item
    $(tableBodyTag).on("mouseenter", this.getTarget(), function (event) {
        var anchor = this;
        var anchorId = $(this).attr("id");
        //If there is a hover class specified, add it to the element
        if (thiz.getHoverClass() !== "") {
            $(this).addClass(thiz.getHoverClass());
        }
        if (!elementMap[anchorId]) {
            elementMap[anchorId] = {};
        }
        thiz.onHover(event);
        //Store of a flag that we're hovered inside this element
        elementMap[anchorId].TIMEOUT = setTimeout(function () {
            thiz.showHover(event, table, anchor);
        }, 500);
    });
    //Bind the mouseleave event
    $(tableBodyTag).on("mouseleave", this.getTarget(), function (event) {
        $(this).removeClass("mpage-tooltip-hover");
        clearTimeout(elementMap[$(this).attr("id")].TIMEOUT);
        thiz.onLeave(event);
    });
};

/**
 * Base showHover function. Must be overwritten by subclasses of the HoverExtension class.
 * @param event the hover event.
 * @param table the table to which this extension belongs.
 * @param anchor the element that will serve as the anchor to the hover.
 */
HoverExtension.prototype.showHover = function (event, table, anchor) {
    throw new Error("showHover has not been overwritten for a HoverExtension base class");
};

/**
 * The TableRowHoverExtension class. Used when you wish to
 * have a row-level hover.
 * @return {TableRowHoverExtension} returns self
 * @constructor
 * @author Will Reynolds
 */
function TableRowHoverExtension() {
    this.setTarget("dl.result-info");                 //Set the target to result-info, or each row
    this.hoverRenderer = null;                      //The hover renderer (can be either a StringTemplateRenderer or a FunctionRenderer)
    return this;
}

TableRowHoverExtension.prototype = new HoverExtension();
TableRowHoverExtension.prototype.constructor = HoverExtension;

/**
 * Gets the hover renderer
 * @return {HoverRenderer} a HoverRenderer object
 */
TableRowHoverExtension.prototype.getHoverRenderer = function () {
    return this.hoverRenderer;
};

/**
 * Sets the hover renderer
 * @param renderer either a template string or a function used for rendering.
 * @return {TableRowHoverExtension} returns self
 */
TableRowHoverExtension.prototype.setHoverRenderer = function (renderer) {
    this.hoverRenderer = HoverRenderFactory.getHoverRenderer(renderer);
    return this;
};

/**
 * Overrides the showHover method in the HoverExtension base class.
 * @param event the hover event.
 * @param table the table to which this extension belongs.
 * @param anchor the element the anchor is being anchored to.
 */
TableRowHoverExtension.prototype.showHover = function (event, table, anchor) {
    if (!this.hoverRenderer) {
        return;
    }
    var data = {};
    data.RESULT_DATA = ComponentTableDataRetriever.getResultFromTable(table, anchor);
    data.SOURCE = "TableRowHoverExtension:ROW_HOVER";
    var content = this.hoverRenderer.render(data);
    if (!content) {
        return;
    }
    //Create a new tooltip
    var tooltip = this.getTooltip();
    tooltip.setX(event.pageX).setY(event.pageY).setAnchor(anchor).setContent(this.hoverRenderer.render(data));
    tooltip.show();
};

/**
 * The TableCellHoverExtension class. Used when you want cell level hovers.
 * @return {TableCellHoverExtension} returns self
 * @constructor
 * @author Will Reynolds
 */
function TableCellHoverExtension() {
    this.setTarget("dd.table-cell");                    //Set the target of the hovers to each table cell
    this.templateMap = {};                              //A mapping of column ids to hover renderers. Allows different hover content per column
    return this;
}

TableCellHoverExtension.prototype = new HoverExtension();
TableCellHoverExtension.prototype.constructor = HoverExtension;

/**
 * Adds a hover rendering method for the specified column
 * @param column the column for which we're specifying the hover renderer
 * @param renderer how the hover is to be rendered. Either a string or a function.
 */
TableCellHoverExtension.prototype.addHoverForColumn = function (column, renderer) {
    //If you attempt to call this on a non-column object, fail
    if (!TableColumn.prototype.isPrototypeOf(column)) {
        throw new Error("Called addTemplateForColumn on TableCellHoverExtension with non TableColumn type for column parameter");
    }
    this.templateMap[column.getColumnId()] = HoverRenderFactory.getHoverRenderer(renderer);
};

/**
 * Overrides the showHover method in the HoverExtension base class.
 * @param event the hover event
 * @param table the table to which this extension belongs
 * @param anchor the element the hover is being anchored to
 */
TableCellHoverExtension.prototype.showHover = function (event, table, anchor) {
    var data = {};
    var columnId = ComponentTableDataRetriever.getColumnIdFromElement(table, anchor);
    var hoverRenderer = this.templateMap[columnId];
    if (!hoverRenderer) {
        return;
    }
    data.RESULT_DATA = ComponentTableDataRetriever.getResultFromTable(table, anchor);
    data.COLUMN_ID = columnId;
    data.SOURCE = "TableCellHoverExtension:CELL_HOVER";
    var content = hoverRenderer.render(data);
    if (!content) {
        return;
    }
    //Create a new tooltip
    var tooltip = this.getTooltip();
    tooltip.setX(event.pageX).setY(event.pageY).setAnchor(anchor).setContent(content);
    tooltip.show();
};

/**
 * A helper class used to get different HoverRenderer classes.
 * @constructor
 * @author Will Reynolds
 */
function HoverRenderFactory() {
}

/**
 * Gets a HoverRenderer object based on the object passed in. A string will return a StringTemplateRenderer, which uses
 * the string templating system. A function will return a FunctionRenderer, which uses a callback function to render the hover.
 * If neither a string nor a function are passed in, an exception is thrown.
 * @param renderObject the object that will handle rendering the hover.
 * @return {HoverRenderer} a HoverRenderer object based on the object passed in.
 */
HoverRenderFactory.getHoverRenderer = function (renderObject) {
    var renderer = null;
    //If the object is a string, we create a StringTemplateRenderer object
    if (typeof renderObject === "string") {
        renderer = new StringTemplateRenderer();
    } else if (typeof renderObject === "function") {
        renderer = new FunctionRenderer();
    } else {
        throw new Error("Called getHoverRenderer on HoverRenderFactory with invalid type for renderObject, use string or function");
    }
    //Initialize the HoverRenderer object with the object passed in
    renderer.init(renderObject);
    return renderer;
};

/**
 * An interface that will render hovers. This interface can be implemented.
 * @constructor
 * @author Will Reynolds
 */
function HoverRenderer() {
}

/**
 * The init interface method which takes in an object that will handle rendering a hover. This method
 * must be overwritten in all sub-classes.
 * @param renderObject the object that will handle rendering a hover
 */
HoverRenderer.prototype.init = function (renderObject) {
    throw new Error("HoverRenderer init method not implemented");
};

/**
 * The render method which takes in a data object. This will populate a hover with the data object. This method
 * must be overwritten in all sub-classes.
 * @param data the data object which will be injected into the hover.
 */
HoverRenderer.prototype.render = function (data) {
    throw new Error("HoverRenderer render method not implemented");
};

/**
 * The StringTemplateRenderer class. It is a sub-class of HoverRenderer. This implementation uses the string
 * templating system.
 * @constructor
 * @author Will Reynolds
 */
function StringTemplateRenderer() {
    this.template = null;
}
StringTemplateRenderer.prototype = new HoverRenderer();
StringTemplateRenderer.prototype.constructor = HoverRenderer;

/**
 * Gets the template
 * @return {Template} the renderer's template object
 */
StringTemplateRenderer.prototype.getTemplate = function () {
    return this.template;
};

/**
 * Sets the template object for the renderer
 * @param template the template object
 * @return {StringTemplateRenderer} returns self
 */
StringTemplateRenderer.prototype.setTemplate = function (template) {
    this.template = template;
    return this;
};

/**
 * Overrides the init method for the HoverRenderer interface. This init method takes the renderObject
 * and stores it as a template.
 * @param renderObject the render object which will be converted to a template. This renderObject must be a string
 * @return {StringTemplateRenderer} returns self
 */
StringTemplateRenderer.prototype.init = function (renderObject) {
    return this.setTemplate(TemplateBuilder.buildTemplate(renderObject));
};

/**
 * Overrides the render method for the HoverRenderer interface. This method simply renders the template with the
 * passed in data.
 * @param data the data to be rendered via the template.
 * @return {string} an html string rendered by the template.
 */
StringTemplateRenderer.prototype.render = function (data) {
    return this.template.render(data);
};

/**
 * The FunctionRenderer class. It is a sub-class of HoverRenderer. This implementation uses function callbacks
 * to perform rendering.
 * @constructor
 * @author Will Reynolds
 */
function FunctionRenderer() {
    this.renderFunction = function (data) {
        return "";
    };
}
FunctionRenderer.prototype = new HoverRenderer();
FunctionRenderer.prototype.constructor = HoverRenderer;

/**
 * Gets the render function
 * @return {Function} returns the function that will perform the rendering
 */
FunctionRenderer.prototype.getRenderFunction = function () {
    return this.renderFunction;
};

/**
 * Sets the render function
 * @param renderFunction the function that will handle rendering
 * @return {FunctionRenderer} returns self
 */
FunctionRenderer.prototype.setRenderFunction = function (renderFunction) {
    if (typeof renderFunction !== "function") {
        throw new Error("Called setRenderFunction on FunctionRenderer with non function type for renderFunction parameter");
    }
    this.renderFunction = renderFunction;
    return this;
};

/**
 * Overrides the init method for the HoverRenderer interface. This simply stores off the renderObject.
 * @param renderObject this will be a function that will perform rendering.
 * @return {FunctionRenderer} returns self
 */
FunctionRenderer.prototype.init = function (renderObject) {
    return this.setRenderFunction(renderObject);
};

/**
 * Overrides the render method for the HoverRenderer interface. This simply calls the renderFunction, passing
 * the data as a parameter.
 * @param data the data that is to be rendered via the renderFunction.
 * @return {string} the html string as rendered by the function.
 */
FunctionRenderer.prototype.render = function (data) {
    return this.renderFunction(data);
};

/**
 * Class for a component table row
 * @constructor
 */
function TableRow() {
    this.rowId = "";
    this.tableCells = [];
    this.resultData = null;
    return this;
}

/**
 * Store the JSON data that belongs to the row
 * @param resultData the JSON result that is associated with the row
 */
TableRow.prototype.setResultData = function (resultData) {
    if(typeof resultData !== "object") {
        throw new Error("Called setResultData on TableRow with non object type for the resultData parameter");
    }
    this.resultData = resultData;
    return this;
};

/**
 * Gets the result data associated with the row
 * @return {JSON Object} the result data associated with the row
 */
TableRow.prototype.getResultData = function () {
    return this.resultData;
};

/**
 * Gets the row id
 * @return {string} gets the row id
 */
TableRow.prototype.getId = function(){
    return this.rowId;
};

/**
 * Sets the row id
 * @param id the row id
 */
TableRow.prototype.setId = function(id) {
    this.rowId = id;
    return this;
};

/**
 * Return all results for the row
 * @return {Array} an array of results for the row
 */
TableRow.prototype.getTableCells = function () {
    return this.tableCells;
};

/**
 * Sets the results for the row
 * @param tableCells the results that belong to the row
 */
TableRow.prototype.setTableCells = function (tableCells) {
    if(!tableCells instanceof Array) {
        throw new Error("Called setTableCells on TableRow with type other than Array");
    }
    this.tableCells = tableCells;
    return this;
};

/**
 * Adds a result to the row, associated with which column it belongs in
 * @param columnId the column we're associating the result to
 * @param tableCell the result
 */
TableRow.prototype.addTableCell = function (columnId, tableCell) {
    if(typeof columnId !== "string") {
        throw new Error("Called addTableCell on TableRow and passed non string type for columnId parameter");
    }
    if(!TableCell.prototype.isPrototypeOf(tableCell)) {
        throw new Error("Called addTableCell on TableRow and passed non TableCell type for tableCell parameter");
    }
    this.tableCells[columnId] = tableCell;
};

/**
 * Gets the result in the row at the specified column
 * @param columnId the column in which we want the result
 * @return {TableCell} a result cell at the specified column
 */
TableRow.prototype.getTableCellInColumn = function (columnId) {
    if(typeof columnId !== "string") {
        throw new Error("Called getTableCellInColumn on TableRow and passed non string type for columnId parameter");
    }
    if(typeof this.tableCells[columnId] === "undefined" || this.tableCells[columnId] === null) {
        throw new Error("In method getTableCellInColumn, the columnId: " + columnId + " returned undefined or null");
    }
    return this.tableCells[columnId];
};
/**
 * Simple template class to encapsulate an html template
 * @author Will Reynolds
 * @constructor
 */
function Template() {
    this.id = "";
    this.templateFunction = null;
}

/**
 * Sets the id of the template
 * @param id the id of the template
 */
Template.prototype.setId = function(id) {
    this.id = id;
};

/**
 * Gets the id of the template
 * @return {string} the id of the template (this can be used to find it in the template cache)
 */
Template.prototype.getId = function() {
    return this.id;
};

/**
 * Set the template rendering function
 * @param templateFunction the template rendering function
 */
Template.prototype.setTemplateFunction = function(templateFunction) {
    this.templateFunction = templateFunction;
};

/**
 * Get the template rendering function
 * @return {Function} the template rendering function
 */
Template.prototype.getTemplateFunction = function() {
    return this.templateFunction;
};

/**
 * Renders the template with provided data
 * @param data the data object you wish to provide to the template
 * @return {string} the populated template
 */
Template.prototype.render = function(data) {
    data = data || {};
    try {
        return this.templateFunction(data);
    } catch(exe) {
        throw new Error("There was an error rendering the template: " + exe.message);
    }
};
/**
 * Simple template builder class
 * @author Will Reynolds
 * @constructor
 */
function TemplateBuilder() {
}

/**
 * Builds a template from a string
 * @param template a template string
 * @return {Template} a template object based on the template string passed in
 */
TemplateBuilder.buildTemplate = function(template) {
    if(typeof template !== "string") {
        throw new Error("Called buildTemplate on TemplateBuilder with non string type for template parameter");
    }
    var newTemplate = new Template();
    //Build the template rendering function
    var templateFunction = new Function("data", "var params=[];" +
        "params.push('" + template.split("${").join("');params.push(data.").split("}").join(");params.push('") + "');"+
        "return params.join('');");
    newTemplate.setTemplateFunction(templateFunction);
    return newTemplate;
};

/**
 * Creates a template AND caches it in the template cache
 * @param id the id by which the template can be accessed
 * @param template the template string
 * @return {Template} the template object created
 */
TemplateBuilder.buildAndCacheTemplate = function(id, template) {
    var templateObject = TemplateBuilder.buildTemplate(template);
    TemplateCache.cacheTemplate(id, templateObject);
    return templateObject;
};/**
 * Simple template cache class to store off constructed templates
 * @author Will Reynolds
 * @constructor
 */
function TemplateCache(){
}

TemplateCache.templates = {};

/**
 * Loads all standard template into the cache to be used later (only do this if you wish to load all templates)
 */
TemplateCache.loadStandardTemplates = function() {
    for(var templateKey in StandardTemplates) {
        var template = StandardTemplates[templateKey];
        if(template && typeof template === "string") {
            TemplateCache.cacheTemplate(templateKey, TemplateBuilder.buildTemplate(template));
        }
    }
};

/**
 * Stores a template in the cache
 * @param id the id of the template that you'll use to get it later
 * @param template the template object you're caching
 */
TemplateCache.cacheTemplate = function(id, template) {
    if(typeof id !== "string") {
        throw new Error("Called cacheTemplate on TemplateCache with non string type for id parameter");
    }
    if(!Template.prototype.isPrototypeOf(template)) {
        throw new Error("Called cacheTemplate on TemplateCache with non Template type for template parameter");
    }
    if(TemplateCache.hasTemplate(id)) {
        throw new Error("Called cacheTemplate on TemplateCache. Template with id: " + id + " already exists. Please use a different identifier.");
    }
    TemplateCache.templates[id] = template;
};

/**
 * Gets a template by the id passed in
 * @param id the id of the template one wishes to obtain
 * @return {Template} if a template exists for the id, returns that Template, otherwise returns null
 */
TemplateCache.getTemplate = function(id) {
    if(!TemplateCache.hasTemplate(id)) {
        throw new Error("Template with id: " + id + " does not exist");
    }
    return TemplateCache.templates[id];
};

/**
 * Checks if a template object exists in the cache
 * @param id the id of the template
 * @return {boolean} true if the template exists, otherwise false
 */
TemplateCache.hasTemplate = function(id) {
    return (typeof TemplateCache.templates[id] !== "undefined" && TemplateCache.templates[id] !== null);
};
function AutoSuggestControl(oComponent,oQueryHandler,oSelectionHandler,oSuggestionDisplayHandler,oItemId){this.cur=0;
this.layer=null;
this.component=oComponent;
this.queryHandler=oQueryHandler;
this.selectionHandler=oSelectionHandler;
this.suggestionDisplayHandler=oSuggestionDisplayHandler;
if(oItemId){this.textbox=_g(oComponent.getStyles().getNameSpace()+oItemId+oComponent.getComponentId());
}else{this.textbox=_g(oComponent.getStyles().getNameSpace()+"ContentCtrl"+oComponent.getComponentId());
}this.objArray="";
this.init();
}AutoSuggestControl.prototype.autosuggest=function(aSuggestions,defaultSelected){this.layer.style.width=this.textbox.offsetWidth;
this.objArray=aSuggestions;
if(aSuggestions&&aSuggestions.length>0){this.showSuggestions(aSuggestions,defaultSelected);
}else{this.hideSuggestions();
}};
AutoSuggestControl.prototype.createDropDown=function(){var oThis=this;
this.layer=document.createElement("div");
this.layer.className="suggestions";
this.layer.style.display="none";
this.layer.style.zIndex="9999";
this.layer.onmousedown=this.layer.onmouseup=this.layer.onmouseover=function(oEvent){oEvent=oEvent||window.event;
oTarget=oEvent.target||oEvent.srcElement;
var index;
if(oEvent.type=="mousedown"){index=AutoSuggestControl.prototype.indexOf(this,oTarget);
oThis.selectionHandler(oThis.objArray[index],oThis.textbox,oThis.component);
oThis.hideSuggestions();
}else{if(oEvent.type=="mouseover"){index=AutoSuggestControl.prototype.indexOf(this,oTarget);
oThis.cur=index;
oThis.highlightSuggestion(oTarget);
}else{oThis.textbox.focus();
}}};
Util.ia(this.layer,Util.gp(this.textbox));
};
AutoSuggestControl.prototype.handleKeyDown=function(oEvent){if(this.layer.style.display!="none"){switch(oEvent.keyCode){case 38:this.previousSuggestion();
break;
case 40:this.nextSuggestion();
break;
case 13:this.selectionHandler(this.objArray[this.cur],this.textbox,this.component);
this.hideSuggestions();
break;
}}};
AutoSuggestControl.prototype.handleKeyUp=function(oEvent){var iKeyCode=oEvent.keyCode;
if(iKeyCode==8||iKeyCode==46){if(this.textbox.value.length>0){this.queryHandler(this,this.textbox,this.component);
}else{this.hideSuggestions();
}}else{if(iKeyCode<32||(iKeyCode>=33&&iKeyCode<46)||(iKeyCode>=112&&iKeyCode<=123)){}else{this.queryHandler(this,this.textbox,this.component);
}}};
AutoSuggestControl.prototype.hideSuggestions=function(){var oNode=this.textbox;
while(oNode&&!Util.Style.ccss(oNode,"section")){oNode=Util.gp(oNode);
}if(oNode){oNode.style.position="relative";
oNode.style.zIndex="1";
}this.layer.style.zIndex="9999";
this.layer.style.display="none";
};
AutoSuggestControl.prototype.highlightSuggestion=function(oSuggestionNode){for(var i=0;
i<this.layer.childNodes.length;
i++){var oNode=this.layer.childNodes[i];
if(oNode==oSuggestionNode||oNode==oSuggestionNode.parentNode){oNode.className="current";
}else{if(oNode.className=="current"){oNode.className="";
}}}};
AutoSuggestControl.prototype.init=function(){var oThis=this;
this.textbox.onkeyup=function(oEvent){if(!oEvent){oEvent=window.event;
}oThis.handleKeyUp(oEvent);
};
this.textbox.onkeydown=function(oEvent){if(!oEvent){oEvent=window.event;
}oThis.handleKeyDown(oEvent);
};
this.textbox.onblur=function(){oThis.hideSuggestions();
};
this.createDropDown();
};
AutoSuggestControl.prototype.nextSuggestion=function(){var cSuggestionNodes=this.layer.childNodes;
if(cSuggestionNodes.length>0&&this.cur<cSuggestionNodes.length-1){var oNode=cSuggestionNodes[++this.cur];
this.highlightSuggestion(oNode);
}};
AutoSuggestControl.prototype.previousSuggestion=function(){var cSuggestionNodes=this.layer.childNodes;
if(cSuggestionNodes.length>0&&this.cur>0){var oNode=cSuggestionNodes[--this.cur];
this.highlightSuggestion(oNode);
}};
AutoSuggestControl.prototype.showSuggestions=function(aSuggestions,defaultSelected){var oDiv=null;
this.layer.innerHTML="";
for(var i=0;
i<aSuggestions.length;
i++){oDiv=document.createElement("div");
if(i===0&&!defaultSelected){oDiv.className="current";
}if(defaultSelected){this.cur=-1;
}else{this.cur=0;
}var domText=this.suggestionDisplayHandler(aSuggestions[i],this.textbox.value);
oDiv.innerHTML=domText;
oDiv.appendChild(document.createTextNode(""));
this.layer.appendChild(oDiv);
}var oNode=this.textbox;
while(oNode&&!Util.Style.ccss(oNode,"section")){oNode=Util.gp(oNode);
}if(oNode){oNode.style.position="relative";
oNode.style.zIndex="2";
}this.layer.style.zIndex="100000";
this.layer.style.display="block";
};
AutoSuggestControl.prototype.indexOf=function(parent,el){var nodeList=parent.childNodes;
for(var i=0;
i<nodeList.length;
i++){var oNode=nodeList[i];
if(oNode==el||oNode==el.parentNode){return i;
}}return -1;
};
AutoSuggestControl.prototype.highlight=function(value,term){return"<strong>"+value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1").split(" ").join("|")+")(?![^<>]*>)(?![^&;]+;)","gi"),"</strong>$1<strong>")+"</strong>";
};
/*
	Blackbird - Open Source JavaScript Logging Utility
	Author: G Scott Olson
	Web: http://blackbirdjs.googlecode.com/
	     http://www.gscottolson.com/blackbirdjs/
	Version: 1.0

	The MIT License - Copyright (c) 2008 Blackbird Project
*/
( function() {
	var NAMESPACE = 'log';
	var IE6_POSITION_FIXED = true; // enable IE6 {position:fixed}
	
	var bbird;
	var outputList;
	var cache = [];
	var loggingActive;
	var state = getState();
	var classes = {};
	var profiler = {};
	var IDs = {
		blackbird: 'blackbird',
		checkbox: 'bbVis',
		filters: 'bbFilters',
		controls: 'bbControls',
		size: 'bbSize'
	}
	var messageTypes = { //order of these properties imply render order of filter controls
		debug: true,
		info: true,
		warn: true,
		error: true,
		profile: true
	};
	
	function isLoggingActive(){
		return (state.active || loggingActive) ? true : false;
	}
	
	function generateMarkup() { //build markup
		var spans = [];
		for ( type in messageTypes ) {
			spans.push( [ '<span class="', type, '" type="', type, '"></span>'].join( '' ) );
		}

		var newNode = document.createElement( 'DIV' );
		newNode.id = IDs.blackbird;
		newNode.style.display = 'none';
		newNode.innerHTML = [
			'<div class="header">',
				'<div class="left">',
					'<div id="', IDs.filters, '" class="filters" title="click to filter by message type">', spans.join( '' ), '</div>',
				'</div>',
				'<div class="right">',
					'<div id="', IDs.controls, '" class="controls">',
						'<span id="', IDs.size ,'" title="contract" op="resize"></span>',
						'<span class="clear" title="clear" op="clear"></span>',
						'<span class="close" title="close" op="close"></span>',
					'</div>',
				'</div>',
			'</div>',
			'<div class="main">',
				'<div class="left"></div><div class="mainBody">',
					'<ol>', cache.join( '' ), '</ol>',
				'</div><div class="right"></div>',
			'</div>'/*,
			'<div class="footer">',
				'<div class="left"><label for="', IDs.checkbox, '"><input type="checkbox" id="', IDs.checkbox, '" />Visible on page load</label></div>',
				'<div class="right"></div>',
			'</div>'*/
		].join( '' );
		return newNode;
	}

	function backgroundImage() { //(IE6 only) change <BODY> tag's background to resolve {position:fixed} support
		var bodyTag = document.getElementsByTagName( 'BODY' )[ 0 ];
		
		if ( bodyTag.currentStyle && IE6_POSITION_FIXED ) {
			if (bodyTag.currentStyle.backgroundImage == 'none' ) {
				bodyTag.style.backgroundImage = 'url(about:blank)';
			}
			if (bodyTag.currentStyle.backgroundAttachment == 'scroll' ) {
				bodyTag.style.backgroundAttachment = 'fixed';
			}
		}
	}

	function addMessage( type, content ) { //adds a message to the output list
		content = ( content.constructor == Array ) ? content.join( '' ) : content;
		if ( outputList ) {
			var newMsg = document.createElement( 'LI' );
			newMsg.className = type;
			newMsg.innerHTML = [ '<span class="icon"></span>', content ].join( '' );
			outputList.appendChild( newMsg );
			scrollToBottom();
		} else {
			cache.push( [ '<li class="', type, '"><span class="icon"></span>', content, '</li>' ].join( '' ) );
		}
	}
	
	function clear() { //clear list output
		outputList.innerHTML = '';
	}
	
	function clickControl( evt ) {
		if ( !evt ) evt = window.event;
		var el = ( evt.target ) ? evt.target : evt.srcElement;

		if ( el.tagName == 'SPAN' ) {
			switch ( el.getAttributeNode( 'op' ).nodeValue ) {
				case 'resize': resize(); break;
				case 'clear':  clear();  break;
				case 'close':  hide();   break;
			}
		}
	}
	
	function clickFilter( evt ) { //show/hide a specific message type
		if ( !evt ) evt = window.event;
		var span = ( evt.target ) ? evt.target : evt.srcElement;

		if ( span && span.tagName == 'SPAN' ) {

			var type = span.getAttributeNode( 'type' ).nodeValue;

			if ( evt.altKey ) {
				var filters = document.getElementById( IDs.filters ).getElementsByTagName( 'SPAN' );

				var active = 0;
				for ( entry in messageTypes ) {
					if ( messageTypes[ entry ] ) active++;
				}
				var oneActiveFilter = ( active == 1 && messageTypes[ type ] );

				for ( var i = 0; filters[ i ]; i++ ) {
					var spanType = filters[ i ].getAttributeNode( 'type' ).nodeValue;

					filters[ i ].className = ( oneActiveFilter || ( spanType == type ) ) ? spanType : spanType + 'Disabled';
					messageTypes[ spanType ] = oneActiveFilter || ( spanType == type );
				}
			}
			else {
				messageTypes[ type ] = ! messageTypes[ type ];
				span.className = ( messageTypes[ type ] ) ? type : type + 'Disabled';
			}

			//build outputList's class from messageTypes object
			var disabledTypes = [];
			for ( type in messageTypes ) {
				if ( ! messageTypes[ type ] ) disabledTypes.push( type );
			}
			disabledTypes.push( '' );
			outputList.className = disabledTypes.join( 'Hidden ' );

			scrollToBottom();
		}
	}

	function clickVis( evt ) {
		if ( !evt ) evt = window.event;
		var el = ( evt.target ) ? evt.target : evt.srcElement;

		state.load = el.checked;
		setState();
	}
	
	
	function scrollToBottom() { //scroll list output to the bottom
		outputList.scrollTop = outputList.scrollHeight;
	}
	
	function isVisible() { //determine the visibility
		return ( bbird.style.display == 'block' );
	}

	function hide() { 
	  bbird.style.display = 'none';
	}
			
	function show() {
		var body = document.getElementsByTagName( 'BODY' )[ 0 ];
		body.removeChild( bbird );
		body.appendChild( bbird );
		bbird.style.display = 'block';
	}
	
	//sets the position
	function reposition( position ) {
		if ( position === undefined || position == null ) {
			position = ( state && state.pos === null ) ? 1 : ( state.pos + 1 ) % 4; //set to initial position ('topRight') or move to next position
		}
				
		switch ( position ) {
			case 0: classes[ 0 ] = 'bbTopLeft'; break;
			case 1: classes[ 0 ] = 'bbTopRight'; break;
			case 2: classes[ 0 ] = 'bbBottomLeft'; break;
			case 3: classes[ 0 ] = 'bbBottomRight'; break;
		}
		state.pos = position;
		setState();
	}

	function resize( size ) {
		if ( size === undefined || size === null ) {
			size = ( state && state.size == null ) ? 1 : ( state.size + 1 ) % 2;
	  	}

		classes[ 1 ] = ( size === 0 ) ? 'bbSmall' : 'bbLarge'

		var span = document.getElementById( IDs.size );
		span.title = ( size === 1 ) ? 'small' : 'large';
		span.className = span.title;	  

		state.size = size;
		setState();
		scrollToBottom();
	}

	function setLogging(){
		state.active = true;
		state.load = true;
		state.size = 1;
		setState();
	}
	
	function setState() {
		var props = [];
		for ( entry in state ) {
			var value = ( state[ entry ] && state[ entry ].constructor === String ) ? '"' + state[ entry ] + '"' : state[ entry ]; 
			props.push( entry + ':' + value );
		}
		props = props.join( ',' );
		
		var expiration = new Date();
		expiration.setDate( expiration.getDate() + 14 );
		document.cookie = [ 'blackbird={', props, '};'].join( '' );

		var newClass = [];
		for ( word in classes ) {
			newClass.push( classes[ word ] );
		}
		bbird.className = newClass.join( ' ' );
	}
	
	function getState() {
		var re = new RegExp( /blackbird=({[^;]+})(;|\b|$)/ );
		var match = re.exec( document.cookie );
		return ( match && match[ 1 ] ) ? eval( '(' + match[ 1 ] + ')' ) : { pos:null, size:null, load:null, active:null };
	}
	
	//event handler for 'keyup' event for window
	function readKey( evt ) {
		if ( !evt ) evt = window.event;
		var code = 113; //F2 key
					
		if ( evt && evt.keyCode == code ) {
					
			var visible = isVisible();
					
			if ( visible && evt.shiftKey && evt.altKey ) clear();
			else if	 (visible && evt.shiftKey ) reposition();
			else if ( !evt.shiftKey && !evt.altKey ) {
			  if(isLoggingActive()){
			    ( visible ) ? hide() : show();
			  }
			}
		}
	}

	//event management ( thanks John Resig )
	function addEvent( obj, type, fn ) {
		var obj = ( obj.constructor === String ) ? document.getElementById( obj ) : obj;
		if ( obj.attachEvent ) {
			obj[ 'e' + type + fn ] = fn;
			obj[ type + fn ] = function(){ obj[ 'e' + type + fn ]( window.event ) };
			obj.attachEvent( 'on' + type, obj[ type + fn ] );
		} else obj.addEventListener( type, fn, false );
	}
	function removeEvent( obj, type, fn ) {
		var obj = ( obj.constructor === String ) ? document.getElementById( obj ) : obj;		
		if ( obj.detachEvent ) {
			if (obj[ type + fn ] != undefined)
            {
				obj.detachEvent( 'on' + type, obj[ type + fn ] );
			}
			obj[ type + fn ] = null;
	  } else {
		obj.removeEventListener( type, fn, false );
	  }
	}
	
	window[ NAMESPACE ] = {
		toggle:
			function() { if(isLoggingActive()){( isVisible() ) ? hide() : show(); }},
		resize:
			function() { resize(); },
		clear:
			function() { clear(); },
		move:
			function() { reposition(); },
		debug: 
			function( msg ) { if(isLoggingActive()){addMessage( 'debug', msg ); }},
		warn:
			function( msg ) { if(isLoggingActive()){addMessage( 'warn', msg ); }},
		info:
			function( msg ) { if(isLoggingActive()){addMessage( 'info', msg ); }},
		error: 
			function( msg ) { if(isLoggingActive()){addMessage( 'error', msg ); }},
		activateLogging:
			function(){
				//Set the state.active to true
				setLogging();
			},
		profile: 
			function( label ) {
				var currentTime = new Date(); //record the current time when profile() is executed
				
				if ( label == undefined || label == '' ) {
					addMessage( 'error', '<b>ERROR:</b> Please specify a label for your profile statement' );
				}
				else if ( profiler[ label ] ) {
					addMessage( 'profile', [ label, ': ', currentTime - profiler[ label ],	'ms' ].join( '' ) );
					delete profiler[ label ];
				}
				else {
					profiler[ label ] = currentTime;
					addMessage( 'profile', label );
				}
				return currentTime;
			},
		isBlackBirdActive:
			function() {
				return isLoggingActive();
			}
	}

	addEvent( window, 'load', 
		/* initialize Blackbird when the page loads */
		function() {
			var body = document.getElementsByTagName( 'BODY' )[ 0 ];
			bbird = body.appendChild( generateMarkup() );
			outputList = bbird.getElementsByTagName( 'OL' )[ 0 ];
		
			backgroundImage();
		
			//add events
			//addEvent( IDs.checkbox, 'click', clickVis );
			addEvent( IDs.filters, 'click', clickFilter );
			addEvent( IDs.controls, 'click', clickControl );
			addEvent( document, 'keyup', readKey);

			resize( state.size );
			reposition( state.pos );
			if ( state.load ) {
				show();
				//document.getElementById( IDs.checkbox ).checked = true; 
			}

			scrollToBottom();

			window[ NAMESPACE ].init = function() {
				show();
				window[ NAMESPACE ].error( [ '<b>', NAMESPACE, '</b> can only be initialized once' ] );
			}

			addEvent( window, 'unload', function() {
				//removeEvent( IDs.checkbox, 'click', clickVis );
				removeEvent( IDs.filters, 'click', clickFilter );
				removeEvent( IDs.controls, 'click', clickControl );
				removeEvent( document, 'keyup', readKey );
			});
			
			if(state.active){
				//Prevent logging from occuring next reload
				loggingActive = true;
				state.active = false;
				state.load = false;
				state.size = 1;
				setState();
			}
		});
})();mp_formatter={};
mp_formatter.Locale=function(properties){this._className="mp_formatter.Locale";
this._parseList=function(names,expectedItems){var array=[];
if(names===null){throw"Names not defined";
}else{if(typeof names=="object"){array=names;
}else{if(typeof names=="string"){array=names.split(";",expectedItems);
for(var i=0;
i<array.length;
i++){if(array[i][0]=='"'&&array[i][array[i].length-1]=='"'){array[i]=array[i].slice(1,-1);
}else{throw"Missing double quotes";
}}}else{throw"Names must be an array or a string";
}}}if(array.length!=expectedItems){throw"Expected "+expectedItems+" items, got "+array.length;
}return array;
};
this._validateFormatString=function(formatString){if(typeof formatString=="string"&&formatString.length>0){return formatString;
}else{throw"Empty or no string";
}};
if(properties===null||typeof properties!="object"){throw"Error: Invalid/missing locale properties";
}if(typeof properties.decimal_point!="string"){throw"Error: Invalid/missing decimal_point property";
}this.decimal_point=properties.decimal_point;
if(typeof properties.thousands_sep!="string"){throw"Error: Invalid/missing thousands_sep property";
}this.thousands_sep=properties.thousands_sep;
if(typeof properties.grouping!="string"){throw"Error: Invalid/missing grouping property";
}this.grouping=properties.grouping;
if(properties===null||typeof properties!="object"){throw"Error: Invalid/missing time locale properties";
}try{this.time24hr=this._validateFormatString(properties.time24hr);
}catch(error){throw"Error: Invalid time24hr property: "+error;
}try{this.time24hrnosec=this._validateFormatString(properties.time24hrnosec);
}catch(error){throw"Error: Invalid time24hrnosec property: "+error;
}try{this.shortdate2yr=this._validateFormatString(properties.shortdate2yr);
}catch(error){throw"Error: Invalid shortdate2yr property: "+error;
}try{this.fulldate4yr=this._validateFormatString(properties.fulldate4yr);
}catch(error){throw"Error: Invalid fulldate4yr property: "+error;
}try{this.fulldate2yr=this._validateFormatString(properties.fulldate2yr);
}catch(error){throw"Error: Invalid fulldate2yr property: "+error;
}try{this.fullmonth4yrnodate=this._validateFormatString(properties.fullmonth4yrnodate);
}catch(error){throw"Error: Invalid fullmonth4yrnodate property: "+error;
}try{this.full4yr=this._validateFormatString(properties.full4yr);
}catch(error){throw"Error: Invalid full4yr property: "+error;
}try{this.fulldatetime2yr=this._validateFormatString(properties.fulldatetime2yr);
}catch(error){throw"Error: Invalid fulldatetime2yr property: "+error;
}try{this.fulldatetime4yr=this._validateFormatString(properties.fulldatetime4yr);
}catch(error){throw"Error: Invalid fulldatetime4yr property: "+error;
}try{this.fulldatetimenoyr=this._validateFormatString(properties.fulldatetimenoyr);
}catch(error){throw"Error: Invalid fulldatetimenoyr property: "+error;
}};
mp_formatter._getPrecision=function(optionsString){if(typeof optionsString!="string"){return -1;
}var m=optionsString.match(/\.(\d)/);
if(m){return parseInt(m[1],10);
}else{return -1;
}};
mp_formatter._isNumber=function(arg){if(typeof arg=="number"){return true;
}if(typeof arg!="string"){return false;
}var s=arg+"";
return(/^-?(\d+|\d*\.\d+)$/).test(s);
};
mp_formatter._isDate=function(arg){if(arg.getDate){return true;
}return false;
};
mp_formatter._trim=function(str){var whitespace=" \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000";
for(var i=0;
i<str.length;
i++){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(i);
break;
}}for(i=str.length-1;
i>=0;
i--){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(0,i+1);
break;
}}return whitespace.indexOf(str.charAt(0))===-1?str:"";
};
mp_formatter._splitNumber=function(amount){if(typeof amount=="number"){amount=amount+"";
}var obj={};
if(amount.charAt(0)=="-"){amount=amount.substring(1);
}var amountParts=amount.split(".");
if(!amountParts[1]){amountParts[1]="";
}obj.integer=amountParts[0];
obj.fraction=amountParts[1];
return obj;
};
mp_formatter._formatIntegerPart=function(intPart,grouping,thousandsSep){if(thousandsSep===""||grouping=="-1"){return intPart;
}var groupSizes=grouping.split(";");
var out="";
var pos=intPart.length;
var size;
while(pos>0){if(groupSizes.length>0){size=parseInt(groupSizes.shift(),10);
}if(isNaN(size)){throw"Error: Invalid grouping";
}if(size==-1){out=intPart.substring(0,pos)+out;
break;
}pos-=size;
if(pos<1){out=intPart.substring(0,pos+size)+out;
break;
}out=thousandsSep+intPart.substring(pos,pos+size)+out;
}return out;
};
mp_formatter._formatFractionPart=function(fracPart,precision){for(var i=0;
fracPart.length<precision;
i++){fracPart=fracPart+"0";
}return fracPart;
};
mp_formatter._hasOption=function(option,optionsString){if(typeof option!="string"||typeof optionsString!="string"){return false;
}if(optionsString.indexOf(option)!=-1){return true;
}else{return false;
}};
mp_formatter._validateFormatString=function(formatString){if(typeof formatString=="string"&&formatString.length>0){return true;
}else{return false;
}};
mp_formatter.NumericFormatter=function(locale){if(typeof locale!="object"||locale._className!="mp_formatter.Locale"){throw"Constructor error: You must provide a valid mp_formatter.Locale instance";
}this.lc=locale;
this.format=function(number,options){if(typeof number=="string"){number=mp_formatter._trim(number);
}if(!mp_formatter._isNumber(number)){throw"Error: The input is not a number";
}var floatAmount=parseFloat(number,10);
var reqPrecision=mp_formatter._getPrecision(options);
if(reqPrecision!=-1){floatAmount=Math.round(floatAmount*Math.pow(10,reqPrecision))/Math.pow(10,reqPrecision);
}var parsedAmount=mp_formatter._splitNumber(String(floatAmount));
var formattedIntegerPart;
if(floatAmount===0){formattedIntegerPart="0";
}else{formattedIntegerPart=mp_formatter._hasOption("^",options)?parsedAmount.integer:mp_formatter._formatIntegerPart(parsedAmount.integer,this.lc.grouping,this.lc.thousands_sep);
}var formattedFractionPart=reqPrecision!=-1?mp_formatter._formatFractionPart(parsedAmount.fraction,reqPrecision):parsedAmount.fraction;
var formattedAmount=formattedFractionPart.length?formattedIntegerPart+this.lc.decimal_point+formattedFractionPart:formattedIntegerPart;
if(mp_formatter._hasOption("~",options)||floatAmount===0){return formattedAmount;
}else{if(mp_formatter._hasOption("+",options)||floatAmount<0){if(floatAmount>0){return"+"+formattedAmount;
}else{if(floatAmount<0){return"-"+formattedAmount;
}else{return formattedAmount;
}}}else{return formattedAmount;
}}};
};
mp_formatter.DateTimeFormatter=function(locale){if(typeof locale!="object"||locale._className!="mp_formatter.Locale"){throw"Constructor error: You must provide a valid mp_formatter.Locale instance";
}this.lc=locale;
this.formatISO8601=function(dateStr,option){if(!mp_formatter._validateFormatString(dateStr)){throw"Error: The input is either empty or no string";
}var date=new Date();
date.setISO8601(dateStr);
return this.format(date,option);
};
this.format=function(dateTime,option){if(!mp_formatter._isDate(dateTime)){throw"Error: The input is not a date object";
}switch(option){case mp_formatter.DateTimeFormatter.TIME_24HOUR:return dateTime.format(this.lc.time24hr);
case mp_formatter.DateTimeFormatter.TIME_24HOUR_NO_SECONDS:return dateTime.format(this.lc.time24hrnosec);
case mp_formatter.DateTimeFormatter.SHORT_DATE_2YEAR:return dateTime.format(this.lc.shortdate2yr);
case mp_formatter.DateTimeFormatter.FULL_DATE_4YEAR:return dateTime.format(this.lc.fulldate4yr);
case mp_formatter.DateTimeFormatter.FULL_DATE_2YEAR:return dateTime.format(this.lc.fulldate2yr);
case mp_formatter.DateTimeFormatter.FULL_MONTH_4YEAR_NO_DATE:return dateTime.format(this.lc.fullmonth4yrnodate);
case mp_formatter.DateTimeFormatter.FULL_4YEAR:return dateTime.format(this.lc.full4yr);
case mp_formatter.DateTimeFormatter.FULL_DATE_TIME_2YEAR:return dateTime.format(this.lc.fulldatetime2yr);
case mp_formatter.DateTimeFormatter.FULL_DATE_TIME_4YEAR:return dateTime.format(this.lc.fulldatetime4yr);
case mp_formatter.DateTimeFormatter.FULL_DATE_TIME_NO_YEAR:return dateTime.format(this.lc.fulldatetimenoyr);
default:alert("Unhandled date time formatting option");
}};
};
mp_formatter.DateTimeFormatter.TIME_24HOUR=1;
mp_formatter.DateTimeFormatter.TIME_24HOUR_NO_SECONDS=2;
mp_formatter.DateTimeFormatter.SHORT_DATE_2YEAR=3;
mp_formatter.DateTimeFormatter.FULL_DATE_4YEAR=4;
mp_formatter.DateTimeFormatter.FULL_DATE_2YEAR=5;
mp_formatter.DateTimeFormatter.FULL_MONTH_4YEAR_NO_DATE=6;
mp_formatter.DateTimeFormatter.FULL_4YEAR=7;
mp_formatter.DateTimeFormatter.FULL_DATE_TIME_2YEAR=8;
mp_formatter.DateTimeFormatter.FULL_DATE_TIME_4YEAR=9;
mp_formatter.DateTimeFormatter.FULL_DATE_TIME_NO_YEAR=10;
var _canLog=true;
function _log(mode,msg){if(!_canLog){return;
}var args=Array.prototype.slice.apply(arguments,[1]);
var dt=new Date();
var tag=dt.getHours()+":"+dt.getMinutes()+":"+dt.getSeconds()+"."+dt.getMilliseconds();
args[0]=tag+" - "+args[0];
try{switch(mode){case"info":window.console.info.apply(window.console,args);
break;
case"warn":window.console.warn.apply(window.console,args);
break;
default:window.console.log.apply(window.console,args);
break;
}}catch(e){if(!window.console){_canLog=false;
}}}function logMsg(msg){Array.prototype.unshift.apply(arguments,["debug"]);
_log.apply(this,arguments);
}var getDynaTreePersistData=null;
var DTNodeStatus_Error=-1;
var DTNodeStatus_Loading=1;
var DTNodeStatus_Ok=0;
(function($){var Class={create:function(){return function(){this.initialize.apply(this,arguments);
};
}};
function getDtNodeFromElement(el){alert("getDtNodeFromElement is deprecated");
return $.ui.dynatree.getNode(el);
}function noop(){}var DynaTreeNode=Class.create();
DynaTreeNode.prototype={initialize:function(parent,tree,data){this.parent=parent;
this.tree=tree;
if(typeof data==="string"){data={title:data};
}if(data.key===undefined){data.key="_"+tree._nodeCount++;
}this.data=$.extend({},$.ui.dynatree.nodedatadefaults,data);
this.li=null;
this.span=null;
this.ul=null;
this.childList=null;
this._isLoading=false;
this.hasSubSel=false;
this.bExpanded=false;
this.bSelected=false;
},toString:function(){return"DynaTreeNode<"+this.data.key+">: '"+this.data.title+"'";
},toDict:function(recursive,callback){var dict=$.extend({},this.data);
dict.activate=(this.tree.activeNode===this);
dict.focus=(this.tree.focusNode===this);
dict.expand=this.bExpanded;
dict.select=this.bSelected;
if(callback){callback(dict);
}if(recursive&&this.childList){dict.children=[];
for(var i=0,l=this.childList.length;
i<l;
i++){dict.children.push(this.childList[i].toDict(true,callback));
}}else{delete dict.children;
}return dict;
},fromDict:function(dict){var children=dict.children;
if(children===undefined){this.data=$.extend(this.data,dict);
this.render();
return;
}dict=$.extend({},dict);
dict.children=undefined;
this.data=$.extend(this.data,dict);
this.removeChildren();
this.addChild(children);
},_getInnerHtml:function(){var tree=this.tree,opts=tree.options,cache=tree.cache,level=this.getLevel(),data=this.data,res="";
if(level<opts.minExpandLevel){if(level>1){res+=cache.tagConnector;
}}else{if(this.hasChildren()!==false){res+=cache.tagExpander;
}else{res+=cache.tagConnector;
}}if(opts.checkbox&&data.hideCheckbox!==true&&!data.isStatusNode){res+=cache.tagCheckbox;
}if(data.icon){res+="<img src='"+opts.imagePath+data.icon+"' alt='' />";
}else{if(data.icon===false){noop();
}else{res+=cache.tagNodeIcon;
}}var nodeTitle="";
if(opts.onCustomRender){nodeTitle=opts.onCustomRender.call(tree,this)||"";
}if(!nodeTitle){var tooltip=data.tooltip?' title="'+data.tooltip.replace(/\"/g,"&quot;")+'"':"",href=data.href||"#";
if(opts.noLink||data.noLink){nodeTitle='<span style="display:inline-block;" class="'+opts.classNames.title+'"'+tooltip+">"+data.title+"</span>";
}else{nodeTitle='<a href="'+href+'" class="'+opts.classNames.title+'"'+tooltip+">"+data.title+"</a>";
}}res+=nodeTitle;
return res;
},_fixOrder:function(){var cl=this.childList;
if(!cl||!this.ul){return;
}var childLI=this.ul.firstChild;
for(var i=0,l=cl.length-1;
i<l;
i++){var childNode1=cl[i];
var childNode2=childLI.dtnode;
if(childNode1!==childNode2){this.tree.logDebug("_fixOrder: mismatch at index "+i+": "+childNode1+" != "+childNode2);
this.ul.insertBefore(childNode1.li,childNode2.li);
}else{childLI=childLI.nextSibling;
}}},render:function(useEffects,includeInvisible){var tree=this.tree,parent=this.parent,data=this.data,opts=tree.options,cn=opts.classNames,isLastSib=this.isLastSibling(),firstTime=false;
if(!parent&&!this.ul){this.li=this.span=null;
this.ul=document.createElement("ul");
if(opts.minExpandLevel>1){this.ul.className=cn.container+" "+cn.noConnector;
}else{this.ul.className=cn.container;
}}else{if(parent){if(!this.li){firstTime=true;
this.li=document.createElement("li");
this.li.dtnode=this;
if(data.key&&opts.generateIds){this.li.id=opts.idPrefix+data.key;
}this.span=document.createElement("span");
this.span.className=cn.title;
this.li.appendChild(this.span);
if(!parent.ul){parent.ul=document.createElement("ul");
parent.ul.style.display="none";
parent.li.appendChild(parent.ul);
}parent.ul.appendChild(this.li);
}this.span.innerHTML=this._getInnerHtml();
var cnList=[];
cnList.push(cn.node);
if(data.isFolder){cnList.push(cn.folder);
}if(this.bExpanded){cnList.push(cn.expanded);
}if(this.hasChildren()!==false){cnList.push(cn.hasChildren);
}if(data.isLazy&&this.childList===null){cnList.push(cn.lazy);
}if(isLastSib){cnList.push(cn.lastsib);
}if(this.bSelected){cnList.push(cn.selected);
}if(this.hasSubSel){cnList.push(cn.partsel);
}if(tree.activeNode===this){cnList.push(cn.active);
}if(data.addClass){cnList.push(data.addClass);
}cnList.push(cn.combinedExpanderPrefix+(this.bExpanded?"e":"c")+(data.isLazy&&this.childList===null?"d":"")+(isLastSib?"l":""));
cnList.push(cn.combinedIconPrefix+(this.bExpanded?"e":"c")+(data.isFolder?"f":""));
this.span.className=cnList.join(" ");
this.li.className=isLastSib?cn.lastsib:"";
if(firstTime&&opts.onCreate){opts.onCreate.call(tree,this,this.span);
}if(opts.onRender){opts.onRender.call(tree,this,this.span);
}}}if((this.bExpanded||includeInvisible===true)&&this.childList){for(var i=0,l=this.childList.length;
i<l;
i++){this.childList[i].render(false,includeInvisible);
}this._fixOrder();
}if(this.ul){var isHidden=(this.ul.style.display==="none");
var isExpanded=!!this.bExpanded;
if(useEffects&&opts.fx&&(isHidden===isExpanded)){var duration=opts.fx.duration||200;
$(this.ul).animate(opts.fx,duration);
}else{this.ul.style.display=(this.bExpanded||!parent)?"":"none";
}}},getKeyPath:function(excludeSelf){var path=[];
this.visitParents(function(node){if(node.parent){path.unshift(node.data.key);
}},!excludeSelf);
return"/"+path.join(this.tree.options.keyPathSeparator);
},getParent:function(){return this.parent;
},getChildren:function(){if(this.hasChildren()===undefined){return undefined;
}return this.childList;
},hasChildren:function(){if(this.data.isLazy){if(this.childList===null||this.childList===undefined){return undefined;
}else{if(this.childList.length===0){return false;
}else{if(this.childList.length===1&&this.childList[0].isStatusNode()){return undefined;
}}}return true;
}return !!this.childList;
},isFirstSibling:function(){var p=this.parent;
return !p||p.childList[0]===this;
},isLastSibling:function(){var p=this.parent;
return !p||p.childList[p.childList.length-1]===this;
},isLoading:function(){return !!this._isLoading;
},getPrevSibling:function(){if(!this.parent){return null;
}var ac=this.parent.childList;
for(var i=1,l=ac.length;
i<l;
i++){if(ac[i]===this){return ac[i-1];
}}return null;
},getNextSibling:function(){if(!this.parent){return null;
}var ac=this.parent.childList;
for(var i=0,l=ac.length-1;
i<l;
i++){if(ac[i]===this){return ac[i+1];
}}return null;
},isStatusNode:function(){return(this.data.isStatusNode===true);
},isChildOf:function(otherNode){return(this.parent&&this.parent===otherNode);
},isDescendantOf:function(otherNode){if(!otherNode){return false;
}var p=this.parent;
while(p){if(p===otherNode){return true;
}p=p.parent;
}return false;
},countChildren:function(){var cl=this.childList;
if(!cl){return 0;
}var n=cl.length;
for(var i=0,l=n;
i<l;
i++){var child=cl[i];
n+=child.countChildren();
}return n;
},sortChildren:function(cmp,deep){var cl=this.childList;
if(!cl){return;
}cmp=cmp||function(a,b){var x=a.data.title.toLowerCase(),y=b.data.title.toLowerCase();
return x===y?0:x>y?1:-1;
};
cl.sort(cmp);
if(deep){for(var i=0,l=cl.length;
i<l;
i++){if(cl[i].childList){cl[i].sortChildren(cmp,"$norender$");
}}}if(deep!=="$norender$"){this.render();
}},_setStatusNode:function(data){var firstChild=(this.childList?this.childList[0]:null);
if(!data){if(firstChild&&firstChild.isStatusNode()){try{if(this.ul){this.ul.removeChild(firstChild.li);
firstChild.li=null;
}}catch(e){}if(this.childList.length===1){this.childList=[];
}else{this.childList.shift();
}}}else{if(firstChild){data.isStatusNode=true;
data.key="_statusNode";
firstChild.data=data;
firstChild.render();
}else{data.isStatusNode=true;
data.key="_statusNode";
firstChild=this.addChild(data);
}}},setLazyNodeStatus:function(lts,opts){var tooltip=(opts&&opts.tooltip)?opts.tooltip:null,info=(opts&&opts.info)?" ("+opts.info+")":"";
switch(lts){case DTNodeStatus_Ok:this._setStatusNode(null);
$(this.span).removeClass(this.tree.options.classNames.nodeLoading);
this._isLoading=false;
if(this.tree.options.autoFocus){if(this===this.tree.tnRoot&&this.childList&&this.childList.length>0){this.childList[0].focus();
}else{this.focus();
}}break;
case DTNodeStatus_Loading:this._isLoading=true;
$(this.span).addClass(this.tree.options.classNames.nodeLoading);
if(!this.parent){this._setStatusNode({title:this.tree.options.strings.loading+info,tooltip:tooltip,addClass:this.tree.options.classNames.nodeWait});
}break;
case DTNodeStatus_Error:this._isLoading=false;
this._setStatusNode({title:this.tree.options.strings.loadError+info,tooltip:tooltip,addClass:this.tree.options.classNames.nodeError});
break;
default:throw"Bad LazyNodeStatus: '"+lts+"'.";
}},_parentList:function(includeRoot,includeSelf){var l=[];
var dtn=includeSelf?this:this.parent;
while(dtn){if(includeRoot||dtn.parent){l.unshift(dtn);
}dtn=dtn.parent;
}return l;
},getLevel:function(){var level=0;
var dtn=this.parent;
while(dtn){level++;
dtn=dtn.parent;
}return level;
},_getTypeForOuterNodeEvent:function(event){var cns=this.tree.options.classNames;
var target=event.target;
if(target.className.indexOf(cns.node)<0){return null;
}var eventX=event.pageX-target.offsetLeft;
var eventY=event.pageY-target.offsetTop;
for(var i=0,l=target.childNodes.length;
i<l;
i++){var cn=target.childNodes[i];
var x=cn.offsetLeft-target.offsetLeft;
var y=cn.offsetTop-target.offsetTop;
var nx=cn.clientWidth,ny=cn.clientHeight;
if(eventX>=x&&eventX<=(x+nx)&&eventY>=y&&eventY<=(y+ny)){if(cn.className==cns.title){return"title";
}else{if(cn.className==cns.expander){return"expander";
}else{if(cn.className==cns.checkbox){return"checkbox";
}else{if(cn.className==cns.nodeIcon){return"icon";
}}}}}}return"prefix";
},getEventTargetType:function(event){var tcn=event&&event.target?event.target.className:"",cns=this.tree.options.classNames;
if(tcn===cns.title){return"title";
}else{if(tcn===cns.expander){return"expander";
}else{if(tcn===cns.checkbox){return"checkbox";
}else{if(tcn===cns.nodeIcon){return"icon";
}else{if(tcn===cns.empty||tcn===cns.vline||tcn===cns.connector){return"prefix";
}else{if(tcn.indexOf(cns.node)>=0){return this._getTypeForOuterNodeEvent(event);
}}}}}}return null;
},isVisible:function(){var parents=this._parentList(true,false);
for(var i=0,l=parents.length;
i<l;
i++){if(!parents[i].bExpanded){return false;
}}return true;
},makeVisible:function(){var parents=this._parentList(true,false);
for(var i=0,l=parents.length;
i<l;
i++){parents[i]._expand(true);
}},focus:function(){this.makeVisible();
try{$(this.span).find(">a").focus();
}catch(e){}},isFocused:function(){return(this.tree.tnFocused===this);
},_activate:function(flag,fireEvents){this.tree.logDebug("dtnode._activate(%o, fireEvents=%o) - %o",flag,fireEvents,this);
var opts=this.tree.options;
if(this.data.isStatusNode){return;
}if(fireEvents&&opts.onQueryActivate&&opts.onQueryActivate.call(this.tree,flag,this)===false){return;
}if(flag){if(this.tree.activeNode){if(this.tree.activeNode===this){return;
}this.tree.activeNode.deactivate();
}if(opts.activeVisible){this.makeVisible();
}this.tree.activeNode=this;
if(opts.persist){$.cookie(opts.cookieId+"-active",this.data.key,opts.cookie);
}this.tree.persistence.activeKey=this.data.key;
$(this.span).addClass(opts.classNames.active);
if(fireEvents&&opts.onActivate){opts.onActivate.call(this.tree,this);
}}else{if(this.tree.activeNode===this){if(opts.onQueryActivate&&opts.onQueryActivate.call(this.tree,false,this)===false){return;
}$(this.span).removeClass(opts.classNames.active);
if(opts.persist){$.cookie(opts.cookieId+"-active","",opts.cookie);
}this.tree.persistence.activeKey=null;
this.tree.activeNode=null;
if(fireEvents&&opts.onDeactivate){opts.onDeactivate.call(this.tree,this);
}}}},activate:function(){this._activate(true,true);
},activateSilently:function(){this._activate(true,false);
},deactivate:function(){this._activate(false,true);
},isActive:function(){return(this.tree.activeNode===this);
},_userActivate:function(){var activate=true;
var expand=false;
if(this.data.isFolder){switch(this.tree.options.clickFolderMode){case 2:activate=false;
expand=true;
break;
case 3:activate=expand=true;
break;
}}if(this.parent===null){expand=false;
}if(expand){this.toggleExpand();
this.focus();
}if(activate){this.activate();
}},_setSubSel:function(hasSubSel){if(hasSubSel){this.hasSubSel=true;
$(this.span).addClass(this.tree.options.classNames.partsel);
}else{this.hasSubSel=false;
$(this.span).removeClass(this.tree.options.classNames.partsel);
}},_updatePartSelectionState:function(){var sel;
if(!this.hasChildren()){sel=(this.bSelected&&!this.data.unselectable&&!this.data.isStatusNode);
this._setSubSel(false);
return sel;
}var i,l,cl=this.childList,allSelected=true,allDeselected=true;
for(i=0,l=cl.length;
i<l;
i++){var n=cl[i],s=n._updatePartSelectionState();
if(s!==false){allDeselected=false;
}if(s!==true){allSelected=false;
}}if(allSelected){sel=true;
}else{if(allDeselected){sel=false;
}else{sel=undefined;
}}this._setSubSel(sel===undefined);
this.bSelected=(sel===true);
return sel;
},_fixSelectionState:function(){var p,i,l;
if(this.bSelected){this.visit(function(node){node.parent._setSubSel(true);
if(!node.data.unselectable){node._select(true,false,false);
}});
p=this.parent;
while(p){p._setSubSel(true);
var allChildsSelected=true;
for(i=0,l=p.childList.length;
i<l;
i++){var n=p.childList[i];
if(!n.bSelected&&!n.data.isStatusNode&&!n.data.unselectable){allChildsSelected=false;
break;
}}if(allChildsSelected){p._select(true,false,false);
}p=p.parent;
}}else{this._setSubSel(false);
this.visit(function(node){node._setSubSel(false);
node._select(false,false,false);
});
p=this.parent;
while(p){p._select(false,false,false);
var isPartSel=false;
for(i=0,l=p.childList.length;
i<l;
i++){if(p.childList[i].bSelected||p.childList[i].hasSubSel){isPartSel=true;
break;
}}p._setSubSel(isPartSel);
p=p.parent;
}}},_select:function(sel,fireEvents,deep){var opts=this.tree.options;
if(this.data.isStatusNode){return;
}if(this.bSelected===sel){return;
}if(fireEvents&&opts.onQuerySelect&&opts.onQuerySelect.call(this.tree,sel,this)===false){return;
}if(opts.selectMode==1&&sel){this.tree.visit(function(node){if(node.bSelected){node._select(false,false,false);
return false;
}});
}this.bSelected=sel;
if(sel){if(opts.persist){this.tree.persistence.addSelect(this.data.key);
}$(this.span).addClass(opts.classNames.selected);
if(deep&&opts.selectMode===3){this._fixSelectionState();
}if(fireEvents&&opts.onSelect){opts.onSelect.call(this.tree,true,this);
}}else{if(opts.persist){this.tree.persistence.clearSelect(this.data.key);
}$(this.span).removeClass(opts.classNames.selected);
if(deep&&opts.selectMode===3){this._fixSelectionState();
}if(fireEvents&&opts.onSelect){opts.onSelect.call(this.tree,false,this);
}}},select:function(sel){if(this.data.unselectable){return this.bSelected;
}return this._select(sel!==false,true,true);
},toggleSelect:function(){return this.select(!this.bSelected);
},isSelected:function(){return this.bSelected;
},isLazy:function(){return !!this.data.isLazy;
},_loadContent:function(){try{var opts=this.tree.options;
this.tree.logDebug("_loadContent: start - %o",this);
this.setLazyNodeStatus(DTNodeStatus_Loading);
if(true===opts.onLazyRead.call(this.tree,this)){this.setLazyNodeStatus(DTNodeStatus_Ok);
this.tree.logDebug("_loadContent: succeeded - %o",this);
}}catch(e){this.tree.logWarning("_loadContent: failed - %o",e);
this.setLazyNodeStatus(DTNodeStatus_Error,{tooltip:""+e});
}},_expand:function(bExpand,forceSync){if(this.bExpanded===bExpand){this.tree.logDebug("dtnode._expand(%o) IGNORED - %o",bExpand,this);
return;
}this.tree.logDebug("dtnode._expand(%o) - %o",bExpand,this);
var opts=this.tree.options;
if(!bExpand&&this.getLevel()<opts.minExpandLevel){this.tree.logDebug("dtnode._expand(%o) prevented collapse - %o",bExpand,this);
return;
}if(opts.onQueryExpand&&opts.onQueryExpand.call(this.tree,bExpand,this)===false){return;
}this.bExpanded=bExpand;
if(opts.persist){if(bExpand){this.tree.persistence.addExpand(this.data.key);
}else{this.tree.persistence.clearExpand(this.data.key);
}}var allowEffects=!(this.data.isLazy&&this.childList===null)&&!this._isLoading&&!forceSync;
this.render(allowEffects);
if(this.bExpanded&&this.parent&&opts.autoCollapse){var parents=this._parentList(false,true);
for(var i=0,l=parents.length;
i<l;
i++){parents[i].collapseSiblings();
}}if(opts.activeVisible&&this.tree.activeNode&&!this.tree.activeNode.isVisible()){this.tree.activeNode.deactivate();
}if(bExpand&&this.data.isLazy&&this.childList===null&&!this._isLoading){this._loadContent();
return;
}if(opts.onExpand){opts.onExpand.call(this.tree,bExpand,this);
}},isExpanded:function(){return this.bExpanded;
},expand:function(flag){flag=(flag!==false);
if(!this.childList&&!this.data.isLazy&&flag){return;
}else{if(this.parent===null&&!flag){return;
}}this._expand(flag);
},scheduleAction:function(mode,ms){if(this.tree.timer){clearTimeout(this.tree.timer);
this.tree.logDebug("clearTimeout(%o)",this.tree.timer);
}var self=this;
switch(mode){case"cancel":break;
case"expand":this.tree.timer=setTimeout(function(){self.tree.logDebug("setTimeout: trigger expand");
self.expand(true);
},ms);
break;
case"activate":this.tree.timer=setTimeout(function(){self.tree.logDebug("setTimeout: trigger activate");
self.activate();
},ms);
break;
default:throw"Invalid mode "+mode;
}this.tree.logDebug("setTimeout(%s, %s): %s",mode,ms,this.tree.timer);
},toggleExpand:function(){this.expand(!this.bExpanded);
},collapseSiblings:function(){if(this.parent===null){return;
}var ac=this.parent.childList;
for(var i=0,l=ac.length;
i<l;
i++){if(ac[i]!==this&&ac[i].bExpanded){ac[i]._expand(false);
}}},_onClick:function(event){var targetType=this.getEventTargetType(event);
if(targetType==="expander"){this.toggleExpand();
this.focus();
}else{if(targetType==="checkbox"){this.toggleSelect();
this.focus();
}else{this._userActivate();
var aTag=this.span.getElementsByTagName("a");
if(aTag[0]){if(!($.browser.msie&&parseInt($.browser.version,10)<9)){aTag[0].focus();
}}else{return true;
}}}event.preventDefault();
},_onDblClick:function(event){},_onKeydown:function(event){var handled=true,sib;
switch(event.which){case 107:case 187:if(!this.bExpanded){this.toggleExpand();
}break;
case 109:case 189:if(this.bExpanded){this.toggleExpand();
}break;
case 32:this._userActivate();
break;
case 8:if(this.parent){this.parent.focus();
}break;
case 37:if(this.bExpanded){this.toggleExpand();
this.focus();
}else{if(this.parent&&this.parent.parent){this.parent.focus();
}}break;
case 39:if(!this.bExpanded&&(this.childList||this.data.isLazy)){this.toggleExpand();
this.focus();
}else{if(this.childList){this.childList[0].focus();
}}break;
case 38:sib=this.getPrevSibling();
while(sib&&sib.bExpanded&&sib.childList){sib=sib.childList[sib.childList.length-1];
}if(!sib&&this.parent&&this.parent.parent){sib=this.parent;
}if(sib){sib.focus();
}break;
case 40:if(this.bExpanded&&this.childList){sib=this.childList[0];
}else{var parents=this._parentList(false,true);
for(var i=parents.length-1;
i>=0;
i--){sib=parents[i].getNextSibling();
if(sib){break;
}}}if(sib){sib.focus();
}break;
default:handled=false;
}if(handled){event.preventDefault();
}},_onKeypress:function(event){},_onFocus:function(event){var opts=this.tree.options;
if(event.type=="blur"||event.type=="focusout"){if(opts.onBlur){opts.onBlur.call(this.tree,this);
}if(this.tree.tnFocused){$(this.tree.tnFocused.span).removeClass(opts.classNames.focused);
}this.tree.tnFocused=null;
if(opts.persist){$.cookie(opts.cookieId+"-focus","",opts.cookie);
}}else{if(event.type=="focus"||event.type=="focusin"){if(this.tree.tnFocused&&this.tree.tnFocused!==this){this.tree.logDebug("dtnode.onFocus: out of sync: curFocus: %o",this.tree.tnFocused);
$(this.tree.tnFocused.span).removeClass(opts.classNames.focused);
}this.tree.tnFocused=this;
if(opts.onFocus){opts.onFocus.call(this.tree,this);
}$(this.tree.tnFocused.span).addClass(opts.classNames.focused);
if(opts.persist){$.cookie(opts.cookieId+"-focus",this.data.key,opts.cookie);
}}}},visit:function(fn,includeSelf){var res=true;
if(includeSelf===true){res=fn(this);
if(res===false||res=="skip"){return res;
}}if(this.childList){for(var i=0,l=this.childList.length;
i<l;
i++){res=this.childList[i].visit(fn,true);
if(res===false){break;
}}}return res;
},visitParents:function(fn,includeSelf){if(includeSelf&&fn(this)===false){return false;
}var p=this.parent;
while(p){if(fn(p)===false){return false;
}p=p.parent;
}return true;
},remove:function(){if(this===this.tree.root){throw"Cannot remove system root";
}return this.parent.removeChild(this);
},removeChild:function(tn){var ac=this.childList;
if(ac.length==1){if(tn!==ac[0]){throw"removeChild: invalid child";
}return this.removeChildren();
}if(tn===this.tree.activeNode){tn.deactivate();
}if(this.tree.options.persist){if(tn.bSelected){this.tree.persistence.clearSelect(tn.data.key);
}if(tn.bExpanded){this.tree.persistence.clearExpand(tn.data.key);
}}tn.removeChildren(true);
this.ul.removeChild(tn.li);
for(var i=0,l=ac.length;
i<l;
i++){if(ac[i]===tn){this.childList.splice(i,1);
break;
}}},removeChildren:function(isRecursiveCall,retainPersistence){this.tree.logDebug("%s.removeChildren(%o)",this,isRecursiveCall);
var tree=this.tree;
var ac=this.childList;
if(ac){for(var i=0,l=ac.length;
i<l;
i++){var tn=ac[i];
if(tn===tree.activeNode&&!retainPersistence){tn.deactivate();
}if(this.tree.options.persist&&!retainPersistence){if(tn.bSelected){this.tree.persistence.clearSelect(tn.data.key);
}if(tn.bExpanded){this.tree.persistence.clearExpand(tn.data.key);
}}tn.removeChildren(true,retainPersistence);
if(this.ul){$("li",$(this.ul)).remove();
}}this.childList=null;
}if(!isRecursiveCall){this._isLoading=false;
this.render();
}},setTitle:function(title){this.fromDict({title:title});
},reload:function(force){throw"Use reloadChildren() instead";
},reloadChildren:function(callback){if(this.parent===null){throw"Use tree.reload() instead";
}else{if(!this.data.isLazy){throw"node.reloadChildren() requires lazy nodes.";
}}if(callback){var self=this;
var eventType="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key;
this.tree.$tree.bind(eventType,function(e,node,isOk){self.tree.$tree.unbind(eventType);
self.tree.logDebug("loaded %o, %o, %o",e,node,isOk);
if(node!==self){throw"got invalid load event";
}callback.call(self.tree,node,isOk);
});
}this.removeChildren();
this._loadContent();
},_loadKeyPath:function(keyPath,callback){var tree=this.tree;
tree.logDebug("%s._loadKeyPath(%s)",this,keyPath);
if(keyPath===""){throw"Key path must not be empty";
}var segList=keyPath.split(tree.options.keyPathSeparator);
if(segList[0]===""){throw"Key path must be relative (don't start with '/')";
}var seg=segList.shift();
if(this.childList){for(var i=0,l=this.childList.length;
i<l;
i++){var child=this.childList[i];
if(child.data.key===seg){if(segList.length===0){callback.call(tree,child,"ok");
}else{if(child.data.isLazy&&(child.childList===null||child.childList===undefined)){tree.logDebug("%s._loadKeyPath(%s) -> reloading %s...",this,keyPath,child);
var self=this;
child.reloadChildren(function(node,isOk){if(isOk){tree.logDebug("%s._loadKeyPath(%s) -> reloaded %s.",node,keyPath,node);
callback.call(tree,child,"loaded");
node._loadKeyPath(segList.join(tree.options.keyPathSeparator),callback);
}else{tree.logWarning("%s._loadKeyPath(%s) -> reloadChildren() failed.",self,keyPath);
callback.call(tree,child,"error");
}});
}else{callback.call(tree,child,"loaded");
child._loadKeyPath(segList.join(tree.options.keyPathSeparator),callback);
}}return;
}}}callback.call(tree,undefined,"notfound",seg,segList.length===0);
tree.logWarning("Node not found: "+seg);
return;
},resetLazy:function(){if(this.parent===null){throw"Use tree.reload() instead";
}else{if(!this.data.isLazy){throw"node.resetLazy() requires lazy nodes.";
}}this.expand(false);
this.removeChildren();
},_addChildNode:function(dtnode,beforeNode){var tree=this.tree,opts=tree.options,pers=tree.persistence;
dtnode.parent=this;
if(this.childList===null){this.childList=[];
}else{if(!beforeNode){if(this.childList.length>0){$(this.childList[this.childList.length-1].span).removeClass(opts.classNames.lastsib);
}}}if(beforeNode){var iBefore=$.inArray(beforeNode,this.childList);
if(iBefore<0){throw"<beforeNode> must be a child of <this>";
}this.childList.splice(iBefore,0,dtnode);
}else{this.childList.push(dtnode);
}var isInitializing=tree.isInitializing();
if(opts.persist&&pers.cookiesFound&&isInitializing){if(pers.activeKey===dtnode.data.key){tree.activeNode=dtnode;
}if(pers.focusedKey===dtnode.data.key){tree.focusNode=dtnode;
}dtnode.bExpanded=($.inArray(dtnode.data.key,pers.expandedKeyList)>=0);
dtnode.bSelected=($.inArray(dtnode.data.key,pers.selectedKeyList)>=0);
}else{if(dtnode.data.activate){tree.activeNode=dtnode;
if(opts.persist){pers.activeKey=dtnode.data.key;
}}if(dtnode.data.focus){tree.focusNode=dtnode;
if(opts.persist){pers.focusedKey=dtnode.data.key;
}}dtnode.bExpanded=(dtnode.data.expand===true);
if(dtnode.bExpanded&&opts.persist){pers.addExpand(dtnode.data.key);
}dtnode.bSelected=(dtnode.data.select===true);
if(dtnode.bSelected&&opts.persist){pers.addSelect(dtnode.data.key);
}}if(opts.minExpandLevel>=dtnode.getLevel()){this.bExpanded=true;
}if(dtnode.bSelected&&opts.selectMode==3){var p=this;
while(p){if(!p.hasSubSel){p._setSubSel(true);
}p=p.parent;
}}if(tree.bEnableUpdate){this.render();
}return dtnode;
},addChild:function(obj,beforeNode){if(typeof(obj)=="string"){throw"Invalid data type for "+obj;
}else{if(!obj||obj.length===0){return;
}else{if(obj instanceof DynaTreeNode){return this._addChildNode(obj,beforeNode);
}}}if(!obj.length){obj=[obj];
}var prevFlag=this.tree.enableUpdate(false);
var tnFirst=null;
for(var i=0,l=obj.length;
i<l;
i++){var data=obj[i];
var dtnode=this._addChildNode(new DynaTreeNode(this,this.tree,data),beforeNode);
if(!tnFirst){tnFirst=dtnode;
}if(data.children){dtnode.addChild(data.children,null);
}}this.tree.enableUpdate(prevFlag);
return tnFirst;
},append:function(obj){this.tree.logWarning("node.append() is deprecated (use node.addChild() instead).");
return this.addChild(obj,null);
},appendAjax:function(ajaxOptions){var self=this;
this.removeChildren(false,true);
this.setLazyNodeStatus(DTNodeStatus_Loading);
if(ajaxOptions.debugLazyDelay){var ms=ajaxOptions.debugLazyDelay;
ajaxOptions.debugLazyDelay=0;
this.tree.logInfo("appendAjax: waiting for debugLazyDelay "+ms);
setTimeout(function(){self.appendAjax(ajaxOptions);
},ms);
return;
}var orgSuccess=ajaxOptions.success,orgError=ajaxOptions.error,eventType="nodeLoaded.dynatree."+this.tree.$tree.attr("id")+"."+this.data.key;
var options=$.extend({},this.tree.options.ajaxDefaults,ajaxOptions,{success:function(data,textStatus,jqXHR){var prevPhase=self.tree.phase;
self.tree.phase="init";
if(options.postProcess){data=options.postProcess.call(this,data,this.dataType);
}else{if(data&&data.hasOwnProperty("d")){data=(typeof data.d)=="string"?$.parseJSON(data.d):data.d;
}}if(!$.isArray(data)||data.length!==0){self.addChild(data,null);
}self.tree.phase="postInit";
if(orgSuccess){orgSuccess.call(options,self,data,textStatus);
}self.tree.logDebug("trigger "+eventType);
self.tree.$tree.trigger(eventType,[self,true]);
self.tree.phase=prevPhase;
self.setLazyNodeStatus(DTNodeStatus_Ok);
if($.isArray(data)&&data.length===0){self.childList=[];
self.render();
}},error:function(jqXHR,textStatus,errorThrown){self.tree.logWarning("appendAjax failed:",textStatus,":\n",jqXHR,"\n",errorThrown);
if(orgError){orgError.call(options,self,jqXHR,textStatus,errorThrown);
}self.tree.$tree.trigger(eventType,[self,false]);
self.setLazyNodeStatus(DTNodeStatus_Error,{info:textStatus,tooltip:""+errorThrown});
}});
$.ajax(options);
},move:function(targetNode,mode){var pos;
if(this===targetNode){return;
}if(!this.parent){throw"Cannot move system root";
}if(mode===undefined||mode=="over"){mode="child";
}var prevParent=this.parent;
var targetParent=(mode==="child")?targetNode:targetNode.parent;
if(targetParent.isDescendantOf(this)){throw"Cannot move a node to it's own descendant";
}if(this.parent.childList.length==1){this.parent.childList=this.parent.data.isLazy?[]:null;
this.parent.bExpanded=false;
}else{pos=$.inArray(this,this.parent.childList);
if(pos<0){throw"Internal error";
}this.parent.childList.splice(pos,1);
}if(this.parent.ul){this.parent.ul.removeChild(this.li);
}this.parent=targetParent;
if(targetParent.hasChildren()){switch(mode){case"child":targetParent.childList.push(this);
break;
case"before":pos=$.inArray(targetNode,targetParent.childList);
if(pos<0){throw"Internal error";
}targetParent.childList.splice(pos,0,this);
break;
case"after":pos=$.inArray(targetNode,targetParent.childList);
if(pos<0){throw"Internal error";
}targetParent.childList.splice(pos+1,0,this);
break;
default:throw"Invalid mode "+mode;
}}else{targetParent.childList=[this];
}if(!targetParent.ul){targetParent.ul=document.createElement("ul");
targetParent.ul.style.display="none";
targetParent.li.appendChild(targetParent.ul);
}if(this.li){targetParent.ul.appendChild(this.li);
}if(this.tree!==targetNode.tree){this.visit(function(node){node.tree=targetNode.tree;
},null,true);
throw"Not yet implemented.";
}if(!prevParent.isDescendantOf(targetParent)){prevParent.render();
}if(!targetParent.isDescendantOf(prevParent)){targetParent.render();
}},lastentry:undefined};
var DynaTreeStatus=Class.create();
DynaTreeStatus._getTreePersistData=function(cookieId,cookieOpts){var ts=new DynaTreeStatus(cookieId,cookieOpts);
ts.read();
return ts.toDict();
};
getDynaTreePersistData=DynaTreeStatus._getTreePersistData;
DynaTreeStatus.prototype={initialize:function(cookieId,cookieOpts){if(cookieId===undefined){cookieId=$.ui.dynatree.prototype.options.cookieId;
}cookieOpts=$.extend({},$.ui.dynatree.prototype.options.cookie,cookieOpts);
this.cookieId=cookieId;
this.cookieOpts=cookieOpts;
this.cookiesFound=undefined;
this.activeKey=null;
this.focusedKey=null;
this.expandedKeyList=null;
this.selectedKeyList=null;
},_log:function(msg){Array.prototype.unshift.apply(arguments,["debug"]);
_log.apply(this,arguments);
},read:function(){this.cookiesFound=false;
var cookie=$.cookie(this.cookieId+"-active");
this.activeKey=(cookie===null)?"":cookie;
if(cookie!==null){this.cookiesFound=true;
}cookie=$.cookie(this.cookieId+"-focus");
this.focusedKey=(cookie===null)?"":cookie;
if(cookie!==null){this.cookiesFound=true;
}cookie=$.cookie(this.cookieId+"-expand");
this.expandedKeyList=(cookie===null)?[]:cookie.split(",");
if(cookie!==null){this.cookiesFound=true;
}cookie=$.cookie(this.cookieId+"-select");
this.selectedKeyList=(cookie===null)?[]:cookie.split(",");
if(cookie!==null){this.cookiesFound=true;
}},write:function(){$.cookie(this.cookieId+"-active",(this.activeKey===null)?"":this.activeKey,this.cookieOpts);
$.cookie(this.cookieId+"-focus",(this.focusedKey===null)?"":this.focusedKey,this.cookieOpts);
$.cookie(this.cookieId+"-expand",(this.expandedKeyList===null)?"":this.expandedKeyList.join(","),this.cookieOpts);
$.cookie(this.cookieId+"-select",(this.selectedKeyList===null)?"":this.selectedKeyList.join(","),this.cookieOpts);
},addExpand:function(key){if($.inArray(key,this.expandedKeyList)<0){this.expandedKeyList.push(key);
$.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts);
}},clearExpand:function(key){var idx=$.inArray(key,this.expandedKeyList);
if(idx>=0){this.expandedKeyList.splice(idx,1);
$.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts);
}},addSelect:function(key){if($.inArray(key,this.selectedKeyList)<0){this.selectedKeyList.push(key);
$.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts);
}},clearSelect:function(key){var idx=$.inArray(key,this.selectedKeyList);
if(idx>=0){this.selectedKeyList.splice(idx,1);
$.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts);
}},isReloading:function(){return this.cookiesFound===true;
},toDict:function(){return{cookiesFound:this.cookiesFound,activeKey:this.activeKey,focusedKey:this.activeKey,expandedKeyList:this.expandedKeyList,selectedKeyList:this.selectedKeyList};
},lastentry:undefined};
var DynaTree=Class.create();
DynaTree.version="$Version: 1.2.1$";
DynaTree.prototype={initialize:function($widget){this.phase="init";
this.$widget=$widget;
this.options=$widget.options;
this.$tree=$widget.element;
this.timer=null;
this.divTree=this.$tree.get(0);
_initDragAndDrop(this);
},_load:function(callback){var $widget=this.$widget;
var opts=this.options,self=this;
this.bEnableUpdate=true;
this._nodeCount=1;
this.activeNode=null;
this.focusNode=null;
if(opts.rootVisible!==undefined){this.logWarning("Option 'rootVisible' is no longer supported.");
}if(opts.minExpandLevel<1){this.logWarning("Option 'minExpandLevel' must be >= 1.");
opts.minExpandLevel=1;
}if(opts.classNames!==$.ui.dynatree.prototype.options.classNames){opts.classNames=$.extend({},$.ui.dynatree.prototype.options.classNames,opts.classNames);
}if(opts.ajaxDefaults!==$.ui.dynatree.prototype.options.ajaxDefaults){opts.ajaxDefaults=$.extend({},$.ui.dynatree.prototype.options.ajaxDefaults,opts.ajaxDefaults);
}if(opts.dnd!==$.ui.dynatree.prototype.options.dnd){opts.dnd=$.extend({},$.ui.dynatree.prototype.options.dnd,opts.dnd);
}if(!opts.imagePath){$("script").each(function(){var _rexDtLibName=/.*dynatree[^\/]*\.js$/i;
if(this.src.search(_rexDtLibName)>=0){if(this.src.indexOf("/")>=0){opts.imagePath=this.src.slice(0,this.src.lastIndexOf("/"))+"/skin/";
}else{opts.imagePath="skin/";
}self.logDebug("Guessing imagePath from '%s': '%s'",this.src,opts.imagePath);
return false;
}});
}this.persistence=new DynaTreeStatus(opts.cookieId,opts.cookie);
if(opts.persist){if(!$.cookie){_log("warn","Please include jquery.cookie.js to use persistence.");
}this.persistence.read();
}this.logDebug("DynaTree.persistence: %o",this.persistence.toDict());
this.cache={tagEmpty:"<span class='"+opts.classNames.empty+"'></span>",tagVline:"<span class='"+opts.classNames.vline+"'></span>",tagExpander:"<span class='"+opts.classNames.expander+"'></span>",tagConnector:"<span class='"+opts.classNames.connector+"'></span>",tagNodeIcon:"<span class='"+opts.classNames.nodeIcon+"'></span>",tagCheckbox:"<span class='"+opts.classNames.checkbox+"'></span>",lastentry:undefined};
if(opts.children||(opts.initAjax&&opts.initAjax.url)||opts.initId){$(this.divTree).empty();
}var $ulInitialize=this.$tree.find(">ul:first").hide();
this.tnRoot=new DynaTreeNode(null,this,{});
this.tnRoot.bExpanded=true;
this.tnRoot.render();
this.divTree.appendChild(this.tnRoot.ul);
var root=this.tnRoot,isReloading=(opts.persist&&this.persistence.isReloading()),isLazy=false,prevFlag=this.enableUpdate(false);
this.logDebug("Dynatree._load(): read tree structure...");
if(opts.children){root.addChild(opts.children);
}else{if(opts.initAjax&&opts.initAjax.url){isLazy=true;
root.data.isLazy=true;
this._reloadAjax(callback);
}else{if(opts.initId){this._createFromTag(root,$("#"+opts.initId));
}else{this._createFromTag(root,$ulInitialize);
$ulInitialize.remove();
}}}this._checkConsistency();
if(!isLazy&&opts.selectMode==3){root._updatePartSelectionState();
}this.logDebug("Dynatree._load(): render nodes...");
this.enableUpdate(prevFlag);
this.logDebug("Dynatree._load(): bind events...");
this.$widget.bind();
this.logDebug("Dynatree._load(): postInit...");
this.phase="postInit";
if(opts.persist){this.persistence.write();
}if(this.focusNode&&this.focusNode.isVisible()){this.logDebug("Focus on init: %o",this.focusNode);
this.focusNode.focus();
}if(!isLazy){if(opts.onPostInit){opts.onPostInit.call(this,isReloading,false);
}if(callback){callback.call(this,"ok");
}}this.phase="idle";
},_reloadAjax:function(callback){var opts=this.options;
if(!opts.initAjax||!opts.initAjax.url){throw"tree.reload() requires 'initAjax' mode.";
}var pers=this.persistence;
var ajaxOpts=$.extend({},opts.initAjax);
if(ajaxOpts.addActiveKey){ajaxOpts.data.activeKey=pers.activeKey;
}if(ajaxOpts.addFocusedKey){ajaxOpts.data.focusedKey=pers.focusedKey;
}if(ajaxOpts.addExpandedKeyList){ajaxOpts.data.expandedKeyList=pers.expandedKeyList.join(",");
}if(ajaxOpts.addSelectedKeyList){ajaxOpts.data.selectedKeyList=pers.selectedKeyList.join(",");
}if(ajaxOpts.success){this.logWarning("initAjax: success callback is ignored; use onPostInit instead.");
}if(ajaxOpts.error){this.logWarning("initAjax: error callback is ignored; use onPostInit instead.");
}var isReloading=pers.isReloading();
ajaxOpts.success=function(dtnode,data,textStatus){if(opts.selectMode==3){dtnode.tree.tnRoot._updatePartSelectionState();
}if(opts.onPostInit){opts.onPostInit.call(dtnode.tree,isReloading,false);
}if(callback){callback.call(dtnode.tree,"ok");
}};
ajaxOpts.error=function(dtnode,XMLHttpRequest,textStatus,errorThrown){if(opts.onPostInit){opts.onPostInit.call(dtnode.tree,isReloading,true,XMLHttpRequest,textStatus,errorThrown);
}if(callback){callback.call(dtnode.tree,"error",XMLHttpRequest,textStatus,errorThrown);
}};
this.logDebug("Dynatree._init(): send Ajax request...");
this.tnRoot.appendAjax(ajaxOpts);
},toString:function(){return"Dynatree '"+this.$tree.attr("id")+"'";
},toDict:function(){return this.tnRoot.toDict(true);
},serializeArray:function(stopOnParents){var nodeList=this.getSelectedNodes(stopOnParents),name=this.$tree.attr("name")||this.$tree.attr("id"),arr=[];
for(var i=0,l=nodeList.length;
i<l;
i++){arr.push({name:name,value:nodeList[i].data.key});
}return arr;
},getPersistData:function(){return this.persistence.toDict();
},logDebug:function(msg){if(this.options.debugLevel>=2){Array.prototype.unshift.apply(arguments,["debug"]);
_log.apply(this,arguments);
}},logInfo:function(msg){if(this.options.debugLevel>=1){Array.prototype.unshift.apply(arguments,["info"]);
_log.apply(this,arguments);
}},logWarning:function(msg){Array.prototype.unshift.apply(arguments,["warn"]);
_log.apply(this,arguments);
},isInitializing:function(){return(this.phase=="init"||this.phase=="postInit");
},isReloading:function(){return(this.phase=="init"||this.phase=="postInit")&&this.options.persist&&this.persistence.cookiesFound;
},isUserEvent:function(){return(this.phase=="userEvent");
},redraw:function(){this.tnRoot.render(false,false);
},renderInvisibleNodes:function(){this.tnRoot.render(false,true);
},reload:function(callback){this._load(callback);
},getRoot:function(){return this.tnRoot;
},enable:function(){this.$widget.enable();
},disable:function(){this.$widget.disable();
},getNodeByKey:function(key){var el=document.getElementById(this.options.idPrefix+key);
if(el){return el.dtnode?el.dtnode:null;
}var match=null;
this.visit(function(node){if(node.data.key==key){match=node;
return false;
}},true);
return match;
},getActiveNode:function(){return this.activeNode;
},reactivate:function(setFocus){var node=this.activeNode;
if(node){this.activeNode=null;
node.activate();
if(setFocus){node.focus();
}}},getSelectedNodes:function(stopOnParents){var nodeList=[];
this.tnRoot.visit(function(node){if(node.bSelected){nodeList.push(node);
if(stopOnParents===true){return"skip";
}}});
return nodeList;
},activateKey:function(key){var dtnode=(key===null)?null:this.getNodeByKey(key);
if(!dtnode){if(this.activeNode){this.activeNode.deactivate();
}this.activeNode=null;
return null;
}dtnode.focus();
dtnode.activate();
return dtnode;
},loadKeyPath:function(keyPath,callback){var segList=keyPath.split(this.options.keyPathSeparator);
if(segList[0]===""){segList.shift();
}if(segList[0]==this.tnRoot.data.key){this.logDebug("Removed leading root key.");
segList.shift();
}keyPath=segList.join(this.options.keyPathSeparator);
return this.tnRoot._loadKeyPath(keyPath,callback);
},selectKey:function(key,select){var dtnode=this.getNodeByKey(key);
if(!dtnode){return null;
}dtnode.select(select);
return dtnode;
},enableUpdate:function(bEnable){if(this.bEnableUpdate==bEnable){return bEnable;
}this.bEnableUpdate=bEnable;
if(bEnable){this.redraw();
}return !bEnable;
},count:function(){return this.tnRoot.countChildren();
},visit:function(fn,includeRoot){return this.tnRoot.visit(fn,includeRoot);
},_createFromTag:function(parentTreeNode,$ulParent){var self=this;
$ulParent.find(">li").each(function(){var $li=$(this),$liSpan=$li.find(">span:first"),$liA=$li.find(">a:first"),title,href=null,target=null,tooltip;
if($liSpan.length){title=$liSpan.html();
}else{if($liA.length){title=$liA.html();
href=$liA.attr("href");
target=$liA.attr("target");
tooltip=$liA.attr("title");
}else{title=$li.html();
var iPos=title.search(/<ul/i);
if(iPos>=0){title=$.trim(title.substring(0,iPos));
}else{title=$.trim(title);
}}}var data={title:title,tooltip:tooltip,isFolder:$li.hasClass("folder"),isLazy:$li.hasClass("lazy"),expand:$li.hasClass("expanded"),select:$li.hasClass("selected"),activate:$li.hasClass("active"),focus:$li.hasClass("focused"),noLink:$li.hasClass("noLink")};
if(href){data.href=href;
data.target=target;
}if($li.attr("title")){data.tooltip=$li.attr("title");
}if($li.attr("id")){data.key=$li.attr("id");
}if($li.attr("data")){var dataAttr=$.trim($li.attr("data"));
if(dataAttr){if(dataAttr.charAt(0)!="{"){dataAttr="{"+dataAttr+"}";
}try{$.extend(data,eval("("+dataAttr+")"));
}catch(e){throw ("Error parsing node data: "+e+"\ndata:\n'"+dataAttr+"'");
}}}var childNode=parentTreeNode.addChild(data);
var $ul=$li.find(">ul:first");
if($ul.length){self._createFromTag(childNode,$ul);
}});
},_checkConsistency:function(){},_setDndStatus:function(sourceNode,targetNode,helper,hitMode,accept){var $source=sourceNode?$(sourceNode.span):null,$target=$(targetNode.span);
if(!this.$dndMarker){this.$dndMarker=$("<div id='dynatree-drop-marker'></div>").hide().prependTo($(this.divTree).parent());
}if(hitMode==="after"||hitMode==="before"||hitMode==="over"){var pos=$target.offset();
switch(hitMode){case"before":this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-over");
this.$dndMarker.addClass("dynatree-drop-before");
pos.top-=8;
break;
case"after":this.$dndMarker.removeClass("dynatree-drop-before dynatree-drop-over");
this.$dndMarker.addClass("dynatree-drop-after");
pos.top+=8;
break;
default:this.$dndMarker.removeClass("dynatree-drop-after dynatree-drop-before");
this.$dndMarker.addClass("dynatree-drop-over");
$target.addClass("dynatree-drop-target");
pos.left+=8;
}this.$dndMarker.css({left:pos.left,top:pos.top,"z-index":1000}).show();
}else{$target.removeClass("dynatree-drop-target");
this.$dndMarker.hide();
}if(hitMode==="after"){$target.addClass("dynatree-drop-after");
}else{$target.removeClass("dynatree-drop-after");
}if(hitMode==="before"){$target.addClass("dynatree-drop-before");
}else{$target.removeClass("dynatree-drop-before");
}if(accept===true){if($source){$source.addClass("dynatree-drop-accept");
}$target.addClass("dynatree-drop-accept");
helper.addClass("dynatree-drop-accept");
}else{if($source){$source.removeClass("dynatree-drop-accept");
}$target.removeClass("dynatree-drop-accept");
helper.removeClass("dynatree-drop-accept");
}if(accept===false){if($source){$source.addClass("dynatree-drop-reject");
}$target.addClass("dynatree-drop-reject");
helper.addClass("dynatree-drop-reject");
}else{if($source){$source.removeClass("dynatree-drop-reject");
}$target.removeClass("dynatree-drop-reject");
helper.removeClass("dynatree-drop-reject");
}},_onDragEvent:function(eventName,node,otherNode,event,ui,draggable){var opts=this.options,dnd=this.options.dnd,res=null,nodeTag=$(node.span),hitMode,enterResponse;
switch(eventName){case"helper":var $helper=$("<div class='dynatree-drag-helper'><span class='dynatree-drag-helper-img' /></div>").append($(event.target).closest("a").clone());
$("ul.dynatree-container",node.tree.divTree).append($helper);
$helper.data("dtSourceNode",node);
res=$helper;
break;
case"start":if(node.isStatusNode()){res=false;
}else{if(dnd.onDragStart){res=dnd.onDragStart(node);
}}if(res===false){this.logDebug("tree.onDragStart() cancelled");
ui.helper.trigger("mouseup");
ui.helper.hide();
}else{nodeTag.addClass("dynatree-drag-source");
}break;
case"enter":res=dnd.onDragEnter?dnd.onDragEnter(node,otherNode):null;
res={over:(res!==false)&&((res===true)||(res==="over")||$.inArray("over",res)>=0),before:(res!==false)&&((res===true)||(res==="before")||$.inArray("before",res)>=0),after:(res!==false)&&((res===true)||(res==="after")||$.inArray("after",res)>=0)};
ui.helper.data("enterResponse",res);
break;
case"over":enterResponse=ui.helper.data("enterResponse");
hitMode=null;
if(enterResponse===false){break;
}else{if(typeof enterResponse==="string"){hitMode=enterResponse;
}else{var nodeOfs=nodeTag.offset();
var relPos={x:event.pageX-nodeOfs.left,y:event.pageY-nodeOfs.top};
var relPos2={x:relPos.x/nodeTag.width(),y:relPos.y/nodeTag.height()};
if(enterResponse.after&&relPos2.y>0.75){hitMode="after";
}else{if(!enterResponse.over&&enterResponse.after&&relPos2.y>0.5){hitMode="after";
}else{if(enterResponse.before&&relPos2.y<=0.25){hitMode="before";
}else{if(!enterResponse.over&&enterResponse.before&&relPos2.y<=0.5){hitMode="before";
}else{if(enterResponse.over){hitMode="over";
}}}}}if(dnd.preventVoidMoves){if(node===otherNode){hitMode=null;
}else{if(hitMode==="before"&&otherNode&&node===otherNode.getNextSibling()){hitMode=null;
}else{if(hitMode==="after"&&otherNode&&node===otherNode.getPrevSibling()){hitMode=null;
}else{if(hitMode==="over"&&otherNode&&otherNode.parent===node&&otherNode.isLastSibling()){hitMode=null;
}}}}}ui.helper.data("hitMode",hitMode);
}}if(hitMode==="over"&&dnd.autoExpandMS&&node.hasChildren()!==false&&!node.bExpanded){node.scheduleAction("expand",dnd.autoExpandMS);
}if(hitMode&&dnd.onDragOver){res=dnd.onDragOver(node,otherNode,hitMode);
}this._setDndStatus(otherNode,node,ui.helper,hitMode,res!==false);
break;
case"drop":var isForbidden=ui.helper.hasClass("dynatree-drop-reject");
hitMode=ui.helper.data("hitMode");
if(hitMode&&dnd.onDrop&&!isForbidden){dnd.onDrop(node,otherNode,hitMode,ui,draggable);
}break;
case"leave":node.scheduleAction("cancel");
ui.helper.data("enterResponse",null);
ui.helper.data("hitMode",null);
this._setDndStatus(otherNode,node,ui.helper,"out",undefined);
if(dnd.onDragLeave){dnd.onDragLeave(node,otherNode);
}break;
case"stop":nodeTag.removeClass("dynatree-drag-source");
if(dnd.onDragStop){dnd.onDragStop(node);
}break;
default:throw"Unsupported drag event: "+eventName;
}return res;
},cancelDrag:function(){var dd=$.ui.ddmanager.current;
if(dd){dd.cancel();
}},lastentry:undefined};
$.widget("ui.dynatree",{_init:function(){if(parseFloat($.ui.version)<1.8){if(this.options.debugLevel>=0){_log("warn","ui.dynatree._init() was called; you should upgrade to jquery.ui.core.js v1.8 or higher.");
}return this._create();
}if(this.options.debugLevel>=2){_log("debug","ui.dynatree._init() was called; no current default functionality.");
}},_create:function(){var opts=this.options;
if(opts.debugLevel>=1){logMsg("Dynatree._create(): version='%s', debugLevel=%o.",$.ui.dynatree.version,this.options.debugLevel);
}this.options.event+=".dynatree";
var divTree=this.element.get(0);
this.tree=new DynaTree(this);
this.tree._load();
this.tree.logDebug("Dynatree._init(): done.");
},bind:function(){this.unbind();
var eventNames="click.dynatree dblclick.dynatree";
if(this.options.keyboard){eventNames+=" keypress.dynatree keydown.dynatree";
}this.element.bind(eventNames,function(event){var dtnode=$.ui.dynatree.getNode(event.target);
if(!dtnode){return true;
}var tree=dtnode.tree;
var o=tree.options;
tree.logDebug("event(%s): dtnode: %s",event.type,dtnode);
var prevPhase=tree.phase;
tree.phase="userEvent";
try{switch(event.type){case"click":return(o.onClick&&o.onClick.call(tree,dtnode,event)===false)?false:dtnode._onClick(event);
case"dblclick":return(o.onDblClick&&o.onDblClick.call(tree,dtnode,event)===false)?false:dtnode._onDblClick(event);
case"keydown":return(o.onKeydown&&o.onKeydown.call(tree,dtnode,event)===false)?false:dtnode._onKeydown(event);
case"keypress":return(o.onKeypress&&o.onKeypress.call(tree,dtnode,event)===false)?false:dtnode._onKeypress(event);
}}catch(e){var _=null;
tree.logWarning("bind(%o): dtnode: %o, error: %o",event,dtnode,e);
}finally{tree.phase=prevPhase;
}});
function __focusHandler(event){event=$.event.fix(event||window.event);
var dtnode=$.ui.dynatree.getNode(event.target);
return dtnode?dtnode._onFocus(event):false;
}var div=this.tree.divTree;
if(div.addEventListener){div.addEventListener("focus",__focusHandler,true);
div.addEventListener("blur",__focusHandler,true);
}else{div.onfocusin=div.onfocusout=__focusHandler;
}},unbind:function(){this.element.unbind(".dynatree");
},enable:function(){this.bind();
$.Widget.prototype.enable.apply(this,arguments);
},disable:function(){this.unbind();
$.Widget.prototype.disable.apply(this,arguments);
},getTree:function(){return this.tree;
},getRoot:function(){return this.tree.getRoot();
},getActiveNode:function(){return this.tree.getActiveNode();
},getSelectedNodes:function(){return this.tree.getSelectedNodes();
},lastentry:undefined});
if(parseFloat($.ui.version)<1.8){$.ui.dynatree.getter="getTree getRoot getActiveNode getSelectedNodes";
}$.ui.dynatree.version="$Version: 1.2.1$";
$.ui.dynatree.getNode=function(el){if(el instanceof DynaTreeNode){return el;
}if(el.selector!==undefined){el=el[0];
}while(el){if(el.dtnode){return el.dtnode;
}el=el.parentNode;
}return null;
};
$.ui.dynatree.getPersistData=DynaTreeStatus._getTreePersistData;
$.ui.dynatree.prototype.options={title:"Dynatree",minExpandLevel:1,imagePath:null,children:null,initId:null,initAjax:null,autoFocus:true,keyboard:true,persist:false,autoCollapse:false,clickFolderMode:3,activeVisible:true,checkbox:false,selectMode:2,fx:null,noLink:false,onClick:null,onDblClick:null,onKeydown:null,onKeypress:null,onFocus:null,onBlur:null,onQueryActivate:null,onQuerySelect:null,onQueryExpand:null,onPostInit:null,onActivate:null,onDeactivate:null,onSelect:null,onExpand:null,onLazyRead:null,onCustomRender:null,onCreate:null,onRender:null,postProcess:null,dnd:{onDragStart:null,onDragStop:null,autoExpandMS:1000,preventVoidMoves:true,onDragEnter:null,onDragOver:null,onDrop:null,onDragLeave:null},ajaxDefaults:{cache:false,timeout:0,dataType:"json"},strings:{loading:"Loading&#8230;",loadError:"Load error!"},generateIds:false,idPrefix:"dynatree-id-",keyPathSeparator:"/",cookieId:"dynatree",cookie:{expires:null},classNames:{container:"dynatree-container",node:"dynatree-node",folder:"dynatree-folder",empty:"dynatree-empty",vline:"dynatree-vline",expander:"dynatree-expander",connector:"dynatree-connector",checkbox:"dynatree-checkbox",nodeIcon:"dynatree-icon",title:"dynatree-title",noConnector:"dynatree-no-connector",nodeError:"dynatree-statusnode-error",nodeWait:"dynatree-statusnode-wait",hidden:"dynatree-hidden",combinedExpanderPrefix:"dynatree-exp-",combinedIconPrefix:"dynatree-ico-",nodeLoading:"dynatree-loading",hasChildren:"dynatree-has-children",active:"dynatree-active",selected:"dynatree-selected",expanded:"dynatree-expanded",lazy:"dynatree-lazy",focused:"dynatree-focused",partsel:"dynatree-partsel",lastsib:"dynatree-lastsib"},debugLevel:1,lastentry:undefined};
if(parseFloat($.ui.version)<1.8){$.ui.dynatree.defaults=$.ui.dynatree.prototype.options;
}$.ui.dynatree.nodedatadefaults={title:null,key:null,isFolder:false,isLazy:false,tooltip:null,href:null,icon:null,addClass:null,noLink:false,activate:false,focus:false,expand:false,select:false,hideCheckbox:false,unselectable:false,children:null,lastentry:undefined};
function _initDragAndDrop(tree){var dnd=tree.options.dnd||null;
if(dnd&&(dnd.onDragStart||dnd.onDrop)){_registerDnd();
}if(dnd&&dnd.onDragStart){tree.$tree.draggable({addClasses:false,appendTo:"body",containment:false,delay:0,distance:4,revert:false,scroll:true,scrollSpeed:7,scrollSensitivity:10,connectToDynatree:true,helper:function(event){var sourceNode=$.ui.dynatree.getNode(event.target);
if(!sourceNode){return"<div></div>";
}return sourceNode.tree._onDragEvent("helper",sourceNode,null,event,null,null);
},start:function(event,ui){var sourceNode=ui.helper.data("dtSourceNode");
return !!sourceNode;
},_last:null});
}if(dnd&&dnd.onDrop){tree.$tree.droppable({addClasses:false,tolerance:"intersect",greedy:false,_last:null});
}}var didRegisterDnd=false;
var _registerDnd=function(){if(didRegisterDnd){return;
}$.ui.plugin.add("draggable","connectToDynatree",{start:function(event,ui){var draggable=$(this).data("draggable"),sourceNode=ui.helper.data("dtSourceNode")||null;
if(sourceNode){draggable.offset.click.top=-2;
draggable.offset.click.left=+16;
return sourceNode.tree._onDragEvent("start",sourceNode,null,event,ui,draggable);
}},drag:function(event,ui){var draggable=$(this).data("draggable"),sourceNode=ui.helper.data("dtSourceNode")||null,prevTargetNode=ui.helper.data("dtTargetNode")||null,targetNode=$.ui.dynatree.getNode(event.target);
if(event.target&&!targetNode){var isHelper=$(event.target).closest("div.dynatree-drag-helper,#dynatree-drop-marker").length>0;
if(isHelper){return;
}}ui.helper.data("dtTargetNode",targetNode);
if(prevTargetNode&&prevTargetNode!==targetNode){prevTargetNode.tree._onDragEvent("leave",prevTargetNode,sourceNode,event,ui,draggable);
}if(targetNode){if(!targetNode.tree.options.dnd.onDrop){noop();
}else{if(targetNode===prevTargetNode){targetNode.tree._onDragEvent("over",targetNode,sourceNode,event,ui,draggable);
}else{targetNode.tree._onDragEvent("enter",targetNode,sourceNode,event,ui,draggable);
}}}},stop:function(event,ui){var draggable=$(this).data("draggable"),sourceNode=ui.helper.data("dtSourceNode")||null,targetNode=ui.helper.data("dtTargetNode")||null,mouseDownEvent=draggable._mouseDownEvent,eventType=event.type,dropped=(eventType=="mouseup"&&event.which==1);
if(!dropped){logMsg("Drag was cancelled");
}if(targetNode){if(dropped){targetNode.tree._onDragEvent("drop",targetNode,sourceNode,event,ui,draggable);
}targetNode.tree._onDragEvent("leave",targetNode,sourceNode,event,ui,draggable);
}if(sourceNode){sourceNode.tree._onDragEvent("stop",sourceNode,null,event,ui,draggable);
}}});
didRegisterDnd=true;
};
}(jQuery));
MPageControls = {};
MPageObjectOriented = {};

MPageObjectOriented.inherits = function (clazz, parent) {
    $.each(parent.prototype, function(k, m) {
        clazz.prototype[k] = m;
    });
};

MPageObjectOriented.createAttribute = function(clazz, name) {

    clazz.prototype["set" + name] = function(value) {
        this["m_"+name] = value;
    };

    clazz.prototype["get" + name] = function() {
        return this["m_" + name];
    };
};

/**
 * Returns a string with the ID of the element. Element can be an ID string,
 * a jquery object, or a plain DOM element. Either way, the ID will be
 * automatically detected. If it can't detect, then an exception will
 * be thrown.
 *  
 * @param {Object} element 
 */
MPageControls.getId = function(element) {
    if (element instanceof String) {
        return element;
    }
    
    // note that null != undefined. We only want to return
    // an empty string when the client has explicitly informed
    // that it is a null variable.
    if (element === null) {
        return "";
    }
    
    var id = undefined;
    if (element instanceof jQuery) {
         id = element.attr("id");
    }
    
    if (element && element.getAttribute) {
        id = element.getAttribute("id");
    }
    
    if (!id) {
        throw {
            "name": "Object with no ID",
            "message": "You have tried to pass an object to MPageControls.getId that does not have a valid ID attribute."
        };
    }
    
    return id;
};


MPageControls.fromId = function(idStr) {
    var el = $("#" + idStr);
    return el.length === 0 ? null : el;
};
/**
 * control.js
 * @author Leonardo Sa
 *
 * Control class
 * ============================================================================
 *
 * Serves as a base class for all other controls. It automatically assigns the
 * "element" constructor argument to its element attribute. It will also
 * automatically call the init method, that is meant to be overriden by child
 * classes.
 */

(function() {
    // ------------------------------------------------------------------------
    // Imports
    // ------------------------------------------------------------------------
	var ns = MPageControls;
    var attribute = MPageObjectOriented.createAttribute;

    // ------------------------------------------------------------------------
    // Class Declaration
    // ------------------------------------------------------------------------
	ns.Control = function(element) {
	    this.setElement(element);
	    this.setControlId(ns.Control.idCounter);
	    ns.Control.idCounter++;
	    
		this.init();
	};
	
	ns.Control.idCounter = 0;
	
	// ------------------------------------------------------------------------
    // Attributes
    // ------------------------------------------------------------------------
	
	/**
	 * A unique ID that identifies this control 
	 */
	attribute(ns.Control, "ControlId");
	
	// ------------------------------------------------------------------------
    // Member Methods
    // ------------------------------------------------------------------------
	
	/**
	 * Executed right after the control is created. Can be overriden by child
	 * classes. The purpose of a separate init method is to allow the user
	 * to rebuild the control from the ground up without having to call
	 * its constructor, removing the need to copy all properties.
	 */
	ns.Control.prototype.init = function() {

	};
	
	ns.Control.prototype.setElement = function(element) {
	    this.m_element = MPageControls.getId(element);
	};
	
	ns.Control.prototype.getElement = function() {
	    return MPageControls.fromId(this.m_element);
	};
	
	ns.Control.prototype.setContents = function(contents) {
	    this.m_contents = MPageControls.getId(contents);
	};
	
	ns.Control.prototype.getContents = function() { 
	    return MPageControls.fromId(this.m_contents);
	};
	// ________________________________________________________________________
	
	/**
	 * Binds an event to a jQuery element. This is similar to jQuery's bind,
	 * except that here we keep track of the binded events in the control so
	 * we can destroy them later if needed. 
     * @param {Object} eventName
     * @param {Object} element
     * @param {Object} handler
	 */
	ns.Control.prototype.bind = function(eventName, element, handler) {
	    element.bind(eventName + ".control" + this.getControlId(), handler);
	};
	
	// ________________________________________________________________________
	
	/**
	 * Destroys all the events associated with the current control 
	 */
	ns.Control.prototype.destroyEvents = function() {
	    if (this.getElement()) {
	       this.getElement().unbind(".control" + this.getControlId());
	    }
	};
})();
/**
 * detail_dialog.js
 * @author Leonardo Sa
 *
 * DetailDialog class
 * ============================================================================
 *
 * Shows a dialog that is attached to an element. This means that
 * it will show next to that element when the show() method is called, similar
 * to drop down menus, except one can make it drop left, right, or even up
 * by changing the ElementCorner and ContentsCorner attributes.
 *
 */

(function($) {
	// ------------------------------------------------------------------------
	// Imports
	// ------------------------------------------------------------------------
	var ns = MPageControls;
	var oo = MPageObjectOriented;
	var inherits = oo.inherits;
	var attribute = oo.createAttribute;

	// -----------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------

	/**
	 * Instantiates a new detail dialog attached to element, where its contents
	 * will be an element defined by contentsElement.
	 */
	ns.DetailDialog = function(element, contentsElement) {
		var defaultHideFx = {
			type: "slide",
			length: 300
		};

		var defaultShowFx = {
			type: "slide",
			length: 300
		};

		this.setElementCorner(["bottom", "left"]);
		this.setContentsCorner(["top", "left"]);
		this.setBeforeShow(function() {
		});
		this.setAutoFlipVertical(true);
		this.setAutoFlipHorizontal(true);
		this.setContents(contentsElement);
		this.setShowEffect(defaultShowFx);
		this.setHideEffect(defaultHideFx);
		this.setVisible(false);
		this.setOnShow(function() {
		});
		this.setOnHide(function() {
		});

		// Calls the parent class constructor
		ns.Control.call(this, element);
	};

	inherits(ns.DetailDialog, ns.Control);

	// ------------------------------------------------------------------------
	// Attributes
	// ------------------------------------------------------------------------

	/**
	 * The contents of the dialog. Since we are using an external library
	 * to render the window, those contents will be used only as a base
	 * to create the dialog. To access the dialog HTML, use the pane()
	 * function.
	 */

	/**
	 * A jQuery effect for showing the dialog
	 */
	attribute(ns.DetailDialog, "ShowEffect");

	/**
	 * A jQuery effect for hiding the dialog
	 */
	attribute(ns.DetailDialog, "HideEffect");

	/**
	 * Whether the dialog is visible or not. This is read only - to change
	 * the visibility, use the hide() and show() functions.
	 */
	attribute(ns.DetailDialog, "Visible");

	/**
	 * Function to be executed after the dialog is shown and the
	 * animation is complete
	 */
	attribute(ns.DetailDialog, "OnShow");

	/**
	 * Function to be executed after the dialog is shown and the
	 * animation is complete
	 */
	attribute(ns.DetailDialog, "OnHide");

	/**
	 * Whether the dialog has been created or not. This is read only
	 * and does not signify that a dialog is visible, only that its
	 * HTML elements have been created.
	 */
	attribute(ns.DetailDialog, "Created");

	/**
	 * Defines to which corner of the element the dialog will attach to
	 */
	attribute(ns.DetailDialog, "ElementCorner");

	/**
	 * Defines which corner of the contents will attach to the element
	 */
	attribute(ns.DetailDialog, "ContentsCorner");

	/**
	 * Defines to which corner of the element the dialog will attach to when being flipped
	 */
	attribute(ns.DetailDialog, "ElementFlippedCorner");

	/**
	 * Defines which corner of the contents will attach to the element when being flipped
	 */
	attribute(ns.DetailDialog, "ContentsFlippedCorner");
	
	/**
	 * Event to be executed right before the dialog is shown
	 */
	attribute(ns.DetailDialog, "BeforeShow");

	/**
	 * Whether the dialog will automatically flip up, down or center if it's near
	 * the edge of the page.
	 */
	attribute(ns.DetailDialog, "AutoFlipVertical");
	
	/**
	 * Whether the dialog will automatically flip left or right if it's near
	 * the edge of the page.
	 */
	attribute(ns.DetailDialog, "AutoFlipHorizontal");
	
	// ------------------------------------------------------------------------
	// Public Member Methods
	// ------------------------------------------------------------------------
	var prot = ns.DetailDialog.prototype;

	prot.init = function() {
	};
	
	// ________________________________________________________________________

    /**
     * Defines a jQuery element to be used as a reference for the autoflip.
     * Sometimes this is necessary if you want the detail dialog to flip
     * when it reaches the end of a certain DIV instead of the window. 
     */
    prot.setFlipReference = function(reference) {
        this.m_flipReference = MPageControls.getId(reference);
    };

    prot.getFlipReference = function() {
       return MPageControls.fromId(this.m_flipReference);
    };

	// ________________________________________________________________________

	/**
	 * Hides or shows the dialog every time this method is called
	 */
	prot.toggle = function() {
		if (this.getVisible()) {
			this.hide();
		}
		else {
			this.show();
		}
	};

	// ________________________________________________________________________

	/**
	 * Updates the position of the dialog in relation to its attached element.
	 * The position will vary according to values of getElementCorner and
	 * getContentsCorner, which specify which corners will be used for alignment.
	 */
	prot.updatePosition = function(elementConnection, contentConnection) {

		// --------------------------------------------------------------------
		// Gets the element x and y
		// --------------------------------------------------------------------
		var element = this.getElement();
		var content = this.getContents();
		
		var elx = 0;
		var ely = 0;
		var elpos = element.offset();
		
		//Make sure we have connections defined
		if(!elementConnection){
			elementConnection = this.getElementCorner();
		}
		
		if(!contentConnection){
			contentConnection = this.getContentsCorner();
		}
		
		switch (elementConnection[0]) {
			case "top":
				ely = elpos.top;
				break;
			case "bottom":
				ely = elpos.top + element.outerHeight();
				break;
		}

		switch (elementConnection[1]) {
			case "left":
				elx = elpos.left;
				break;
			case "right":
				elx = elpos.left + element.outerWidth();
				break;
		}

		// --------------------------------------------------------------------
		// Offsets the x and y with the width and height of the contents
		// --------------------------------------------------------------------
		if (contentConnection[0] == "bottom") {
			ely = ely - content.outerHeight();
		}

		if (contentConnection[1] == "right") {
			elx = elx - content.outerWidth();
		}

		// --------------------------------------------------------------------
		// Compensate coordinates to be relative to parent instead of window
		// --------------------------------------------------------------------
		//This is a special case for IE7 when offsetParent returns the HTML tag which has offset of {top: 2, left: 2} even though it should be {top:0. left:0}.
		var parent = content.offsetParent();
		if(parent.length && parent.prop('tagName') === "HTML"){
			parent = $(document.body);
		}
		var x = elx - parent.offset().left;
		var y = 0;
		//windowTop is a special condition where the dialog contents will be hidden if flipped to the opposite side
		//so we use the top of the viewable area for the y offset.
		if(contentConnection[0] == "windowTop"){
			y = parent.offset().top;
		}
		else{
			y = ely - parent.offset().top;
		}

		// --------------------------------------------------------------------
		// Updates the contents
		// --------------------------------------------------------------------
		this.getContents().css("position", "absolute");
		this.getContents().css({
			left: x,
			top: y
		}).show();
	};

	// ________________________________________________________________________

	/**
	 * Displays the dialog
	 */
	prot.show = function() {
		if (this.getVisible()) {
			return;
		}

		var self = this;
		this.beforeShow();
		this.getContents().css("display", "block");
		this.updatePosition(this.getElementCorner(), this.getContentsCorner());
		//Save a copy of the current connection corners for use when we attempt to flip the content
		this.setElementFlippedCorner(this.getElementCorner());
		this.setContentsFlippedCorner(this.getContentsCorner());
		this.autoFlipVertical();
		this.autoFlipHorizontal();
		this.m_OnShow(this);
		this.setVisible(true);
	};

	// ________________________________________________________________________
	/**
	 * This function is used for passivity reasons and will call the updated autoFlipVertical function 
	 */
	prot.autoFlipUp = function(){
		this.autoFlipVertical();
	}

	/**
	 * If the AutoFlipVertical is true and the content is close to the bottom of
	 * the viewport, this will move it to the top instead.  If it then does not fit in the top
	 * it will be positioned so that the top of the content is aligned with the top of the screen.
	 * If the contents still do not fit the content will be scrolled and a max-height will be set
	 * on the content element container. 
	 */
	prot.autoFlipVertical = function() {
		var anchorVertical = "";
		//Check to see if we should attempt to auto flip
		if (!this.getAutoFlipVertical()) {
			return;
		}
		
		//Get the bottom edge of the window based on the scrolled position and the window height
		var windowEdge = $(window).scrollTop() + $(window).height();
		var contents = this.getContents();
		// If we have a flip reference, then we will use that as the edge instead of the window element
		if (this.getFlipReference()) {
		  //May need to apply scrollTop() to the filp reference if it is scrolled
		  windowEdge = this.getFlipReference().offset().top + parseInt(this.getFlipReference().outerHeight(), 10);
		}
		var contentHeight = parseInt(contents.outerHeight(), 10);
		var contentTop = contents.offset().top;
		var bottomEdge = contentTop + contentHeight;
		if (bottomEdge >= windowEdge) {
			anchorVertical = (this.getElementFlippedCorner()[1] == this.getContentsFlippedCorner()[1]) ? "top" : "bottom";
			if(contentTop <= contentHeight){
				//Check to see if the dialog is larger than the screen.  If so we will scroll its content.
				if(contentHeight >= windowEdge){
					//Reduce the size of the content container plus some padding
					contents.outerHeight(windowEdge - 10);
					//Expand the menu width to account for the scroll bar
					contents.outerWidth(contents.outerWidth() + 17);
					//Apply scrolling to the container
					contents.css("overflow-y", "auto");
				}
				//Flipping the content up will still hide some of the content so we will align it with the top of the screen
				this.setElementFlippedCorner([anchorVertical, this.getElementFlippedCorner()[1]]);
				this.setContentsFlippedCorner(["windowTop", this.getContentsFlippedCorner()[1]]);
				this.updatePosition(this.getElementFlippedCorner(), this.getContentsFlippedCorner());
			}
			else{
				//Flipping the menu up will let it show all of its contents
				this.setElementFlippedCorner([anchorVertical, this.getElementFlippedCorner()[1]]);
				this.setContentsFlippedCorner(["bottom", this.getContentsFlippedCorner()[1]]);
				this.updatePosition(this.getElementFlippedCorner(), this.getContentsFlippedCorner());
			}
		}
	};

	// ________________________________________________________________________

	
	/**
	 * If the AutoFlipHorizontal is true and the content is close to edge of
	 * the viewport, this will move it to the opposite side.
	 */
	prot.autoFlipHorizontal = function() {
		//Check to see if we should attempt to flip horizontally
		if (!this.getAutoFlipHorizontal()) {
			return;
		}
		
		//Get the viewport edge offsets
		var windowRightEdge = $(window).width();
		var windowLeftEdge = 0;
		var flipReference = this.getFlipReference();
		// if we have a flip reference, then we will use that as the edge instead
		if (flipReference) {
			windowLeftEdge = flipReference.offset().left;
			windowRightEdge = windowLeftEdge + parseInt(flipReference.outerWidth(), 10);
		}
		//Get the dialog edge offsets
		var dialogLeftEdge = this.getContents().offset().left;
		var dialogRightEdge = dialogLeftEdge + parseInt(this.getContents().outerWidth(), 10);
		
		//Flip the dialog if necessary
		if(dialogLeftEdge < windowLeftEdge){
			//Dialog left edge is less than the viewport left edge so we will flip right
			this.updatePosition([this.getElementFlippedCorner()[0], "right"], [this.getContentsFlippedCorner()[0], "left"]);
		}
		else if(dialogRightEdge > windowRightEdge){
			//Dialog right edge is greater than the viewport left edge so we will flip left
			this.updatePosition([this.getElementFlippedCorner()[0], "left"], [this.getContentsFlippedCorner()[0], "right"]);
		}
	};

	// ________________________________________________________________________

	/**
	 * Hides the dialog
	 */
	prot.hide = function() {
		if (!this.getVisible()) {
			return;
		}

		this.getContents().css("display", "none");
		this.setVisible(false);
		this.m_OnHide(this);
	};

	// ________________________________________________________________________

	/**
	 * Executed before showing the dialog. Is a wrapper for the beforeShow
	 * event.
	 */
	prot.beforeShow = function() {
		this.getBeforeShow()(this);
	};

	// ________________________________________________________________________

	/**
	 * Destroys the HTML elements inside the dialog, along with the dialog
	 * itself.
	 */
	prot.destroy = function() {
	    if (this.getContents()) {
		  this.getContents().remove();
		}
		this.setVisible(false);
		this.setCreated(false);
	};
})(jQuery);
/**
 * drop_down.js
 * @author Leonardo Sa
 *
 * DropDown Class
 * ============================================================================
 *
 * Abstract base for other drop down classes. Connects a detail dialog with a selector 
 * in order to form a drop down like control. Also, makes it possible to change 
 * or set a value by calling get/setValue.
 *
 */
(function($) {
	// -----------------------------------------------------------------------
	// Imports
	// ------------------------------------------------------------------------
	var ns = MPageControls;
	var inherits = MPageObjectOriented.inherits;
	var attribute = MPageObjectOriented.createAttribute;

	// ------------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------
	ns.DropDown = function(element, contentsElement, defaultValue) {

		this.setSelector(new ns.Selector(element, "selected", "unselected"));
		this.setContents(contentsElement);
		this.setOnShow(function() {
		});
		this.setOnHide(function() {
		});
		this.setOnSelect(function() {
		});

		this.m_value = defaultValue;

		ns.Control.call(this, element);
	};

	inherits(ns.DropDown, ns.Control);

	// ------------------------------------------------------------------------
	// Attributes
	// ------------------------------------------------------------------------

	/**
	 * The DetailDialog that contains the menu content
	 */
	attribute(ns.DropDown, "DetailDialog");

	/**
	 * The selector that triggers the DetailDialog
	 */
	attribute(ns.DropDown, "Selector");

	/**
	 * Function to be executed when the drop down is shown
	 */
	attribute(ns.DropDown, "OnShow");

	/**
	 * Function to be executed when the drop down has been hidden
	 */
	attribute(ns.DropDown, "OnHide");

	/**
	 * Function to be executed when an item is selected
	 */
	attribute(ns.DropDown, "OnSelect");

	// ------------------------------------------------------------------------
	// Public Member Methods
	// ------------------------------------------------------------------------
	
	var prot = ns.DropDown.prototype;

	/**
	 * Generates the root node with a tree of nodes and updates the contents
	 * of the DetailDialog with the generated <ul>s from the Node.
	 */
	prot.init = function() {
		this.setDetailDialog(new ns.DetailDialog(this.getElement(), this.getContents()));

		var self = this;
		this.getSelector().setOnSelect(function() {
			self.getDetailDialog().show();
		});

		this.getSelector().setOnUnselect(function() {
			self.getDetailDialog().hide();
		});

		this.getDetailDialog().setOnShow(function() {
			// make sure this will be above everyone else
			self.getDetailDialog().getContents().css("z-index", "7000");
			self.onShow();
		});

		this.getDetailDialog().setOnHide(function() {
			self.m_OnHide(self);
		});

		// this is needed to force updating the value of the textbox
		this.setValue(this.getValue());
	};

	// ________________________________________________________________________

	prot.setValue = function(value) {
		this.m_value = value;
		
		if (this.getElement()) {
		  this.getElement().html(value);
		}
	};
	
	// ________________________________________________________________________

	prot.onShow = function() {
		this.m_OnShow(this);
	};
	
	// ________________________________________________________________________

	prot.getValue = function() {
		if (!this.getDetailDialog()) {
            return "";
        }
		
		return this.m_value;
	};
	
	// ________________________________________________________________________

	/**
	 * Shows the drop down list
	 */
	prot.show = function() {
	    if (!this.getDetailDialog()) {
	        return;
	    }
	    
		this.getDetailDialog().show();
	};
	
	// ________________________________________________________________________

	/**
	 * Hides the drop down list
	 */
	prot.hide = function() {
	    if (!this.getDetailDialog()) {
	        return;
	    }
	    
		this.getDetailDialog().hide();
	};
	
	// ________________________________________________________________________

	/**
	 * Erases the drop down list from the DOM
	 */
	prot.destroy = function() {
	    if (!this.getDetailDialog() || !this.getElement()) {
	        return;
	    }
	    
		this.getDetailDialog().destroy();
		this.getElement().remove();
	};
})(jQuery);
/**
 * drop_down_list.js
 * @author Leonardo Sa
 *
 * DropDownList Class
 * ============================================================================
 *
 * Renders a drop down list attached to the specified element.
 * The drop down list data can be provided in the form of a tree, causing the actual
 * drop down menu to appear nested into different levels. The tree format must
 * follow the standard set on DropDownList.Node class.
 *
 * It uses a DetailDialog as the generator for the list. Therefore, to change
 * its position, one can change the associated DetailDialog alignment.
 *
 */
(function($) {
    // ------------------------------------------------------------------------
    // Imports
    // ------------------------------------------------------------------------
	var ns = MPageControls;
	var attribute = MPageObjectOriented.createAttribute;
    var inherits = MPageObjectOriented.inherits;
    
	// -----------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------
	ns.DropDownList = function(element, tree) {
        this.setSelector(new ns.Selector(element, "selected", "unselected"));
        this.setOnShow(function() {
        });
        this.setOnHide(function() {
        });
        this.setOnSelect(function() {
        });
        this.setTree(tree);

		ns.Control.call(this, element);
	};

	inherits(ns.DropDownList, ns.Control);
	var prot = ns.DropDownList.prototype;

    // ------------------------------------------------------------------------
    // Attributes
    // ------------------------------------------------------------------------

    /**
     * The DetailDialog that contains the menu content
     */
    attribute(ns.DropDownList, "DetailDialog");

    /**
     * The selector that triggers the DetailDialog
     */
    attribute(ns.DropDownList, "Selector");

    /**
     * Data for the list
     */
    attribute(ns.DropDownList, "Tree");

    /**
     * Root node element of the tree, once the tree is parsed
     */
    attribute(ns.DropDownList, "RootNode");

    /**
     * Function to be executed when the drop down is shown
     */
    attribute(ns.DropDownList, "OnShow");

    /**
     * Function to be executed when the drop down has been hidden
     */
    attribute(ns.DropDownList, "OnHide");

    /**
     * Function to be executed when an item is selected
     */
    attribute(ns.DropDownList, "OnSelect");

    /**
     * Returns the current selected node in the tree. It is
     * updated by the select() method.
     */
    attribute(ns.DropDownList, "SelectedNode");

	// ------------------------------------------------------------------------
	// Inner Classes
	// ------------------------------------------------------------------------

	/**
	 * Represents a single node in a tree structure.
	 *
	 * This constructor will build an entire node tree according to JsonData
	 * and the provided arguments. If you are making a root node, parentNode
	 * can be null. ParentDropDown will be the same for all nodes in the tree.
	 *
	 * JsonData needs to be provided according to the following standard:
	 *
	 * var jsonData = {
	 *     name: "root",
	 *     children: [
	 *          {name: "Child 1" },
	 *          {
	 *           name: "Child 2",
	 *           children: [ ... ]
	 *          }
	 *     ]
	 * }   
	 *
	 * @param {Object} jsonData
	 * @param {Object} parentNode
	 * @param {Object} parentDropDown
	 */
	ns.DropDownList.Node = function(jsonData, parentNode, parentDropDown) {
		this.children = [];
		this.parent = parentNode;
		this.dropDown = parentDropDown;
		var self = this;

		$.each(jsonData, function(k, v) {
			if (k == "children") {
				$.each(v, function() {
					self.children.push(new ns.DropDownList.Node(this, self, parentDropDown));
				});
			}
			else {
				self[k] = v;
			}
		});
	};

	// ________________________________________________________________________

	/**
	 * Appends a series of nested lists of <ul> and <li> tags based on the tree
	 * structure of the current node. Also, attaches dropdown.select() to the
	 * on click event of each <li>.
	 *
	 * @param {Object} parentElement
	 */
	ns.DropDownList.Node.prototype.makeElement = function(parentElement) {
		var current = $("<li></li>").html(this.name);
		var self = this;
		$(current).click(function() {
			self.dropDown.select(self);
		});
		parentElement.append(current);

		var rootUl = "";
		if (this.children.length > 0) {
			rootUl = $("<ul></ul>");
			$.each(this.children, function() {
				this.makeElement(rootUl);
			});
		}
		parentElement.append(rootUl);

		return current;
	};

	// ------------------------------------------------------------------------
	// Public Member Methods
	// ------------------------------------------------------------------------

	/**
	 * Generates the root node with a tree of nodes and updates the contents
	 * of the DetailDialog with the generated <ul>s from the Node.
	 */
	prot.init = function() {
		this.setRootNode(new ns.DropDownList.Node(this.getTree(), null, this));
		var id = "controlContents" + this.getControlId();
		var rootUl = $("<ul></ul>");
		this.getRootNode().makeElement(rootUl);
		
		// we exclude the root node here
		var menuContent = $("<div></div>");
		menuContent.attr("id", id);
		menuContent.append(rootUl.children("ul"));
		menuContent.appendTo($("body"));
		
		this.setDetailDialog(new ns.DetailDialog(this.getElement(), menuContent));
		var self = this;
		this.getSelector().setOnSelect(function() {
			self.getDetailDialog().show();
		});
		this.getSelector().setOnUnselect(function() {
			self.getDetailDialog().hide();
		});
		this.getDetailDialog().setOnShow(function() {
			// make sure this will be above everyone else
			self.getDetailDialog().getContents().css("z-index", "7000");
			self.m_OnShow(self);
		});
		this.getDetailDialog().setOnHide(function() {
			self.m_OnHide(self);
		});
	};

	// ________________________________________________________________________

	/**
	 * Marks a node as selected, causing the drop down list to hide and its
	 * value to change.
	 *
	 * @param {Object} node
	 */
	prot.select = function(node) {
		this.getElement().html(node.name);
		this.setSelectedNode(node);
		this.getSelector().unselect();
		this.m_OnSelect(node);
	};

	// ________________________________________________________________________

	/**
	 * Shows the drop down list
	 */
	prot.show = function() {
		this.getDetailDialog().show();
	};
	// ________________________________________________________________________

	/**
	 * Hides the drop down list
	 */
	prot.hide = function() {
		this.getDetailDialog().hide();
	};
	// ________________________________________________________________________

	/**
	 * Erases the drop down list from the DOM
	 */
	prot.destroy = function() {
		this.getDetailDialog().destroy();
		this.getElement().remove();
	};
})(jQuery);
/**
 * drop_down_list.js
 * @author Leonardo Sa
 *
 * DropDownTree Class
 * ============================================================================
 *
 * Renders a detail dialog which contains a tree, usually used to lazy load
 * folders. The main difference between this control and the drop down list
 * is that this control can expand and controct folders, and perform ajax
 * calls for the folders
 *
 */

(function($) {
	// ------------------------------------------------------------------------
	// Imports
	// ------------------------------------------------------------------------
	var ns = MPageControls;
	var DropDown = MPageControls.DropDown;
	var inherits = MPageObjectOriented.inherits;
	var attribute = MPageObjectOriented.createAttribute;
	var Tree = MPageControls.Tree;

	// ------------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------
	ns.DropDownTree = function(element) {
		this.setTreeCreated(false);
		this.setOnSelect(function() {
		});
		this.setOnCreate(function() {
		    
		});
        DropDown.call(this, element, null);
	};

	inherits(ns.DropDownTree, DropDown);

	// ------------------------------------------------------------------------
	// Attributes
	// ------------------------------------------------------------------------
	attribute(ns.DropDownTree, "Tree");
	attribute(ns.DropDownTree, "TreeCreated");
	attribute(ns.DropDownTree, "OnLazyRead");
	attribute(ns.DropDownTree, "OnCreate");
	attribute(ns.DropDownTree, "OnSelect");

	// ------------------------------------------------------------------------
	// Member Methods
	// ------------------------------------------------------------------------
	var prot = ns.DropDownTree.prototype;

	prot.init = function() {
		var content = $("<div></div>");

        content.appendTo(this.getElement().offsetParent());
        content.attr("id", "content" + this.getControlId());
        this.setContents(content);
		
		DropDown.prototype.init.call(this);
		
		var self = this;
		this.getDetailDialog().setBeforeShow(function() {
			self.beforeShow();
		});
		
	};

    prot.setTreeElement = function(element) {
        this.mTreeElement = MPageControls.getId(element);
    };
    
    prot.getTreeElement = function() {
      return MPageControls.fromId(this.mTreeElement);  
    };

	// ________________________________________________________________________

	prot.create = function() {
		var self = this;
		var treeElement = $("<div class='dynatree'></div>").appendTo(this.getContents());
		var id = "treeElement" + this.getControlId();
		treeElement.attr("id", id);
		
		this.setTreeElement(treeElement);
		this.setTree(new MPageControls.Tree(this.getTreeElement()));
		this.getTree().setOnSelect(function(node) {
			self.onSelect(node);
		});
		this.getOnCreate()();
		this.setTreeCreated(true);
	};

	// ________________________________________________________________________

	prot.onSelect = function(node) {
		this.setValue(node.data.title);
		this.getSelector().unselect();
	};

	// ________________________________________________________________________

    /**
     * Returns the node that has been selected by the user mouse click 
     */
	prot.getSelectedNode = function() {
		if (this.getTree() === null || this.getTree() === undefined) {
			return null;
		}

		return this.getTree().getSelectedNode();
	};
	// ________________________________________________________________________

	/**
	 * Is executed before the tree is shown, and automatically triggers lazy
	 * loading if the tree hasn't been initialized yet.
	 */
	prot.beforeShow = function() {
		if (this.getTreeCreated()) {
			return;
		}

		this.create();
		if (this.getOnLazyRead()) {
			this.getTree().setOnLazyRead(this.getOnLazyRead());
		}
	};

})(jQuery);
/**
 * drop_down_list.js
 * @author Leonardo Sa
 *
 * Modeless Class
 * ============================================================================
 *
 * Renders a drop down list attached to the specified element. The only difference
 * between this class and the detaildialog class is that modeless windows can only
 * be opened one at a time.
 *
 */
(function($) {
	// ------------------------------------------------------------------------
	// Imports
	// ------------------------------------------------------------------------
	var ns = MPageControls;
	var oo = MPageObjectOriented;
	var inherits = oo.inherits;
	var attribute = oo.createAttribute;

	// ------------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------
	ns.Modeless = function(element, contentsElement) {
		this.setOnForceHide(function() {
		});
		ns.DetailDialog.call(this, element, contentsElement);
	};
	ns.Modeless.visibleInstance = null;
    inherits(ns.Modeless, ns.DetailDialog);

    // ------------------------------------------------------------------------
    // Attributes
    // ------------------------------------------------------------------------

	/**
	 * Callback executed when the modeless is forced to hide because another
	 * one is about to be shown
	 */
	attribute(ns.Modeless, "OnForceHide");

	// ------------------------------------------------------------------------
	// Member Methods
	// ------------------------------------------------------------------------
	var prot = ns.Modeless.prototype;
	
	prot.show = function() {
		// hides the last shown modeless instance
		if (ns.Modeless.visibleInstance && ns.Modeless.visibleInstance.getVisible()) {
			ns.Modeless.visibleInstance.hide();
			ns.Modeless.visibleInstance.getOnForceHide()();
		}

		ns.DetailDialog.prototype.show.call(this);

		// sets this modeless as the visible instance
		ns.Modeless.visibleInstance = this;
	};

})(jQuery);
/**
 * selector.js
 * @author Leonardo Sa
 *
 * Selector class
 * ============================================================================
 * A simple selector that alternates between two css classes on click, much
 * like a checkbox would do. The css styles can be specified in the constructor.
 */
(function($) {
    // -----------------------------------------------------------------------
    // Imports
    // ------------------------------------------------------------------------
	var ns = MPageControls;
	var inherits = MPageObjectOriented.inherits;
	var attribute = MPageObjectOriented.createAttribute;

	// ------------------------------------------------------------------------
	// Class Declaration
	// ------------------------------------------------------------------------
	ns.Selector = function(element, selClass, unselClass) {
		this.setIsSelected(false);
		this.setEnabled(true);
		this.setSelectedClass(selClass);
		this.setUnselectedClass(unselClass);
		this.setOnSelect(function() {
		});
		this.setOnUnselect(function() {
		});

		ns.Control.call(this, element);
	};
	
	// -----------------------------------------------------------------------
    // Attributes
    // ------------------------------------------------------------------------

	/**
	 * The CSS class to be applied to the element when it is selected
	 */
	attribute(ns.Selector, "SelectedClass");

	/**
	 * The CSS class to be applied to the element when it is unselected
	 */
	attribute(ns.Selector, "UnselectedClass");

	/**
	 * Whether the control has been selected or not
	 */
	attribute(ns.Selector, "IsSelected");

	/**
	 * Event fired on select
	 */
	attribute(ns.Selector, "OnSelect");

	/**
	 * Event fired on unselect
	 */
	attribute(ns.Selector, "OnUnselect");
	
	/**
	 * Whether the star will toggle when clicked on 
	 */
	attribute(ns.Selector, "Enabled");

	inherits(ns.Selector, ns.Control);
	var prot = ns.Selector.prototype;

	// ------------------------------------------------------------------------
	// Public Member Methods
	// ------------------------------------------------------------------------

	prot.init = function() {
		var self = this;
		this.getElement().addClass(this.getUnselectedClass());
		this.bind("click", this.getElement(), function() {
		    if (self.getEnabled()) {
			 self.toggle();
			}
		});

		if (this.getIsSelected()) {
			this.performSelection();
		}
		else {
			this.performUnselection();
		}
	};

	// ________________________________________________________________________

	/**
	 * Toggles the selector to select() or unselect()
	 */
	prot.toggle = function() {
		if (this.getIsSelected()) {
			this.unselect();
		}
		else {
			this.select();
		}
	};

	// ________________________________________________________________________

	/**
	 * Triggers the selection of the control
	 */
	prot.select = function() {
		if (this.getIsSelected()) {
			return;
		}

		this.performSelection();
		this.m_OnSelect(this);
	};
    
    // ________________________________________________________________________

	prot.performSelection = function() {
		this.getElement().removeClass(this.getUnselectedClass());
		this.getElement().addClass(this.getSelectedClass());
		this.setIsSelected(true);
	};

	// ________________________________________________________________________

	/**
	 * Triggers the unselection of the control
	 */
	prot.unselect = function() {
		if (!this.getIsSelected()) {
			return;
		}

		this.performUnselection();
		this.m_OnUnselect(this);
	};

    // ________________________________________________________________________

	prot.performUnselection = function() {
		this.getElement().removeClass(this.getSelectedClass());
		this.getElement().addClass(this.getUnselectedClass());
		this.setIsSelected(false);
	};

	// ________________________________________________________________________

	prot.destroy = function() {
		this.destroyEvents();
	};
})(jQuery); /**
 * tree.js
 * @author Leonardo Sa
 *
 * Tree class
 * ============================================================================
 *
 * Renders a AJAX tree of folders, based on the dynatree jquery plugin.
 * In order to populate the tree, one needs to register a function listener
 * by using setOnLazyRead.
 *
 */

(function($) {
	// ------------------------------------------------------------------------
	// Imports
	// ------------------------------------------------------------------------
	var ns = MPageControls;
	var attribute = MPageObjectOriented.createAttribute;
	var inherits = MPageObjectOriented.inherits;

	// ------------------------------------------------------------------------
	// Class declaration
	// ------------------------------------------------------------------------
	ns.Tree = function(element) {
		this.setDynatreeOptions({});
		this.setOnSelect(function() {
		});

		ns.Control.call(this, element);
	};

	inherits(ns.Tree, ns.Control);

	// ------------------------------------------------------------------------
	// Attributes
	// ------------------------------------------------------------------------

	/**
	 * Options for the dynatree third party library
	 */
	attribute(ns.Tree, "DynatreeOptions");

	/**
	 * Function to be executed when an element is selected
	 */
	attribute(ns.Tree, "OnSelect");

	/**
	 * Returns the dynatree node that is currently selected
	 */
	attribute(ns.Tree, "SelectedNode");

	var prot = ns.Tree.prototype;

	// ________________________________________________________________________

	prot.init = function() {

		var self = this;
		opts = this.getDynatreeOptions();
		opts.onLazyRead = function(node) {
			self.lazyRead(node);
		};
		opts.onActivate = function(node) {
			self.onSelect(node);
		};
		opts.OnPostInit = this.treeInit;
		opts.autoFocus = false;
		opts.initAjax = {};
		this.getElement().dynatree(opts);
	};

	// ________________________________________________________________________

	/**
	 * Defines a function to be executed whenever there is a need to load more
	 * nodes in the tree. A "node" argument will be passed with the node that
	 * is the parent caller. A first call to this function will be performed
	 * with the dynatree's root node to populate the initial folders.
	 *
	 * @param {function} function to be executed
	 */
	prot.setOnLazyRead = function(fun) {
		this.m_OnLazyRead = fun;
		this.lazyRead(this.getElement().dynatree("getRoot"));
	};

	// ________________________________________________________________________

	prot.getOnLazyRead = function() {
		return this.m_OnLazyRead;
	};

	// ________________________________________________________________________

	prot.lazyRead = function(node) {
		this.m_OnLazyRead(node);
	};

	// ________________________________________________________________________

	prot.onSelect = function(node) {
		this.getOnSelect()(node);
		this.setSelectedNode(node);
	};
})(jQuery); /**
 * A collection of functions which can be used to maintain, create, destroy and update menus.
 * The MP_MenuManager function keeps a copy of all of the Menu objects that have been created
 * for the current view.  If a Menu object is updated outside of these functions, the updated
 * version of the object should replace the stale version that is stored here by using the
 * updateMenuObject functionality.
 * @constructor
 */
var MenuManager = function() {
	//A collection of menu objects references by a unique i
	this.menuCollection = {};
	//Active Menu Stack
	this.menuStack = [];
	//Root menu offsetParent which will be used by submenus to attach their content
	this.offsetParent = null;
};

/**
 * This function will be used to add Menu objects to the collection of Menu objects.  This collection of
 * Menu objects will be the one source of this type of object and will be used when showing menus.
 * @param {Menu} menuObj An instance of the Menu object
 * @return {boolean} true if the object was added successfully, false otherwise
 */
MenuManager.prototype.addMenuObject = function(menuObj) {
	var menuId = "";
	//Check that he object is not null and that the object type is Menu
	if(!(Menu.prototype.isPrototypeOf(menuObj))) {
		MP_Util.LogError("MenuManager.addMenuObject only accepts objects of type Menu or any object that uses Menu.prototype");
		return false;
	}

	//Check for a valid id.
	menuId = menuObj.getId();
	if(!menuId) {
		//Menu id is not populated
		MP_Util.LogError("MenuManager.addMenuObject: no/invalid menu id given");
		return false;
	}
	else if(this.menuCollection[menuId]) {
		//Menu id is already in use
		MP_Util.LogError("MenuManager.addMenuObject: menu id" + menuId + " is already in use");
		return false;
	}

	//Add the Menu Object to the list of Menu objects
	this.menuCollection[menuId] = menuObj;
	return true;
};

/**
 * Closes the menus based on the elements currently in the menuStack.  If the forceClose flag is set to true, all menus will be
 * closed regardless of where a user is hovering.  If the forceClose flag is set to true all menus will be close up to the first menu
 * that is being hovered over by the user.
 * @param {string} menuId The id of the menu that should be closed
 * @return {boolean} True if the top menu was closed successfully, false otherwise
 */
MenuManager.prototype.closeMenuStack = function(forceClose) {
	var anchorActiveClass = "";
	var closeFunc = null;
	var self = this;
	var topMenuItem = null;

	try {
		//Check to see if there are any menus on the stack
		topMenuItem = this.menuStack.pop();
		if(topMenuItem) {
			//Check to see if the cursor is still over this menu, if so return
			if(!forceClose) {
				if(topMenuItem.isMouseOverMenu()) {
					//Push the menu back on the stack since we aren't closing it
					this.menuStack.push(topMenuItem);
					return true;
				}
			}

			//Delete the menu DOM elements
			$("#" + topMenuItem.getContentElementId()).remove();
			topMenuItem.setContentElementId("");

			//Remove the active class for the anchor element if supplied
			anchorActiveClass = topMenuItem.getAnchorActiveClass();
			if(anchorActiveClass) {
				$("#" + topMenuItem.getAnchorElementId()).removeClass(anchorActiveClass);
			}

			//Mark the menu as inactive so it can update all of its MenuItems with the proper active indicator
			topMenuItem.setIsActive(false);
			topMenuItem.setIsVisible(false);

			//Reset the mouse hover flag
			topMenuItem.setIsMouseOverMenu(false);

			//Clear the hover timeout since we are forcing the menu closed
			topMenuItem.clearHoverTimeout();

			//Close the next menu on stack and close it.
			return this.closeMenuStack(forceClose);
		}
		//Reset the offset parent since we have closed all menus down to the root
		this.offsetParent = null;
		return true;
	}
	catch(err) {
		MP_Util.LogJSError(err, null, "MenuManager", "closeMenu");
		return false;
	}
};

/**
 * Deletes the Menu object with the associated id of menuId from the collection of Menu objects.
 * @param {string} menuId The id of the Menu item to be deleted
 * @param {boolean} True if the menu was removed from the collection
 */
MenuManager.prototype.deleteMenuObject = function(menuId) {
	return (
	delete this.menuCollection[menuId]);
};

/**
 * Retrieves the Menu object with the associated id of menuId.
 * @param {string} menuId The id of the Menu object to retrieve
 * @return {Menu} The Menu object if it exists, null otherwise
 */
MenuManager.prototype.getMenuObject = function(menuId) {
	return this.menuCollection[menuId] || null;
};

/**
 * Render and show the menu based on the settings applied in the Menu object referenced by the menuId parameter.  This function will
 * create the container for the menu and have the menu populate the contents for that container.
 * @param {string} menuId The id of the Menu object to render
 * @return {boolean} True if the menu was rendered successfully, false otherwise.
 */
MenuManager.prototype.showMenu = function(menuId) {
	var anchorActiveClass = "";
	var anchorElement = null;
	var contentParentElement = null;
	var menuClass = "";
	var menuControl = null;
	var menuEle = null;
	var menuItems = null;
	var menuObj = null;
	var itemListEle = null;
	var itemArr = [];
	var itemArrCnt = 0;
	var self = this;
	var x = 0;

	//Get the Menu object
	menuObj = this.getMenuObject(menuId);
	if(!menuObj) {
		MP_Util.LogError("Menu " + menuId + " does not exist");
		return false;
	}

	//See if the menu already exists, if so delete it
	$("#menuContent" + menuId).remove();

	//See if this is a root menu.  If so close all other open menus
	if(menuObj.isRootMenu()) {
		this.closeMenuStack(true);
	}

	//Create the main container for the menu
	menuClass = (menuObj.isRootMenu()) ? "menu-container-root" : "menu-container-submenu";
	menuEle = $("<div></div>").attr("id", "menuContent" + menuId).addClass(menuClass + " " + menuObj.getTypeClass());
	
	//Check to see if the menu should be persistent.  If it is persistent ignore the hover events else create the hover events.
	if(!(menuObj.isPersistent() && menuObj.isRootMenu())){  
		//Setup the hover actions so we know which menu item the user is hovering over
		menuEle.hover(function() {
			//Set the flag to indicate that the user is hovering over the menu content
			menuObj.setIsMouseOverMenu(true);
			//Clear the timeout since we are back in the menu
			menuObj.clearHoverTimeout();
		}, function() {
			//Set the flag to indicate that the user is not hovering over the menu content
			menuObj.setIsMouseOverMenu(false);
			//Set the timeout since we have left the menu
			menuObj.startHoverTimeout();
		});
	}
	//Set the id for the menu's content section
	menuObj.setContentElementId("menuContent" + menuId);

	//Tell the menu object to create its own content
	menuItems = menuObj.generateMenuContent();
	$(menuItems).each(function(index, element) {
		$(menuEle).append(element);
	});

	//Apply the active class for the anchor element if supplied
	anchorActiveClass = menuObj.getAnchorActiveClass();
	if(anchorActiveClass) {
		$("#" + menuObj.getAnchorElementId()).addClass(anchorActiveClass);
	}

	//Append the menu to the offsetParent for the anchor so it will scroll correctly
	anchorElement = $("#" + menuObj.getAnchorElementId());
	//If the developer has defined a content parent element id then append the content to that location
	contentParentElement = $("#" + menuObj.getContentParentId());
	if(contentParentElement.length){
		$(contentParentElement).append(menuEle);
	}
	else{
		$(document.body).append(menuEle);
	}

	//We must explicitly set the width of the menu element for the controls framework
	$(menuEle).width($(menuEle).outerWidth());
	//Create the controls DetailDialog for our menu visuals
	menuControl = new MPageControls.DetailDialog(anchorElement, menuEle);
	menuControl.setAutoFlipHorizontal(menuObj.autoFlipHorizontal());
	menuControl.setAutoFlipVertical(menuObj.autoFlipVertical());
	menuControl.setElementCorner(menuObj.getAnchorConnectionCorner());
	menuControl.setContentsCorner(menuObj.getContentConnectionCorner());
	menuControl.show();

	//Push this menu onto the stack and update all of the necessary identifiers
	menuObj.setIsActive(true);
	menuObj.setIsVisible(true);
	if(menuObj.isRootMenu() && !menuObj.isPersistent()) {
		menuObj.startHoverTimeout(3000);
	}
	this.menuStack.push(menuObj);
};

/**
 * This function will update the visuals of the top menu currently being shown.  This function is typically
 * called when visual elements of a menu are being changed, such as the label for a menu item.
 * @param {string} menuId The id of the menu that needs to be refreshed.
 */
MenuManager.prototype.refreshMenuDisplay = function(menuId) {
	var menuObj = null;
	var topMenuIndex = 0;

	//Get the Menu object
	menuObj = this.getMenuObject(menuId);
	if(!menuObj) {
		MP_Util.LogError("Menu " + menuId + " does not exist");
		return false;
	}

	//Check to see if the menu is on top of the menu stack
	topMenuIndex = this.menuStack.length - 1;
	if(topMenuIndex >= 0 && menuObj === this.menuStack[topMenuIndex]) {
		this.showMenu(menuId);
	}
};

/**
 * Updates the existing Menu with a new instance of the object.  If the menu object does not exist it is added to the
 * collection
 * @param {Menu} menuObj The updated instance of the Menu object.
 * @return {boolean} True if the menu object was added/updated successfully, false otherwise.
 */
MenuManager.prototype.updateMenuObject = function(menuObj) {
	//Check that the object is not null and that the object type is Menu
	if(!Menu.prototype.isPrototypeOf(menuObj)) {
		MP_Util.LogError("MenuManager.updateMenuObject only accepts objects of type Menu");
		return false;
	}

	//Blindly update the Menu object.  If it didn't previously exist, it will now.
	this.menuCollection[menuObj.getId()] = menuObj;
	return true;
};

//This should only be instantiated once
var MP_MenuManager = new MenuManager();
/**
 * The MenuItem object contains all of the basic information needed for the various menu item elements.  Depending on how these
 * variables are set the menu will flex accordingly.  All elements that will be displayed within a menu will inherit from this
 * base class.
 * @constructor
 */
function MenuItem(menuId) {

	//A boolean to determine if this MenuItem is active or not
	this.m_activeInd = false;

	//This is the developer defined click function that can be created to handle any custom logic that needs to occur when the menu item
	// is selected
	this.m_clickFunc = function() {
	};

	//This flag will determine if the containing menu should be closed when the item is clicked
	this.m_closeOnClick = true;

	//This is the default function that will be executed when the MenuItem is clicked
	this.m_defaultClickFunction = function() {
	};

	//This flag will determine if the menu item is disabled or not.
	this.m_disabledInd = false;

	//This will be the id of the DOM element associated with this MenuItem
	this.m_elementId = "";

	//This will be the label used when the MenuItem is shown within a menu
	this.m_label = "";

	//The id given to the MenuItem object.  This id should be unique and will be used to set/retrieve the
	//MenuItem object
	this.m_menuItemId = menuId;

	//This type CSS class will be used to style the different types of menu item elements
	this.m_menuItemTypeClass = "";

}

/** Checkers **/

/**
 * A check to see if this MenuItem object will force the containing Menu to close when clicked
 * @return {boolean} True if the containing menu should close, false otherwise
 */
MenuItem.prototype.closeOnClick = function() {
	return this.m_closeOnClick;
};

/**
 * Checks to see if this MenuItem is actively being used or shown to the user
 */
MenuItem.prototype.isActive = function() {
	return this.m_activeInd;
};

/**
 * A check to see if this MenuItem object is disabled or not
 * @return {boolean} True if the menu item is disabled, false otherwise
 */
MenuItem.prototype.isDisabled = function() {
	return this.m_disabledInd;
};

/** Getters **/

/**
 * Returns the click function assigned to this MenuItem object.
 * @return {function} The function to be assigned to the click action for this MenuItem
 */
MenuItem.prototype.getClickFunction = function() {
	return this.m_clickFunc;
};

/**
 * Retrieves the default onClick function for the MenuItem object.  This default functionality should be created for each object
 * that uses the MenuItem prototype if special actions need to occur when the element is clicked.  The developer will still be able
 * to define custom actions in the standard onClick function.
 * @return {function} The default function to execute when an element is clicked.
 */
MenuItem.prototype.getDefaultClickFunction = function() {
	return this.m_defaultClickFunction;
};

/**
 * Retrieves the DOM element id associated with the visuals for this MenuItem object
 * @return {string} The DOM element id given to this MenuItem object
 */
MenuItem.prototype.getElementId = function() {
	return this.m_elementId;
};

/**
 * Retrieves the id given to this MenuItem object
 * @return {string} The id given to this MenuItem object
 */
MenuItem.prototype.getId = function() {
	return this.m_menuItemId;
};

/**
 * Retrieves the menu item label for this MenuItem object
 * @return {string} The label given to this MenuItem object
 */
MenuItem.prototype.getLabel = function() {
	return this.m_label;
};

/**
 * Retrieves the menu item type class given to this MenuItem object for visual styling purposes
 * @return {string} The type class given to this MenuItem object
 */
MenuItem.prototype.getTypeClass = function() {
	return this.m_menuItemTypeClass;
};

/** Setters **/

/**
 * Sets the function to execute when the MenuItem item is clicked within the context of a menu
 * @param {function} clickFunc The function that will be executed when the MenuItem item is clicked
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setClickFunction = function(clickFunc) {
	if( typeof clickFunc == "function") {
		this.m_clickFunc = clickFunc;
	}
	return this;
};

/**
 * Sets the flag which determines if the menu which contains this MenuItem should be closed when the user selects this item.
 * @param {boolean} closeFlag The boolean that identifies whether the containing menu will be closed or not.
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setCloseOnClick = function(closeFlag) {
	if( typeof closeFlag == "boolean") {
		this.m_closeOnClick = closeFlag;
	}
	return this;
};

/**
 * Retrieves the default onClick function for the MenuItem object.  This default functionality should be created for each object
 * that uses the MenuItem prototype if special actions need to occur when the element is clicked.  The developer will still be able
 * to define custom actions in the standard onClick function.
 * @param {function} The default function to execute when an element is clicked.
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setDefaultClickFunction = function(clickFunc) {
	if( typeof clickFunc == "function") {
		this.m_defaultClickFunction = clickFunc;
	}
	return this;
};

/**
 * Sets the id which will be used to identify the DOM element associated with this MenuItem
 * @param {string} elementId The id that will be assigned to this MenuItem object
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setElementId = function(elementId) {
	if( typeof elementId == "string") {
		this.m_elementId = elementId;
	}
	return this;
};

/**
 * Sets the id which will be used to identify a particular MenuItem object.
 * @param {string} id The id that will be assigned to this MenuItem object
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setId = function(id) {
	if(id && typeof id == "string") {
		this.m_menuItemId = id;
	}
	return this;
};

/**
 * Sets the active flag for this MenuItem indicating that the containing menu is being shown
 * @param {boolean} activeInd The indicator which will be used to determine if the menu is active or not
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setIsActive = function(activeInd) {
	if( typeof activeInd === "boolean") {
		this.m_activeInd = activeInd;
	}
	return this;
};

/**
 * Sets the flag which determines if the menu item should be disabled or not.
 * @param {boolean} disabled The boolean that identifies whether the menu item should be disabled or not
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setIsDisabled = function(disabled) {
	if( typeof disabled == "boolean") {
		this.m_disabledInd = disabled;
	}
	return this;
};

/**
 * Sets the label used when showing the MenuItem within the context of a menu.  The display of the menu will be updated if the menu
 * is currently being shown
 * @param {string} label The label that will be shown within the menu for this menu item
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setLabel = function(label) {
	var menuContainerId = "";

	if(label && typeof label == "string") {
		this.m_label = label;

		//Update the label if this menu item is acive
		if(this.isActive()) {
			//Refresh the menu contents
			menuContainerId = this.getElementId().replace(/menuSel[0-9]+-/, "");
			MP_MenuManager.refreshMenuDisplay(menuContainerId);
		}
	}

	return this;
};

/**
 * Sets the specific css class for this type of MenuItem object.  This class will be used for styling purposes
 * @param {string} typeClass The CSS class that will be assigned to this MenuItem object for styling purposes
 * @return {MenuItem} The menu item object calling this function so chaining can be used
 */
MenuItem.prototype.setTypeClass = function(typeClass) {
	if( typeof typeClass == "string") {
		this.m_menuItemTypeClass = typeClass;
	}
	return this;
};

/**
 * This function is used to generate the default HTML for the MenuItem.  This includes a selection indicator and the label.  Any
 * object which inherits the MenuItem prototype can override this function and create its own selection content.
 * @return {[jQuery]} An array of jQuery objects which will be appended to the menu.
 */
MenuItem.prototype.generateSelectionContent = function() {
	return [$("<span>&nbsp;</span>").addClass("menu-selection-ind"), $("<span></span>").addClass("menu-selection").html(this.getLabel())];
};
/**
 * The Menu object inherits from the MenuItem object and adds additional functionality used to create standard menus.
 * Specifically the developer can define the individual items that will be displayed within the menu.  Those elements
 * must be an object that inherits from the MenuItem object.
 * @constructor
 */
function Menu(menuId) {
	//Set the id for this object
	this.setId(menuId);

	//Set the close on click flag to false
	this.setCloseOnClick(false);

	//Set the default on click function for this element.  This function will be run regardless of the existence of the
	//developer defined click function.  This function is used when a menu items is defined as a submenu.  If the menu is
	//defined as a root menu, this will be ignored.
	this.setDefaultClickFunction(function(clickEvent) {
		MP_MenuManager.showMenu(this.getId());
	});
	
	//This following flags are used to allow the menu content to flip horizontally and vertically when there isn't room on the screen to 
	//accommodate them based on the anchor/content connection corners.
	this.m_autoFlipVertical = true;
	this.m_autoFlipHorizontal = true;
	
	//This string identifies the CSS class to add to the anchor element when the menu it is
	//associated with is active
	this.m_anchorActiveClass = "";

	//This string identifies the id of the anchor element that this menu will be attached to
	this.m_anchorElementId = "";

	//This object defines which corners of the content section and the anchor will be connected.  The default
	//values attach the bottom right corner of the anchor with the top right corner of the content
	this.anchorCorner = null;
	this.contentCorner = null;

	//This string identifies the id of the content element that will be created when the menu is opened.  This id
	//will be created on the fly when the menu is opened.
	this.m_contentElementId = "";
	
	//This string will identify the id of the element to append the menu to.  If this is not defined the menu will be appended to the body
	this.m_contentParentId = "";
	
	//This flag will determine if the menu can be shown as persistent.  If set, no hover timeout or mouseleave will cause the 
	//menu to disappear.  This setting is only valid for root menus
	this.m_isPersistent = false;

	//This this the timeout reference we are using to determine if the menu contents should still be displayed or not
	this.m_hoverTimout = null;

	//This array contains the list of MenuItem objects which will make up the contents of the Menu.  This element starts off
	//as null to ensure each instance of the Menu object gets its own list of MenuItem objects.
	this.m_menuItemArr = null;

	//This will be the function which gets executed when the menu is being closed
	this.m_onCloseFunction = null;

	//This boolean will be used to determine if this menu item is the root or a submenu item
	this.m_rootMenuInd = false;

	//This boolean indicates if the user is hovering over the menu or not
	this.m_mouseOverContent = false;

	//This boolean indicated whether the user has their mouse over the MenuItem selection within a menu
	this.m_mouseOverAnchor = false;

	//This boolean indicates if the menu contents are visible to the user or not
	this.m_visibleInd = false;

}

/**
 * Setup the prototype and constructor to inherit from the base Menu object
 */
Menu.prototype = new MenuItem();
Menu.prototype.constructor = MenuItem;

/** Checkers **/

/**
 * Checks to see if the menu should be auto flipped horizontally by the detailed dialog controls.
 * @return {boolean} True if this Menu should be auto flipped horizontally
 */
Menu.prototype.autoFlipHorizontal = function() {
	return this.m_autoFlipHorizontal;
};

/**
 * Checks to see if the menu should be auto flipped vertically by the detailed dialog controls.
 * @return {boolean} True if this Menu should be auto flipped vertically
 */
Menu.prototype.autoFlipVertical = function() {
	return this.m_autoFlipVertical;
};

/**
 * Checks to see if the MenuItem with the passed in id is already defined within the context of this menu.
 */
Menu.prototype.containsMenuItem = function(menuItemId) {
	var x = 0;
	var itemArr = this.m_menuItemArr;
	if(!itemArr) {
		return false;
	}
	for( x = itemArr.length; x--; ) {
		if(itemArr[x].getId() === menuItemId) {
			return true;
		}
	}
	return false;
};

/**
 * Checks to see if the menu is a root menu or a sub menu element
 * @return {boolean} True if this Menu is considered a root menu, false otherwise
 */
Menu.prototype.isRootMenu = function() {
	return this.m_rootMenuInd;
};

/**
 * Checks to see if the user is hovering over the menu or not
 * @return {boolean} True if the mouse is currently over the menu content
 */
Menu.prototype.isMouseOverMenu = function() {
	return this.m_mouseOverContent;
};

/**
 * Checks to see if the user is hovering over the menu anchor or not.
 * @return {boolean} True if the mouse is hovering over the menu anchor, false otherwise
 */
Menu.prototype.isMouseOverAnchor = function() {
	return this.m_mouseOverAnchor;
};

/**
 * Checks to see if the menu should be persistent or not.  A persistent menu does not have a hover timeout nor does the menu 
 * disappear when the user hovers outside of the menu's area.  The menu can only be closed programatically or when another menu
 * is opened.
 * @return {boolean} True if the menu should be shown as persistent, false otherwise
 */
Menu.prototype.isPersistent = function() {
	return this.m_isPersistent;
};

/**
 * Checks to see if the menu contents are visible to the user or not.
 * @return {boolean} True if the menu is currently visible, false otherwise
 */
Menu.prototype.isVisible = function() {
	return this.m_visibleInd;
};

/** Getters **/

/**
 * Gets the CSS class to apply to the menu's anchor element when the menu is active
 * @return {string} The CSS class to apply to the anchor element when the associated menu is active
 */
Menu.prototype.getAnchorActiveClass = function() {
	return this.m_anchorActiveClass;
};

/**
 * Gets the corner of the anchor element which the content section should connect with.
 * @return {[string]} An array of two strings which identify which corner of the anchor element should connect with the content
 * element.
 */
Menu.prototype.getAnchorConnectionCorner = function() {
	if(!this.anchorCorner){
		return ["bottom", "right"];
	}
	return this.anchorCorner;
};

/**
 * Gets the id of the DOM element that this menu is attached to.
 * @return {string} The id of the DOM element that this menu is attached to
 */
Menu.prototype.getAnchorElementId = function() {
	return this.m_anchorElementId;
};

/**
 * Gets the function to call when the Menu is closed
 * @return {function} The function to execute when the Menu is closed
 */
Menu.prototype.getCloseFunction = function() {
	return this.m_onCloseFunction;
};

/**
 * Gets the corner of the content section which the anchor element should connect with.
 * @return {[string]} An array of two strings which identify which corner of the content element should connect with the anchor
 * element.
 */
Menu.prototype.getContentConnectionCorner = function() {
	if(!this.contentCorner){
		return ["top", "right"];
	}
	return this.contentCorner;
};

/**
 * Gets the id of the content container element that is created when the menu is active.
 * @return {string} The id of the DOM element that contains all of the menus contents.
 */
Menu.prototype.getContentElementId = function() {
	return this.m_contentElementId;
};

/**
 * Gets the id of the parent element where the content will be appended.  If this is not set the the document.body will be used
 * @return {string} The id of the DOM element where the menu content will be appended.
 */
Menu.prototype.getContentParentId = function() {
	return this.m_contentParentId;
};

/**
 * Gets the array of MenuItem elements that are set to show within this menu.
 * @return {[MenuItem]} An array of MenuItem object that will be used when creating the menu
 */
Menu.prototype.getMenuItemArray = function() {
	return this.m_menuItemArr;
};

/** Setters **/

/**
 * Sets the corner of the anchor element which should connect with the content section.  The cornerArr should only contain two
 * strings.  The first string will determine the top or bottom edge of the anchor element and the second string will determine the
 * left or right edge of the anchor element.  For example, ["top", "left"].
 * @param {[string]} cornerArr The string array identifying the corner of the anchor element which should connect with the content
 * section
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setAnchorConnectionCorner = function(cornerArr) {
	if( typeof cornerArr === "object" && cornerArr.length) {
		this.anchorCorner = cornerArr;
	}
	return this;
};

/**
 * Sets the CSS class to apply to the anchor element when it's associated menu is active
 * @param {string} activeClass The CSS class to apply to the anchor element when the menu is active
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setAnchorActiveClass = function(activeClass) {
	if( typeof activeClass === "string") {
		this.m_anchorActiveClass = activeClass;
	}
	return this;
};

/**
 * Sets the id of the DOM element that this menu is anchored to
 * @param {string} anchorId The id of the DOM element that this menu is attached to
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setAnchorElementId = function(anchorId) {
	if( typeof anchorId === "string") {
		this.m_anchorElementId = anchorId;
	}
	return this;
};

/**
 * Sets the flag to allow/disallow the horizontal repositioning of menus based on available space.
 * @param {boolean} horizontalFlip A flag used to set the horizontal flip indicator of the detail dialog that is used to house the menu contents
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setAutoFlipHorizontal = function(horizontalFlip) {
	if( typeof horizontalFlip === "boolean") {
		this.m_autoFlipHorizontal = horizontalFlip;
	}
	return this;
};

/**
 * Sets the flag to allow/disallow the vertical repositioning of menus based on available space.
 * @param {boolean} verticalFlip A flag used to set the vertical flip indicator of the detail dialog that is used to house the menu contents
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setAutoFlipVertical = function(verticalFlip) {
	if( typeof verticalFlip === "boolean") {
		this.m_autoFlipVertical = verticalFlip;
	}
	return this;
};

/**
 * Sets the function that will be called when this menu is closed
 * @param {function} closeFunc The function to execute when the menu is closed
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setCloseFunction = function(closeFunc) {
	if( typeof closeFunc == "function") {
		this.m_onCloseFunction = closeFunc;
	}
	return this;
};

/**
 * Sets the corner of the content container element which should connect with the anchor element.  The cornerArr should only contain
 * two strings. The first string will determine the top or bottom edge of the content container element and the second string will
 * determine the left or right edge of the content container element.  For example, ["top", "left"].
 * @param {[string]} cornerArr The string array identifying the corner of the anchor element which should connect with the content
 * section
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setContentConnectionCorner = function(cornerArr) {
	if( typeof cornerArr === "object" && cornerArr.length) {
		this.contentCorner = cornerArr;
	}
	return this;
};

/**
 * Sets the id of the DOM element that contains this menu's content.  This id will be set when the menu is being shown and removed
 * with it is closed.
 * @param {[string]} elementId The id of the DOM element that contains all of the menus contents.
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setContentElementId = function(elementId) {
	if( typeof elementId === "string") {
		this.m_contentElementId = elementId;
	}
	return this;
};

/**
 * Sets the id of the DOM element where the menu contents will be appended.  If this value is set in the root menu 
 * all submenus will also be appended to the same parent.  If no value is supplied then the menu content will be
 * appended to the document.body
 * @param {[string]} parentId The id of the DOM element where the menu content will be appended
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setContentParentId = function(parentId) {
	if( typeof parentId === "string") {
		this.m_contentParentId = parentId;
	}
	return this;
};

/**
 * Sets the element id for the sub menu selection.  This element is only used when creating sub menus
 * @param {string} elementId The element id for the sub menu selection
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setElementId = function(elementId) {
	if( typeof elementId == "string") {
		this.m_elementId = elementId;
		this.m_anchorElementId = elementId;
	}
	return this;
};

/**
 * Sets the active flag for this menu item indicating that the menu is being shown.  Setting a Menu item as active also sets all of
 * the MenuItems that are contained within it to active
 * @param {boolean} activeInd The indicator which will be used to determine if the menu is active or not
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsActive = function(activeInd) {
	var menuItems = null;
	var x = 0;

	if( typeof activeInd === "boolean") {
		this.m_activeInd = activeInd;
	}

	//Set all of the menuItems as active/inactive as well
	menuItems = this.getMenuItemArray();
	if(menuItems && menuItems.length) {
		for( x = menuItems.length; x--; ) {
			menuItems[x].setIsActive(activeInd);
		}
	}

	return this;
};

/**
 * Sets the flag which determines if this menu is a root menu or not
 * @param {boolean} rootMenuInd The indicator which will be used to determine if the menu is a root menu or a submenu
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsRootMenu = function(rootMenuInd) {
	if( typeof rootMenuInd === "boolean") {
		this.m_rootMenuInd = rootMenuInd;
	}
	return this;
};

/**
 * Sets the flag which indicates if the mouse is hovering over the menu's contents or not.
 * @param {boolean} mouseOver The indicator which indicates if the mouse if over the menu's contents or not
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsMouseOverMenu = function(mouseOver) {
	if( typeof mouseOver === "boolean") {
		this.m_mouseOverContent = mouseOver;
	}
	return this;
};

/**
 * Sets the flag which indicates if the mouse is hovering over the menu's anchor or not.
 * @param {boolean} mouseOver The indicator which indicates if the mouse if over the menu's anchor or not
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsMouseOverAnchor = function(mouseOver) {
	if( typeof mouseOver === "boolean") {
		this.m_mouseOverAnchor = mouseOver;
	}
	return this;
};


/**
 * Sets the flag which indicates if the menu is persistent or not.  A persistent menu does not have a hover timeout nor does the menu 
 * disappear when the user hovers outside of the menu's area.  The menu can only be closed programatically or when another menu
 * is opened.
 * @param {boolean} persistent The boolean which indicates if the menu should be persistent or not.
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsPersistent = function(persistent) {
	if( typeof persistent === "boolean") {
		this.m_isPersistent = persistent;
	}
	return this;
};

/**
 * Sets the visible flag for this menu item indicating that the menu is being shown
 * @param {boolean} visibleInd The indicator which will be used to determine if the menu is being shown or not
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.setIsVisible = function(visibleInd) {
	if( typeof visibleInd === "boolean") {
		this.m_visibleInd = visibleInd;
	}
	return this;
};

/** Helper Functions **/

/**
 * Adds a MenuItem object to the list of menu items that will be shown within this menu
 * @param {MenuItem} menuItem The MenuItem object to add to the Menu.
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.addMenuItem = function(menuItem) {
	//Verify that this element is a MenuItem
	if(MenuItem.prototype.isPrototypeOf(menuItem)) {
		if(!this.m_menuItemArr) {
			this.m_menuItemArr = [];
		}
		this.m_menuItemArr.push(menuItem);
		
		//Add the menu to the collection within MP_MenuManager so we can reference it later when attempting to render the menu
		if(Menu.prototype.isPrototypeOf(menuItem)) {
			//Make sure we append the submenu to the same parent as the root
			menuItem.setContentParentId(this.m_contentParentId);
			MP_MenuManager.updateMenuObject(menuItem);
		}
	}
	return this;
};

/**
 * Sets the hover timeout for the menu contents.  This hover timeout will be used when moving the mouse over and out of the menu's
 * content.  This can be set to a specific time or default to 250 ms.
 * @param {number} setTime The time in milliseconds before the menu will atempt to close itself
 */
Menu.prototype.startHoverTimeout = function(setTime) {
	var that = this;
	setTime = setTime || 250;
	this.clearHoverTimeout();
	this.m_hoverTimout = window.setTimeout(function() {
		//Get the close function and execute it
		var closeFunc = that.getCloseFunction();
		if(closeFunc) {
			closeFunc.call(that);
		}
		MP_MenuManager.closeMenuStack(false);
	}, setTime);

};

/**
 * Clears the hover timeout for the menu.  This happens when the user hovers over the menu's content or when the user hovers
 * over the menu's anchor.
 */
Menu.prototype.clearHoverTimeout = function() {
	window.clearTimeout(this.m_hoverTimout);
};

/**
 * This function will insert a MenuItem object into the list of MenuItems that will be shown within the menu.
 * @param {MenuItem} menuItem The MenuItem object to insert
 * @param {number} index The index where the MenuItem will be inserted
 * @return {Menu} The Menu object calling this function so chaining can be used
 */
Menu.prototype.insertMenuItem = function(menuItem, index) {
	//create the menu item array if it is null
	if(!this.m_menuItemArr) {
		this.m_menuItemArr = [];
	}

	if( typeof index != "number") {
		return this;
	}

	//Verify that this element is a MenuItem and the index is valid
	if(MenuItem.prototype.isPrototypeOf(menuItem) && index <= this.m_menuItemArr.length && index >= 0) {
		this.m_menuItemArr.splice(index, 0, menuItem);
		//Add the menu to the collection so we can reference it later when attempting to render the menu
		if(Menu.prototype.isPrototypeOf(menuItem)) {
			MP_MenuManager.updateMenuObject(menuItem);
		}
	}
	return this;
};

/**
 * This function removes a specific MenuItem element from the menu item array
 * @param {MenuItem} menuItem The MenuItem object to remove from the Menu's list of menu items.
 * @return {boolean} True if a MenuItem was removed, false otherwise
 */
Menu.prototype.removeMenuItem = function(menuItem) {
	var x = 0;
	var menuItemArr = this.m_menuItemArr;

	if(!menuItemArr) {
		return false;
	}
	//Verify that this element is a MenuItem
	if(MenuItem.prototype.isPrototypeOf(menuItem) && !this.isActive()) {
		for( x = menuItemArr.length; x--; ) {
			if(menuItemArr[x] === menuItem) {
				menuItemArr.splice(x, 1);
				//Remove the menu from  the collection
				if(Menu.prototype.isPrototypeOf(menuItem)) {
					MP_MenuManager.deleteMenuObject(menuItem);
				}
				return true;
			}
		}
	}
	return false;
};

/**
 * This function is used to generate the HTML content for this menu.  It examines each MenuItem that is contained within
 * the m_menuItemArray and generates the content for each item, applies the hover events, applies the click events and returns an
 * array of jQuery objects which will make up the contents of the menu.
 * @return {[jQuery]} An array of jQuery object which make of the menu contents.
 */
Menu.prototype.generateMenuContent = function() {
	var disabledClass = "";
	var element = null;
	var elementArr = [];
	var itemArr = this.getMenuItemArray();
	var itemArrCnt = (itemArr) ? itemArr.length : 0;
	var menuItem = null;
	var selectorEle = null;

	function generateClickFunction(menuItemObj) {
		return function(ele) {
			var clickFunc = null;
			if(!menuItemObj.isDisabled()) {
				//Check to see if the element should close on click
				if(menuItemObj.closeOnClick()) {
					//Close the entire menu
					MP_MenuManager.closeMenuStack(true);
				}
				else {
					//Close any menus above this item
					MP_MenuManager.closeMenuStack(false);
				}

				//Perform the default MenuItem click event
				clickFunc = menuItemObj.getDefaultClickFunction();
				clickFunc.call(menuItemObj, ele);

				//Perform the specialized MenuItem click action
				clickFunc = menuItemObj.getClickFunction();
				if(clickFunc) {
					clickFunc.call(menuItemObj, ele);
				}

			}
		};

	}

	function generateHoverOverFunction(menuItemObj) {
		return function() {
			//If the MenuItem is a Menu
			if(Menu.prototype.isPrototypeOf(menuItemObj)) {
				//Set the flag to indicate that the user is hovering over the menu anchor
				menuItemObj.setIsMouseOverAnchor(true);
				//Check to see if the menu is currently active
				if(menuItemObj.isVisible()) {
					//Clear the hover timeout so it doesn't disappear
					menuItemObj.clearHoverTimeout();
				}
				else {
					//Show the menu after a quarter of a second
					//Need to make sure we don't open this menu item too soon
					window.setTimeout(function() {
						//If we are still hovering over this menu item selector, show the menu
						if(menuItemObj.isMouseOverAnchor()) {
							MP_MenuManager.showMenu(menuItemObj.getId());
						}
					}, 251);

				}
			}
		};

	}

	function generateHoverOutFunction(menuItemObj) {
		return function() {
			//If the MenuItem is a Menu
			if(Menu.prototype.isPrototypeOf(menuItemObj)) {
				//Set the flag to indicate that the user is no longer hovering over the menu anchor
				menuItemObj.setIsMouseOverAnchor(false);
				//Check to see if the menu is currently active
				if(menuItemObj.isVisible()) {
					//Start the hover timeout so the menu will disappear if we dont go back
					menuItemObj.startHoverTimeout();
				}
			}
		};

	}

	//Loop through each MenuItem and have it generate its menu selection content
	for( x = 0; x < itemArrCnt; x++) {
		menuItem = itemArr[x];
		//Create and store the dom element id for the menu item
		menuItemId = "menuSel" + x + "-" + this.getId();
		menuItem.setElementId(menuItemId);
		//Create the menu item html container
		disabledClass = (menuItem.isDisabled()) ? "menu-item-disabled" : "";
		element = $("<div></div>").addClass("menu-item " + disabledClass + " " + menuItem.getTypeClass()).attr("id", menuItemId);

		//Hover logic for the menu items
		$(element).hover(generateHoverOverFunction(menuItem), generateHoverOutFunction(menuItem));
		selectorEle = menuItem.generateSelectionContent();
		$(selectorEle).each(function(index, selector) {
			$(element).append(selector);
		});

		//Add the default and custom click event to the action
		$(element).click(generateClickFunction(menuItem));

		elementArr.push(element);
	}
	return elementArr;
};

/**
 * This function is in charge of generating the selection content when it is defined as a submenu.  This content will make up the
 * anchor of the submenu.
 * @return {[jQuery]} An array of jQuery elements which will make up the menu selection HTML content.
 */
Menu.prototype.generateSelectionContent = function() {
	return [$("<span>&nbsp;</span>").addClass("menu-selection-ind"), $("<span></span>").addClass("menu-selection").html(this.getLabel()), $("<span>&nbsp;</span>").addClass("menu-submenu-ind")];
};
/**
 * The DynamicMenu object inherits from the Menu object and adds additional functionality used when creating dynamic menus.
 * Specifically the developer can define the content creation function which will be in charge of generating the HTML content
 * to show within the menu display.
 * @constructor
 */
function DynamicMenu(menuId) {
	//Set the id for this object
	this.setId(menuId);

	//Set the close on click flag to false
	this.setCloseOnClick(false);

	//This will be the function used to generate the dynamic menu's content
	this.m_contentCreationFunc = function() {
	};

}

/**
 * Setup the prototype and constructor to inherit from the base Menu object
 */
DynamicMenu.prototype = new Menu();
DynamicMenu.prototype.constructor = Menu;

/** Checkers **/

/** Getters **/

/**
 * Returns the function that will be used to create the dynamic menu content.
 * @return {function} The function to call when the dynamic menu should create its content
 */
DynamicMenu.prototype.getContentCreationFunction = function() {
	return this.m_contentCreationFunc;
};

/** Setters **/

/**
 * Sets the function to execute when the DynamicMenu should render its contents.
 * @param {function} creationFunc The function that will be executed when the MenuSelection items is clicked for this DynamicMenu
 * @return {DynamicMenu} The DynamicMenu object calling this function so chaining can be used
 */
DynamicMenu.prototype.setContentCreationFunction = function(creationFunc) {
	if( typeof creationFunc == "function") {
		this.m_contentCreationFunc = creationFunc;
	}
	return this;
};

/** Helper Functions **/
/**
 * Call the function defined to create the dynamic menu's content and passes the results back to the caller.  If no function
 * is defined it will simply return null.
 * @return {[jQuery]} An array of jQuery object which will be used as the dynamic menu content.  Null of the content creation
 * function is not defined.
 */
DynamicMenu.prototype.generateMenuContent = function() {
	var contentCreationFunct = this.getContentCreationFunction();
	if(contentCreationFunct) {
		return contentCreationFunct.call(this);
	}
	return null;
};
/**
 * @constructor
 * The AdvancedFilterMenu object will be used by component developers creating specialized filter menus for components.
 * This menu creates dialog for the developer so that advanced filter menus are consistent across all uses.
 */
function AdvancedFilterMenu(menuId) {

	//Set the id for the menu element
	this.setId(menuId);

	//Set the type class for this type of menu
	this.setTypeClass("adv-filter-menu-override");
	
	//Prevent the vertical flipping of the advanced filter menu
	this.setAutoFlipVertical(false);
	
	//Default settings for the Advanced Filter Menu
	this.settings = {
		//Settings for the cancel button
		cancel : {
			enabled : false,
			onclick : function() {
				return false;
			},

			label : i18n.CANCEL
		},
		//Settings for the options checkbox
		checkbox : {
			enabled : false,
			isChecked : false,
			onclick : function() {
				return false;
			},

			label : ""
		},
		//Settins for the sction link
		actionLink : {
			enabled : false,
			onclick : function() {
				return false;
			},

			label : ""
		},
		//This is the function that will be called when attempting to populate the advanced filter menu content
		advancedFilterCreationFunction : function() {
			return null;
		},
		//This is the width that will be applied to the menu when rendering
		dimensions : {
			width : 600
		},
		//Settings for the save button
		save : {
			enabled : false,
			onclick : function() {
				return false;
			},

			label : i18n.SAVE
		}
	};
	//Set the content creation function for this instance of the AdvnacedFilterMenu
	this.setContentCreationFunction(function() {
		var checkbox = this.settings.checkbox;
		var actionLink = this.settings.actionLink;
		var save = this.settings.save;
		var cancel = this.settings.cancel;
		//Create the main container for all of the AdvancedFilterMenu
		var menuContent = $("<div class='adv-filter-menu'></div>").width(this.settings.dimensions.width);
		//Create the inner container for the AdvancedFilterMenu
		var innerContainer = $("<div class='adv-filter-menu-inner-container'></div>").appendTo(menuContent);
		//Create the label based on the label defined in the object and append to the innerContainer
		$("<div class='adv-filter-menu-label'>" + this.getLabel() + "</div>").appendTo(innerContainer);
		//Add the custom content into a pre-defined section by calling the advancedFilterCreationFunction
		$("<div class='adv-filter-menu-custom-content'></div>").html(this.settings.advancedFilterCreationFunction()).appendTo(innerContainer);
		//If we do not have any of the controls enabled, just return the menu without any controls
		if(!(checkbox.enabled || save.enabled || cancel.enabled || actionLink.enabled)) {
			return menuContent;
		}

		//At this point, we have at least one control
		var controlContainer = $("<div class='adv-filter-menu-control-container'></div>").appendTo(menuContent);
		var buttonContainer = $("<span class='adv-filter-menu-button-container'></span>");
		var savePadding = 0;
		//Check to see if we should create a check box or an action link
		if(checkbox.enabled && checkbox.label) {
			var checkBoxContainer = $("<span class='adv-filter-menu-checkbox-container'></span>");
			//Create the contents for the checkbox and label and apply the click events
			var checkboxEle = $("<input type='checkbox'>");
			checkboxEle[0].checked = checkbox.isChecked;
			checkboxEle.click(checkbox.onclick).appendTo(checkBoxContainer);
			$("<span class='adv-filter-menu-checkbox-label'>" + checkbox.label + "</span>").appendTo(checkBoxContainer);
			checkBoxContainer.appendTo(controlContainer);
		}
		else if(actionLink.enabled && actionLink.label) {
			//Create the content for the action link and apply the click events
			var actionLinkContainer = $("<span class='adv-filter-menu-action-container'></span>");
			$("<span class='adv-filter-menu-action-label'>" + actionLink.label + "</span>").click(actionLink.onclick).appendTo(actionLinkContainer);
			actionLinkContainer.appendTo(controlContainer);
		}
		//If the cancel button is enabled
		if(cancel.enabled) {
			$("<button type='button' class='adv-filter-menu-button'>").html(cancel.label).click(cancel.onclick).appendTo(buttonContainer);
			savePadding = 6;
			buttonContainer.appendTo(controlContainer);
		}
		//If the save button has been enabled
		if(save.enabled) {
			$("<button type='button' class='adv-filter-menu-button'>").html(save.label).css("margin-right", savePadding).click(save.onclick).appendTo(buttonContainer);
			buttonContainer.appendTo(controlContainer);
		}
		return menuContent;
	});

}

AdvancedFilterMenu.prototype = new DynamicMenu();
AdvancedFilterMenu.prototype.constructor = DynamicMenu;

/**
 * Sets the function that will inject the custom menu content for the AdvancedFilterMenu
 * @param {function} contentFunction The function used to inject the custom content into this menu
 */
AdvancedFilterMenu.prototype.setAdvancedFilterCreationFunction = function(contentFunction) {
	if(contentFunction && typeof contentFunction == "function") {
		this.settings.advancedFilterCreationFunction = contentFunction;
	}
};

/**
 * Sets the label to appear on the Cancel button
 * @param {string} lebel The string used as the label
 */
AdvancedFilterMenu.prototype.setCancelButtonLabel = function(label) {
	if(label && typeof label == "string") {
		//If the user is setting the label, assume they want the button enabled
		this.setIsCancelButtonEnabled(true);
		this.settings.cancel.label = label;
	}
};

/**
 * Sets the function to occur when the user clicks the cancel button
 * @param {function} cancelFunction The function to execute when the user clicks the cancel button
 */
AdvancedFilterMenu.prototype.setCancelFunction = function(cancelFunction) {
	if(cancelFunction && ( typeof cancelFunction == "function")) {
		//If the user is setting the cancel function, assume they want the button enabled
		this.setIsCancelButtonEnabled(true);
		this.settings.cancel.onclick = cancelFunction;
	}
};

/**
 * Sets the function for when the user clicks the check box
 * @param {function} checkboxClickFunction the function to execute when the user clicks the check box
 */
AdvancedFilterMenu.prototype.setCheckboxClickFunction = function(checkboxClickFunction) {
	if(checkboxClickFunction && ( typeof checkboxClickFunction == "function")) {
		//If the user defines the checkbox click function, assume they want it enabled
		this.setIsCheckboxEnabled(true);
		this.settings.checkbox.onclick = checkboxClickFunction;
	}
};

/**
 * Sets the label to the right of the checkbox
 * @param {string} label The label to the right of the checkbox
 */
AdvancedFilterMenu.prototype.setCheckboxLabel = function(label) {
	if( typeof label == "string") {
		this.settings.checkbox.label = label;
	}
};

/**
 * Sets the function to execute when you click on the action link
 * @param {function} linkFunc The function to execute when the action link is clicked
 */
AdvancedFilterMenu.prototype.setActionLinkFunction = function(linkFunc) {
	if(linkFunc && typeof linkFunc == "function") {
		//If the user is setting the action label assume they are wanting it to show
		this.setIsActionLinkEnabled(true);
		this.settings.actionLink.onclick = linkFunc;
	}
};

/**
 * Sets the label for the action link
 * @param {string} label The label for the action link
 */
AdvancedFilterMenu.prototype.setActionLinkLabel = function(label) {
	if( typeof label == "string") {
		this.settings.actionLink.label = label;
	}
};

/**
 * Function to set if the cancel button is enabled
 * @param {boolean} isEnabled True if the cancel button is to be enabled, false otherwise
 */
AdvancedFilterMenu.prototype.setIsCancelButtonEnabled = function(isEnabled) {
	if( typeof isEnabled == "boolean") {
		this.settings.cancel.enabled = isEnabled;
	}
};

/**
 * Sets whether or not the check box is checked by default
 * @param {boolean} isChecked True if the check box is checked by default, false otherwise
 */
AdvancedFilterMenu.prototype.setIsCheckboxChecked = function(isChecked) {
	if( typeof isChecked == "boolean") {
		this.settings.checkbox.isChecked = isChecked;
	}
};

/**
 * Sets whether or not the check box for the menu is enabled
 * @param {boolean} isEnabled True if the check box should be enabled, false otherwise
 */
AdvancedFilterMenu.prototype.setIsCheckboxEnabled = function(isEnabled) {
	if( typeof isEnabled == "boolean") {
		this.settings.checkbox.enabled = isEnabled;
	}
};

/**
 * Sets whether or not the action link for the menu is enabled
 * @param {boolean} isEnabled True if the action link should be enabled or not
 */
AdvancedFilterMenu.prototype.setIsActionLinkEnabled = function(isEnabled) {
	if( typeof isEnabled == "boolean") {
		this.settings.actionLink.enabled = isEnabled;
	}
};

/**
 * Function to set if the save button is enabled
 * @param {boolean} isEnabled True if the save button should be enabled or not
 */
AdvancedFilterMenu.prototype.setIsSaveButtonEnabled = function(isEnabled) {
	if( typeof isEnabled == "boolean") {
		this.settings.save.enabled = isEnabled;
	}
};

/**
 * Sets the label to appear on the Save button
 * @param {string} label The string used as the label
 */
AdvancedFilterMenu.prototype.setSaveButtonLabel = function(label) {
	if(label && typeof label == "string") {
		this.setIsSaveButtonEnabled(true);
		this.settings.save.label = label;
	}
};

/**
 * Sets the function to occur when the user clicks the save button
 * @param {function} saveFunction The function to execute when the user clicks the save button
 */
AdvancedFilterMenu.prototype.setSaveFunction = function(saveFunction) {
	if(saveFunction && ( typeof saveFunction == "function")) {
		//If the user is setting the save function, assume they want the button enabled
		this.setIsSaveButtonEnabled(true);
		this.settings.save.onclick = saveFunction;
	}
};

/**
 * Sets the width of the AdvancedFilterMenu
 * @param {number} width How wide the menu is to be when first rendered
 */
AdvancedFilterMenu.prototype.setWidth = function(width) {
	if(width && typeof width == "number") {
		this.settings.dimensions.width = width;
	}
};

function ContextMenu(menuId) {
	//Set the id for this object
	this.setId(menuId);
	//The is the x offset of the cursor at the time of the context menu creation
	this.m_xOffset = 0;
	//The is the x offset of the cursor at the time of the context menu creation
	this.m_yOffset = 0;
}

/**
 * Setup the prototype and constructor to inherit from the base Menu object
 */
ContextMenu.prototype = new Menu();
ContextMenu.prototype.constructor = Menu;

/** Checkers **/

/** Getters **/

ContextMenu.prototype.getXOffset = function() {
	return this.m_xOffset;
};


ContextMenu.prototype.getYOffset = function() {
	return this.m_yOffset;
};


/** Setters **/


ContextMenu.prototype.setXOffset = function(xOffset) {
	if( typeof xOffset == "number") {
		this.m_xOffset = xOffset;
	}
	return this;
};


ContextMenu.prototype.setYOffset = function(yOffset) {
	if( typeof yOffset == "number") {
		this.m_yOffset = yOffset;
	}
	return this;
};

/** Helper Functions **/

ContextMenu.prototype.setAnchorElement = function() {
	$(document.body).append($("<div id='" + this.getId() + "Anchor' class='context-menu'></div>").css({"top": this.getYOffset(), "left":this.getXOffset()}));
};

ContextMenu.prototype.removeAnchorElement = function(){
	$("#" + this.getId() + "Anchor").remove();
};
/**
 * The MenuSelection object inherits from the MenuItem object and is used as a basic selection option for a menu.  
 * The MenuSelection object does have the power to determine if the parent Menu will closed or not when it is clicked.
 * Additional options for this menu item include showing a custom selection icon in front of the menu item.
 * @constructor
 */
function MenuSelection(selectionId) {
	//Set the id for this object
	this.setId(selectionId);
	
	//Set the default on click function for this element.  This function will be run regardless of the existence of the 
	//developer defined click function.
	this.setDefaultClickFunction(function(clickEvent){
		//Toggle the selection indicator if we aren't supposed to close the menu and this item isn't disabled
		if(!this.closeOnClick() && !this.isDisabled()){
			this.toggleSelection();
		}
	});
	
	//This flag determines if the menu selection should show as being selected or not.
	this.m_selectedInd = false;
	
	//The selection class will be used to style item which have been selected within the menu
	this.m_selectedClass = "menu-item-selected";
}

/**
 * Setup the prototype and constructor to inherit from the base MenuItem object
 */
MenuSelection.prototype = new MenuItem();
MenuSelection.prototype.constructor = MenuItem;

/** Checkers **/
/**
 * Checks to see if this MenuSelection should be shown as selected or not
 * @return {boolean} True if this MenuSelection has been selected or should default to being selected
 */
MenuSelection.prototype.isSelected = function(){
	return this.m_selectedInd;
};

/** Getters **/
/**
 * Returns the class to apply to items which have been selected within the menu or are defaulted to being selected
 * @return {string} The class which will be applied to selected menu selection items
 */
MenuSelection.prototype.getSelectedClass = function(){
	return this.m_selectedClass;
};

/** Setters **/
/**
 * Sets the indicator which determines if this MenuSelection should be shown as selected or not within the menu
 * @param {boolean} selected A boolean which indicates if this MenuSelection item should show up as selected within the menu
 * @return {MenuSelection}
 */
MenuSelection.prototype.setIsSelected = function(selected){
	var selectedClass = "";
	var element = null;
	if(typeof selected === "boolean"){
		this.m_selectedInd = selected;
	
		//If the MenuSelection element is active update the visuals
		if(this.isActive()){
			selectedClass = this.getSelectedClass();
			element = $("#" + this.getElementId() + " :first-child");
			if(selected){
				$(element).addClass(selectedClass);
			}
			else{
				$(element).removeClass(selectedClass);
			}
		}
	}
		
	return this;
};

/**
 * Sets the class which will be applied to the menu item element which indicates an item has been selected.
 * @param {string} selectedClass The CSS class to apply to a selected menu item
 * @return {MenuSelection} The MenuSelection object calling this function so chaining can be used
 */
MenuSelection.prototype.setSelectedClass = function(selectedClass){
	if(typeof selectedClass === "string"){
		this.m_selectedClass = selectedClass;
	}
	return this;
};

/** Helper Functions **/

/**
 * This function is used to toggle the isSelected flag for the MenuSelection item
 */
MenuSelection.prototype.toggleSelection = function(){
	this.setIsSelected(!this.isSelected());
};

/**
 * This function is used to generate the HTML which will be shown within the menu when it is rendered
 */
MenuSelection.prototype.generateSelectionContent = function(){
	var selectedClass = this.getSelectedClass();
	if(!this.isSelected()){
		selectedClass = "";
	}
	return [$("<span>&nbsp;</span>").addClass("menu-selection-ind " + selectedClass), $("<span></span>").addClass("menu-selection").html(this.getLabel())];
};/* This object is used to easily place a separator within the context of a menu */
function MenuSeparator(seperatorId) {
	//Set the id for this object
	this.setId(seperatorId);
	
	//Set the type class for this item since it requires special styling
	this.setTypeClass("menu-separator");
}

/**
 * Setup the prototype and constructor to inherit from the base MenuItem object
 */
MenuSeparator.prototype = new MenuItem();
MenuSeparator.prototype.constructor = MenuItem;

/**
 * Returns a non-breaking space so the container element will always show.
 */
MenuSeparator.prototype.generateSelectionContent = function(){
	return ["&nbsp;"];
};/**
 * @constructor
 * The UtilitiesMenu object will be used by component developers to create utilities drop down dialogs which are persistent.
 * This means that there will be no timeout when the user hovers over and hovers our of the menus content area.  These menus 
 * will need to be closed programitically or will be closed automatically when another menu is opened.
 */
function UtilitiesMenu(menuId) {

	//Set the id for the menu element
	this.setId(menuId);

	//Set the type class for this type of menu
	this.setTypeClass("utilities-menu-override");

	//Set the default active anchor class
	this.setAnchorActiveClass("vwp-util-active");
	//Set the menu as persistent
	this.setIsPersistent(true);
	
	//Set the root menu flag
	this.setIsRootMenu(true);
	
	//Default settings for the Utilities Menu
	this.settings = {
		//This is the function that will be called when attempting to populate the Utilities Menu content
		utilitiesContentCreationFunction : function() {
			return null;
		},
		//This is the width that will be applied to the menu when rendering
		dimensions : {
			width : 300,
			maxHeight: ""
		}
	};
	//Set the content creation function for this instance of the UtilitiesMenu
	this.setContentCreationFunction(function() {
		//Create the main container for all of the UtilitiesMenu
		var menuContent = $("<div class='utilities-menu'></div>").width(this.settings.dimensions.width);
		//Create the inner container for the UtilitiesMenu
		var innerContainer = $("<div class='utilities-menu-inner-container'></div>").appendTo(menuContent);
		//Create the label based on the label defined in the object and append to the innerContainer
		$("<div class='utilities-menu-label'>" + this.getLabel() + "</div>").appendTo(innerContainer);
		//Add the custom content into a pre-defined section by calling the utilitiesContentCreationFunction
		$("<div class='utilities-menu-custom-content'></div>").css("max-height", this.settings.dimensions.maxHeight || "").html(this.settings.utilitiesContentCreationFunction()).appendTo(innerContainer);
		return menuContent;
	});

}

UtilitiesMenu.prototype = new DynamicMenu();
UtilitiesMenu.prototype.constructor = DynamicMenu;

UtilitiesMenu.prototype.setIsRootMenu = function(isRoot){
	if(typeof isRoot == "boolean"){
		if(!isRoot){
			throw new Error("UtilitiesMenu can only be used as root menus");
		}
		else{
			this.m_rootMenuInd = isRoot;
		}
	}
};

UtilitiesMenu.prototype.setIsPersistent = function(isPersistent){
	if(typeof isPersistent == "boolean"){
		if(!isPersistent){
			throw new Error("UtilitiesMenu can only be used as a persistent menu");
		}
		else{
			this.m_isPersistent = isPersistent;
		}
	}
};

/**
 * Sets the function that will inject the custom menu content for the UtilitiesMenu
 * @param {function} contentFunction The function used to inject the custom content into this menu
 */
UtilitiesMenu.prototype.setUtilitiesContentCreationFunction = function(contentFunction) {
	if(contentFunction && typeof contentFunction == "function") {
		this.settings.utilitiesContentCreationFunction = contentFunction;
	}
};

/**
 * Sets the width of the UtilitiesMenu
 * @param {number} width How wide the menu is to be when first rendered
 */
UtilitiesMenu.prototype.setWidth = function(width) {
	if(width && typeof width == "number") {
		this.settings.dimensions.width = width;
	}
};
/**
 * Sets the maxHeight of the utilities menu
 * @param {number} width How wide the menu is to be when first rendered
 */
UtilitiesMenu.prototype.setMaxHeight = function(maxHeight) {
	if(maxHeight && typeof maxHeight == "number") {
		this.settings.dimensions.maxHeight = maxHeight;
	}
};TemplateEngine={};
(function(ns,$){ns.getHtmlTags=function(){var tags=["html","span","head","body","pre","h1","h2","h3","h4","h5","h6","b","i","em","strong","font","a","p","br","dl","dt","dd","ol","ul","li","div","img","hr","table","th","tr","td","tbody","thead","form","option","input","textarea","button"];
var result={};
result=ns.getTags(tags);
return result;
};
ns.getTags=function(tags){var result={};
$.each(tags,function(i,tagname){result[tagname]=ns.tag(tagname);
});
return result;
};
ns.tag=function(tagname){return function(){var args=[].slice.call(arguments);
args.unshift(tagname);
var tagObj=new ns.Tag(tagname);
ns.Tag.apply(tagObj,args);
return tagObj;
};
};
ns.button=function(attributes){attributes.type="button";
return new ns.Tag("input",attributes,null);
};
ns.textbox=function(attributes){attributes.type="text";
return new ns.Tag("input",attributes,null);
};
ns.Tag=function(name,args){this.name=name;
this.parent=null;
this.element=null;
this.content="";
this.attributes={};
if(arguments.length==1){return;
}var arg2=arguments[1];
var contentOffset=1;
if(arg2 instanceof Object&&!(arg2 instanceof ns.Tag)&&!(arg2 instanceof String)&&!(arg2 instanceof Array)){this.attributes=arg2;
contentOffset=2;
}if(arguments.length==2&&contentOffset==2){return;
}var contentArr=[];
for(var i=contentOffset;
i<arguments.length;
i++){if(arguments[i] instanceof Array){$.merge(contentArr,arguments[i]);
}else{contentArr.push(arguments[i]);
}}this.content=contentArr;
};
ns.Tag.prototype.render=function(){this.makeElement();
this.makeContent();
return this.element;
};
ns.Tag.prototype.makeElement=function(){var element=$("<"+this.name+"></"+this.name+">");
$.each(this.attributes,function(key,value){if(!value){value="";
}element.attr(key,value);
});
this.element=element;
return element;
};
ns.Tag.traverse=function(content,parentTag){if(!content){return;
}if(content instanceof ns.Tag){content.parent=parentTag;
parentTag.element.append(content.render());
return;
}if(!(content instanceof Array)){parentTag.element.append(content);
return;
}$.each(content,function(key,value){ns.Tag.traverse(value,parentTag);
});
};
ns.Tag.prototype.makeContent=function(){ns.Tag.traverse(this.content,this);
};
ns.Template=function(templateFunction){this.m_function=templateFunction;
this.m_factory=null;
};
ns.Template.prototype.render=function(context){var scope=new ns.ScopeManager();
if(this.m_factory){this.m_factory.before(scope);
}var rootTag=this.m_function(context);
if(!(rootTag instanceof ns.Tag)){alert("The template function does not return a Tag instance.");
}var rendered=rootTag.render();
scope.clean();
if(this.m_factory){this.m_factory.after(scope);
}return rendered;
};
ns.TemplateFactory=function(templates){var self=this;
$.each(templates,function(k,v){if(k!="before"&&k!="after"){self[k]=new ns.Template(v);
self[k].m_factory=self;
}else{self[k]=v;
}});
};
ns.TemplateFactory.prototype.before=function(){};
ns.TemplateFactory.prototype.after=function(){};
ns.ScopeManager=function(){this.m_originalScope={};
};
ns.ScopeManager.prototype.use=function(objects){var self=this;
$.each(objects,function(k,v){if(window[k]!==undefined){self.m_originalScope[k]=window[k];
}window[k]=v;
});
};
ns.ScopeManager.prototype.clean=function(){var self=this;
$.each(this.m_originalScope,function(k,v){window[k]=v;
});
};
}(TemplateEngine,jQuery));
function MeasurementBaseComponent(criterion){this.m_resultCount=0;
this.m_isEventSetInfo=false;
this.m_isComment=false;
MeasurementBaseComponent.method("setResultCount",function(value){this.m_resultCount=value;
});
MeasurementBaseComponent.method("getResultCount",function(){return(this.m_resultCount);
});
MeasurementBaseComponent.method("setIncludeEventSetInfo",function(value){this.m_isEventSetInfo=value;
});
MeasurementBaseComponent.method("includeEventSetInfo",function(){return(this.m_isEventSetInfo);
});
MeasurementBaseComponent.method("setIncludeComments",function(value){this.m_isComment=value;
});
MeasurementBaseComponent.method("includeComments",function(){return(this.m_isComment);
});
MeasurementBaseComponent.method("InsertData",function(){var timerLoadComponent=MP_Util.CreateTimer(this.getComponentLoadTimerName(),this.getCriterion().category_mean);
try{getMeasurementData(this);
}catch(err){if(timerLoadComponent){timerLoadComponent.Abort();
timerLoadComponent=null;
}}finally{if(timerLoadComponent){timerLoadComponent.Stop();
}}});
function getMeasurementData(component){var groups=component.getGroups();
if(groups&&groups.length>0){var mgr=new MP_Core.XMLCCLRequestThreadManager(component.HandleSuccess,component,true);
var criterion=component.getCriterion();
var programName="MP_RETRIEVE_N_RESULTS_JSON";
for(var x=0,xl=groups.length;
x<xl;
x++){var group=groups[x];
var sEventSets="0.0",sEventCodes="0.0";
var sBeginDate="^^";
var sEndDate="^^";
var esInfo=(component.includeEventSetInfo())?1:0;
var commentInfo=(component.includeComments())?1:0;
var sendAr=[];
var request=null;
var thread=null;
var sEncntr=(component.getScope()===2)?criterion.encntr_id+".0":"0.0";
if(group instanceof MPageEventSetGroup){sEventSets=MP_Util.CreateParamArray(group.getEventSets(),1);
}else{if(group instanceof MPageEventCodeGroup){sEventCodes=MP_Util.CreateParamArray(group.getEventCodes(),1);
}else{if(group instanceof MPageSequenceGroup){var mapItems=group.getMapItems();
sEventSets=MP_Util.CreateParamArray(MP_Util.GetValueFromArray("CODE_VALUE",mapItems),1);
}else{if(group instanceof MPageGrouper){var g=group.getGroups();
var ec=[];
for(var y=0,yl=g.length;
y<yl;
y++){if(g[y] instanceof MPageEventCodeGroup){ec=ec.concat(g[y].getEventCodes());
}}sEventCodes=MP_Util.CreateParamArray(ec,1);
}else{continue;
}}}}sendAr.push("^MINE^",criterion.person_id+".0",sEncntr,criterion.provider_id+".0",criterion.ppr_cd+".0",component.getResultCount(),"^^",sEventSets,sEventCodes,component.getLookbackUnits(),component.getLookbackUnitTypeFlag(),esInfo,sBeginDate,sEndDate,commentInfo);
request=new MP_Core.ScriptRequest(component,"ENG:MPG.MEASBASE.O1 - load "+group.getGroupName());
request.setProgramName(programName);
request.setParameters(sendAr);
request.setAsync(true);
thread=new MP_Core.XMLCCLRequestThread(group.getGroupName(),component,request);
mgr.addThread(thread);
}mgr.begin();
}else{MP_Core.CreateSimpleError(component,i18n.discernabu.measurement_base_o1.ERROR_MISSING_ES_EC);
}}}MeasurementBaseComponent.inherits(MPageComponent);
var CERN_MEASUREMENT_BASE_O1=function(){function getMeasurementDataArray(recordData,personnelArray,codeArray){var measureArray=[];
if(!codeArray){codeArray=MP_Util.LoadCodeListJSON(recordData.CODES);
}if(!personnelArray){personnelArray=MP_Util.LoadPersonelListJSON(recordData.PRSNL);
}var results=recordData.RESULTS;
for(var i=0,il=results.length;
i<il;
i++){var result=results[i];
if(result.CLINICAL_EVENTS.length>0){for(var j=0,jl=result.CLINICAL_EVENTS.length;
j<jl;
j++){var meas=result.CLINICAL_EVENTS[j];
for(var k=0,kl=meas.MEASUREMENTS.length;
k<kl;
k++){var measurement=new MP_Core.Measurement();
measurement.initFromRec(meas.MEASUREMENTS[k],codeArray);
measureArray.push(measurement);
}}}}return measureArray;
}return{LoadMeasurementDataMap:function(recordData,personnelArray,codeArray,sortOption){var mapObjects=[];
var results=recordData.RESULTS;
if(!codeArray){codeArray=MP_Util.LoadCodeListJSON(recordData.CODES);
}if(!personnelArray){personnelArray=MP_Util.LoadPersonelListJSON(recordData.PRSNL);
}for(var i=0,il=results.length;
i<il;
i++){var result=results[i];
if(result.CLINICAL_EVENTS.length>0){for(var j=0,jl=result.CLINICAL_EVENTS.length;
j<jl;
j++){var measureArray=[];
var mapObject=null;
if(result.EVENT_CD>0){mapObject=new MP_Core.MapObject(result.EVENT_CD,measureArray);
}else{mapObject=new MP_Core.MapObject(result.EVENT_SET_NAME,measureArray);
}var meas=result.CLINICAL_EVENTS[j];
for(var k=0,kl=meas.MEASUREMENTS.length;
k<kl;
k++){var measurement=new MP_Core.Measurement();
measurement.initFromRec(meas.MEASUREMENTS[k],codeArray);
measureArray.push(measurement);
}if(measureArray.length>0){if(sortOption){measureArray.sort(sortOption);
}else{measureArray.sort(CERN_MEASUREMENT_BASE_O1.SortByEffectiveDateDesc);
}mapObjects.push(mapObject);
}}}}return mapObjects;
},LoadMeasurementDataArray:function(recordData,personnelArray,codeArray,sortOption){var measureArray=getMeasurementDataArray(recordData,personnelArray,codeArray);
if(measureArray.length>0){if(sortOption){measureArray.sort(sortOption);
}else{measureArray.sort(CERN_MEASUREMENT_BASE_O1.SortByEffectiveDateDesc);
}}return measureArray;
},LoadMeasurementDataArrayNoSort:function(recordData,personnelArray,codeArray){return getMeasurementDataArray(recordData,personnelArray,codeArray);
},SortByEffectiveDateDesc:function(a,b){if(a.getDateTime()>b.getDateTime()){return -1;
}else{if(a.getDateTime()<b.getDateTime()){return 1;
}}return 0;
}};
}();
function CustomComponentStyle(){this.initByNamespace("cust");
}CustomComponentStyle.prototype=new ComponentStyle();
CustomComponentStyle.prototype.constructor=ComponentStyle;
function CustomComponent(criterion){var m_compNamespace="";
var m_compOptionsObjName="";
var m_custCompRef=null;
this.setCriterion(criterion);
this.setStyles(new CustomComponentStyle());
this.setComponentLoadTimerName("USR:MPG.CUSTOM_COMP.O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.CUSTOM_COMP.O1 - render component");
this.updateLabel=function(title){var rootComponentNode=this.getRootComponentNode();
var secHead=Util.gc(rootComponentNode,0);
var secTitle=Util.gc(Util.Style.g("sec-title",secHead,"span")[0],0);
var anchor=_gbt("a",secTitle);
if(anchor[0]){anchor[0].innerHTML=title;
}else{secTitle.innerHTML=title;
}};
}CustomComponent.prototype=new MPageComponent();
CustomComponent.prototype.constructor=MPageComponent;
CustomComponent.prototype.setComponentNamespace=function(value){this.m_compNamespace=value;
};
CustomComponent.prototype.getComponentNamespace=function(){return this.m_compNamespace;
};
CustomComponent.prototype.setComponentOptionsObjectName=function(value){this.m_compOptionsObjName=value;
};
CustomComponent.prototype.getComponentOptionsObjectName=function(){return this.m_compOptionsObjName;
};
CustomComponent.prototype.setCustomComponentReference=function(value){this.m_custCompRef=value;
};
CustomComponent.prototype.getCustomComponentReference=function(){return this.m_custCompRef;
};
CustomComponent.prototype.InsertData=function(){CERN_CUSTOM_COMP_O1.GetCustomCompTable(this);
};
CustomComponent.prototype.openTab=function(){var criterion=this.getCriterion();
var sParms="/PERSONID="+criterion.person_id+" /ENCNTRID="+criterion.encntr_id+" /FIRSTTAB=^"+this.getLink()+"+^";
APPLINK(0,criterion.executable,sParms);
this.InsertData();
};
CustomComponent.prototype.getFilterMappingsObj=function(){var reportMean=this.getReportMean();
var custCompNum=/[0-9]+$/.exec(reportMean);
var fullPageComp=(/.?_fp_.?/.exec(reportMean))?"FP_":"";
this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_PRG_"+custCompNum,{type:"STRING",field:"FREETEXT_DESC",setFunction:this.setComponentNamespace});
this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_OBJ_"+custCompNum,{type:"STRING",field:"FREETEXT_DESC",setFunction:this.setComponentOptionsObjectName});
if(fullPageComp==="FP_"){this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_"+custCompNum+"_DISPLAY",{type:"Boolean",field:"FREETEXT_DESC",setFunction:this.setDisplayEnabled});
}return this.m_filterMappingsObj;
};
CustomComponent.prototype.getMaxHeight=function(){var compDOMObj=null;
var compHeight=0;
var contentBodyHeight=0;
var calcHeight=null;
var container=null;
var contentBodyObj=null;
var miscHeight=20;
var viewHeight=0;
if(this.getStyles().getComponentType()===CERN_COMPONENT_TYPE_WORKFLOW){container=$("#vwpBody");
if(!container.length){return;
}viewHeight=$(container).height();
compDOMObj=$(this.getRootComponentNode());
if(!compDOMObj.length){return;
}contentBodyObj=$(this.getSectionContentNode());
if(contentBodyObj.length){compHeight=compDOMObj.height();
contentBodyHeight=$(contentBodyObj).height();
calcHeight=(viewHeight-(compHeight-contentBodyHeight+miscHeight));
}}return calcHeight;
};
CustomComponent.prototype.preProcessing=function(){if(this.getStyles().getComponentType()!==CERN_COMPONENT_TYPE_WORKFLOW){var resizeTimout=null;
var self=this;
$(window).resize(function(){if(resizeTimout){clearTimeout(resizeTimout);
}resizeTimout=setTimeout(function(){self.resizeComponent();
},110);
});
}};
CustomComponent.prototype.resizeComponent=function(){var maxHeight=null;
var contentBodyObj=null;
var maxWidth=null;
var compObj=null;
compObj=this.getCustomComponentReference();
if(!compObj){return;
}contentBodyObj=this.getSectionContentNode();
maxHeight=this.getMaxHeight();
compObj.setProperty("maxHeight",maxHeight);
maxWidth=$(contentBodyObj).width();
if(maxHeight){$(contentBodyObj).css("max-height",maxHeight).css("overflow-y","auto");
}compObj.resize(maxWidth,maxHeight);
};
var CERN_CUSTOM_COMP_O1=function(){return{GetCustomCompTable:function(component){var criterion=component.getCriterion();
var compId;
var compNamespace;
var custComp;
var callback;
var optionsObjectName;
var options;
var contentBodyObj;
var compHeight;
try{compNamespace=component.getComponentNamespace();
eval("custComp = new "+compNamespace+"();");
}catch(err){if(compNamespace){err=new Error(i18n.discernabu.customcomponents_o1.INVALID_NAMESPACE.replace("{0}",compNamespace));
}else{err=new Error(i18n.discernabu.customcomponents_o1.UNDEFINED_NAMESPACE);
}MP_Util.LogJSError(err,component,"customcomp.js","GetCustomCompTable");
CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,err);
return;
}try{optionsObjectName=component.getComponentOptionsObjectName();
if(optionsObjectName){eval("options = "+optionsObjectName+";");
}else{options=null;
}}catch(err){if(!options){err=new Error(i18n.discernabu.customcomponents_o1.INVALID_OPTIONS.replace("{0}",optionsObjectName));
}MP_Util.LogJSError(err,component,"customcomp.js","GetCustomCompTable");
CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,err);
return;
}try{compId=component.getStyles().getId();
custComp.setOption("id",compId);
custComp.setOption("parentComp",component);
compHeight=component.getMaxHeight();
custComp.setProperty("mine","mine");
custComp.setProperty("compId",component.getComponentId());
custComp.setProperty("personId",criterion.person_id);
custComp.setProperty("userId",criterion.provider_id);
custComp.setProperty("encounterId",criterion.encntr_id);
custComp.setProperty("pprCd",criterion.ppr_cd);
custComp.setProperty("PPRCode",criterion.ppr_cd);
custComp.setProperty("staticContent",criterion.static_content);
custComp.setProperty("compSourceLocation",criterion.static_content+"/custom-components/");
custComp.setProperty("positionCd",criterion.position_cd);
custComp.setProperty("categoryMean",criterion.category_mean);
custComp.setProperty("viewableEncounters",criterion.getPersonnelInfo().getViewableEncounters());
custComp.setProperty("headerTitle",component.getLabel());
custComp.setProperty("headerSubTitle","");
custComp.setProperty("headerOverflowState",component.isScrollingEnabled());
custComp.setProperty("maxHeight",compHeight);
if(compHeight){contentBodyObj=component.getSectionContentNode();
$(contentBodyObj).css("max-height",compHeight).css("overflow-y","auto");
}custComp.setTarget(component.getSectionContentNode());
MPage.addCustomComp(custComp);
component.setCustomComponentReference(custComp);
callback=function(custCompRef){CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,null);
};
custComp.generate(custComp.getTarget(),callback,options);
}catch(err){MP_Util.LogJSError(err,component,"customcomp.js","GetCustomCompTable");
CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,err);
}},ReloadCustomComp:function(component,custComp){try{var callback=function(custCompRef){CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,null);
};
custComp.generate(custComp.getTarget(),callback,null);
}catch(err){MP_Util.LogJSError(err,component,"customcomp.js","ReloadCustomComp");
CERN_CUSTOM_COMP_O1.FinalizeCustomComp(component,err);
}},FinalizeCustomComp:function(component,error){if(error){var countText="";
var errMsg=["<b>",i18n.ERROR_OCCURED,"</b><br /><ul><li>",error.description,"</li></ul>"];
MP_Util.Doc.FinalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(),errMsg.join("")),component,countText);
}else{var rootComponentNode=component.getRootComponentNode();
var totalCount=Util.Style.g("sec-total",rootComponentNode,"span");
var custCompRef=component.getCustomComponentReference();
if(custCompRef.getProperty("headerSubTitle")!=="undefined"){totalCount[0].innerHTML=custCompRef.getProperty("headerSubTitle");
}else{totalCount[0].innerHTML="";
}}}};
}();
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_1",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_2",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_3",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_4",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_5",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_6",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_7",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_8",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_9",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_10",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_11",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_12",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_13",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_14",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_15",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_16",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_17",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_18",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_19",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_20",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_1",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_2",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_3",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_4",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_5",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_6",CustomComponent);
function DashAnticipStopsComponentStyle(){this.initByNamespace("dash");
}DashAnticipStopsComponentStyle.inherits(ComponentStyle);
function DashAnticipStopsComponent(criterion,id,cmptConfig){this.setCriterion(criterion);
this.setStyles(new DashAnticipStopsComponentStyle());
this.setComponentLoadTimerName("USR:MPG.dash_"+id+".O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.dash_"+id+".O1 - render component");
this.setIncludeLineNumber(false);
this.setAlwaysExpanded(true);
this.setResourceRequired(false);
this.setComponentId(id);
this.m_Config=cmptConfig;
this.m_gridPosLeft=cmptConfig.gridPosLeft;
this.m_gridPosTop=cmptConfig.gridPosTop;
this.m_gridPosRight=cmptConfig.gridPosRight;
this.m_gridPosBottom=cmptConfig.gridPosBottom;
this.m_chartDataCall=cmptConfig.chartDataCall;
this.m_detailDataCall=cmptConfig.detailDataCall;
DashAnticipStopsComponent.method("InsertData",function(){CERN_DASH_ANTICIP_STOPS_O1.GetComponentData(this);
});
DashAnticipStopsComponent.method("HandleSuccess",function(recordData){CERN_DASH_ANTICIP_STOPS_O1.RenderComponent(this,recordData);
});
}DashAnticipStopsComponent.prototype=new MPageComponent();
DashAnticipStopsComponent.prototype.constructor=MPageComponent;
var CERN_DASH_ANTICIP_STOPS_O1=function(){function processResults(component,results,tmpArray){var curTime=new Date();
var endHour=null;
var isFullDayView=component.m_Config.fullDayView||false;
var chartDataLen,tmpResult;
if(isFullDayView){endHour=24;
curTime.setHours(0);
curTime.setMinutes(15);
chartData=results[0];
chartDataLen=chartData.length;
tmpResult=chartData[0];
}else{endHour=curTime.getHours()+6;
endHour=(endHour>24)?24:endHour;
curTime.setMinutes((curTime.getMinutes()<30)?15:45);
curTime.setTime(curTime.getTime()-30*60000);
chartData=results[1];
chartDataLen=chartData.length;
tmpResult=chartData[0];
}var tmpTime;
var tmpSeries=[];
var startHour=curTime.getHours();
var startMinute=curTime.getMinutes();
var idx=0;
var curHour;
var tmpDataPoint;
for(curHour=startHour;
curHour<endHour;
curHour++){do{tmpTime=curHour+":"+startMinute;
tmpDataPoint=[];
tmpDataPoint.push(tmpTime);
var curTimeAsInt=parseInt(curHour.toString()+startMinute.toString(),10);
while((idx<chartDataLen)&&(parseInt(tmpResult[0],10)<curTimeAsInt)){idx++;
tmpResult=(isFullDayView)?results[0][idx]:results[1][idx];
}if(tmpResult){if(parseInt(tmpResult[0],10)===curTimeAsInt){tmpDataPoint.push(tmpResult[1]);
}else{tmpDataPoint.push(0);
}}else{tmpDataPoint.push(0);
}tmpSeries.push(tmpDataPoint);
if(startMinute==15){startMinute=45;
}else{startMinute=15;
}}while(startMinute==45);
}tmpArray.push(tmpSeries);
if(!isFullDayView){curTime.setTime(curTime.getTime()+30*60000);
startHour=curTime.getHours();
startMinute=curTime.getMinutes();
tmpTime=startHour+":"+startMinute;
tmpSeries=[];
tmpSeries.push([tmpTime,results[0][0]]);
tmpArray.push(tmpSeries);
}}function moveTitle(componentID){var title=$("#dashContent"+componentID).find($(".jqplot-title"));
$("#dashContent"+componentID).prepend(title);
title.addClass("anticip-stops-title dash-sec-title jqplot-target").css({width:"100%",top:"10px"});
}return{GetComponentData:function(component){var dataCall=component.m_chartDataCall;
var cmptConfig=component.m_Config;
var cmptFilters=cmptConfig.componentFilters;
var combinedFilters=DASH_CORE.CombineCmptAndPageFilters(cmptFilters,component);
var sendAr=DASH_CORE.GetParamsFromFilters(combinedFilters);
MP_Core.XMLCclRequestWrapper(component,dataCall,sendAr,true);
},RenderComponent:function(component,recordData){try{var dashboard_chart_i18n=i18n.discernabu.dashboard_chart_i18n;
var criterion=component.getCriterion();
var componentID=component.getComponentId();
var thisContent=[];
if(!recordData.RESULTS){DASH_CORE.DisplayNoDataMessage(component);
return;
}var results=JSON.parse(recordData.RESULTS);
var tmpArray=[];
processResults(component,results,tmpArray);
component.m_ChartData=(tmpArray);
thisContent.push('<div id="'+componentID,'" class="dash-target anticip-stops"></div>');
MP_Util.Doc.FinalizeComponent(thisContent.join(""),component,0);
$("#dashContent"+componentID).addClass("anticip-stops-scroll");
var renderer;
var rendererOption;
try{renderer=component.m_Config.chartConfig.seriesDefaults.renderer;
rendererOptions=component.m_Config.chartConfig.seriesDefaults.rendererOptions;
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": The Component is missing the renderer or rendererOptions configuration settings.</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
}component.m_plot=$.jqplot(componentID,component.m_ChartData,component.m_Config.chartConfig);
moveTitle(componentID);
$("#dashContent"+componentID).bind("resize",function(event,ui){component.m_plot.replot({resetAxes:true});
moveTitle(componentID);
});
$(window).resize(function(e){if(e.target==window){component.m_plot.replot({resetAxes:true});
moveTitle(componentID);
}});
DASH_CORE.CheckThresholds(component);
DASH_CORE.CreateConvertImageButton(componentID);
DASH_CORE.GetChartDetails(component);
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": ",err.message,"</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
MP_Util.Doc.FinalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(),errMsg.join("")),component,"");
throw (err);
}}};
}();
function DashHistoricalBarComponentStyle(){this.initByNamespace("dash");
}DashHistoricalBarComponentStyle.inherits(ComponentStyle);
function DashHistoricalBarComponent(criterion,id,cmptConfig){this.setCriterion(criterion);
this.setStyles(new DashHistoricalBarComponentStyle());
this.setComponentLoadTimerName("USR:MPG.dash_"+id+".O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.dash_"+id+".O1 - render component");
this.setIncludeLineNumber(false);
this.setAlwaysExpanded(true);
this.setResourceRequired(false);
this.setComponentId(id);
this.m_Config=cmptConfig;
this.m_gridPosLeft=cmptConfig.gridPosLeft;
this.m_gridPosTop=cmptConfig.gridPosTop;
this.m_gridPosRight=cmptConfig.gridPosRight;
this.m_gridPosBottom=cmptConfig.gridPosBottom;
this.m_chartDataCall=cmptConfig.chartDataCall;
this.m_detailDataCall=cmptConfig.detailDataCall;
DashHistoricalBarComponent.method("InsertData",function(){CERN_DASH_HIST_BAR_O1.GetComponentData(this);
});
DashHistoricalBarComponent.method("HandleSuccess",function(recordData){CERN_DASH_HIST_BAR_O1.RenderComponent(this,recordData);
});
}DashHistoricalBarComponent.prototype=new MPageComponent();
DashHistoricalBarComponent.prototype.constructor=MPageComponent;
var CERN_DASH_HIST_BAR_O1=function(){function SortByValue(a,b){var aValue=a[1];
var bValue=b[1];
return((aValue>bValue)?-1:((aValue<bValue)?1:0));
}return{GetComponentData:function(component){var dataCall=component.m_chartDataCall;
var cmptConfig=component.m_Config;
var cmptFilters=cmptConfig.componentFilters||[];
var combinedFilters=DASH_CORE.CombineCmptAndPageFilters(cmptFilters,component);
var sendAr=DASH_CORE.GetParamsFromFilters(combinedFilters);
MP_Core.XMLCclRequestWrapper(component,dataCall,sendAr,true);
},RenderComponent:function(component,recordData){try{var dashboard_chart_i18n=i18n.discernabu.dashboard_chart_i18n;
var criterion=component.getCriterion();
var componentID=component.getComponentId();
var thisContent=[];
if(!recordData.RESULTS){DASH_CORE.DisplayNoDataMessage(component);
return;
}var results=JSON.parse(recordData.RESULTS)||[];
component.m_ChartData=results;
thisContent.push('<div id="'+componentID,'" class="dash-target dash-hist-bar-chart"></div>');
MP_Util.Doc.FinalizeComponent(thisContent.join(""),component,0);
var dashContent=$("#dashContent"+componentID);
var parentHgt=dashContent.parent().height();
var sibsHgt=dashContent.siblings().height();
var plotHgt=parentHgt-sibsHgt;
var renderer;
var rendererOption;
try{renderer=component.m_Config.chartConfig.seriesDefaults.renderer;
rendererOptions=component.m_Config.chartConfig.seriesDefaults.rendererOptions;
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": The Component is missing the renderer or rendererOptions configuration settings.</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
}if(renderer==$.jqplot.BarRenderer){results[0].sort(SortByValue);
var tmpResults=[];
tmpResults.push([]);
var maxDatapoints=component.m_Config.maxDatapoints||100;
var idx;
for(idx=0;
idx<maxDatapoints;
idx++){tmpResults[0].push(results[0][idx]);
}component.m_ChartData=tmpResults;
}component.m_plot=$.jqplot(componentID,component.m_ChartData,component.m_Config.chartConfig);
DASH_CORE.BindResizeEvent(component);
DASH_CORE.CheckThresholds(component);
DASH_CORE.CreateConvertImageButton(componentID);
DASH_CORE.GetChartDetails(component);
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": ",err.message,"</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
MP_Util.Doc.FinalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(),errMsg.join("")),component,"");
throw (err);
}}};
}();
function DashChartComponentStyle(){this.initByNamespace("dash");
}DashChartComponentStyle.inherits(ComponentStyle);
function DashChartComponent(criterion,id,cmptConfig){this.setCriterion(criterion);
this.setStyles(new DashChartComponentStyle());
this.setComponentLoadTimerName("USR:MPG.dash_"+id+".O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.dash_"+id+".O1 - render component");
this.setIncludeLineNumber(false);
this.setAlwaysExpanded(true);
this.setResourceRequired(false);
this.setComponentId(id);
this.m_Config=cmptConfig;
this.m_gridPosLeft=cmptConfig.gridPosLeft;
this.m_gridPosTop=cmptConfig.gridPosTop;
this.m_gridPosRight=cmptConfig.gridPosRight;
this.m_gridPosBottom=cmptConfig.gridPosBottom;
this.m_chartDataCall=cmptConfig.chartDataCall;
this.m_detailDataCall=cmptConfig.detailDataCall;
DashChartComponent.method("InsertData",function(){CERN_DASHBOARD_CHART_O1.GetComponentData(this);
});
DashChartComponent.method("HandleSuccess",function(recordData){CERN_DASHBOARD_CHART_O1.RenderComponent(this,recordData);
});
}DashChartComponent.prototype=new MPageComponent();
DashChartComponent.prototype.constructor=MPageComponent;
var CERN_DASHBOARD_CHART_O1=function(){return{GetComponentData:function(component){var dataCall=component.m_chartDataCall;
var cmptConfig=component.m_Config;
var cmptFilters=cmptConfig.componentFilters||[];
var combinedFilters=DASH_CORE.CombineCmptAndPageFilters(cmptFilters,component);
var sendAr=DASH_CORE.GetParamsFromFilters(combinedFilters);
MP_Core.XMLCclRequestWrapper(component,dataCall,sendAr,true);
},RenderComponent:function(component,recordData){try{var dashboard_chart_i18n=i18n.discernabu.dashboard_chart_i18n;
var criterion=component.getCriterion();
var componentID=component.getComponentId();
var thisContent=[];
if(!recordData.RESULTS){DASH_CORE.DisplayNoDataMessage(component);
return;
}var results=JSON.parse(recordData.RESULTS)||[];
component.m_ChartData=results;
thisContent.push('<div id="'+componentID,'" class="dash-target"></div>');
MP_Util.Doc.FinalizeComponent(thisContent.join(""),component,0);
var dashContent=$("#dashContent"+componentID);
var parentHgt=dashContent.parent().height();
var sibsHgt=dashContent.siblings().height();
var plotHgt=parentHgt-sibsHgt;
var renderer;
var rendererOption;
try{renderer=component.m_Config.chartConfig.seriesDefaults.renderer;
rendererOptions=component.m_Config.chartConfig.seriesDefaults.rendererOptions;
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": The Component is missing the renderer or rendererOptions configuration settings.</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
}if(renderer==$.jqplot.BarRenderer){$("#"+componentID).bind("jqplotDataClick",function(ev,seriesIndex,pointIndex,data){if($(".dash-filter-row .roomSelectControl").hasClass("hidden")){$(".dash-filter-row .roomAnchorControl").click();
$(".dash-filter-row .roomSelectControl option").filter(function(){return $(this).text()==component.m_ChartData[seriesIndex][pointIndex][0];
}).attr("selected",true);
$(".dash-filter-row .roomSelectControl").change();
$(".dash-filter-row #refreshButton").click();
}});
var tmpResults=[];
tmpResults.push([]);
var maxDatapoints=component.m_Config.maxDatapoints||100;
var idx;
for(idx=0;
idx<maxDatapoints;
idx++){tmpResults[0].push(results[0][idx]);
}component.m_ChartData=tmpResults;
}if(renderer==$.jqplot.PieRenderer){rendererOptions.diameter=plotHgt*0.5;
}if(renderer==$.jqplot.DonutRenderer){rendererOptions.diameter=plotHgt*0.5;
rendererOptions.innerDiameter=plotHgt*0.15;
}if(renderer==$.jqplot.MeterGaugeRenderer){var totCount=0;
totCount=component.m_ChartData[0];
component.m_ChartData.splice(0,1);
greenInterval=Math.floor(totCount*0.05);
yellowInterval=Math.floor(totCount*0.1);
redInterval=Math.floor(totCount*0.2);
redInterval=(component.m_ChartData[0][0]>redInterval)?component.m_ChartData[0][0]:redInterval;
rendererOptions.intervals=[greenInterval,yellowInterval,redInterval];
}component.m_plot=$.jqplot(componentID,component.m_ChartData,component.m_Config.chartConfig);
DASH_CORE.BindResizeEvent(component);
DASH_CORE.CheckThresholds(component);
DASH_CORE.CreateConvertImageButton(componentID);
DASH_CORE.GetChartDetails(component);
}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": ",err.message,"</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
MP_Util.Doc.FinalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(),errMsg.join("")),component,"");
throw (err);
}}};
}();
function DashScoreboardComponentStyle(){this.initByNamespace("dash");
}DashScoreboardComponentStyle.inherits(ComponentStyle);
function DashScoreboardComponent(criterion,id,cmptConfig){this.setCriterion(criterion);
this.setStyles(new DashScoreboardComponentStyle());
this.setComponentLoadTimerName("USR:MPG.dash_"+id+".O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.dash_"+id+".O1 - render component");
this.setIncludeLineNumber(false);
this.setAlwaysExpanded(true);
this.setResourceRequired(false);
this.setComponentId(id);
this.m_Config=cmptConfig;
this.m_gridPosLeft=cmptConfig.gridPosLeft;
this.m_gridPosTop=cmptConfig.gridPosTop;
this.m_gridPosRight=cmptConfig.gridPosRight;
this.m_gridPosBottom=cmptConfig.gridPosBottom;
this.m_chartDataCall=cmptConfig.chartDataCall;
this.m_detailDataCall=cmptConfig.detailDataCall;
DashScoreboardComponent.method("InsertData",function(){CERN_DASHBOARD_SCOREBOARD_O1.GetComponentData(this);
});
DashScoreboardComponent.method("HandleSuccess",function(recordData){CERN_DASHBOARD_SCOREBOARD_O1.RenderComponent(this,recordData);
});
}DashScoreboardComponent.prototype=new MPageComponent();
DashScoreboardComponent.prototype.constructor=MPageComponent;
var CERN_DASHBOARD_SCOREBOARD_O1=function(){function loadTable(targetIdent,results,config){if(!results.length){return;
}var detailsButton=$("#"+targetIdent+"DetailsBtn");
if(!detailsButton.length){detailsButtonContainer=$("<div />").addClass("sb-details-button-container").appendTo("#dash"+targetIdent);
detailsButton=$("<div id='"+targetIdent+"DetailsBtn' title='Open detail table'></div>").addClass("sb-details-button");
detailsButton.appendTo(detailsButtonContainer);
}var detailsDialog=$("#"+targetIdent+"DetailsDialog");
if(!detailsDialog.length){detailsDialog=$("<div id='"+targetIdent+"DetailsDialog' title='Details'></div>").addClass("chart-details-dialog").appendTo("#"+targetIdent);
}else{detailsDialog.empty();
}var detailsTable=$("<table id='"+targetIdent+"DetailsTable'></table>").appendTo(detailsDialog);
$("<div id='"+targetIdent+"Pager'></div>").appendTo(detailsDialog);
var colNames=config.detailTableColumnNames||[];
var colModel=config.detailTableColumnModel||[];
var tmpData=[];
var idx1,idx2;
var resultLen=results.length;
tmpData.push("[");
for(idx1=1;
idx1<resultLen;
idx1++){var dataRow=results[idx1];
tmpData.push((idx1!=1)?",":"");
tmpData.push("{");
for(idx2=0;
idx2<dataRow.VALUES.length;
idx2++){tmpData.push((idx2)?",":"");
tmpData.push('"',results[0].VALUES[idx2].VALUE,'":"',dataRow.VALUES[idx2].VALUE,'"');
}tmpData.push("}");
}tmpData.push("]");
var gridData;
gridData=JSON.parse(tmpData.join(""));
detailsTable.jqGrid({datatype:"local",data:gridData,height:"100%",width:"95%",colNames:colNames,colModel:colModel,rowNum:15,pager:"#"+targetIdent+"Pager",gridView:true});
detailsTable.navGrid("#"+targetIdent+"Pager",{edit:false,add:false,del:false,search:true});
detailsTable.jqGrid("navButtonAdd","#"+targetIdent+"Pager",{title:"Copy to clipboard",caption:"",buttonicon:"ui-icon-clipboard",onClickButton:function(){DASH_CORE.CreateCTCForDetailTable(gridData);
}});
detailsDialog.dialog({autoOpen:false,width:"75%",show:"slide",hide:"puff",height:"500"});
detailsButton.click(function(){$(detailsDialog).dialog("open");
});
}return{GetComponentData:function(component){var dataCall=component.m_chartDataCall;
var cmptConfig=component.m_Config;
var cmptFilters=cmptConfig.componentFilters||[];
var combinedFilters=DASH_CORE.CombineCmptAndPageFilters(cmptFilters,component);
var sendAr=DASH_CORE.GetParamsFromFilters(combinedFilters);
MP_Core.XMLCclRequestWrapper(component,dataCall,sendAr,true);
},RenderComponent:function(component,recordData){try{var dashboard_scoreboard_i18n=i18n.discernabu.dashboard_scoreboard_i18n;
var criterion=component.getCriterion();
var componentID=component.getComponentId();
var thisContent=[];
if(!recordData.RESULTS){DASH_CORE.DisplayNoDataMessage(component);
return;
}var results=JSON.parse(recordData.RESULTS);
component.m_ChartData=results;
thisContent.push("<div id='"+componentID,"' class='dash-target'></div>");
MP_Util.Doc.FinalizeComponent(thisContent.join(""),component,0);
var targetComponent=$("#"+componentID);
targetComponent.addClass("dash-sb-container");
var header=$("<div>"+component.m_Config.label+"</div>").addClass("dash-sb-title").appendTo(targetComponent);
var thresholds=component.m_Config.thresholds;
var isFirst=true;
var resultsLen=results[0].length;
$(results[0]).each(function(){var tmpResult=$(this);
var container=$("<div></div>").addClass("dash-sb-sec").appendTo(targetComponent);
container.width((100/resultsLen)+"%");
if(isFirst){isFirst=false;
}else{$("<div></div>").addClass("dash-sb-divider").appendTo(container);
}var secTitle=$("<div>"+tmpResult[0]+"</div>").addClass("dash-sb-sec-title").appendTo(container);
secTitle.css("font-size",(secTitle.width()*0.9)+"%");
var secResult=$("<div>"+tmpResult[1]+"</div>").addClass("dash-sb-result").appendTo(container);
secResult.css("font-size",(secResult.height()*5)+"%");
$(thresholds).each(function(){var threshold=this;
if(tmpResult[0]==threshold.measure&&parseInt(tmpResult[1],10)>=threshold.limit){var actions=threshold.actions;
$(actions).each(function(){var action=$(this);
$(container).css(action[0].effect,action[0].value);
});
}});
});
var dataCall=component.m_detailDataCall;
if(dataCall){var cmptConfig=component.m_Config;
var cmptFilters=cmptConfig.componentFilters||[];
var combinedFilters=DASH_CORE.CombineCmptAndPageFilters(cmptFilters,component);
var sendAr=DASH_CORE.GetParamsFromFilters(combinedFilters);
if(CERN_BrowserDevInd){var request=new MP_Core.ScriptRequest(null,null);
request.setProgramName(dataCall);
request.setParameters(sendAr);
request.setAsync(true);
MP_Core.XMLCCLRequestCallBack(null,request,function(response){if(response.getResponse().STATUS_DATA.STATUS=="S"){var results=response.getResponse().RESULTS||[];
loadTable(componentID,results,cmptConfig);
}});
}else{var info=new XMLCclRequest();
info.onreadystatechange=function(){if(this.readyState==4&&this.status==200){MP_Util.LogScriptCallInfo(null,this,"dash_core.js",dataCall);
var jsonEval=JSON.parse(this.responseText);
if(jsonEval.RECORD_DATA.STATUS_DATA.STATUS=="S"){var results=jsonEval.RECORD_DATA.RESULTS||[];
loadTable(componentID,results,cmptConfig);
}}if(this.readyState==4){MP_Util.ReleaseRequestReference(this);
}};
info.open("GET",dataCall,true);
info.send(sendAr.join(","));
}}}catch(err){var errMsg=[];
errMsg.push("<b>",i18n.JS_ERROR,"</b><br><ul><li>",i18n.MESSAGE,": ",err.message,"</li><li>",i18n.NAME,": ",err.name,"</li><li>",i18n.NUMBER,": ",(err.number&65535),"</li><li>",i18n.DESCRIPTION,": ",err.description,"</li></ul>");
MP_Util.Doc.FinalizeComponent(MP_Util.HandleErrorResponse(component.getStyles().getNameSpace(),errMsg.join("")),component,"");
throw (err);
}}};
}();
DashboardMPage=function(){MP_Util.LogInfo("Rendering Dashboard MPages View");
this.setName("DASHBOARD");
var periopDashConfig=dashboard;
var dashConfig=periopDashConfig.periopORManager;
if(!dashConfig){throw new Error("DASHBOARD_SETTINGS_UNAVAILABLE");
}MP_Resources.addSharedResource("dashConfig",dashConfig);
};
DashboardMPage.prototype=new MPageView();
DashboardMPage.prototype.constructor=MPageView;
DashboardMPage.prototype.initializeMPageView=function(){MPageView.prototype.initializeMPageView.call(this,null);
this.setHelpFileURL("https://wiki.ucern.com/plugins/servlet/helpServlet?eas=MPages&cas=ICUSummary&culture=en-US&release=4");
this.setHelpFileName("file:"+this.getCriterion().static_content.replace(/\\/g,"/")+"/html/TODO");
};
DashboardMPage.prototype.loadPageSettings=function(){};
DashboardMPage.prototype.initializeComponents=function(){var componentType=null;
var components=[];
var dashConfig=MP_Resources.getSharedResource("dashConfig");
try{var criterion=this.getCriterion();
var layoutConfig=dashConfig.layout||{};
var componentConfigs=layoutConfig.components||{};
for(var cIdx=0,cLmt=componentConfigs.length;
cIdx<cLmt;
cIdx++){var componentConfig=componentConfigs[cIdx];
var type="";
var label="";
var id="";
var tmpComponent=null;
type=componentConfig.componentType;
label=componentConfig.label;
id=componentConfig.id;
switch(type){case"Scoreboard":tmpComponent=new DashScoreboardComponent(criterion,id,componentConfig);
break;
case"Twitter Feed":tmpComponent=new DashTwitterFeedComponent(criterion,id,componentConfig);
break;
case"BaseChart":tmpComponent=new DashChartComponent(criterion,id,componentConfig);
break;
case"AnticipatedStops":tmpComponent=new DashAnticipStopsComponent(criterion,id,componentConfig);
break;
case"HistoricalBar":tmpComponent=new DashHistoricalBarComponent(criterion,id,componentConfig);
break;
default:tmpComponent=new MPageDashboardChartComponent(criterion,id,componentConfig);
}if(tmpComponent){tmpComponent.m_Config=componentConfig;
}components.push(tmpComponent);
}this.setComponents(components);
return true;
}catch(err){MP_Util.LogJSError(err,null,"dashboard.js","initializeComponents");
throw err;
}};
DashboardMPage.prototype.renderMPage=function(){var componentList=null;
try{componentList=this.getComponents();
if(componentList.length===0){throw new Error(i18n.VIEW_SETTINGS_UNAVAILABLE);
}DASH_CORE.InitDashboardLayout(this,this.getHelpFileName(),this.getHelpFileURL(),null);
window.setTimeout("MP_Util.Doc.RenderLayout()",0);
return true;
}catch(err){MP_Util.LogJSError(err,null,"dashboard.js","renderMPage");
throw err;
}};
DashboardMPage.prototype.postProcessing=function(){MPageView.prototype.postProcessing.call(this,null);
};
;(function($){
/**
 * jqGrid English Translation
 * Tony Tomov tony@trirand.com
 * http://trirand.com/blog/ 
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
**/
$.jgrid = $.jgrid || {};
$.extend($.jgrid,{
	defaults : {
		recordtext: "View {0} - {1} of {2}",
		emptyrecords: "No records to view",
		loadtext: "Loading...",
		pgtext : "Page {0} of {1}"
	},
	search : {
		caption: "Search...",
		Find: "Find",
		Reset: "Reset",
		odata: [{ oper:'eq', text:'equal'},{ oper:'ne', text:'not equal'},{ oper:'lt', text:'less'},{ oper:'le', text:'less or equal'},{ oper:'gt', text:'greater'},{ oper:'ge', text:'greater or equal'},{ oper:'bw', text:'begins with'},{ oper:'bn', text:'does not begin with'},{ oper:'in', text:'is in'},{ oper:'ni', text:'is not in'},{ oper:'ew', text:'ends with'},{ oper:'en', text:'does not end with'},{ oper:'cn', text:'contains'},{ oper:'nc', text:'does not contain'}],
		groupOps: [	{ op: "AND", text: "all" },	{ op: "OR",  text: "any" }	]
	},
	edit : {
		addCaption: "Add Record",
		editCaption: "Edit Record",
		bSubmit: "Submit",
		bCancel: "Cancel",
		bClose: "Close",
		saveData: "Data has been changed! Save changes?",
		bYes : "Yes",
		bNo : "No",
		bExit : "Cancel",
		msg: {
			required:"Field is required",
			number:"Please, enter valid number",
			minValue:"value must be greater than or equal to ",
			maxValue:"value must be less than or equal to",
			email: "is not a valid e-mail",
			integer: "Please, enter valid integer value",
			date: "Please, enter valid date value",
			url: "is not a valid URL. Prefix required ('http://' or 'https://')",
			nodefined : " is not defined!",
			novalue : " return value is required!",
			customarray : "Custom function should return array!",
			customfcheck : "Custom function should be present in case of custom checking!"
			
		}
	},
	view : {
		caption: "View Record",
		bClose: "Close"
	},
	del : {
		caption: "Delete",
		msg: "Delete selected record(s)?",
		bSubmit: "Delete",
		bCancel: "Cancel"
	},
	nav : {
		edittext: "",
		edittitle: "Edit selected row",
		addtext:"",
		addtitle: "Add new row",
		deltext: "",
		deltitle: "Delete selected row",
		searchtext: "",
		searchtitle: "Find records",
		refreshtext: "",
		refreshtitle: "Reload Grid",
		alertcap: "Warning",
		alerttext: "Please, select row",
		viewtext: "",
		viewtitle: "View selected row"
	},
	col : {
		caption: "Select columns",
		bSubmit: "Ok",
		bCancel: "Cancel"
	},
	errors : {
		errcap : "Error",
		nourl : "No url is set",
		norecords: "No records to process",
		model : "Length of colNames <> colModel!"
	},
	formatter : {
		integer : {thousandsSeparator: ",", defaultValue: '0'},
		number : {decimalSeparator:".", thousandsSeparator: ",", decimalPlaces: 2, defaultValue: '0.00'},
		currency : {decimalSeparator:".", thousandsSeparator: ",", decimalPlaces: 2, prefix: "", suffix:"", defaultValue: '0.00'},
		date : {
			dayNames:   [
				"Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat",
				"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"
			],
			monthNames: [
				"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
				"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
			],
			AmPm : ["am","pm","AM","PM"],
			S: function (j) {return j < 11 || j > 13 ? ['st', 'nd', 'rd', 'th'][Math.min((j - 1) % 10, 3)] : 'th';},
			srcformat: 'Y-m-d',
			newformat: 'n/j/Y',
			parseRe : /[Tt\\\/:_;.,\t\s-]/,
			masks : {
				// see http://php.net/manual/en/function.date.php for PHP format used in jqGrid
				// and see http://docs.jquery.com/UI/Datepicker/formatDate
				// and https://github.com/jquery/globalize#dates for alternative formats used frequently
				// one can find on https://github.com/jquery/globalize/tree/master/lib/cultures many
				// information about date, time, numbers and currency formats used in different countries
				// one should just convert the information in PHP format
				ISO8601Long:"Y-m-d H:i:s",
				ISO8601Short:"Y-m-d",
				// short date:
				//    n - Numeric representation of a month, without leading zeros
				//    j - Day of the month without leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				// example: 3/1/2012 which means 1 March 2012
				ShortDate: "n/j/Y", // in jQuery UI Datepicker: "M/d/yyyy"
				// long date:
				//    l - A full textual representation of the day of the week
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				LongDate: "l, F d, Y", // in jQuery UI Datepicker: "dddd, MMMM dd, yyyy"
				// long date with long time:
				//    l - A full textual representation of the day of the week
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				//    Y - A full numeric representation of a year, 4 digits
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    s - Seconds, with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				FullDateTime: "l, F d, Y g:i:s A", // in jQuery UI Datepicker: "dddd, MMMM dd, yyyy h:mm:ss tt"
				// month day:
				//    F - A full textual representation of a month
				//    d - Day of the month, 2 digits with leading zeros
				MonthDay: "F d", // in jQuery UI Datepicker: "MMMM dd"
				// short time (without seconds)
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				ShortTime: "g:i A", // in jQuery UI Datepicker: "h:mm tt"
				// long time (with seconds)
				//    g - 12-hour format of an hour without leading zeros
				//    i - Minutes with leading zeros
				//    s - Seconds, with leading zeros
				//    A - Uppercase Ante meridiem and Post meridiem (AM or PM)
				LongTime: "g:i:s A", // in jQuery UI Datepicker: "h:mm:ss tt"
				SortableDateTime: "Y-m-d\\TH:i:s",
				UniversalSortableDateTime: "Y-m-d H:i:sO",
				// month with year
				//    Y - A full numeric representation of a year, 4 digits
				//    F - A full textual representation of a month
				YearMonth: "F, Y" // in jQuery UI Datepicker: "MMMM, yyyy"
			},
			reformatAfterEdit : false
		},
		baseLinkUrl: '',
		showAction: '',
		target: '',
		checkbox : {disabled:true},
		idName : 'id'
	}
});
})(jQuery);
