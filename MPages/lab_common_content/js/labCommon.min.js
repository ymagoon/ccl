Date.prototype.setISO8601=function(string){var regexp="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?";var d=string.match(new RegExp(regexp));var offset=0;var date=new Date(d[1],0,1);if(d[3]){date.setMonth(d[3]-1)}if(d[5]){date.setDate(d[5])}if(d[7]){date.setHours(d[7])}if(d[8]){date.setMinutes(d[8])}if(d[10]){date.setSeconds(d[10])}if(d[12]){date.setMilliseconds(Number("0."+d[12])*1000)}if(d[14]){offset=(Number(d[16])*60)+Number(d[17]);offset*=((d[15]=="-")?1:-1)}offset-=date.getTimezoneOffset();time=(Number(date)+(offset*60*1000));this.setTime(Number(time))};Date.prototype.toISO8601String=function(format,offset){if(!format){var format=6}if(!offset){var offset="Z";var date=this}else{var d=offset.match(/([-+])([0-9]{2}):([0-9]{2})/);var offsetnum=(Number(d[2])*60)+Number(d[3]);offsetnum*=((d[1]=="-")?-1:1);var date=new Date(Number(Number(this)+(offsetnum*60000)))}var zeropad=function(num){return((num<10)?"0":"")+num};var str="";str+=date.getUTCFullYear();if(format>1){str+="-"+zeropad(date.getUTCMonth()+1)}if(format>2){str+="-"+zeropad(date.getUTCDate())}if(format>3){str+="T"+zeropad(date.getUTCHours())+":"+zeropad(date.getUTCMinutes())}if(format>5){var secs=Number(date.getUTCSeconds()+"."+((date.getUTCMilliseconds()<100)?"0":"")+zeropad(date.getUTCMilliseconds()));str+=":"+zeropad(secs)}else{if(format>4){str+=":"+zeropad(date.getUTCSeconds())}}if(format>3){str+=offset}return str};var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length<len){val="0"+val}return val};return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(date)=="[object String]"&&!/\d/.test(date)){mask=date;date=undefined}date=date?new Date(date):new Date;if(isNaN(date)){throw SyntaxError("invalid date")}mask=String(dF.masks[mask]||mask||dF.masks["default"]);if(mask.slice(0,4)=="UTC:"){mask=mask.slice(4);utc=true}var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc)};Date.prototype.addDays=function(n){this.setDate(this.getDate()+n);return this};Date.prototype.addHours=function(n){this.setHours(this.getHours()+n);return this};dateFormat.masks.shortDateTime="mm/dd/yy h:MM TT";dateFormat.masks.convertibleDtTm="dd-mmm-yyyy HH:MM:ss";dateFormat.masks.shortDateLongYear="mm/dd/yyyy";dateFormat.masks.shortDateTimeLongYear="mm/dd/yyyy h:MM TT";dateFormat.masks.shortDateTimeDashed="mm-dd-yyyy h:MM TT";function getRefRange(item,result){var stSpan=" ";var endSpan=" ";var strFlags="";if(item.CRITICAL_MEAN.trim()==RESULT_PROCESS_MEAN.CRITICAL){stSpan='<span class="result-critical" title="Reference Range" id="'+item.NORMAL_LOW+" - "+item.NORMAL_HIGH+'">';endSpan="</span>"}else{if(item.NORMAL_RANGE_FLAG!==undefined){switch(item.NORMAL_RANGE_FLAG){case 1:stSpan='<span class="result-norm" title="Reference Range" id=">= '+item.NORMAL_LOW+'">';endSpan="</span>";break;case 2:stSpan='<span class="result-norm" title="Reference Range" id="<= '+item.NORMAL_HIGH+'">';endSpan="</span>";break;case 3:stSpan='<span class="result-norm" title="Reference Range" id="'+item.NORMAL_LOW+" - "+item.NORMAL_HIGH+'">';endSpan="</span>";break;default:stSpan='<span class="result-norm" title="Reference Range" id="'+item.NORMAL_ALPHA.trim()+'">';endSpan="</span>"}}}return stSpan+result+endSpan}var RESULT_STATUS_MEAN={PERFORMED:"PERFORMED",INREVIEW:"INREVIEW",VERIFIED:"VERIFIED"};var RESULT_TYPE={TEXT:"1",ALPHA:"2",NUMERIC:"3",INTERP:"4",MULTI_ALPHA:"5",DATE:"6",FREETEXT:"7",CALC:"8",CODESET:"9",TIME:"10",DATE_TIME:"11",COUNT:"13",YES_NO:"18",ALPHA_FREETEXT:"21"};var RESULT_PROCESS_MEAN={ALP_ABNORMAL:"ALP_ABNORMAL",NORMAL_HIGH:"NORMAL_HIGH",NORMAL_LOW:"NORMAL_LOW",ALP_CRITICAL:"ALP_CRITICAL",CRITICAL:"CRITICAL",REVIEW:"REVIEW",ALP_REVIEW:"ALP_REVIEW",DELTA_FAIL:"DELTA_FAIL",FEASIBLE:"FEASIBLE",LINEAR:"LINEAR",ALP_NOTIFY:"ALP_NOTIFY",NOTIFY:"NOTIFY",QCOVERRIDE:"QC_OVERRIDE"};function getResultProcessFlags(sText,item){if((item.DILUTION_FACTOR!==undefined)&&(item.DILUTION_FACTOR>0)){sText+="x"+item.DILUTION_FACTOR+" "}switch(item.NORMAL_MEAN.trim()){case RESULT_PROCESS_MEAN.NORMAL_HIGH:case RESULT_PROCESS_MEAN.NORMAL_LOW:case RESULT_PROCESS_MEAN.ALP_ABNORMAL:sText+=item.NORMAL_DISP.trim();break}if(item.CRITICAL_MEAN!==undefined){if((item.CRITICAL_MEAN.trim()==RESULT_PROCESS_MEAN.CRITICAL)||(item.CRITICAL_MEAN.trim()==RESULT_PROCESS_MEAN.ALP_CRITICAL)){sText+=item.CRITICAL_DISP.trim()}}if(item.REVIEW_MEAN!==undefined){if((item.REVIEW_MEAN.trim()==RESULT_PROCESS_MEAN.REVIEW)||(item.REVIEW_MEAN.trim()==RESULT_PROCESS_MEAN.ALP_REVIEW)){sText+=item.REVIEW_DISP.trim()}}if(item.LINEAR_MEAN.trim()==RESULT_PROCESS_MEAN.LINEAR){sText+=item.LINEAR_DISP.trim()}if(item.FEASIBLE_MEAN.trim()==RESULT_PROCESS_MEAN.FEASIBLE){sText+=item.FEASIBLE_DISP.trim()}if(item.DELTA_MEAN.trim()==RESULT_PROCESS_MEAN.DELTA_FAIL){sText+=item.DELTA_DISP.trim()}if(item.INTERP_DATA_ID>0){sText+="(i)"}if(item.QC_OVERRIDE_MEAN!==undefined){if(item.QC_OVERRIDE_MEAN.trim()==RESULT_PROCESS_MEAN.QCOVERRIDE){sText+=item.QC_OVERRIDE_DISP.trim()}}if(item.NOTIFY_MEAN!==undefined){if(item.NOTIFY_MEAN.trim()==RESULT_PROCESS_MEAN.ALP_NOTIFY){sText+=item.NOTIFY_DISP.trim()}}if((item.NOMENCLATURE_ID>0)&&(item.LONG_TEXT_ID>0)){sText+="(t)"}return sText}function getResult2(item){var result="",sText="";switch(item.RESULT_TYPE_MEAN.trim()){case RESULT_TYPE.TEXT:case RESULT_TYPE.FREETEXT:sText="";if(item.ASCII_TEXT.trim().length>30){result=item.ASCII_TEXT.substring(0,30)+'<input class="btnMoreText" type="button" value="..."/>'}else{result=item.ASCII_TEXT}if(item.RESULT_TYPE_MEAN.trim()==RESULT_TYPE.FREETEXT){result+=" "+getResultProcessFlags(sText,item)}break;case RESULT_TYPE.ALPHA:sText="";result=item.RESULT_VALUE_ALPHA;result+=" "+getResultProcessFlags(sText,item);break;case RESULT_TYPE.INTERP:sText="";if(item.RESULT_VALUE_ALPHA.trim().length>0){result=item.RESULT_VALUE_ALPHA.trim();result+=" "+getResultProcessFlags(sText,item)}else{if(item.ASCII_TEXT.trim().length>0){result=item.ASCII_TEXT}else{if((item.FORMATTED_RESULT!==undefined)&&(item.FORMATTED_RESULT.trim().length>0)){result=item.FORMATTED_RESULT}else{if(item.ASCII_TEXT.trim().length>0){result=item.ASCII_TEXT}else{result=item.RESULT_VALUE_NUMERIC}}result+=" "+getResultProcessFlags(sText,item)}}break;case RESULT_TYPE.CALC:case RESULT_TYPE.NUMERIC:if((item.FORMATTED_RESULT!==undefined)&&(item.FORMATTED_RESULT.trim().length>0)){result=item.FORMATTED_RESULT}else{if(item.ASCII_TEXT.trim().length>0){result=item.ASCII_TEXT}else{result=item.RESULT_VALUE_NUMERIC}}result+=" "+getResultProcessFlags(sText,item);break;case RESULT_TYPE.DATE:result=getDateString(item.RESULT_VALUE_DT_TM,"shortDateLongYear");break;case RESULT_TYPE.DATE_TIME:result=getDateString(item.RESULT_VALUE_DT_TM);break;case RESULT_TYPE.TIME:result=getDateString(item.RESULT_VALUE_DT_TM,"shortTime");break;case RESULT_TYPE.CODESET:result=item.RESULT_CODE_SET_DISP;break;default:result=item.ASCII_TEXT.trim()}return getRefRange(item,result)}function getQCResult(item){if(item.RESULT_TYPE_MEAN.trim()==RESULT_TYPE.ALPHA){return item.RESULT_TYPE_ALPHA.trim()}else{return item.FORMATTED_RESULT.trim()}}function getDateString(date,format){var emptyDateRegEx=/([0]{4})(-([0]{2})(-([0]{2})(T([0]{2}):([0]{2})(:([0]{2})(\.([0]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?/;var newDate=new Date();if(format===undefined){format="shortDateTimeLongYear"}if(date instanceof Date){newDate=date}else{if(date.match(new RegExp(emptyDateRegEx))){return""}newDate.setISO8601(date)}return newDate.format(format)}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};