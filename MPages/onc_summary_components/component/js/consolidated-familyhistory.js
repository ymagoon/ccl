var CERN_FAM_HISTORY_CONSOLIDATED=function(){var fhxi18n=i18n.discernabu.consolidated_history;
function getAgePhrase(age,unit,yearEnabled){var agePhrase="";
switch(unit){case"YEARS":case"":if(yearEnabled){agePhrase=i18n.discernabu.X_YEARS.replace("{0}",age);
}else{agePhrase=age;
}break;
case"MONTHS":agePhrase=i18n.discernabu.X_MONTHS.replace("{0}",age);
break;
case"DAYS":agePhrase=i18n.discernabu.X_DAYS.replace("{0}",age);
break;
case"WEEKS":agePhrase=i18n.discernabu.X_WEEKS.replace("{0}",age);
break;
default:agePhrase=age;
}return agePhrase;
}return{RenderComponentByFamily:function(component){var recordData=component.getFamRecordData();
var codeArray=MP_Util.LoadCodeListJSON(recordData.CODES);
var jsFamHTML=[];
var hoverCnt=0;
var compId=component.getComponentId();
var fhxSummary="";
var sLen=0;
var fhxSummaryInd="";
var allHistNeg="";
if(recordData.PATIENT_ADOPTED_IND==1){fhxSummary=fhxi18n.ADOPTED;
sLen+=1;
}if(recordData.HIST_NEG_IND==1){allHistNeg=fhxi18n.FAMILY_HISTORY_NEGATIVE;
}if(recordData.NEGATIVE_IND==1){fhxSummaryInd=fhxi18n.FAMILY_HISTORY_NEGATIVE;
sLen+=1;
}else{if(recordData.UNKNOWN_IND==1){fhxSummaryInd=fhxi18n.FAMILY_HISTORY_UNKNOWN;
sLen+=1;
}else{if(recordData.UNABLE_TO_OBTAIN_IND==1){fhxSummaryInd=fhxi18n.UNABLE_TO_OBTAIN;
sLen+=1;
}}}if(fhxSummaryInd!==""&&recordData.CONDITION_CNT===0){if(fhxSummary===""){fhxSummary=fhxSummaryInd;
}else{fhxSummary+="; "+fhxSummaryInd;
}}if(allHistNeg!==""&&recordData.CONDITION_CNT===0){if(fhxSummary===""){fhxSummary=allHistNeg;
}else{fhxSummary+="; "+allHistNeg;
}sLen=0;
}var summaryLabel="<span class='res-none'>"+fhxSummary+"</span>";
var len=recordData.FAMILY_CNT;
if(len===0){jsFamHTML.push(summaryLabel);
}else{if(len>0){var family=null;
var condLen="";
var condition="";
var memberDisp="";
var detailInfo="";
var codeObj="";
var commentHTML=[];
for(i=0;
i<len;
i++){family=recordData.FAMILIES[i];
if(family.MEMBER>0){codeObj=MP_Util.GetValueFromArray(family.MEMBER,codeArray);
family.MEMBER_DISP=codeObj.display;
}}recordData.FAMILIES.sort(function(a,b){if(a.MEMBER_DISP.toUpperCase()<b.MEMBER_DISP.toUpperCase()){return -1;
}return 1;
});
var zebraStriping="";
var comment="";
var onsetInfo="";
var hoverOnsetAge="";
var hoverLifeCycle="";
var hoverSeverity="";
var hoverCourse="";
var hoverName="";
var hoverDeceased="";
var hoverLastReviewed="";
if(fhxSummary){jsFamHTML.push('<div class="chx-menu">',summaryLabel,"</div>");
}jsFamHTML.push("<div class='content-hdr chx-grp-by-family'><dl class='hdr' id='fmHistHdrRow",compId,"'><dt class='chx-family-hd'>",fhxi18n.MEMBERS,"</dt><dt class='chx-condition-hd'>",fhxi18n.CONDITION,"</dt></dl></div><div class='content-body chx-grp-by-family'>");
var j=0;
for(var i=0;
i<len;
i++){commentHTML=[];
family=recordData.FAMILIES[i];
condLen=family.COND_CNT;
detailInfo="";
memberDisp="";
condition="";
if(family.MEMBER>0){codeObj=MP_Util.GetValueFromArray(family.MEMBER,codeArray);
memberDisp+=codeObj.display;
codeObj=MP_Util.GetValueFromArray(family.DECEASED_CD,codeArray);
if(codeObj&&codeObj.meaning=="YES"){memberDisp+=" - ";
detailInfo=fhxi18n.DECEASED+" ("+family.DECEASED_DESP+", "+fhxi18n.AT_AGE+" "+getAgePhrase(family.DECEASED_AGE,family.DECEASED_AGEUNIT)+")";
}}zebraStriping=(i%2)?"even":"odd";
jsFamHTML.push("<dl class='chx-row ",zebraStriping,"'><dt>",fhxi18n.MEMBERS,"</dt><dd class='chx-family'>",memberDisp,"<span class='detail-line'>",detailInfo,"</span></dd><dd class='chx-condition'>");
for(j=0;
j<condLen;
j++){condition=family.CONDITION[j];
onsetInfo=condition.ONSET_AGE?" ("+fhxi18n.AT_AGE+" "+getAgePhrase(condition.ONSET_AGE,condition.ONSET_AGEUNIT)+")":"";
jsFamHTML.push("<div id='fmHistHoverable",compId,"Item",hoverCnt,"' class='chx-fhx-item chx-info result-info'>",condition.CONDITION,"<span class='detail-line'>",onsetInfo,"</span></div>");
hoverOnsetAge=condition.ONSET_AGE?getAgePhrase(condition.ONSET_AGE,condition.ONSET_AGEUNIT,1):"--";
hoverLifeCycle=condition.LIFECYCLE?condition.LIFECYCLE:"--";
hoverSeverity=condition.SEVERITY?condition.SEVERITY:"--";
hoverCourse=condition.COURSE?condition.COURSE:"--";
hoverName="--";
if(family.NAMEFIRST||family.NAMELAST){hoverName=family.NAMEFIRST+" "+family.NAMELAST;
}hoverDeceased="--";
if(family.DECEASED_AGE){hoverDeceased=getAgePhrase(family.DECEASED_AGE,family.DECEASED_AGEUNIT,1)+(family.DECEASED_DESP?"<br />"+family.DECEASED_DESP:"");
}hoverLastReviewed="--";
if(condition.LASTREVIEWED!==""){hoverLastReviewed=new Date();
hoverLastReviewed.setISO8601(condition.LASTREVIEWED);
hoverLastReviewed=hoverLastReviewed.format("shortDate3");
}comment="--";
if(condition.COMMENT){comment=condition.COMMENT.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br />");
commentHTML.push("<dt>",fhxi18n.COMMENT,"</dt><dd><p>",condition.CONDITION,": ",comment,"</p></dd>");
}jsFamHTML.push("<div id='fmHistHover",compId,"Item",hoverCnt,"' class='result-details hover'><h4 class='det-hd'>",i18n.DETAILS,"</h4><dl class='chx-det'><dt><span>",fhxi18n.NAME,":</span></dt><dd><span>",hoverName,"</span></dd><dt><span>",fhxi18n.DECEASED,":</span></dt><dd><span>",hoverDeceased,"</span></dd><dt><span>",fhxi18n.ONSET,":</span></dt><dd><span>",hoverOnsetAge,"</span></dd><dt><span>",fhxi18n.LIFECYCLE,":</span></dt><dd><span>",hoverLifeCycle,"</span></dd><dt><span>",fhxi18n.SEVERITY,":</span></dt><dd><span>",hoverSeverity,"</span></dd><dt><span>",fhxi18n.COURSE,":</span></dt><dd><span>",hoverCourse,"</span></dd><dt><span>",fhxi18n.LASTREVIEWED,":</span></dt><dd><span>",hoverLastReviewed,"</span></dd><dt><span>",fhxi18n.COMMENT,":</span></dt><dd><span>",comment,"</span></dd></dl></div>");
hoverCnt++;
}if(commentHTML.length){jsFamHTML.push("<dl class='comment'>",commentHTML.join(""),"</dl>");
}jsFamHTML.push("</dd></dl>");
}jsFamHTML.push("</div>");
}}jsFamHTML.push("</div>");
component.loadTabData(recordData.CONDITION_CNT+sLen,jsFamHTML.join(""),component.HistoryComponentIndexObj.FAMILY_HISTORY,function(){for(i=0;
i<hoverCnt;
i++){var hvrElmnt=document.getElementById("fmHistHoverable"+compId+"Item"+i);
var hvrDetail=document.getElementById("fmHistHover"+compId+"Item"+i);
hs(hvrElmnt,hvrDetail,component);
}});
},RenderComponentByCondition:function(component){var recordData=component.getFamRecordData();
var codeArray=MP_Util.LoadCodeListJSON(recordData.CODES);
var jsFamHTML=[];
var hoverCnt=0;
var compId=component.getComponentId();
var fhxSummary="";
var sLen=0;
var fhxSummaryInd="";
var allHistNeg="";
if(recordData.PATIENT_ADOPTED_IND==1){fhxSummary=fhxi18n.ADOPTED;
sLen+=1;
}if(recordData.HIST_NEG_IND==1){allHistNeg=fhxi18n.FAMILY_HISTORY_NEGATIVE;
}if(recordData.NEGATIVE_IND==1){fhxSummaryInd=fhxi18n.FAMILY_HISTORY_NEGATIVE;
sLen+=1;
}else{if(recordData.UNKNOWN_IND==1){fhxSummaryInd=fhxi18n.FAMILY_HISTORY_UNKNOWN;
sLen+=1;
}else{if(recordData.UNABLE_TO_OBTAIN_IND==1){fhxSummaryInd=fhxi18n.UNABLE_TO_OBTAIN;
sLen+=1;
}}}if(fhxSummaryInd!==""&&recordData.CONDITION_CNT===0){if(fhxSummary===""){fhxSummary=fhxSummaryInd;
}else{fhxSummary+="; "+fhxSummaryInd;
}}if(allHistNeg!==""&&recordData.CONDITION_CNT===0){if(fhxSummary===""){fhxSummary=allHistNeg;
}else{fhxSummary+="; "+allHistNeg;
}sLen=0;
}var summaryLabel="<span class='res-none'>"+fhxSummary+"</span>";
var len=recordData.CONDITION_CNT;
if(len===0){jsFamHTML.push(summaryLabel);
}else{if(len>0){if(fhxSummary){jsFamHTML.push('<div class="chx-menu">',summaryLabel,"</div>");
}jsFamHTML.push("<div class='content-hdr chx-grp-by-cond'><dl class='hdr grouped' id='fmHistHdrRow",compId,"'><dt class='chx-condition-hd'>",fhxi18n.CONDITION,"</dt><dt class='chx-family-hd'>",fhxi18n.MEMBERS,"</dt></dl></div>");
jsFamHTML.push("<div class='content-body chx-grp-by-cond'>");
var condition="";
var familyLen="";
var memberDisp="";
var condLen=0;
var group="";
var groupNames=recordData.groupNames||[];
var i=0,j=0;
if(!recordData.groups){recordData.groups={};
var gLen;
var unknowGroupName="&nbsp;";
for(i=0;
i<len;
i++){condition=recordData.CONDITIONS[i];
gLen=condition.CATEGORY_CNT;
if(gLen){for(j=0;
j<gLen;
j++){group=condition.CATEGORIES[j].CATEGORY;
if(!recordData.groups.hasOwnProperty(group)){recordData.groups[group]={conditions:[],name:group};
groupNames.push(group);
}recordData.groups[group].conditions.push(condition);
}}else{if(!recordData.groups.hasOwnProperty(unknowGroupName)){recordData.groups[unknowGroupName]={conditions:[],name:unknowGroupName};
groupNames.push(unknowGroupName);
}recordData.groups[unknowGroupName].conditions.push(condition);
}}groupNames.sort(function(a,b){if(a.toUpperCase()<b.toUpperCase()){return -1;
}return 1;
});
recordData.groupNames=groupNames;
}var detailInfo="";
var codeObj="";
var zebraStriping="";
var commentHTML=[];
var comment="";
var hoverOnsetAge="";
var hoverLifeCycle="";
var hoverSeverity="";
var hoverCourse="";
var hoverName="";
var hoverDeceased="";
var hoverLastReviewed="";
for(var z=0;
z<groupNames.length;
z++){group=groupNames[z];
if(recordData.groups.hasOwnProperty(group)){jsFamHTML.push("<div class='sub-sec'><h3 class='sub-sec-hd'><span class='sub-sec-hd-tgl' title='",i18n.discernabu.HIDE_SECTION,"'>-</span><span class='sub-sec-title'>",group,"</span></h3><div class='sub-sec-content'>");
condLen=recordData.groups[group].conditions.length;
for(i=0;
i<condLen;
i++){condition=recordData.groups[group].conditions[i];
zebraStriping=(i%2)?"even":"odd";
jsFamHTML.push("<dl class='chx-row ",zebraStriping," grouped'><dt>",fhxi18n.CONDITION,"</dt><dd class='chx-condition'><span>",condition.CONDITION,"</span></dd><dd class='chx-family'>");
familyLen=condition.FAMILY_CNT;
commentHTML=[];
for(j=0;
j<familyLen;
j++){family=condition.FAMILY[j];
if(family.MEMBER>0){detailInfo=family.ONSET_AGE?" ("+fhxi18n.AT_AGE+" "+getAgePhrase(family.ONSET_AGE,family.ONSET_AGEUNIT)+")":"";
codeObj=MP_Util.GetValueFromArray(family.MEMBER,codeArray);
memberDisp=codeObj.display;
codeObj=MP_Util.GetValueFromArray(family.DECEASED_CD,codeArray);
if(codeObj&&codeObj.meaning=="YES"){detailInfo+=" - "+fhxi18n.DECEASED;
}jsFamHTML.push("<div id='fmHistHoverable",compId,"Item",hoverCnt,"' class='chx-fhx-item chx-info result-info'>",memberDisp,"<span class='detail-line'>",detailInfo,"</span></div>");
hoverOnsetAge=family.ONSET_AGE?getAgePhrase(family.ONSET_AGE,family.ONSET_AGEUNIT,1):"--";
hoverLifeCycle=family.LIFECYCLE?family.LIFECYCLE:"--";
hoverSeverity=family.SEVERITY?family.SEVERITY:"--";
hoverCourse=family.COURSE?family.COURSE:"--";
hoverName="--";
if(family.NAMEFIRST||family.NAMELAST){hoverName=family.NAMEFIRST+" "+family.NAMELAST;
}hoverDeceased="--";
if(family.DECEASED_AGE){hoverDeceased=getAgePhrase(family.DECEASED_AGE,family.DECEASED_AGEUNIT,1)+(family.DECEASED_DESP?"<br />"+family.DECEASED_DESP:"");
}hoverLastReviewed="--";
if(family.LASTREVIEWED!==""){hoverLastReviewed=new Date();
hoverLastReviewed.setISO8601(family.LASTREVIEWED);
hoverLastReviewed=hoverLastReviewed.format("shortDate3");
}comment="--";
if(family.COMMENT){comment=family.COMMENT.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br />");
commentHTML.push("<dt>",fhxi18n.COMMENT,"</dt><dd><p>",memberDisp,": ",comment,"</p></dd>");
}jsFamHTML.push("<div id='fmHistHover",compId,"Item",hoverCnt,"' class='result-details hover'><h4 class='det-hd'>",i18n.DETAILS,"</h4><dl class='chx-det'><dt><span>",fhxi18n.NAME,":</span></dt><dd><span>",hoverName,"</span></dd><dt><span>",fhxi18n.DECEASED,":</span></dt><dd><span>",hoverDeceased,"</span></dd><dt><span>",fhxi18n.ONSET,":</span></dt><dd><span>",hoverOnsetAge,"</span></dd><dt><span>",fhxi18n.LIFECYCLE,":</span></dt><dd><span>",hoverLifeCycle,"</span></dd><dt><span>",fhxi18n.SEVERITY,":</span></dt><dd><span>",hoverSeverity,"</span></dd><dt><span>",fhxi18n.COURSE,":</span></dt><dd><span>",hoverCourse,"</span></dd><dt><span>",fhxi18n.LASTREVIEWED,":</span></dt><dd><span>",hoverLastReviewed,"</span></dd><dt><span>",fhxi18n.COMMENT,":</span></dt><dd><span>",comment,"</span></dd></dl></div>");
hoverCnt++;
}}if(commentHTML.length){jsFamHTML.push("<dl class='comment'>",commentHTML.join(""),"</dl>");
}jsFamHTML.push("</dd></dl>");
}jsFamHTML.push("</div></div>");
}}jsFamHTML.push("</div>");
}}component.loadTabData(recordData.CONDITION_CNT+sLen,jsFamHTML.join(""),component.HistoryComponentIndexObj.FAMILY_HISTORY,function(){for(i=0;
i<hoverCnt;
i++){var hvrElmnt=document.getElementById("fmHistHoverable"+compId+"Item"+i);
var hvrDetail=document.getElementById("fmHistHover"+compId+"Item"+i);
hs(hvrElmnt,hvrDetail,component);
}});
}};
}();
