CKEDITOR.plugins.add("cerngetxhtml",{beforeInit:function(oEditor){var m_oFilters=[];
oEditor.registerXhtmlFilter=function(oFilter){m_oFilters.push(oFilter);
};
oEditor.getXhtml=function(){var snapshot=this.getSnapshot();
for(var i=0;
i<m_oFilters.length;
i++){m_oFilters[i]();
}DDCOMMON.resetCaches();
var sCleanedXHTML=this.getData();
this.loadSnapshot(snapshot);
if(typeof this.config.emitValidXhtml&&true==this.config.emitValidXhtml){sCleanedXHTML='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xmlns:dd="DynamicDocumentation">\n<head><title></title></head>\n<body>\n'+sCleanedXHTML+"\n</body></html>";
}return sCleanedXHTML;
};
var m_aDirtyFilters=[];
oEditor.registerDirtyFilter=function(callback){m_aDirtyFilters.push(callback);
};
oEditor.cleanContribution=function(contribution){var frag=document.createDocumentFragment();
frag.appendChild(contribution.cloneNode(true));
for(var i=0;
i<m_aDirtyFilters.length;
i++){var filter=m_aDirtyFilters[i];
if(filter&&filter.apply){filter(frag);
}}return frag.firstChild;
};
}});
