/**
 * @module whatsupdoc/commands/utility/files
 * @requires fs
 * @requires path
 */
const fs = require("fs");
const path = require("path");

/**
 * Reads a list of files in a given directory.
 *
 * @public
 * @function module:whatsupdoc/commands/utility/files.readFiles
 * @param {String} dir - the relative directory path to read files from
 * @returns {Promise} Returns promise containing file names and file data as strings
 */
const readFiles = (dir) => new Promise((resolve, reject) => fs.readdir(
        path.resolve(__dirname, dir),
        (error, data) => error ? reject(error) : resolve(data)
    )).then(files => Promise.all(
        files.map(file => new Promise((resolve, reject) => fs.readFile(
            path.resolve(__dirname, dir, file),
            'utf8',
            (error, data) => error
                ? reject(error)
                : resolve({
                    name: file,
                    text: data
                })
        )))
    ));

/**
 * @alias module:whatsupdoc/commands/utility/files
 */
module.exports = {
    readFiles
};
