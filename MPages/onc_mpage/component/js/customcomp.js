function CustomComponent(criterion){this.m_compNamespace="";
this.m_compOptionsObjName="";
this.m_custCompRef=null;
this.setCriterion(criterion);
var stylesObj=new ComponentStyle();
stylesObj.initByNamespace("cust");
this.setStyles(stylesObj);
this.setComponentLoadTimerName("USR:MPG.CUSTOM_COMP.O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.CUSTOM_COMP.O1 - render component");
}CustomComponent.prototype=new MPageComponent();
CustomComponent.prototype.constructor=MPageComponent;
CustomComponent.prototype.setComponentNamespace=function(namespace){this.m_compNamespace=namespace;
};
CustomComponent.prototype.getComponentNamespace=function(){return this.m_compNamespace;
};
CustomComponent.prototype.setComponentOptionsObjectName=function(optionsName){this.m_compOptionsObjName=optionsName;
};
CustomComponent.prototype.getComponentOptionsObjectName=function(){return this.m_compOptionsObjName;
};
CustomComponent.prototype.setCustomComponentReference=function(customCompRef){this.m_custCompRef=customCompRef;
};
CustomComponent.prototype.getCustomComponentReference=function(){return this.m_custCompRef;
};
CustomComponent.prototype.openTab=function(){var criterion=this.getCriterion();
var sParms="/PERSONID="+criterion.person_id+" /ENCNTRID="+criterion.encntr_id+" /FIRSTTAB=^"+this.getLink()+"+^";
APPLINK(0,criterion.executable,sParms);
};
CustomComponent.prototype.getFilterMappingsObj=function(){var reportMean=this.getReportMean().toUpperCase();
var custCompNum=/[0-9]+$/.exec(reportMean)[0];
var fullPageComp=(/.?_FP_.?/i.exec(reportMean))?"FP_":"";
this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_PRG_"+custCompNum,{type:"STRING",field:"FREETEXT_DESC",setFunction:this.setComponentNamespace});
this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_OBJ_"+custCompNum,{type:"STRING",field:"FREETEXT_DESC",setFunction:this.setComponentOptionsObjectName});
if(fullPageComp==="FP_"){this.addFilterMappingObject(fullPageComp+"CUSTOM_COMP_"+custCompNum+"_DISPLAY",{type:"Boolean",field:"FREETEXT_DESC",setFunction:this.setDisplayEnabled});
}return this.m_filterMappingsObj;
};
CustomComponent.prototype.getMaxHeight=function(){var compDOMObj=null;
var compHeight=0;
var contentBodyHeight=0;
var calcHeight=null;
var container=null;
var contentBodyObj=null;
var miscHeight=20;
var viewHeight=0;
if(this.getStyles().getComponentType()===CERN_COMPONENT_TYPE_WORKFLOW){compDOMObj=$(this.getRootComponentNode());
if(!compDOMObj.length){return null;
}container=$("#vwpBody");
if(!container.length){return null;
}viewHeight=container.height();
contentBodyObj=$(this.getSectionContentNode());
if(contentBodyObj.length){compHeight=compDOMObj.height();
contentBodyHeight=contentBodyObj.height();
calcHeight=(viewHeight-(compHeight-contentBodyHeight+miscHeight));
}}return calcHeight;
};
CustomComponent.prototype.getMenu=function(){return MPageComponent.prototype.getMenu.call(this);
};
CustomComponent.prototype.resizeComponent=function(){var maxHeight=null;
var contentBodyObj=null;
var maxWidth=null;
var compObj=this.getCustomComponentReference();
if(!compObj){return;
}maxHeight=this.getMaxHeight();
compObj.setProperty("maxHeight",maxHeight);
contentBodyObj=$(this.getSectionContentNode());
if(maxHeight){contentBodyObj.css({"max-height":maxHeight,"overflow-y":"auto"});
}maxWidth=contentBodyObj.width();
compObj.resize(maxWidth,maxHeight);
};
CustomComponent.prototype.refreshComponent=function(){var customComp=this.getCustomComponentReference();
if(customComp){customComp.refresh();
}};
CustomComponent.prototype.reloadCustomComp=function(){var self=this;
var customComp=this.getCustomComponentReference();
try{var callback=function(){self.finalizeCustomComp(null);
};
customComp.generate(customComp.getTarget(),callback,null);
}catch(err){logger.logJSError(err,this,"customcomp.js","reloadCustomComp");
this.finalizeCustomComp(err);
}};
CustomComponent.prototype.retrieveComponentData=function(){var callback=null;
var compHeight=0;
var compId="";
var compNamespace="";
var contentBodyObj=null;
var criterion=this.getCriterion();
var custComp=null;
var options=null;
var optionsObjectName="";
var self=this;
try{compNamespace=this.getComponentNamespace();
if(compNamespace){eval("custComp = new "+compNamespace+"();");
}else{throw new Error();
}}catch(namespaceError){var invalidNamespaceErr=null;
if(compNamespace){invalidNamespaceErr=new Error(i18n.discernabu.customcomponents_o1.INVALID_NAMESPACE.replace("{0}",compNamespace));
}else{invalidNamespaceErr=new Error(i18n.discernabu.customcomponents_o1.UNDEFINED_NAMESPACE);
}logger.logJSError(invalidNamespaceErr,this,"customcomp.js","retrieveComponentData");
this.finalizeCustomComp(invalidNamespaceErr);
return;
}try{optionsObjectName=this.getComponentOptionsObjectName();
if(optionsObjectName){eval("options = "+optionsObjectName+";");
}else{options=null;
}}catch(optionsObjectError){var invalidOptionsErr=new Error(i18n.discernabu.customcomponents_o1.INVALID_OPTIONS.replace("{0}",optionsObjectName));
logger.logJSError(invalidOptionsErr,this,"customcomp.js","retrieveComponentData");
this.finalizeCustomComp(invalidOptionsErr);
return;
}try{compId=this.getStyles().getId();
custComp.setOption("id",compId);
custComp.setOption("parentComp",this);
custComp.setProperty("mine","mine");
custComp.setProperty("compId",this.getComponentId());
custComp.setProperty("personId",criterion.person_id);
custComp.setProperty("userId",criterion.provider_id);
custComp.setProperty("encounterId",criterion.encntr_id);
custComp.setProperty("pprCd",criterion.ppr_cd);
custComp.setProperty("PPRCode",criterion.ppr_cd);
custComp.setProperty("staticContent",criterion.static_content);
custComp.setProperty("compSourceLocation",criterion.static_content.replace("UnifiedContent","custom_mpage_content")+"/custom-components/");
custComp.setProperty("positionCd",criterion.position_cd);
custComp.setProperty("categoryMean",criterion.category_mean);
custComp.setProperty("viewableEncounters",criterion.getPersonnelInfo().getViewableEncounters());
custComp.setProperty("headerTitle",this.getLabel());
custComp.setProperty("headerSubTitle","");
custComp.setProperty("headerOverflowState",(this.isScrollingEnabled())?true:false);
custComp.properties.userPreferences=this.getPreferencesObj();
compHeight=this.getMaxHeight();
custComp.setProperty("maxHeight",compHeight);
if(compHeight){contentBodyObj=this.getSectionContentNode();
$(contentBodyObj).css("max-height",compHeight).css("overflow-y","auto");
}custComp.setTarget(this.getSectionContentNode());
MPage.addCustomComp(custComp);
this.setCustomComponentReference(custComp);
callback=function(){self.finalizeCustomComp(null);
};
custComp.generate(custComp.getTarget(),callback,options);
}catch(renderError){logger.logJSError(renderError,this,"customcomp.js","retrieveComponentData");
this.finalizeCustomComp(renderError);
}};
CustomComponent.prototype.finalizeCustomComp=function(error){if(error){logger.logJSError(error,this,"customcomp.js","finalizeCustomComp");
this.finalizeComponent(this.generateScriptFailureHTML(),"");
}else{var custCompRef=this.getCustomComponentReference();
var headerSubTitle=(custCompRef.getProperty("headerSubTitle")!=="undefined")?custCompRef.getProperty("headerSubTitle"):"";
this.updateSubLabel(headerSubTitle);
this.notifyAggregateTimer();
}};
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_1",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_2",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_3",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_4",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_5",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_6",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_7",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_8",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_9",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_10",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_11",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_12",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_13",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_14",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_15",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_16",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_17",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_18",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_19",CustomComponent);
MP_Util.setObjectDefinitionMapping("CUSTOM_COMP_20",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_1",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_2",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_3",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_4",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_5",CustomComponent);
MP_Util.setObjectDefinitionMapping("FP_CUSTOM_COMP_6",CustomComponent);
