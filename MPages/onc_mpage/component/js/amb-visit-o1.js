function AmbVisitComponentStyle(){this.initByNamespace("av");
}AmbVisitComponentStyle.inherits(ComponentStyle);
function AmbVisitComponent(criterion){this.setCriterion(criterion);
this.setStyles(new AmbVisitComponentStyle());
this.setComponentLoadTimerName("USR:MPG.AMBVISIT.O1 - load component");
this.setComponentRenderTimerName("ENG:MPG.AMBVISIT.O1 - render component");
this.resultCount=0;
this.avI18nObj={};
this.tooltip=new MPageTooltip();
this.setIncludeLineNumber(true);
this.m_encntrdetailsind=0;
this.m_finind=0;
this.m_reasonforvisitind=0;
this.m_healthplanind=0;
this.m_diagind=0;
this.m_finlabel="";
this.m_visitprovlabel="";
this.m_refprovlabel="";
this.m_consultprovlabel="";
this.m_admitprovlabel="";
this.m_attendprovlabel="";
this.m_reldischlabel="";
this.m_chieflabel="";
this.m_reasonforvisitlabel="";
this.m_hplabel="";
this.m_diaglabel="";
this.m_documentlabel="";
this.m_qualtype=[];
this.m_visitprovtype=[];
this.m_refprovtype=[];
this.m_consulttype=[];
this.m_admittype=[];
this.m_attendtype=[];
this.m_dischtype=[];
this.m_diagtype=[];
this.m_chiefeventset=[];
this.m_documenteventset=[];
this.m_bedrockparamArray=[];
}AmbVisitComponent.prototype=new MPageComponent();
AmbVisitComponent.prototype.constructor=MPageComponent;
AmbVisitComponent.prototype.expandCollapseVisitSubSections=function(subsectionid){if($("#"+subsectionid+"_rows").css("display")==="block"){$("#"+subsectionid+"_rows").css("display","none");
$("#"+subsectionid).attr("title",i18n.SHOW_SECTION);
$("#"+subsectionid+"_tgl").removeClass().addClass("pwx-vi_sub-sec-hd-tgl-close");
}else{$("#"+subsectionid+"_rows").css("display","block");
$("#"+subsectionid).attr("title",i18n.HIDE_SECTION);
$("#"+subsectionid+"_tgl").removeClass().addClass("pwx-vi_sub-sec-hd-tgl");
}};
AmbVisitComponent.prototype.expandCollapseVisitMainSections=function(tbody_class,title_class,tgl_class,h3_class,scroll_div_id){var pwx_scroll_div_sub_id=$("#"+scroll_div_id+" .sub-sec-hd");
if(pwx_scroll_div_sub_id.attr("id")!==h3_class){pwx_scroll_div_sub_id.children("span:first").attr("class","pwx-vi_sub-sec-hd-tgl-close");
pwx_scroll_div_sub_id.parent("a:first").attr("title",i18n.SHOW_SECTION);
if(pwx_scroll_div_sub_id.closest("dl").attr("class")==="pwx_vi_top_encounter"){pwx_scroll_div_sub_id.closest("dl").removeClass("pwx_vi_enc_head_blue_border");
pwx_scroll_div_sub_id.closest("dl").addClass("pwx_vi_grey_border_all");
}else{pwx_scroll_div_sub_id.closest("dl").removeClass("pwx_vi_enc_head_blue_border");
pwx_scroll_div_sub_id.closest("dl").addClass("pwx_vi_grey_border_no_top");
}pwx_scroll_div_sub_id.closest("dl").nextAll("div[id$='row']:first").css("display","none");
pwx_scroll_div_sub_id.attr("class","pwx_vi_white_sub-sec-hd");
}var element;
if(document.getElementById&&(element=document.getElementById(tbody_class))){var pwx_title_class=$("#"+title_class).closest("dl");
if(document.getElementById(tbody_class).style.display==="block"){if(pwx_title_class.attr("class")=="pwx_vi_top_encounter"){pwx_title_class.removeClass("pwx_vi_enc_head_blue_border");
pwx_title_class.addClass("pwx_vi_grey_border_all");
}else{pwx_title_class.removeClass("pwx_vi_enc_head_blue_border");
pwx_title_class.addClass("pwx_vi_grey_border_no_top");
}document.getElementById(tbody_class).style.display="none";
document.getElementById(title_class).title=i18n.SHOW_SECTION;
document.getElementById(tgl_class).className="pwx-vi_sub-sec-hd-tgl-close";
document.getElementById(h3_class).className="pwx_vi_white_sub-sec-hd";
}else{if(pwx_title_class.attr("class")==="pwx_vi_top_encounter"){pwx_title_class.removeClass("pwx_vi_grey_border_all");
pwx_title_class.addClass("pwx_vi_enc_head_blue_border");
}else{pwx_title_class.removeClass("pwx_vi_grey_border_no_top");
pwx_title_class.addClass("pwx_vi_enc_head_blue_border");
}$("#"+title_class).children("h3:first").attr("class","sub-sec-hd");
document.getElementById(tbody_class).style.display="block";
document.getElementById(title_class).title=i18n.HIDE_SECTION;
document.getElementById(tgl_class).className="pwx-vi_sub-sec-hd-tgl";
}}};
AmbVisitComponent.prototype.setencntrdetailsind=function(value){this.m_encntrdetailsind=(value===true?1:0);
};
AmbVisitComponent.prototype.getencntrdetailsind=function(){return this.m_encntrdetailsind;
};
AmbVisitComponent.prototype.setfinind=function(value){this.m_finind=(value===true?1:0);
};
AmbVisitComponent.prototype.getfinind=function(){return this.m_finind;
};
AmbVisitComponent.prototype.setreasonforvisitind=function(value){this.m_reasonforvisitind=(value===true?1:0);
};
AmbVisitComponent.prototype.getreasonforvisitind=function(){return this.m_reasonforvisitind;
};
AmbVisitComponent.prototype.sethealthplanind=function(value){this.m_healthplanind=(value===true?1:0);
};
AmbVisitComponent.prototype.gethealthplanind=function(){return this.m_healthplanind;
};
AmbVisitComponent.prototype.setdiagind=function(value){this.m_diagind=(value===true?1:0);
};
AmbVisitComponent.prototype.getdiagind=function(){return this.m_diagind;
};
AmbVisitComponent.prototype.setfinlabel=function(value){this.m_finlabel=value;
};
AmbVisitComponent.prototype.getfinlabel=function(){return this.m_finlabel;
};
AmbVisitComponent.prototype.setvisitprovlabel=function(value){this.m_visitprovlabel=value;
};
AmbVisitComponent.prototype.getvisitprovlabel=function(){return this.m_visitprovlabel;
};
AmbVisitComponent.prototype.setrefprovlabel=function(value){this.m_refprovlabel=value;
};
AmbVisitComponent.prototype.getrefprovlabel=function(){return this.m_refprovlabel;
};
AmbVisitComponent.prototype.setconsultprovlabel=function(value){this.m_consultprovlabel=value;
};
AmbVisitComponent.prototype.getconsultprovlabel=function(){return this.m_consultprovlabel;
};
AmbVisitComponent.prototype.setadmitprovlabel=function(value){this.m_admitprovlabel=value;
};
AmbVisitComponent.prototype.getadmitprovlabel=function(){return this.m_admitprovlabel;
};
AmbVisitComponent.prototype.setattendprovlabel=function(value){this.m_attendprovlabel=value;
};
AmbVisitComponent.prototype.getattendprovlabel=function(){return this.m_attendprovlabel;
};
AmbVisitComponent.prototype.setreldischlabel=function(value){this.m_reldischlabel=value;
};
AmbVisitComponent.prototype.getreldischlabel=function(){return this.m_reldischlabel;
};
AmbVisitComponent.prototype.setchieflabel=function(value){this.m_chieflabel=value;
};
AmbVisitComponent.prototype.getchieflabel=function(){return this.m_chieflabel;
};
AmbVisitComponent.prototype.setreasonforvisitlabel=function(value){this.m_reasonforvisitlabel=value;
};
AmbVisitComponent.prototype.getreasonforvisitlabel=function(){return this.m_reasonforvisitlabel;
};
AmbVisitComponent.prototype.sethplabel=function(value){this.m_hplabel=value;
};
AmbVisitComponent.prototype.gethplabel=function(){return this.m_hplabel;
};
AmbVisitComponent.prototype.setdiaglabel=function(value){this.m_diaglabel=value;
};
AmbVisitComponent.prototype.getdiaglabel=function(){return this.m_diaglabel;
};
AmbVisitComponent.prototype.setdocumentlabel=function(value){this.m_documentlabel=value;
};
AmbVisitComponent.prototype.getdocumentlabel=function(){return this.m_documentlabel;
};
AmbVisitComponent.prototype.setqualtype=function(value){this.m_qualtype=value;
};
AmbVisitComponent.prototype.getqualtype=function(){return this.m_qualtype;
};
AmbVisitComponent.prototype.setvisitprovtype=function(value){this.m_visitprovtype=value;
};
AmbVisitComponent.prototype.getvisitprovtype=function(){return this.m_visitprovtype;
};
AmbVisitComponent.prototype.setrefprovtype=function(value){this.m_refprovtype=value;
};
AmbVisitComponent.prototype.getrefprovtype=function(){return this.m_refprovtype;
};
AmbVisitComponent.prototype.setconsulttype=function(value){this.m_consulttype=value;
};
AmbVisitComponent.prototype.getconsulttype=function(){return this.m_consulttype;
};
AmbVisitComponent.prototype.setadmittype=function(value){this.m_admittype=value;
};
AmbVisitComponent.prototype.getadmittype=function(){return this.m_admittype;
};
AmbVisitComponent.prototype.setattendtype=function(value){this.m_attendtype=value;
};
AmbVisitComponent.prototype.getattendtype=function(){return this.m_attendtype;
};
AmbVisitComponent.prototype.setdischtype=function(value){this.m_dischtype=value;
};
AmbVisitComponent.prototype.getdischtype=function(){return this.m_dischtype;
};
AmbVisitComponent.prototype.setdiagtype=function(value){this.m_diagtype=value;
};
AmbVisitComponent.prototype.getdiagtype=function(){return this.m_diagtype;
};
AmbVisitComponent.prototype.setchiefeventset=function(value){this.m_chiefeventset=value;
};
AmbVisitComponent.prototype.getchiefeventset=function(){return this.m_chiefeventset;
};
AmbVisitComponent.prototype.setdocumenteventset=function(value){this.m_documenteventset=value;
};
AmbVisitComponent.prototype.getdocumenteventset=function(){return this.m_documenteventset;
};
AmbVisitComponent.prototype.setbedrockparamArray=function(value){this.m_bedrockparamArray=value;
};
AmbVisitComponent.prototype.getbedrockparamArray=function(){return this.m_bedrockparamArray;
};
AmbVisitComponent.prototype.loadFilterMappings=function(){MPageComponent.prototype.loadFilterMappings.call(this);
this.addFilterMappingObject("ENCNTRS_DETAILS_DISP",{setFunction:this.setencntrdetailsind,type:"Boolean",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_FIN_CLASS_DISP",{setFunction:this.setfinind,type:"Boolean",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_HEALTH_PLANS_DISP",{setFunction:this.sethealthplanind,type:"Boolean",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RFV_DISP",{setFunction:this.setreasonforvisitind,type:"Boolean",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_DIAG_DISP",{setFunction:this.setdiagind,type:"Boolean",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_FIN_CLASS_LABEL",{setFunction:this.setfinlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_VISITPROV_LABEL",{setFunction:this.setvisitprovlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_REF_PROV_LABEL",{setFunction:this.setrefprovlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_CONSULT_LABEL",{setFunction:this.setconsultprovlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_ADMIT_LABEL",{setFunction:this.setadmitprovlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_ATTEND_LABEL",{setFunction:this.setattendprovlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RELTN_DISCH_LABEL",{setFunction:this.setreldischlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_CHIEF_COMP_LABEL",{setFunction:this.setchieflabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_RFV_DISP_LABEL",{setFunction:this.setreasonforvisitlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_HEALTH_PLANS_LABEL",{setFunction:this.sethplabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_DIAG_DISP_LABEL",{setFunction:this.setdiaglabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_DOCUMENTS_LABEL",{setFunction:this.setdocumentlabel,type:"STRING",field:"FREETEXT_DESC"});
this.addFilterMappingObject("ENCNTRS_QUAL_TYPES",{setFunction:this.setqualtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_VISITPROV_TYPE",{setFunction:this.setvisitprovtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_REF_PROV_TYPE",{setFunction:this.setrefprovtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_CONSULT_TYPE",{setFunction:this.setconsulttype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_ADMIT_TYPE",{setFunction:this.setadmittype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_ATTEND_TYPE",{setFunction:this.setattendtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_DIAG_TYPES",{setFunction:this.setdiagtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_RELTN_DISCH_TYPE",{setFunction:this.setdischtype,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_CHIEF_COMP_CE",{setFunction:this.setchiefeventset,type:"ARRAY",field:"PARENT_ENTITY_ID"});
this.addFilterMappingObject("ENCNTRS_DOCUMENTS_CE",{setFunction:this.setdocumenteventset,type:"ARRAY",field:"PARENT_ENTITY_ID"});
};
AmbVisitComponent.prototype.retrieveComponentData=function(){var criterion=null;
var request=null;
var self=this;
var sendAr=null;
var paramArray1=null;
var paramArray2=null;
criterion=this.getCriterion();
var prsnlInfo=criterion.getPersonnelInfo();
var encntrs=prsnlInfo.getViewableEncounters();
var encntrVal=(encntrs)?"value("+encntrs+")":"0.0";
var encntrValScope=(this.getScope()==2)?"value("+criterion.encntr_id+".0 )":encntrVal;
paramArray1=["^MINE^",criterion.person_id+".0",criterion.provider_id+".0",criterion.encntr_id+".0",criterion.position_cd+".0",0];
paramArray2=[this.getencntrdetailsind(),MP_Util.CreateParamArray(this.getchiefeventset(),1),MP_Util.CreateParamArray(this.getdiagtype(),1),MP_Util.CreateParamArray(this.getdocumenteventset(),1),MP_Util.CreateParamArray(this.getqualtype(),1),MP_Util.CreateParamArray(this.getadmittype(),1),MP_Util.CreateParamArray(this.getattendtype(),1),MP_Util.CreateParamArray(this.getconsulttype(),1),MP_Util.CreateParamArray(this.getdischtype(),1),MP_Util.CreateParamArray(this.getrefprovtype(),1),MP_Util.CreateParamArray(this.getvisitprovtype(),1),this.gethealthplanind(),"^"+this.getvisitprovlabel()+"^","^"+this.getrefprovlabel()+"^","^"+this.getconsultprovlabel()+"^","^"+this.getadmitprovlabel()+"^","^"+this.getattendprovlabel()+"^","^"+this.getreldischlabel()+"^",encntrValScope];
this.setbedrockparamArray(paramArray2);
sendAr=paramArray1.concat(paramArray2);
MP_Core.XMLCclRequestWrapper(this,"AMB_MP_ENCOUNTER_COMP",sendAr,true);
};
AmbVisitComponent.prototype.renderComponent=function(reply){var thiz=this;
var numberResults=0;
var results=null;
this.avI18nObj=i18n.discernabu.visit_o1;
var criterion=this.getCriterion();
numberResults=reply.E_LIST.length;
var visitcompId=this.getComponentId();
var visitcompContentElemID="amb_vi_enc_scroll_div"+visitcompId;
$("#"+visitcompContentElemID).off();
var mainvisitHvrArray=[];
var diagnosisHvrArray=[];
var documentsHvrArray=[];
var healthHvrArray=[];
var pwx_encounter_id_row="0";
var pwx_encounter_index_row="0";
var pwxencmainobject=reply;
var pwxdata={};
var pid=criterion.person_id;
var eid=criterion.encntr_id;
var uid=criterion.provider_id;
var posid=criterion.position_cd;
var encdetaildefaultind=0;
var selectedUTCDate=new Date();
if(reply.E_LIST[0].REG_DATE!=="--"){selectedUTCDate.setISO8601(reply.E_LIST[0].REG_DATE);
var selectedDate=selectedUTCDate.format("shortDate2");
}else{var selectedDate="--";
}var pwx_prog_sub_title="&nbsp;"+this.avI18nObj.VIS+"  "+selectedDate;
var encHTML=[];
var encdetailinfo=[];
encHTML.push('<div class="pwx_vi_div_scroll " id="'+visitcompContentElemID+'">');
for(var cc=0;
cc<numberResults;
cc++){var pwx_enc_regi_date_time_HTML="";
var encUTCDate=new Date();
if(reply.E_LIST[cc].REG_DATE!=="--"){encUTCDate.setISO8601(reply.E_LIST[cc].REG_DATE);
var visitUTCdate=encUTCDate.format("shortDate2");
var visitUTCtime=encUTCDate.format("shortTime");
}else{var visitUTCdate="--";
}var dischUTCDate=new Date();
if(reply.E_LIST[cc].DISCH_DATE!=="--"){dischUTCDate.setISO8601(reply.E_LIST[cc].DISCH_DATE);
var discUTCdate=dischUTCDate.format("shortDate2");
}else{var discUTCdate="--";
}var myHvr=[];
var row_cnt=4;
myHvr.length=row_cnt;
myHvr[0]=["",""];
myHvr[0][0]=""+this.avI18nObj.REGDATE+":";
myHvr[0][1]=visitUTCdate;
myHvr[1]=["",""];
myHvr[1][0]=""+this.avI18nObj.DISDATE+":";
myHvr[1][1]=discUTCdate;
myHvr[2]=["",""];
myHvr[2][0]=""+this.avI18nObj.LOC+":";
myHvr[2][1]=reply.E_LIST[cc].LOCATION;
myHvr[3]=["",""];
myHvr[3][0]=""+this.avI18nObj.ORG+":";
myHvr[3][1]=reply.E_LIST[cc].ORG_NAME;
if(thiz.getencntrdetailsind()===1){row_cnt=row_cnt+1;
myHvr.length=row_cnt;
myHvr[row_cnt-1]=["",""];
myHvr[row_cnt-1][0]=""+this.avI18nObj.ENCTYPE+":";
myHvr[row_cnt-1][1]=reply.E_LIST[cc].TYPE;
row_cnt=row_cnt+1;
myHvr.length=row_cnt;
myHvr[row_cnt-1]=["",""];
myHvr[row_cnt-1][0]=""+this.avI18nObj.MEDSER+":";
myHvr[row_cnt-1][1]=reply.E_LIST[cc].MED_SERVICE;
}mainvisitHvrArray.push(myHvr);
encdetailinfo[cc]=[];
encdetailinfo[cc].length=5;
encdetailinfo[cc][0]=reply.E_LIST[cc].FIN_CLASS;
encdetailinfo[cc][1]=reply.E_LIST[cc].REASON_FOR;
encdetailinfo[cc][2]=reply.E_LIST[cc].ORDER_CNT;
encdetailinfo[cc][3]=reply.E_LIST[cc].CHARGE_CNT;
encdetailinfo[cc][4]=reply.E_LIST[cc].RX_CNT;
var encntr_title_id=""+visitcompId+"_vi_"+cc+"_title";
var encntr_row_id=""+visitcompId+"_vi_"+cc+"_row";
var encntr_tgl_id=""+visitcompId+"_vi_"+cc+"_tgl";
var encntr_h3_id=""+visitcompId+"_vi_"+cc+"_h3";
if(reply.E_LIST[cc].REG_DATE!=="--"){pwx_enc_regi_date_time_HTML+='<span class="pwx_vi_header_black">'+visitUTCdate+'&nbsp;<span class="disabled" style="font-size:10px;">'+visitUTCtime+"</span>&nbsp;&nbsp;&nbsp;"+reply.E_LIST[cc].LOCATION+"</span>";
}else{pwx_enc_regi_date_time_HTML+='<span class="pwx_vi_header_black" style="font-size:12px;">'+this.avI18nObj.VIS+': </span><span class="pwx_vi_header_black" style="font-size:10px;">'+visitUTCdate+'</span><span class="pwx_vi_header_black">&nbsp;&nbsp;&nbsp;'+reply.E_LIST[cc].LOCATION+"</span>";
}if(cc===0){encHTML.push('<dl id="visit_row_'+cc+"_"+visitcompId+'" class="visit_class_'+cc+' visit-click-detail pwx_vi_pwxnopad_enc-info pwx_vi_top_encounter pwx_vi_enc_head_blue_border visit-info"><dt class="pwx_vi_single_sub_sec_white_dt"><a id="'+encntr_title_id+'" class="pwx_vi_sub_sub_sec_link pwx_vi_main_sec_class" title="'+i18n.HIDE_SECTION+'">','<h3 class="sub-sec-hd" id="'+encntr_h3_id+'"><span id="'+encntr_tgl_id+'" class="pwx-vi_sub-sec-hd-tgl">-</span> '+pwx_enc_regi_date_time_HTML+'</h3></a></dt><span class="pwx-enc-index'+cc+'" style="display:none">'+cc+'</span><span class="pwx-enc-id'+cc+'" style="display:none">'+reply.E_LIST[cc].ENCNTR_ID+"</span></dl>");
encHTML.push('<div id="'+encntr_row_id+'" class="pwx_vi_enc_detail_div_'+visitcompId+"_"+cc+' pwx_vi_enc_div_blue_border"style="display:block">');
renderEncounterDetails(0,pwxencmainobject,encdetaildefaultind,eid);
encHTML.push("</div>");
}else{encHTML.push('<dl id="visit_row_'+cc+"_"+visitcompId+'" class="visit_class_'+cc+' visit-click-detail pwx_vi_pwxnopad_enc-info pwx_vi_grey_border_no_top visit-info"><dt class="pwx_vi_single_sub_sec_white_dt"><a id="'+encntr_title_id+'" class="pwx_vi_sub_sub_sec_link pwx_vi_main_sec_class" title="'+i18n.SHOW_SECTION+'">','<h3 class="pwx_vi_white_sub-sec-hd" id="'+encntr_h3_id+'"><span id="'+encntr_tgl_id+'" class="pwx-vi_sub-sec-hd-tgl-close">-</span>'+pwx_enc_regi_date_time_HTML+'</h3></a></dt><span class="pwx-enc-index'+cc+'" style="display:none">'+cc+'</span><span class="pwx-enc-id'+cc+'" style="display:none">'+reply.E_LIST[cc].ENCNTR_ID+"</span></dl>");
encHTML.push('<div id="'+encntr_row_id+'" class="pwx_vi_enc_detail_div_'+visitcompId+"_"+cc+' pwx_vi_enc_div_blue_border" style="display:none"></div>');
}}this.finalizeComponent(encHTML.join(""),MP_Util.CreateTitleText(this,numberResults,pwx_prog_sub_title));
var containerScrollDiv=document.getElementById(visitcompContentElemID);
var maxResults=this.getScrollNumber();
MP_Util.Doc.InitSectionScrolling(containerScrollDiv,maxResults,"1.6");
function renderEncounterDetails(pwx_encounter_index_row,pwxdata,encdetaildefaultind,pwx_encounter_id_row){var encdetailHTML=[];
diagnosisHvrArray=[];
documentsHvrArray=[];
healthHvrArray=[];
var cc=0;
var encntr_title_id=""+visitcompId+""+pwx_encounter_index_row+"_title";
var encntr_row_id=""+visitcompId+""+pwx_encounter_index_row+"_row";
var encntr_tgl_id=""+visitcompId+""+pwx_encounter_index_row+"_tgl";
if(eid>0&&eid!==pwx_encounter_id_row){encdetailHTML.push('<dl class="pwx_vi_grey_dash_border_bottom-info"><a class="pwx_vi_blue_link" title="'+thiz.avI18nObj.OPENVI+'"',"href=\"javascript:APPLINK(0,'Powerchart.exe','/PERSONID="+pid+" /ENCNTRID="+pwx_encounter_id_row+" ')\">",thiz.avI18nObj.OPENVI,"</a></dl>");
}encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.avI18nObj.FIN+':</dt><dt class="pwx_vi_2_col_enc_value">'+pwxdata.FIN+"</dt></dl>");
if(thiz.getencntrdetailsind()===1){encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.avI18nObj.LOC+':</dt><dt class="pwx_vi_2_col_enc_value">'+mainvisitHvrArray[pwx_encounter_index_row][2][1]+"</dt></dl>");
encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.avI18nObj.ORG+':</dt><dt class="pwx_vi_2_col_enc_value">'+mainvisitHvrArray[pwx_encounter_index_row][3][1]+"</dt></dl>");
encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.avI18nObj.ENCTYPE+':</dt><dt class="pwx_vi_2_col_enc_value">'+mainvisitHvrArray[pwx_encounter_index_row][4][1]+"</dt></dl>");
encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.avI18nObj.MEDSER+':</dt><dt class="pwx_vi_2_col_enc_value">'+mainvisitHvrArray[pwx_encounter_index_row][5][1]+"</dt></dl>");
}if(thiz.getfinind()===1){encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.getfinlabel()+':</dt><dt class="pwx_vi_2_col_enc_value">'+encdetailinfo[pwx_encounter_index_row][0]+"</dt></dl>");
}if(pwxdata.RELTNS.length>0){for(var i=0;
i<pwxdata.RELTNS.length;
i++){encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+pwxdata.RELTNS[i].LABEL+':</dt><dt class="pwx_vi_2_col_enc_value">'+pwxdata.RELTNS[i].TEXT+"</dt></dl>");
}}if(pwxdata.CHIEF_COMP_DISP===1){if(pwxdata.CHIEF_COMP.length>0){var amb_chief_length=pwxdata.CHIEF_COMP.length;
encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.getchieflabel()+':</dt><dt class="pwx_vi_2_col_enc_value">');
for(var i=0;
i<amb_chief_length;
i++){if(pwxdata.CHIEF_COMP[i].ID===0){encdetailHTML.push(pwxdata.CHIEF_COMP[i].TEXT);
}else{encdetailHTML.push('<a id="',pwxdata.CHIEF_COMP[i].ID,"_"+visitcompId+'" class="pwx_vi_result_link visit_cheif_view_link"  title="'+thiz.avI18nObj.VIEWRES+'" >',pwxdata.CHIEF_COMP[i].TEXT+"</a>");
}if((i+1)!==pwxdata.CHIEF_COMP.length){encdetailHTML.push('<span class="disabled"> | </span>');
}}encdetailHTML.push("</dt></dl>");
}else{encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.getchieflabel()+':</dt><dt class="pwx_vi_2_col_enc_value">--</dt></dl>');
}}if(thiz.getreasonforvisitind()===1){encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.getreasonforvisitlabel()+':</dt><dt class="pwx_vi_2_col_enc_value">'+encdetailinfo[pwx_encounter_index_row][1]+"</dt></dl>");
}if(pwxdata.ENC_DIAG_DISP===1){var myHvr=[];
myHvr.length=1;
myHvr[0]=["",""];
encdetailHTML.push('<dl class="pwx_vi_grey_border-info"><dt class="pwx_vi_2_col_enc_lbl">'+thiz.getdiaglabel()+" ("+pwxdata.DIAG.length+'):</dt><dt id="diagnosis_row_'+cc+"_"+visitcompId+'" class="pwx_vi_2_col_enc_value pwx_vi_small_text visit-info">');
if(pwxdata.DIAG.length>0){myHvr[0][0]=thiz.getdiaglabel()+" ("+pwxdata.DIAG.length+"):";
myHvr[0][1]="";
myHvr.length=2;
myHvr[1]=["",""];
myHvr[1][0]="";
myHvr[1][1]='<span class="pwx_vi_normal_line_height pwx_vi_small_text">';
for(var i=0;
i<pwxdata.DIAG.length;
i++){if(pwxdata.DIAG[i].CODE!==""){myHvr[1][1]+=pwxdata.DIAG[i].TEXT+'<span class="disabled"> ('+pwxdata.DIAG[i].CODE+")</span><br />";
}else{myHvr[1][1]+=pwxdata.DIAG[i].TEXT+"<br />";
}}myHvr[1][1]+="<br /></span>";
var diag_limit=5;
if(pwxdata.DIAG.length<5){diag_limit=pwxdata.DIAG.length;
}for(var i=0;
i<diag_limit;
i++){if(pwxdata.DIAG[i].CODE!==""){encdetailHTML.push(pwxdata.DIAG[i].TEXT+'<span class="disabled"> ('+pwxdata.DIAG[i].CODE+")</span><br />");
}else{encdetailHTML.push(pwxdata.DIAG[i].TEXT+"<br />");
}}if(pwxdata.DIAG.length>5){encdetailHTML.push('<span class="disabled pwx_vi_small_text">'+thiz.avI18nObj.MORE+"...</span>");
}}else{myHvr[0][0]=thiz.getdiaglabel()+":";
myHvr[0][1]=""+thiz.avI18nObj.NOVIDIAG+"";
encdetailHTML.push("--");
}diagnosisHvrArray.push(myHvr);
encdetailHTML.push("</dt></dl>");
}if(pwxdata.DOCUMENTS_DISP===1){var doc_title_id=""+visitcompId+"_doc"+pwx_encounter_index_row+"_title";
var doc_row_id=""+visitcompId+"_doc"+pwx_encounter_index_row+"_title_rows";
var doc_tgl_id=""+visitcompId+"_doc"+pwx_encounter_index_row+"_title_tgl";
encdetailHTML.push('<dl class="pwx_vi_pwxnopad-info pwx_vi_doc_class"><dt class="pwx_vi_single_sub_sub_sec_dt"><a id="'+doc_title_id+'" class="pwx_vi_sub_sec_link visit_sub_section_class" title="'+i18n.HIDE_SECTION+'">','<span id="'+doc_tgl_id+'" class="pwx-vi_sub-sec-hd-tgl-close">-</span><h3 class="pwx_vi_sub_sub-sec-hd"><span class="pwx-vi-bgc">','<span class="disabled">'+thiz.getdocumentlabel()+" ("+pwxdata.DOCS.length,")&nbsp;</span></h3></span></a></dt></dl>",'<div id="'+doc_row_id+'" style="display:none">');
if(pwxdata.DOCS.length>0){var documenthvrindex=0;
var amb_doc_length=pwxdata.DOCS.length;
for(var i=0;
i<amb_doc_length;
i++){var documentdateUTC=new Date();
var myHvr=[];
if(pwxdata.DOCS[i].DATE!=="--"){documentdateUTC.setISO8601(pwxdata.DOCS[i].DATE);
var docUTC=documentdateUTC.format("shortDate2");
}else{var docUTC="--";
}var documentupdateUTC=new Date();
if(pwxdata.DOCS[i].UPDT_DT!=="--"){documentupdateUTC.setISO8601(pwxdata.DOCS[i].UPDT_DT);
var docupdateUTC=documentupdateUTC.format("shortDate2");
}else{var docupdateUTC="--";
}myHvr.length=6;
myHvr[0]=["",""];
myHvr[0][0]=""+thiz.avI18nObj.TYP+":";
myHvr[0][1]=pwxdata.DOCS[i].TYPE;
myHvr[1]=["",""];
myHvr[1][0]=""+thiz.avI18nObj.SUB+":";
myHvr[1][1]=pwxdata.DOCS[i].SUBJECT;
myHvr[2]=["",""];
myHvr[2][0]=""+thiz.avI18nObj.AUH+":";
myHvr[2][1]=pwxdata.DOCS[i].AUTHOR;
myHvr[3]=["",""];
myHvr[3][0]=""+thiz.avI18nObj.STAT+":";
myHvr[3][1]=pwxdata.DOCS[i].STATUS;
myHvr[4]=["",""];
myHvr[4][0]=""+thiz.avI18nObj.CREDATE+":";
myHvr[4][1]=docUTC;
myHvr[5]=["",""];
myHvr[5][0]=""+thiz.avI18nObj.UPDATE+":";
myHvr[5][1]=docupdateUTC;
documentsHvrArray.push(myHvr);
encdetailHTML.push('<dl id="documents_row_'+documenthvrindex+"_"+visitcompId+'" class="pwx_vi_grey_border-info pwx_vi_small_text visit-info"><dt class="pwx_vi_2_col_enc_doc_text">','<a id="',pwxdata.DOCS[i].EVENT_ID,'"  class="pwx_vi_result_link visit_doc_view_link"  title="'+thiz.avI18nObj.VIWDOC+'" >');
if(pwxdata.DOCS[i].SUBJECT==="--"){encdetailHTML.push(pwxdata.DOCS[i].TYPE);
}else{encdetailHTML.push(pwxdata.DOCS[i].SUBJECT);
}encdetailHTML.push('</a></dt><dt class="pwx_vi_2_col_enc_doc_date disabled"> '+docUTC+"</dt></dl>");
documenthvrindex=documenthvrindex+1;
}}else{encdetailHTML.push('<dl class="pwx_vi_grey_border-info pwx_vi_small_text"><dt class="pwx_vi_sub_sub_single_dt_wpad"><span class="res-none">'+i18n.NO_RESULTS_FOUND+"</span></dt></dl>");
}encdetailHTML.push("</div>");
}if(pwxdata.HEALTHPLAN_DISP===1){var healthplan_title_id=""+visitcompId+"_hp"+pwx_encounter_index_row+"_title";
var healthplan_row_id=""+visitcompId+"_hp"+pwx_encounter_index_row+"_title_rows";
var healthplan_tgl_id=""+visitcompId+"_hp"+pwx_encounter_index_row+"_title_tgl";
encdetailHTML.push('<dl class="pwx_vi_pwxnopad-info pwx_vi_doc_class"><dt class="pwx_vi_single_sub_sub_sec_dt"><a id="'+healthplan_title_id+'" class="pwx_vi_sub_sec_link visit_sub_section_class" title="'+i18n.HIDE_SECTION+'">','<span id="'+healthplan_tgl_id+'" class="pwx-vi_sub-sec-hd-tgl-close">-</span><h3 class="pwx_vi_sub_sub-sec-hd"><span class="pwx-vi-bgc">','<span class="disabled">'+thiz.gethplabel()+" ("+pwxdata.HP_LIST.length,")&nbsp;</span></h3></span></a></dt></dl>",'<div id="'+healthplan_row_id+'" style="display:none">');
if(pwxdata.HP_LIST.length>0){var healthplanindex=0;
var amb_hp_length=pwxdata.HP_LIST.length;
for(var i=0;
i<amb_hp_length;
i++){myHvr=[];
myHvr.length=6;
myHvr[0]=["",""];
myHvr[0][0]=""+thiz.avI18nObj.HEAPLAN+":";
myHvr[0][1]=pwxdata.HP_LIST[i].NAME;
myHvr[1]=["",""];
myHvr[1][0]=""+thiz.avI18nObj.MEM+"#:";
myHvr[1][1]=pwxdata.HP_LIST[i].MEMBER_NUM;
myHvr[2]=["",""];
myHvr[2][0]=""+thiz.avI18nObj.GRP+"#:";
myHvr[2][1]=pwxdata.HP_LIST[i].GROUP_NUM;
myHvr[3]=["",""];
myHvr[3][0]=""+thiz.avI18nObj.POL+"#:";
myHvr[3][1]=pwxdata.HP_LIST[i].POLICY_NUM;
myHvr[4]=["",""];
myHvr[4][0]=""+thiz.avI18nObj.TYP+":";
myHvr[4][1]=pwxdata.HP_LIST[i].TYPE;
myHvr[5]=["",""];
myHvr[5][0]=""+thiz.avI18nObj.FINCLASS+":";
myHvr[5][1]=pwxdata.HP_LIST[i].FIN_CLASS;
healthHvrArray.push(myHvr);
encdetailHTML.push('<dl id="healthplan_row_'+healthplanindex+"_"+visitcompId+'" class="pwx_vi_grey_border-nowordwrap_info pwx_vi_small_text visit-info"><dt class="pwx_vi_2_col_enc_healthplan_name">');
encdetailHTML.push(pwxdata.HP_LIST[i].NAME);
encdetailHTML.push('</dt><dt class="pwx_vi_2_col_enc_healthplan_fclass disabled"> '+pwxdata.HP_LIST[i].FIN_CLASS+"</dt></dl>");
healthplanindex=healthplanindex+1;
}}else{encdetailHTML.push('<dl class="pwx_vi_grey_border-info pwx_vi_small_text"><dt class="pwx_vi_sub_sub_single_dt_wpad"><span class="res-none">'+i18n.NO_RESULTS_FOUND+"</span></dt></dl>");
}encdetailHTML.push("</div>");
}if(encdetaildefaultind===1){$(".pwx_vi_enc_detail_div_"+visitcompId+"_"+pwx_encounter_index_row).html(encdetailHTML.join(""));
}else{encHTML.push(encdetailHTML.join(""));
}}var visitcompContentElem=$("#"+visitcompContentElemID);
visitcompContentElem.off("click","a.pwx_vi_main_sec_class");
visitcompContentElem.on("click","a.pwx_vi_main_sec_class",function(event){var encntr_title_fn_id=$(this).attr("id");
var enctr_array=encntr_title_fn_id.split("_");
var enctr_join_array=enctr_array[0]+"_"+enctr_array[1]+"_"+enctr_array[2];
var encntr_fn_row_id=""+enctr_join_array+"_row";
var encntr_fn_tgl_id=""+enctr_join_array+"_tgl";
var encntr_fn_h3_id=""+enctr_join_array+"_h3";
thiz.expandCollapseVisitMainSections(encntr_fn_row_id,encntr_title_fn_id,encntr_fn_tgl_id,encntr_fn_h3_id,visitcompContentElemID);
});
visitcompContentElem.off("click","a.visit_sub_section_class");
visitcompContentElem.on("click","a.visit_sub_section_class",function(event){thiz.expandCollapseVisitSubSections($(this).attr("id"));
});
visitcompContentElem.off("click",".visit_doc_view_link");
visitcompContentElem.on("click",".visit_doc_view_link",function(){var docid=$(this).attr("id");
var pwxPVViewerMPage=window.external.DiscernObjectFactory("PVVIEWERMPAGE");
pwxPVViewerMPage.CreateDocViewer(criterion.person_id);
pwxPVViewerMPage.AppendDocEvent(docid);
pwxPVViewerMPage.LaunchDocViewer();
});
visitcompContentElem.off("click",".visit_cheif_view_link");
visitcompContentElem.on("click",".visit_cheif_view_link",function(){var resulteventid=$(this).attr("id").split("_");
var pwxPVViewerMPage=window.external.DiscernObjectFactory("PVVIEWERMPAGE");
pwxPVViewerMPage.CreateEventViewer(criterion.person_id);
pwxPVViewerMPage.AppendEvent(resulteventid[0]);
pwxPVViewerMPage.LaunchEventViewer();
});
function ambvisitresultsview(persId,eventId){var pwxPVViewerMPage=window.external.DiscernObjectFactory("PVVIEWERMPAGE");
pwxPVViewerMPage.CreateEventViewer(persId);
pwxPVViewerMPage.AppendEvent(eventId);
pwxPVViewerMPage.LaunchEventViewer();
}function ambvisitdocumentview(persId,eventId){var pwxPVViewerMPage=window.external.DiscernObjectFactory("PVVIEWERMPAGE");
pwxPVViewerMPage.CreateDocViewer(persId);
pwxPVViewerMPage.AppendDocEvent(eventId);
pwxPVViewerMPage.LaunchDocViewer();
}visitcompContentElem.off("click",".visit-click-detail");
visitcompContentElem.on("click",".visit-click-detail",function(event){var jsonId=$(this).attr("id").split("_");
var $visitdetailContentElem=$(".pwx_vi_enc_detail_div_"+visitcompId+"_"+jsonId[2]);
$visitdetailContentElem.html('<div class="pwx_loading_div" id="pwx_vi-loading_text">'+thiz.avI18nObj.LOAD+"...</div>");
pwx_encounter_id_row=$(".pwx-enc-id"+jsonId[2]).html();
pwx_encounter_index_row=$(".pwx-enc-index"+jsonId[2]).html();
if(pwx_encounter_index_row!==0){$(".visit_class_0").attr("style","border-top:1px solid #EDEDED");
}else{$(".visit_class_0").removeAttr("style","border-top:1px solid #EDEDED");
}var DefaultParampass=[];
var BedrockParampass=[];
var sendAr=null;
var request=null;
DefaultParampass=["^MINE^",pid+".0",uid+".0",pwx_encounter_id_row+".0",posid+".0",1];
BedrockParampass=thiz.getbedrockparamArray();
sendAr=DefaultParampass.concat(BedrockParampass);
request=new MP_Core.ScriptRequest(thiz,thiz.getComponentLoadTimerName());
request.setProgramName("AMB_MP_ENCOUNTER_COMP");
request.setParameters(sendAr);
request.setAsync(true);
MP_Core.XMLCCLRequestCallBack(thiz,request,function(reply){var pwxdata=reply.getResponse();
encdetaildefaultind=1;
renderEncounterDetails(pwx_encounter_index_row,pwxdata,encdetaildefaultind,pwx_encounter_id_row);
});
});
var elementMap={};
visitcompContentElem.off("mouseenter",".visit-info");
visitcompContentElem.off("mouseleave",".visit-info");
visitcompContentElem.on("mouseenter",".visit-info",function(event){var anchor=this;
$(this).css("background-color","#FFFCE0");
var anchorId=$(this).attr("id");
if(!elementMap[anchorId]){elementMap[anchorId]={};
}elementMap[anchorId].TIMEOUT=setTimeout(function(){showvisitsHover(event,anchor);
},500);
});
visitcompContentElem.on("mouseleave",".visit-info",function(event){$(this).css("background-color","#FFF");
clearTimeout(elementMap[$(this).attr("id")].TIMEOUT);
});
function showvisitsHover(event,anchor){var jsonId=$(anchor).attr("id").split("_");
switch(jsonId[0]){case"visit":var mainvisitindexarray=mainvisitHvrArray[jsonId[2]];
showvisitsHoverHTML(event,anchor,mainvisitindexarray);
break;
case"diagnosis":var diagnosisindexarray=diagnosisHvrArray[jsonId[2]];
showvisitsHoverHTML(event,anchor,diagnosisindexarray);
break;
case"documents":var documentsindexarray=documentsHvrArray[jsonId[2]];
showvisitsHoverHTML(event,anchor,documentsindexarray);
break;
case"healthplan":var healthindexarray=healthHvrArray[jsonId[2]];
showvisitsHoverHTML(event,anchor,healthindexarray);
break;
}}function showvisitsHoverHTML(event,anchor,visithoverarray){var visithvr=[];
visithvr.push('<div class="result-details pwx_vi_result_details">');
for(var i=0;
i<visithoverarray.length;
i++){visithvr.push('<dl class="visits-det">',"<dt><span>"+visithoverarray[i][0]+"</span></dt><dd><span>"+visithoverarray[i][1]+"</span></dd></dl>");
}visithvr.push("</div>");
var visithvrtooltip=thiz.tooltip;
visithvrtooltip.setX(event.pageX).setY(event.pageY).setAnchor(anchor).setContent(visithvr.join(""));
visithvrtooltip.show();
}};
MP_Util.setObjectDefinitionMapping("AMB_VISITS_ENC",AmbVisitComponent);
