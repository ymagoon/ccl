/************************************************************************
          Date Written:
          Source file name:   SIM_ESOR_AVG_HOUR_REPORT.prg
          Object name:        SIM_ESOR_AVG_HOUR_REPORT
          Request #:
 
          Program purpose:    SIM_ESOR_AVG_HOUR_REPORT report
 
          Executing from:     Explorer Menu
 
 ***********************************************************************
 *                  GENERATED MODIFICATION CONTROL LOG                 *
 ***********************************************************************
 *                                                                     *
 *Mod Date     Engineer             Comment                            *
 *--- -------- -------------------- -----------------------------------*
 *000 05/07/13 JTW                  initial release                    *
 *                                  -Code from MHCRT, last included    *
 *                                   4/2/2013 by M042530               *
 *                                  -This file to create physical      *
 *                                   source code to be re-included     *
 *                                   after a Cerner upgrade.           *
 ***********************************************************************
 
  ******************  END OF ALL MODCONTROL BLOCKS  ********************/
 
DROP PROGRAM   SIM_ESOR_AVG_HOUR_REPORT : DBA  GO
CREATE PROGRAM  SIM_ESOR_AVG_HOUR_REPORT : DBA
PROMPT "Output to File/Printer/MINE" ="MINE" ,
"Error Level" ="0"
 
DECLARE  SIM_ESOR_AVG_HOUR_REPORT_VER  =  VC  WITH  CONSTANT ("001" )
 
DECLARE  ESO_AVG_BY_HOUR_REPORT ( NULL ) =  I4
 
IF ( ( VALIDATE ( NBR_LINES )=0 ) )
DECLARE  NBR_LINES  =  I4  WITH  NOCONSTANT (0 )
ENDIF
 
 
IF ( ( VALIDATE ( LSTATUS )=0 ) )
DECLARE  LSTATUS  =  I4  WITH  NOCONSTANT (0 )
ENDIF
 
 
IF ( ( VALIDATE ( GRAPHQUAL )=0 ) )
DECLARE  GRAPHQUAL  =  I4  WITH  NOCONSTANT (0 )
ENDIF
 
 
IF ( ( VALIDATE ( DATAQUAL )=0 ) )
DECLARE  DATAQUAL  =  I4  WITH  NOCONSTANT (0 )
ENDIF
 
 
IF ( ( VALIDATE ( COLQUAL )=0 ) )
DECLARE  COLQUAL  =  I4  WITH  NOCONSTANT (0 )
ENDIF
 
 
IF ( ( VALIDATE ( STEMP )=0 ) )
DECLARE  STEMP  =  VC  WITH  NOCONSTANT (" " )
ENDIF
 
 
DECLARE  SMODE  =  VC  WITH  NOCONSTANT ("" )
 
IF ( ( VALIDATE ( REPLY )=0 ) )
RECORD  REPLY  (
1  REPORT_NAME  =  VC
1  NUM_OF_LINES  =  I4
1  REPORT_TYPE  =  VC
1  REPORT_LINES [*]
2  LINES  =  VC
1  GRAPHSQUAL [*]
2  GRAPHQUAL [*]
3  HEADERTEXT  =  VC
3  FOOTERTEXT  =  VC
3  GRAPHTYPE  =  I4
3  XAXISTITLE  =  VC
3  YAXISTITLE  =  VC
3  DATAQUAL [*]
4  ROWTEXT  =  VC
4  COLQUAL [*]
5  COLTEXT  =  VC
5  COLDATA  =  F8
1  ADDITIONALINFO [*]
2  INFO_NAME  =  VC
2  STRING_VALUE  =  VC
2  DOUBLE_VALUE  =  F8
2  LONG_VALUE  =  I4
1  STATUS_DATA
2  STATUS  =  C1
2  SUBEVENTSTATUS [1 ]
3  OPERATIONNAME  =  C25
3  OPERATIONSTATUS  =  C1
3  TARGETOBJECTNAME  =  C25
3  TARGETOBJECTVALUE  =  VC )
ENDIF
 
 
 CALL ECHORECORD ( REQUEST )
 
SET  LSTATUS  =  ESO_AVG_BY_HOUR_REPORT ( NULL )
 
 CALL ECHORECORD ( REPLY )
 
SUBROUTINE   ESO_AVG_BY_HOUR_REPORT  ( NULL  )
 
SET  MODE  = 0
SET  SMODE  = "Report for all of today's activity."
SET  REPLY -> REPORT_TYPE  = "HTML"
 CALL ECHO ( CNVTUPPER ( SUBSTRING (1 , 1 ,  REQUEST -> QUAL [1 ]-> PROMPT_TEXT )))
IF ( ( SIZE ( REQUEST -> QUAL , 5 )>0 ) )
CASE (  CNVTUPPER ( SUBSTRING (1 , 1 ,  REQUEST -> QUAL [1 ]-> PROMPT_TEXT )) )
 OF "6" :
SET  MODE  = 5
SET  SMODE  = "Report for the time frame specified"
 OF "5" :
SET  MODE  = 4
SET  SMODE  = "Report for the last week of activity."
 OF "4" :
SET  MODE  = 3
SET  SMODE  = "Report for all activity for the last 24 hours."
 OF "3" :
SET  MODE  = 2
SET  SMODE  = "Report for all activity since yesterday."
 OF "2" :
SET  MODE  = 1
SET  SMODE  = "Report for all of yesterday's activity."
 OF "1" :
SET  SMODE  = "Report for all of today's activity."
 ENDCASE
 
ENDIF
 
SET  STAT  =  ALTERLIST ( REPLY -> GRAPHSQUAL , 1 )
SELECT  INTO  CONCAT ("cer_print:" ,  TRIM ( REPLY -> REPORT_NAME ))
T.PROCESS_STATUS_FLAG,
T.QUEUE_ID,
T.PROCESS_STOP_DT_TM,
T.PROCESS_START_DT_TM,
Q.QUEUE_ID,
 T1 =(( DATETIMEDIFF (T.PROCESS_STOP_DT_TM, T.PROCESS_START_DT_TM)*24.0 )*3600.0 ),
 TT1 =(( DATETIMEDIFF (T.PROCESS_STOP_DT_TM, T.CREATE_DT_TM)*24.0 )*3600.0 ),
 LT1 =(( DATETIMEDIFF (T.PROCESS_START_DT_TM, T.CREATE_DT_TM)*24.0 )*3600.0 ),
 T2 =T.CREATE_DT_TM"DDHH"
 
FROM (
 CQM_FSIESO_TR_1  T
),
(
 CQM_FSIESO_QUE  Q
)
 PLAN ( T
WHERE (T.TRIGGER_ID>0 ) AND (T.PROCESS_STATUS_FLAG=90 ) AND  (( ( MODE =4 ) AND (T.CREATE_DT_TM>=
 CNVTDATETIME (( CURDATE -7 ),  CURTIME3 )) )  OR  ( (( ( MODE =0 ) AND (T.CREATE_DT_TM>=
 CNVTDATETIME ( CURDATE , 0 )) )  OR  ( (( ( MODE =1 ) AND (T.CREATE_DT_TM< CNVTDATETIME ( CURDATE
, 0 )) AND (T.CREATE_DT_TM>= CNVTDATETIME (( CURDATE -1 ), 0 )) )  OR  ( (( ( MODE =2 ) AND (
T.CREATE_DT_TM>= CNVTDATETIME (( CURDATE -1 ), 0 )) )  OR  ( (( ( MODE =3 ) AND (T.CREATE_DT_TM>=
 CNVTDATETIME (( CURDATE -1 ),  CURTIME3 )) )  OR  (( MODE =5 ) AND (T.CREATE_DT_TM>= CNVTDATETIME (
 CNVTDATE ( CNVTINT ( SUBSTRING (1 , 8 ,  REQUEST -> QUAL [2 ]-> PROMPT_TEXT ))),  CNVTINT (
 SUBSTRING (9 , 4 ,  REQUEST -> QUAL [2 ]-> PROMPT_TEXT )))) AND (T.CREATE_DT_TM< CNVTDATETIME (
 CNVTDATE ( CNVTINT ( SUBSTRING (1 , 8 ,  REQUEST -> QUAL [3 ]-> PROMPT_TEXT ))),  CNVTINT (
 SUBSTRING (9 , 4 ,  REQUEST -> QUAL [3 ]-> PROMPT_TEXT )))) ))  ))  ))  ))  )) )
 AND ( Q
WHERE (T.QUEUE_ID=Q.QUEUE_ID))
 
ORDER BY T.CREATE_DT_TM
 
HEAD REPORT
 ROW +0 ,
"<HTML>" ,
 ROW +1 ,
"<STYLE>" ,
 ROW +1 ,
"H1 {Text-Align:Center; Background:LIGHTBLUE; font: 14pt Arial; font-weight: Bold}" ,
 ROW +1 ,
"H2 {Text-Align:Center; Background:LIGHTBLUE; font: 12pt Arial; font-weight: Bold}" ,
 ROW +1 ,
"H3 {Text-Align:Center; Background:LIGHTBLUE; font: 10pt Arial; font-weight: Bold}" ,
 ROW +1 ,
"H4 {Text-Align:Center; Background:LIGHTBLUE; font: 8pt Arial; font-weight: Bold}" ,
 ROW +1 ,
"CAPTION {font: 10pt Arial; text-Align:Center;font-weight:bold}" ,
 ROW +1 ,
"TD {font: 9pt Arial}" ,
 ROW +1 ,
"TH {font: 10pt Arial;font-weight:bold}" ,
 ROW +1 ,
"BODY {font: 9pt Arial}" ,
 ROW +1 ,
"#TOTAL {font: 12pt Arial; text-Align:Center;font-weight:bold}" ,
 ROW +1 ,
"#FAILED {font: 9pt Arial; Background:RED; font-weight:Bold}" ,
 ROW +1 ,
"#INACTIVE {font: 10pt Arial;font-weight:bold ; Background:WHITE; color:RED }" ,
 ROW +1 ,
"</STYLE>" ,
 ROW +1 ,
"<HEAD>" ,
 STEMP = CONCAT ("<TITLE Style =" , '"' , "Position:Center" , '"' ,
">ESO AVERAGES BY MESSAGE TYPE:</TITLE>" ),
 ROW +1 ,
 STEMP ,
 STEMP = CONCAT ("<META NAME=" , '"' , "HAND-CREATED" , '"' , " CONTENT=" , '"' , "By GENE" , '"' ,
">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</HEAD>" ,
 ROW +1 ,
"<BODY>" ,
 STEMP = CONCAT ("<H1>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"ESO AVERAGES BY MESSAGE TYPE:" ,
 ROW +1 ,
"</H1>" ,
 STEMP = CONCAT ("<H2>" ),
 ROW +1 ,
 STEMP ,
 STEMP = CONCAT ("Report Type: " ,  TRIM ( SMODE )),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</H2>" ,
 STEMP = CONCAT ("The time zone for selection is: " ,  TRIM ( DATETIMEZONEBYINDEX ( CURTIMEZONEAPP )
)),
 ROW +1 ,
 STEMP ,
 DTEMP =((20 *11 )+195 ),
 STEMP = CONCAT ("<DIV ID=" , '"' , "HOURLY" , '"' , " Style = " , '"' , "position:absolute;top:" ,
 CNVTSTRING ( DTEMP ), ";left:0;width:100%" , '"' , ">" ),
 ROW +1 ,
 STEMP
HEAD  T2
 GRAPHQUAL =( GRAPHQUAL +1 ), STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL ,  GRAPHQUAL )
, REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> HEADERTEXT = CONCAT (
"Hourly Totals and Averages Since: " ,  FORMAT ( DATETIMEZONE (T.CREATE_DT_TM,  CURTIMEZONEAPP ),
"MM/DD/YY HH;4;q" ), ":00" ), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> FOOTERTEXT =
 CONCAT ( FORMAT ( DATETIMEZONE (T.CREATE_DT_TM,  CURTIMEZONEAPP ), "MM/DD/YY HH;4;q" ), ":00" ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> GRAPHTYPE =1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> XAXISTITLE ="Message Type" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> YAXISTITLE ="Time (Sec.) / Count"
FOOT   T2
 STEMP = CONCAT ("<TABLE Style = " , '"' , "Position:Center;width:80%" , '"' ,
" Align=Center Cols = 4 Border cellspacing = " , '"' , "0" , '"' , " BorderColor = " , '"' ,
"LIGHTBLUE" , '"' , ">" ), ROW +1 , STEMP , STEMP = CONCAT ("<CAPTION Style = " , '"' ,
"font-weight:bold" , '"' , ">Totals and Averages for the " ,  FORMAT ( DATETIMEZONE (T.CREATE_DT_TM
,  CURTIMEZONEAPP ), "HH;4;q" ), ":00 hour on" ,  FORMAT ( DATETIMEZONE (T.CREATE_DT_TM,
 CURTIMEZONEAPP ), "MM/DD/YY ;4;q" ), "</CAPTION>" ), ROW +1 , STEMP , STEMP = CONCAT (
"<TR Style =" , '"' , "text-align:center;font-weight:bold" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,
"<TH>Message Type</TH>" , ROW +1 ,"<TH>Count</TH>" , ROW +1 ,"<TH>Average (Sec.)</TH>" , ROW +1 ,
"<TH>Latency Average (Sec.)</TH>" , ROW +1 ,"</TR>" , STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL , 3 ), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [1 ]-> ROWTEXT ="Average" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL
[2 ]-> ROWTEXT ="Lat Average" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]->
 ROWTEXT ="Count" , STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [1 ]-> COLQUAL , 11 ), STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL , 11 ), STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL , 11 ), ROW +2 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [1 ]-> COLTEXT ="Result" , REPLY -> GRAPHSQUAL [
1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [1 ]-> COLDATA = AVG ( T1
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]->
 COLTEXT ="Result" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [
1 ]-> COLDATA = AVG ( LT1
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [1 ]->
 COLTEXT ="Result" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [
1 ]-> COLDATA = COUNT (T.SEQ
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))), STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ), ROW +1 ,
 STEMP , ROW +1 ,"<TD>Result</TD>" , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [1 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [1 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP
, DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]->
 COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,
"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [2 ]
-> COLTEXT ="Charge" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL
[2 ]-> COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [2 ]-> COLTEXT ="Charge" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [2 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [2 ]-> COLTEXT ="Charge" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [2 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>Charge</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [2 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [2 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [2 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [3 ]-> COLTEXT ="Schedule" , REPLY -> GRAPHSQUAL
[1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [3 ]-> COLDATA = AVG ( T1
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [3 ]
-> COLTEXT ="Schedule" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]->
 COLQUAL [3 ]-> COLDATA = AVG ( LT1
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [3 ]
-> COLTEXT ="Schedule" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]->
 COLQUAL [3 ]-> COLDATA = COUNT (T.SEQ
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))), STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ), ROW +1 ,
 STEMP , ROW +1 ,"<TD>Schedule</TD>" , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [3 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [3 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP
, DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [3 ]->
 COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,
"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [4 ]
-> COLTEXT ="Formulary" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [4 ]-> COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [4 ]-> COLTEXT ="Formulary" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [4 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [4 ]-> COLTEXT ="Formulary" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [4 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>Formulary</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [4 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [4 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [4 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]-> COLTEXT ="FSI Query" , REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]-> COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [5 ]-> COLTEXT ="FSI Query" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [5 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [5 ]-> COLTEXT ="FSI Query" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [5 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>FSI Query</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [5 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [5 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]-> COLTEXT ="HNAUser" , REPLY -> GRAPHSQUAL [
1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]-> COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [6 ]-> COLTEXT ="HNAUser" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [6 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [6 ]-> COLTEXT ="HNAUser" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [6 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>HNAUser</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [6 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [6 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [7 ]-> COLTEXT ="Inventory" , REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [7 ]-> COLDATA = AVG ( T1
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [7 ]
-> COLTEXT ="Inventory" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]->
 COLQUAL [7 ]-> COLDATA = AVG ( LT1
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [7 ]
-> COLTEXT ="Inventory" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]->
 COLQUAL [7 ]-> COLDATA = COUNT (T.SEQ
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))), STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ), ROW +1 ,
 STEMP , ROW +1 ,"<TD>Inventory</TD>" , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [7 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [7 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP
, DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [7 ]->
 COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,
"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [8 ]
-> COLTEXT ="Order" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [
8 ]-> COLDATA = AVG ( T1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [
8 ]-> COLTEXT ="Order" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]->
 COLQUAL [8 ]-> COLDATA = AVG ( LT1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [
8 ]-> COLTEXT ="Order" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]->
 COLQUAL [8 ]-> COLDATA = COUNT (T.SEQ
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ), STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ), ROW +
1 , STEMP , ROW +1 ,"<TD>Order</TD>" , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [8 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [8 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP
, DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [8 ]->
 COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,
"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [9 ]
-> COLTEXT ="Pharmacy" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]->
 COLQUAL [9 ]-> COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [9 ]-> COLTEXT ="Pharmacy" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [9 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [9 ]-> COLTEXT ="Pharmacy" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [9 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>Pharmacy</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [9 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [9 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [9 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +1 , REPLY -> GRAPHSQUAL [1 ]->
 GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]-> COLTEXT ="ADT" , REPLY -> GRAPHSQUAL [1 ]
-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]-> COLDATA = AVG ( T1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" ) )  OR  ((Q.CLASS="TRACK_TRANS" ) )) ), REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [10 ]-> COLTEXT ="ADT" , REPLY
-> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [10 ]-> COLDATA = AVG ( LT1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" ) )  OR  ((Q.CLASS="TRACK_TRANS" ) )) ), REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [10 ]-> COLTEXT ="ADT" , REPLY
-> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [10 ]-> COLDATA = COUNT (
T.SEQ
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" ) )  OR  ((Q.CLASS="TRACK_TRANS" ) )) ), STEMP =
 CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,
"<TD>ADT</TD>" , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]->
 COLQUAL [10 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 ,
 STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]
-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP =
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [10 ]-> COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +
1 , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]-> COLTEXT =
"ProFit" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]->
 COLDATA = AVG ( T1
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [2 ]-> COLQUAL [11 ]-> COLTEXT ="ProFit" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [11 ]-> COLDATA = AVG ( LT1
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )), REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]->
 DATAQUAL [3 ]-> COLQUAL [11 ]-> COLTEXT ="ProFit" , REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [11 ]-> COLDATA = COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )), STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>ProFit</TD>" , DTEMP = REPLY ->
 GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [11 ]-> COLDATA , STEMP =
 CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1
]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,
 CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [
 GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [11 ]-> COLDATA , STEMP = CONCAT ("<TD>" ,  CNVTSTRING (
 DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , STEMP = CONCAT ("<TR Style =" , '"' ,
"text-align:center" , '"' , ">" ), ROW +1 , STEMP , ROW +1 ,"<TD>Total</TD>" , DTEMP = COUNT (T.SEQ)
, STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = AVG ( T1 ),
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , DTEMP = AVG ( LT1 ),
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ), ROW +1 , STEMP , ROW +1 ,"</TR>" , ROW +
1 ,"</TABLE>" , ROW +1 ,"<BR>"
FOOT REPORT
 ROW +1 ,
"</DIV>" ,
 MIN_CREATE_DT_TM = MIN (T.CREATE_DT_TM),
 MAX_CREATE_DT_TM = MAX (T.CREATE_DT_TM),
 GRAPHQUAL =( GRAPHQUAL +1 ),
 STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL ,  GRAPHQUAL ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> HEADERTEXT = CONCAT (
"Processing Totals and Averages Since: " ,  FORMAT ( DATETIMEZONE ( MIN_CREATE_DT_TM ,
 CURTIMEZONEAPP ), ";4;q" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> FOOTERTEXT = CONCAT ( FORMAT ( DATETIMEZONE (
T.CREATE_DT_TM,  CURTIMEZONEAPP ), "MM/DD/YY HH;4;q" ), ":00" ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> GRAPHTYPE =1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> XAXISTITLE ="Message Type" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> YAXISTITLE ="Time (Sec.) / Count" ,
 STEMP = CONCAT ("<DIV ID=" , '"' , "TOTALS" , '"' , " STYLE = " , '"' ,
"position:absolute;top:120;left:0;width:100%" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 STEMP = CONCAT ("<TABLE Style = " , '"' , "Position:Center;width:80%" , '"' ,
" Align=Center Cols = 4 Border cellspacing = " , '"' , "0" , '"' , " BorderColor = " , '"' ,
"DARKBLUE" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 STEMP = CONCAT ("<CAPTION ID= " , '"' , "TOTAL" , '"' , ">Summary of Totals and Averages From " ,
 FORMAT ( DATETIMEZONE ( MIN_CREATE_DT_TM ,  CURTIMEZONEAPP ), "MM/DD/YY HH;4;q" ), ":00" , " To "
,  FORMAT ( DATETIMEZONE ( MAX_CREATE_DT_TM ,  CURTIMEZONEAPP ), "MM/DD/YY HH;4;q" ), ":00" ,
"</CAPTION>" ),
 ROW +1 ,
 STEMP ,
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center;font-weight:bold" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TH>Message Type</TH>" ,
 ROW +1 ,
"<TH>Count</TH>" ,
 ROW +1 ,
"<TH>Average (Sec.)</TH>" ,
 ROW +1 ,
"<TH>Latency Average (Sec.)</TH>" ,
 ROW +1 ,
"</TR>" ,
 STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL , 3 ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> ROWTEXT ="Average" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> ROWTEXT ="Lat Average" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> ROWTEXT ="Count" ,
 STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL ,
11 ),
 STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL ,
11 ),
 STAT = ALTERLIST ( REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL ,
11 ),
 ROW +2 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [1 ]-> COLTEXT =
"Result" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [1 ]-> COLDATA = AVG (
 T1
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]-> COLTEXT =
"Result" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]-> COLDATA = AVG (
 LT1
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [1 ]-> COLTEXT =
"Result" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [1 ]-> COLDATA =
 COUNT (T.SEQ
WHERE (Q.CLASS IN ("CE" ,
"CHART" ))),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Result</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [1 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [1 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [2 ]-> COLTEXT =
"Charge" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [2 ]-> COLDATA = AVG (
 T1
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [2 ]-> COLTEXT =
"Charge" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [2 ]-> COLDATA = AVG (
 LT1
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [2 ]-> COLTEXT =
"Charge" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [2 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 5 , Q.CLASS)="CHARG" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Charge</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [2 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [2 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [2 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [3 ]-> COLTEXT =
"Schedule" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [3 ]-> COLDATA = AVG (
 T1
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [3 ]-> COLTEXT =
"Schedule" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [3 ]-> COLDATA = AVG (
 LT1
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [3 ]-> COLTEXT =
"Schedule" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [3 ]-> COLDATA =
 COUNT (T.SEQ
WHERE (Q.CLASS IN ("EBOOKING" ,
"SCHED" ,
"HIM_CODING" ))),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Schedule</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [3 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [3 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [3 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [4 ]-> COLTEXT =
"Formulary" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [4 ]-> COLDATA = AVG (
 T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [4 ]-> COLTEXT =
"Formulary" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [4 ]-> COLDATA = AVG (
 LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [4 ]-> COLTEXT =
"Formulary" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [4 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FOR" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Formulary</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [4 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [4 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [4 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]-> COLTEXT =
"FSI Query" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]-> COLDATA = AVG (
 T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [5 ]-> COLTEXT =
"FSI Query" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [5 ]-> COLDATA = AVG (
 LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [5 ]-> COLTEXT =
"FSI Query" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [5 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="FSI" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>FSI Query</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [5 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [5 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [5 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]-> COLTEXT =
"HNAUser" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]-> COLDATA = AVG (
 T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [6 ]-> COLTEXT =
"HNAUser" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [6 ]-> COLDATA = AVG (
 LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [6 ]-> COLTEXT =
"HNAUser" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [6 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="HNA" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>HNAUser</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [6 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [6 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [6 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [7 ]-> COLTEXT =
"Inventory" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [7 ]-> COLDATA = AVG (
 T1
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [7 ]-> COLTEXT =
"Inventory" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [7 ]-> COLDATA = AVG (
 LT1
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [7 ]-> COLTEXT =
"Inventory" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [7 ]-> COLDATA =
 COUNT (T.SEQ
WHERE (Q.CLASS IN ("INVENTORY" ,
"PROCURE" ,
"WKFC_MNGMNT" ))),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Inventory</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [7 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [7 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [7 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [8 ]-> COLTEXT =
"Order" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [8 ]-> COLDATA = AVG (
 T1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [8 ]-> COLTEXT =
"Order" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [8 ]-> COLDATA = AVG (
 LT1
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [8 ]-> COLTEXT =
"Order" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [8 ]-> COLDATA =
 COUNT (T.SEQ
WHERE  (( ( SUBSTRING (1 , 3 , Q.CLASS)="ORM" ) )  OR  ((Q.CLASS IN ("SCS_NET" ,
"SCS_TS_APP" )) )) ),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Order</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [8 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [8 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [8 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [9 ]-> COLTEXT =
"Pharmacy" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [9 ]-> COLDATA = AVG (
 T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [9 ]-> COLTEXT =
"Pharmacy" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [9 ]-> COLDATA = AVG (
 LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [9 ]-> COLTEXT =
"Pharmacy" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [9 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PHA" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Pharmacy</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [9 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [9 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [9 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]-> COLTEXT =
"ADT" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]-> COLDATA = AVG
( T1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [10 ]-> COLTEXT =
"ADT" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [10 ]-> COLDATA = AVG
( LT1
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [10 ]-> COLTEXT =
"ADT" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [10 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 3 , Q.CLASS)="PM_" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>ADT</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [10 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [10 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [1 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]-> COLTEXT =
"ProFit" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]-> COLDATA = AVG
( T1
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [11 ]-> COLTEXT =
"ProFit" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [11 ]-> COLDATA = AVG
( LT1
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )),
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [11 ]-> COLTEXT =
"ProFit" ,
 REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [11 ]-> COLDATA =
 COUNT (T.SEQ
WHERE ( SUBSTRING (1 , 4 , Q.CLASS)="PROF" )),
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>ProFit</TD>" ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [3 ]-> COLQUAL [11 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [1 ]-> COLQUAL [11 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = REPLY -> GRAPHSQUAL [1 ]-> GRAPHQUAL [ GRAPHQUAL ]-> DATAQUAL [2 ]-> COLQUAL [11 ]->
 COLDATA ,
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 STEMP = CONCAT ("<TR Style =" , '"' , "text-align:center" , '"' , ">" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"<TD>Total</TD>" ,
 DTEMP = COUNT (T.SEQ),
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = AVG ( T1 ),
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 DTEMP = AVG ( LT1 ),
 STEMP = CONCAT ("<TD>" ,  CNVTSTRING ( DTEMP ), "</TD>" ),
 ROW +1 ,
 STEMP ,
 ROW +1 ,
"</TR>" ,
 ROW +1 ,
"</TABLE>" ,
 ROW +1 ,
"</DIV>" ,
 ROW +1 ,
"</BODY>" ,
 ROW +1 ,
"</HTML>"
 WITH  NOCOUNTER  RETURN (0 )
 
 
END ;Subroutine
 
END GO
 
