<REPORTLAYOUT name="sch_itnry_layout_mayo_mn" group="0" orientation="0" outputtype="0" printhead="0" unittype="0" pageheight="11" pagewidth="8.5" leftmargin="0.5" rightmargin="0.5" topmargin="0.5" bottommargin="0.5" destination="0" severity="1" i18nenabledliterals="0" htmltable="0" locked="0" subreport="0" version="612" timestamp="41534.4498726852" xmlversion="6" programhasprompts="1" executingprogram="" tableview="0" tableborderwidth="0.014" tablebordercolor="0" tablecolumndefault="1" tablebackcolor="16777215" tablebackmode="0" fileversion="2013.12.1.24"><RPTDESCRIPTION><![CDATA[]]></RPTDESCRIPTION><RPTSPOOLWITHOPTIONS><![CDATA[deleted]]></RPTSPOOLWITHOPTIONS><RPTLAYOUT name="PatientPortalSection" height="0.896" order="0" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="PatientPortalSection" left="0.271" top="0.448" width="8.501" height="0.896" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="PatientPortalTxt" left="0.813" top="0.001" width="6.813" height="0.896" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Mayo Clinic offers Online Services for Patients.  These services can be accessed through a secure Web site or the Mayo Clinic Patient Mobile app.  Patient Online services allows you to view portions of your medical record, your appointment schedule, communicate with your care team (available in select departments), complete forms, and view and pay your bill.  To create your account and simplify how you manage your healthcare, visit 
http://www.mayoclinic.org/onlineservices.]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="headsection1" height="0.875" order="1" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="headsection1" left="0.271" top="1.521" width="8.501" height="0.875" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="CMRN" left="2.001" top="0.5" width="2.938" height="0.188" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[trim(cmrn)]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName1" left="0.761" top="0.5" width="1.24" height="0.188" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Mayo Clinic Number:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="2"><RPTFONT ver="1" name="Times" size="1200" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName0" left="0.5" top="0.251" width="7.5" height="0.251" anchor="0" angle="0" flags="20" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Mayo Clinic Health System Patient Itinerary]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="3"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="patname" left="0.75" top="0.688" width="7.25" height="0.188" anchor="0" angle="0" flags="32" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[trim(pat_nme)]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="AddressSection" height="0.188" order="2" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="AddressSection" left="0.271" top="2.573" width="8.501" height="0.188" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="AddressLine" left="0.75" top="0.001" width="7.25" height="0.188" anchor="0" angle="0" flags="32" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[trim(temp_line)]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="LineSeperatorSection" height="0.188" order="3" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="LineSeperatorSection" left="0.271" top="2.938" width="8.501" height="0.188" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTLINE ver="1" name="FieldName0" left="0.5" top="0.001" width="7.49" height="0.188" anchor="0" direction="0"><![CDATA[]]></RPTLINE><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY><![CDATA[]]></RPTDISPLAY></RPTITEM></RPTLAYOUT><RPTLAYOUT name="ApptHeadSection" height="0.271" order="4" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="ApptHeadSection" left="0.271" top="3.303" width="8.501" height="0.271" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName1" left="5.938" top="0.001" width="0.938" height="0.261" anchor="0" angle="0" flags="4" borders="2" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Specimen Type]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY><![CDATA[t_list->loc [d1.seq].appt [d2.seq].rscind = 2]]></RPTDISPLAY></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="resource_label" left="3.126" top="0.021" width="1.021" height="0.251" anchor="0" angle="0" flags="0" borders="2" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[rscLbl]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="2"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName10" left="2.126" top="0.001" width="0.688" height="0.261" anchor="0" angle="0" flags="4" borders="2" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Appt Time:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="3"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName9" left="0.75" top="0.021" width="0.75" height="0.251" anchor="0" angle="0" flags="4" borders="2" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Appt Date:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="footappointment" height="0.344" order="5" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="footappointment" left="0.271" top="3.751" width="8.501" height="0.344" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="spec_type" left="5.875" top="0.001" width="2.126" height="0.282" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[t_list->loc [d1.seq].appt [d2.seq].lab [zz].spec_type]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY><![CDATA[t_list->loc [d1.seq].appt [d2.seq].rscind = 2
and zz > 0]]></RPTDISPLAY></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="resource" left="3.126" top="0.063" width="2.605" height="0.282" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[;;rscType
if (zz = 1)
   rscType
elseif (zz = -1)
   "*Continued*"
else
   T_LIST->LOC [d1.seq].APPT [d2.seq].lab[zz].test

endif]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="2"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="time" left="2.188" top="0.063" width="0.542" height="0.219" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[time]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="3"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="date" left="0.75" top="0.063" width="1.313" height="0.178" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[date]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="AddlLabSection" height="0.271" order="6" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="AddlLabSection" left="0.271" top="4.271" width="8.501" height="0.271" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="spec_type" left="5.875" top="0.001" width="2.126" height="0.282" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[t_list->LOC[d1.seq].appt[d2.seq].lab[zz].spec_type]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="resource" left="3.126" top="0.001" width="2.605" height="0.282" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[t_list->LOC[d1.seq].appt[d2.seq].lab[zz].test]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="footlocation" height="0.563" order="7" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="footlocation" left="0.271" top="4.719" width="8.501" height="0.563" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="phone_nbr" left="1.313" top="0.376" width="1.157" height="0.188" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[cnvtphone(phone_nbr,874)]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="dept_nme" left="1.563" top="0.188" width="4.563" height="0.251" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[dept_nme]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="2"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="build_nme" left="1.563" top="0.001" width="4.563" height="0.251" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[build_nme]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="3"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName7" left="0.688" top="0.376" width="0.563" height="0.188" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Phone #:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="4"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName5" left="0.688" top="0.188" width="0.771" height="0.251" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Department:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="5"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName3" left="0.688" top="0.001" width="0.688" height="0.251" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Building:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="ContinuedSection" height="0.25" order="8" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="ContinuedSection" left="0.271" top="5.459" width="8.501" height="0.251" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName0" left="0.5" top="0.001" width="7.511" height="0.251" anchor="0" angle="0" flags="20" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[** Continued on next page **]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="footprepshead" height="0.25" order="9" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="0.25" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="footprepshead" left="0.271" top="5.886" width="8.501" height="0.251" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="1" italic="0" underline="1" strikethrough="0" color="0"/><RPTLABEL ver="1" name="PreLbl" left="1.125" top="0.001" width="0.521" height="0.251" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Prep:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTDISPLAY><![CDATA[preps > " " and first_time = 1]]></RPTDISPLAY></RPTLAYOUT><RPTLAYOUT name="footpreps" height="0.188" order="10" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="footpreps" left="0.271" top="6.313" width="8.501" height="0.188" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="prep_inst" left="1.375" top="0.001" width="6.375" height="0.188" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="1" backcolor="16777215" backmode="0"><![CDATA[trim(t_list->loc[d1seq].appt[d2seq].preps[tmpseq].prepInstruct, 3)]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY><![CDATA[(preps > " " )
]]></RPTDISPLAY></RPTITEM></RPTLAYOUT><RPTLAYOUT name="FootPageSection" height="0.448" order="11" pagebreak="0" advanceypos="1" maxheight="0" allowmaxheight="0" absolutey="10.1" allowabsolutey="1" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="FootPageSection" left="0.271" top="6.678" width="8.501" height="0.448" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName2" left="0.709" top="0.188" width="0.792" height="0.261" anchor="0" angle="0" flags="4" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[Printed Date:]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="FieldName1" left="2.063" top="0.188" width="0.75" height="0.261" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[CURTIME]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="2"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="FieldName0" left="1.5" top="0.188" width="0.553" height="0.261" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[CURDATE]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="3"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTLABEL ver="1" name="FieldName6" left="1.438" top="0.001" width="6" height="0.251" anchor="0" angle="0" flags="36" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[If you have a Copayment for your visit listed above, be prepared to pay at time of service.]]></RPTLABEL><RPTPEN width="0.014" color="0" style="0"/></RPTITEM><RPTITEM index="4"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="page_nbr" left="5.625" top="0.188" width="1.875" height="0.261" anchor="0" angle="0" flags="64" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"><![CDATA[RPT_PageOfPage]]></RPTTEXT><RPTPEN width="0.014" color="0" style="0"/></RPTITEM></RPTLAYOUT><RPTLAYOUT name="headpagesection" height="9.563" order="12" pagebreak="0" advanceypos="0" maxheight="0" allowmaxheight="0" absolutey="0" allowabsolutey="0" keep="1" expandedheight="1" expanded="1"><RPTFONT ver="1" name="Times" size="1000" bold="0" italic="0" underline="0" strikethrough="0" color="0"/><RPTTEXT ver="1" name="headpagesection" left="0.271" top="7.303" width="8.501" height="9.563" anchor="0" angle="0" flags="0" borders="0" padding="0" paddingsize="0" linespacing="0" rtf="0" grow="0" backcolor="16777215" backmode="0"/><RPTPEN width="0.014" color="0" style="0"/><RPTITEM index="0"><RPTRECT ver="1" name="FieldName10" left="0.5" top="0.001" width="7.511" height="9.563" anchor="0" backcolor="16777215" backmode="0"><![CDATA[]]></RPTRECT><RPTPEN width="0.014" color="0" style="0"/><RPTDISPLAY><![CDATA[]]></RPTDISPLAY></RPTITEM></RPTLAYOUT><RPTQUERY name="LayoutQuery" layout="1"><RPTQUERYSTRING><![CDATA[SELECT INTO "nl:"
	pat_nme = trim(substring(1,50, t_list->patName), 3)
	, build_nme = trim(substring(1,200, t_list->loc[d1.seq].building), 3)
	, dept_nme = trim(substring(1,200, t_list->loc[d1.seq].department), 3)
	, phone_nbr = trim(substring(1,30, t_list->loc[d1.seq].phone), 3)
	, date = trim(substring(1,30, t_list->loc[d1.seq].appt[d2.seq].date), 3)
	, time = trim(substring(1,20, t_list->loc[d1.seq].appt[d2.seq].time), 3)
	, rscLbl = trim(substring(1,40, t_list->loc[d1.seq].appt[d2.seq].rscLbl), 3)
	, rscType = trim(substring(1,50, t_list->loc[d1.seq].appt[d2.seq].rscType), 3)
	, preps = trim(substring(1,100, t_list->loc[d1.seq].appt[d2.seq].preps[d3.seq].prepInstruct), 3)
	, d1seq = d1.seq
	, d2seq = d2.seq
	, d3seq = d3.seq
	, lapptCnt1 = t_list->aptCnt
	, prepLneCnt = t_list->loc[d1.seq].appt[d2.seq].lPrepLneCnt
	, CMRN = trim(substring(1,50, t_list->CMRN), 3)

FROM
	(dummyt   d1  with seq = lLocCnt)
	, (dummyt   d2  with seq = 1)
	, (dummyt   d3  with seq = 1)

plan d1 where maxrec(d2,size(t_list->loc[d1.seq].appt,5))
   join d2 where maxrec(d3, size(t_list->loc[d1.seq].appt[d2.seq].preps,5))
   join d3

ORDER BY
	d1.seq
	, d2.seq
	, d3.seq

WITH NOCOUNTER, SEPARATOR=" ", FORMAT, outerjoin = d2, outerjoin = d3, TIME = 60]]></RPTQUERYSTRING><RPTSELECTIF condition="1"><![CDATA[]]></RPTSELECTIF><RPTSELECTIF condition="0"><![CDATA[]]></RPTSELECTIF><RPTSELECTIF condition="0"><![CDATA[]]></RPTSELECTIF></RPTQUERY><RPTRECORD><![CDATA[record T_LIST (
  1 BEG_DT_TM = DQ8   
  1 END_DT_TM = DQ8   
  1 PATNAME = VC   
  1 LLOCCNT = I4   
  1 LOC [*]  
    2 LOCCD = F8   
    2 BUILDING = VC   
    2 DEPARTMENT = VC   
    2 PHONE = VC   
    2 LAPPTCNT = I4   
    2 APPT [*]  
      3 APPTID = F8   
      3 DATE = VC   
      3 TIME = VC   
      3 RSCIND = I4   
      3 RSCTYPE = VC   
      3 RSCLBL = VC   
      3 LPREPCNT = I4   
      3 PREPS [*]  
        4 PREPINSTRUCT = VC   
) 
]]></RPTRECORD><RPTHEADERS><RPTHEADER name="Head Report" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSEGMENT name="Code Segment"><![CDATA[_fEndDetail = _fEndDetail - 0.45 ; adjusted end detail for har coded section]]></RPTSEGMENT></RPTHEADER><RPTHEADER name="Head Page" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSECTION name="headpagesection"/><RPTSECTION name="headsection1"/><RPTSEGMENT name="Code Segment"><![CDATA[;if (curpage > 1 and lCnt1 < lapptCnt1)
;	dummy_val = PageBreak(0)
;endif
;call echo (" start head report segment ")
;if (lCnt1 < lapptCnt1)
;  dummy_val = HeadPageSection(RPT_RENDER)
;  dummy_val = headsection1(RPT_RENDER)
; call echo (" end head report segment ") 
;endif
;;**************************   Head Page code_segment  ******************************
if (size(T_LIST->addr,5) >0 )
	 temp_line = fillstring(100," ")
for (addr_cnt = 1 to size(T_LIST->addr,5))
     if (trim(T_LIST->addr[addr_cnt].line,3) > " ")
	     temp_line = T_LIST->addr[addr_cnt].line
		dummy_val = addressSection(RPT_RENDER)
	endif
endfor
endif
dummy_val = LineSeperatorSection(RPT_RENDER)
dummy_val = PatientPortalSection(RPT_RENDER)]]></RPTSEGMENT></RPTHEADER><RPTHEADER name="Head d1.seq" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSEGMENT name="Code Segment"><![CDATA[;;**************************   Head d1.seq code_segment  ******************************
call echo (" in head d1 segment ")

/*
; calculate section height
_fDrawHeight = footlocation(RPT_CALCHEIGHT)
; break if bottom of page exceeded
if (_YOffset+_fDrawHeight +
t_list->loc[d1.seq].appt[d2.seq].lPrepLneCnt/2  >_fEndDetail)
	break
endif

if(lCnt1 < lapptCnt1)
  dummy_val = footlocation(RPT_RENDER)
endif

*/

/****** YOUR CODE BEGINS HERE ******/
first_time = 1
call echo (" end head d1 segment ")
/*----- YOUR CODE ENDS HERE -----*/]]></RPTSEGMENT></RPTHEADER><RPTHEADER name="Head d2.seq" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSEGMENT name="Code Segment"><![CDATA[;;**************************   Head d2.seq code_segment 1  ******************************
call echo (" in head d2 code segment 1 ")
call echo (build("d1.seq = ",d1.seq))
call echo (build("d2.seq = ",d2.seq))
call echo (build("current page =",curpage))

if ( size(t_list->loc[d1.seq].appt[d2.seq].PREPS,5) >0)
 for ( tmpseq = 1 to size(t_list->loc[d1.seq].appt[d2.seq].PREPS,5))
		call echo (build(" tmpseq = ",tmpseq))
 
  call echo(" calling drawheight for foot appt and preps") 
	zz = 1
 ;pel  _fDrawHeight = footprepshead(RPT_CALCHEIGHT) + 1
_fDrawHeight = (lineSeperatorSection(RPT_CALCHEIGHT) +
                ApptHeadSection(RPT_CALCHEIGHT) +
                footappointment(RPT_CALCHEIGHT) +
                footlocation(rpt_calcheight) +  ;;
                footprepshead(RPT_CALCHEIGHT) )

if (size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5) > 1)

   call echo ("starting for loop")
   call echo(size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5))
   hold_zz = 0
   hold_zz = zz
   for (zzz = 2 to size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5))
       zz = zzz
       call echo (build("setting zz value -",zz))
      _fDrawHeight = _fDrawHeight + AddlLabSection(RPT_CALCHEIGHT)
   endfor
   zz = hold_zz
endif


; keep together
call echo( "returned from drawheight")
if (_fEndDetail > _YOffset+_fDrawHeight  )
   call echo ("_fEndDetail > _YOffset+_fDrawHeight")
	_bHoldContinue = 0
	call echo (" calling fDrawHeight  ")
	_fDrawHeight = _fDrawHeight+footpreps(RPT_CALCHEIGHT,_fEndDetail-_YOffset-_fDrawHeight,_bHoldContinue)
	if (_bHoldContinue=1) ; force a break to happen
		_fDrawHeight = _fEndDetail + 1
	endif
endif
;009
; break if bottom of page exceeded
call echo("break if bottom of page exceeded")
if (_YOffset+_fDrawHeight>_fEndDetail)
  call echo(" break - _YOffset+_fDrawHeight>_fEndDetail")
	break

	zz = 1
;         dummy_val = footlocation(RPT_RENDER)
endif
;009
_bContfootpreps = 0
; begin grow loop
bFirstTime = 1
loop_cnt = 0
loop_stop = 0
while (_bContfootpreps=1 OR bFirstTime=1 or loop_stop =1)
call echo ("in while loop")
    loop_cnt = loop_cnt + 1
    if (loop_cnt > 100)
    loop_stop = 1
    endif
    call echo (build("loop_cnt =",loop_cnt))
    call echo (_bContfootpreps)
    call echo (bFirstTime)
; calculate section height
_bHoldContinue = _bContfootpreps
_fDrawHeight = footpreps(RPT_CALCHEIGHT,_fEndDetail-_YOffset,_bContfootpreps) ;_bHoldContinue)

;009
; break if bottom of page exceeded
if (_YOffset+_fDrawHeight>_fEndDetail)
	dummy_val = ContinuedSection(RPT_RENDER)  ;099

	break
; keep section if doesn't fit (one time only)
elseif (_bHoldContinue=1 AND _bContfootpreps = 0)
	dummy_val = ContinuedSection(RPT_RENDER)  ;099
	break
endif
;009
bFirstTime = 0
endwhile
 
 endfor

endif


zz = 1

call echo (" end head d2 segment 1 ")]]></RPTSEGMENT><RPTSECTION name="LineSeperatorSection"/><RPTSECTION name="ApptHeadSection"/><RPTSECTION name="footappointment"/><RPTSEGMENT name="Code Segment"><![CDATA[;;**************************   Head d2.seq code_segment 2 ******************************
call echo (" in head d2 code segment 2 ")
if (size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5) > 1)
     zz = 0
;for (zz = 2 to size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5))
;_fDrawHeight = AddlLabSection(RPT_CALCHEIGHT)
;endfor
;*/ commented out for testing
call echo ("starting for loop")
call echo(size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5))
for (zzz = 2 to size(T_LIST->LOC[d1.seq].APPT[d2.seq].lab,5))
  zz = zzz
  call echo (build("zz =",zz))
  _fDrawHeight = AddlLabSection(RPT_CALCHEIGHT)
  call echo(build("_fDrawHeight = ",_fDrawHeight))
  call echo(build("_fEndDetail =",_fEndDetail))
  call echo(build("_YOffset =",_YOffset))
  call echo (_YOffset +_fDrawHeight)
  if (_YOffset+_fDrawHeight >_fEndDetail)
	dummy_val = ContinuedSection(RPT_RENDER)
	break
	dummy_val = LineSeperatorSection(RPT_RENDER)
	dummy_val = ApptHeadSection(RPT_RENDER)
	dummy_val = FootAppointment(RPT_RENDER)
    
;
    call echo ("page break printing lab************************")
;  endif
  else
    dummy_val = AddlLabSection(RPT_RENDER)
  endif
endfor

;;;** what sections do I need to check here?????????
;*/
  _fDrawHeight = footlocation(RPT_CALCHEIGHT)
  if (_YOffset+_fDrawHeight>_fEndDetail)
    if (size(T_LIST->LOC[d1.seq].APPT[d2.seq].PREPS,5) > 0)
   		dummy_val = ContinuedSection(RPT_RENDER)


	break
	dummy_val = LineSeperatorSection(RPT_RENDER)
    zz = -1 ; set zz to display continue
	dummy_val = ApptHeadSection(RPT_RENDER)
	dummy_val = FootAppointment(RPT_RENDER)
   	endif
  endif
zz = 1 ; reset zz
endif

call echo (build("_YOffset =",_YOffset))
call echo (build("_fEndDetail =",_fEndDetail))
call echo (" end head d2 code segment 2 ")]]></RPTSEGMENT><RPTSECTION name="footlocation"/></RPTHEADER><RPTHEADER name="Head d3.seq" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSEGMENT name="Code Segment"><![CDATA[;;**************************   Head d3.seq code_segment  ******************************
call echo (" in head d3 segment ")
    if (size(T_LIST->LOC[d1.seq].APPT[d2.seq].PREPS,5) > 0)


tmpseq = d3seq
; calculate section height
call echo (" calc footprepshead  ")

;pel  _fDrawHeight = footprepshead(RPT_CALCHEIGHT) + 1
_fDrawHeight = footprepshead(RPT_CALCHEIGHT) 
; keep together
if (_fEndDetail >= _YOffset+_fDrawHeight  )
	_bHoldContinue = 0
	call echo (" calling fDrawHeight  ")
	_fDrawHeight = _fDrawHeight+footpreps(RPT_CALCHEIGHT,_fEndDetail-_YOffset-_fDrawHeight,_bHoldContinue)
	if (_bHoldContinue=1) ; force a break to happen
		_fDrawHeight = _fEndDetail + 1
	endif
endif
;009
; break if bottom of page exceeded
if (_YOffset+_fDrawHeight >= _fEndDetail)
    if (size(T_LIST->LOC[d1.seq].APPT[d2.seq].PREPS,5) > 0)

		dummy_val = ContinuedSection(RPT_RENDER)
	endif

	zz = -1
	break
	dummy_val = LineSeperatorSection(RPT_RENDER)  ;pel page break
    zz = -1 ; set zz to display continue
	dummy_val = ApptHeadSection(RPT_RENDER) ;pel page break
	dummy_val = FootAppointment(RPT_RENDER) ;pel page break

;         dummy_val = footlocation(RPT_RENDER)
	zz = 1
endif
;009
call echo (" render footprepshead  ")
dummy_val = footprepshead(RPT_RENDER)
_bContfootpreps = 0
; begin grow loop
bFirstTime = 1
while (_bContfootpreps=1 OR bFirstTime=1)

; calculate section height
_bHoldContinue = _bContfootpreps
_fDrawHeight = footpreps(RPT_CALCHEIGHT,_fEndDetail-_YOffset,_bContfootpreps)

;009
; break if bottom of page exceeded
if (_YOffset+_fDrawHeight >_fEndDetail)
	zz = -1
	dummy_val = ContinuedSection(RPT_RENDER)

	break
	dummy_val = LineSeperatorSection(RPT_RENDER)  ;pel page break
    zz = -1 ; set zz to display continue
	dummy_val = ApptHeadSection(RPT_RENDER) ;pel page break
	dummy_val = FootAppointment(RPT_RENDER) ;pel page break

; keep section if doesn't fit (one time only)
elseif (_bHoldContinue=1 AND _bContfootpreps = 0)
	zz = -1
	dummy_val = ContinuedSection(RPT_RENDER)

	break
	dummy_val = LineSeperatorSection(RPT_RENDER)  ;pel page break
    zz = -1 ; set zz to display continue
	dummy_val = ApptHeadSection(RPT_RENDER) ;pel page break
	dummy_val = FootAppointment(RPT_RENDER) ;pel page break

endif
;009
dummy_val = footpreps(RPT_RENDER,_fEndDetail-_YOffset,_bContfootpreps)
bFirstTime = 0
endwhile
endif
	zz = 1

/****** YOUR CODE BEGINS HERE ******/
first_time = 0
;call echo (" end head d3 segment ")
;call echorecord(t_list)
/*----- YOUR CODE ENDS HERE -----*/
call echo (" end head d3 code segment ")]]></RPTSEGMENT></RPTHEADER><RPTHEADER name="Foot Page" version="1" keeptogether="1" keepgroup="0" repeat="0" forcefootpage="0"><RPTSEGMENT name="Code Segment"><![CDATA[;;**************************   Foot Page code_segment  ******************************
call echo (" in foot report segment ")
;;_YHold = _YOffset
;;_YOffset = _fEndDetail

;;  dummy_val = FootPageSection(RPT_RENDER)

;;_YOffset = _YHold

call echo (" end foot report segment ")]]></RPTSEGMENT><RPTSECTION name="FootPageSection"/></RPTHEADER></RPTHEADERS></REPORTLAYOUT>
